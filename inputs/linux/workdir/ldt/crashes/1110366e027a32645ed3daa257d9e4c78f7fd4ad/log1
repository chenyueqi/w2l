
Debian GNU/Linux 9 syzkaller ttyS0

Warning: Permanently added '[localhost]:51727' (ECDSA) to the list of known hosts.
2020/04/20 20:33:53 fuzzer started
2020/04/20 20:33:54 dialing manager at 10.0.2.10:40665
2020/04/20 20:33:54 syscalls: 4
2020/04/20 20:33:54 code coverage: enabled
2020/04/20 20:33:54 comparison tracing: enabled
2020/04/20 20:33:54 extra coverage: enabled
2020/04/20 20:33:54 setuid sandbox: enabled
2020/04/20 20:33:54 namespace sandbox: /proc/self/ns/user does not exist
2020/04/20 20:33:54 Android sandbox: enabled
2020/04/20 20:33:54 fault injection: CONFIG_FAULT_INJECTION is not enabled
2020/04/20 20:33:54 leak checking: CONFIG_DEBUG_KMEMLEAK is not enabled
2020/04/20 20:33:54 net packet injection: /dev/net/tun does not exist
2020/04/20 20:33:54 net device setup: enabled
2020/04/20 20:33:54 concurrency sanitizer: /sys/kernel/debug/kcsan does not exist
2020/04/20 20:33:54 devlink PCI setup: PCI device 0000:00:10.0 is not available
2020/04/20 20:33:54 USB emulation: /dev/raw-gadget does not exist
20:33:54 executing program 0:
modify_ldt$write(0x1, &(0x7f0000000000)={0x2358, 0x1000, 0x1000, 0x1, 0x3, 0x1, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000040)={0xe58f, 0x100000, 0xffffffffffffffff, 0x1, 0x3, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000080)={0x8, 0x20001000, 0x2000, 0x1, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f00000000c0)=""/33, 0x21)
modify_ldt$read_default(0x2, &(0x7f0000000100)=""/106, 0x6a)
modify_ldt$write(0x1, &(0x7f0000000180)={0x8001, 0x100000, 0x4000, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000001c0)={0x9, 0x20000000, 0x6000, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000200)={0x7fffffff, 0x1000, 0x400, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000240)={0xffffffff, 0x20001000, 0xffffffffffffffff, 0x0, 0x2, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000280)={0x0, 0x20000800, 0x2000, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000002c0)={0x7, 0x20000800, 0x4000, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000300)=""/90, 0x5a)
modify_ldt$write2(0x11, &(0x7f0000000380)={0x7445e09d, 0x100000, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000003c0)={0x7fff, 0x20000000, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000400)={0x40000, 0x100000, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000440)={0x4, 0xffffffffffffffff, 0x2000, 0x1, 0x2, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000480)={0x8, 0x20000000, 0xffffffffffffffff, 0x0, 0x2, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000004c0)={0x2, 0x0, 0x2000, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000500)={0x0, 0x20000800, 0x2000, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000540)={0x4, 0x20000000, 0x2000, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1}, 0x10)

20:33:54 executing program 1:
modify_ldt$read_default(0x2, &(0x7f0000000000)=""/43, 0x2b)
modify_ldt$read(0x0, &(0x7f0000000040)=""/66, 0x42)
modify_ldt$read(0x0, &(0x7f00000000c0)=""/122, 0x7a)
modify_ldt$read_default(0x2, &(0x7f0000000140)=""/247, 0xf7)
modify_ldt$read(0x0, &(0x7f0000000240)=""/176, 0xb0)
modify_ldt$read(0x0, &(0x7f0000000300)=""/164, 0xa4)
modify_ldt$write2(0x11, &(0x7f00000003c0)={0xc4, 0x20000000, 0x0, 0x1, 0x2, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000400)=""/67, 0x43)
modify_ldt$write(0x1, &(0x7f0000000480)={0x8, 0xffffffffffffffff, 0x0, 0x1, 0x2, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000004c0)={0x6, 0x0, 0x1000, 0x0, 0x3, 0x1, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000500)=""/157, 0x9d)
modify_ldt$write(0x1, &(0x7f00000005c0)={0x1f, 0x20001000, 0xffffffffffffffff, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000600)={0x1, 0x20000000, 0x2000, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000640)={0xd486, 0x1000, 0x0, 0x1, 0x3, 0x1, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000680)={0x80000000, 0x0, 0x1000, 0x0, 0x2, 0x0, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000006c0)={0x8, 0x1000, 0x2000, 0x1, 0x3, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000700)={0x1, 0x0, 0x4000, 0x1, 0x2, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000740)=""/208, 0xd0)
modify_ldt$read(0x0, &(0x7f0000000840)=""/69, 0x45)
modify_ldt$write2(0x11, &(0x7f00000008c0)={0x81, 0x1000, 0x45b45206bdc47c27, 0x0, 0x3, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)

20:33:54 executing program 2:
modify_ldt$read(0x0, &(0x7f0000000000)=""/46, 0x2e)
modify_ldt$read_default(0x2, &(0x7f0000000040)=""/84, 0x54)
modify_ldt$read_default(0x2, &(0x7f00000000c0)=""/19, 0x13)
modify_ldt$write2(0x11, &(0x7f0000000100)={0x1, 0x100000, 0x2000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000140)={0x3, 0x20001000, 0x0, 0x1, 0x3, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000180)={0x4, 0xffffffffffffffff, 0x1000, 0x1, 0x2}, 0x10)
modify_ldt$read(0x0, &(0x7f00000001c0)=""/4096, 0x1000)
modify_ldt$read(0x0, &(0x7f00000011c0)=""/116, 0x74)
modify_ldt$write(0x1, &(0x7f0000001240)={0xfffffffa, 0x20000000, 0x2000, 0x1, 0x3, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000001280)={0x0, 0x20000800, 0x1000, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f00000012c0)=""/17, 0x11)
modify_ldt$read(0x0, &(0x7f0000001300)=""/1, 0x1)
modify_ldt$write2(0x11, &(0x7f0000001340)={0x80000001, 0x0, 0x400, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001380)={0x6, 0x20000000, 0x400, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000013c0)={0x2, 0x100000, 0x2000, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001400)={0x80, 0xffffffffffffffff, 0x1315931822e2ba13, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000001440)=""/91, 0x5b)
modify_ldt$read(0x0, &(0x7f00000014c0)=""/193, 0xc1)
modify_ldt$write2(0x11, &(0x7f00000015c0)={0x5, 0x20000800, 0x2000, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000001600)={0x5, 0x20000800, 0x1000, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)

20:33:54 executing program 3:
modify_ldt$read(0x0, &(0x7f0000000000)=""/104, 0x68)
modify_ldt$read(0x0, &(0x7f0000000080)=""/4096, 0x1000)
modify_ldt$read(0x0, &(0x7f0000001080), 0x0)
modify_ldt$read(0x0, &(0x7f00000010c0)=""/147, 0x93)
modify_ldt$write(0x1, &(0x7f0000001180)={0x4, 0x20001000, 0xffffffffffffffff, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000011c0)={0x2, 0x20000800, 0xffffffffffffffff, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001200)={0x401, 0x1000, 0x1000, 0x1, 0x3, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000001240)={0xffffffff, 0x20001000, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001280)={0x8, 0x20001000, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000012c0)={0x8001, 0x20001000, 0x1000, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001300)={0x4, 0x1000, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001340)={0x9, 0x20001000, 0x4000, 0x0, 0x2, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000001380)={0x9, 0x20001000, 0xffffffffffffffff, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000013c0)={0x5337, 0x20001000, 0x1000, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000001400)={0x6, 0xffffffffffffffff, 0x4000, 0x0, 0x3, 0x0, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001440)={0x5, 0x0, 0x0, 0x0, 0x2, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001480)={0x0, 0x20000000, 0x2000, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000014c0)={0xab, 0x20000800, 0x2000, 0x1, 0x3, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001500)={0x1, 0x20000800, 0x400, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000001540)=""/20, 0x14)

syzkaller login: [   10.776991] audit: type=1400 audit(1587414834.784:8): avc:  denied  { execmem } for  pid=329 comm="syz-executor.0" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   10.882235] cgroup1: Unknown subsys name 'perf_event'
[   10.893321] cgroup1: Unknown subsys name 'net_cls'
[   10.922968] cgroup1: Unknown subsys name 'perf_event'
[   10.926567] cgroup1: Unknown subsys name 'net_cls'
[   10.928412] cgroup1: Unknown subsys name 'perf_event'
[   10.930250] cgroup1: Unknown subsys name 'perf_event'
[   10.934666] cgroup1: Unknown subsys name 'net_cls'
[   10.937047] cgroup1: Unknown subsys name 'net_cls'
[   10.963082] ------------[ cut here ]------------
[   10.965669] Found leaking site of nlattr
[   10.966031] WARNING: CPU: 0 PID: 334 at lib/nlattr.c:522 nla_strlcpy+0xa0/0x1e0
[   10.970463] Kernel panic - not syncing: panic_on_warn set ...
[   10.973490] CPU: 0 PID: 334 Comm: syz-executor.2 Not tainted 5.5.3 #56
[   10.976786] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.0-59-gc9ba5276e321-prebuilt.qemu.org 04/01/2014
[   10.981621] Call Trace:
[   10.982721]  dump_stack+0x15e/0x1ae
[   10.984348]  panic+0x228/0x700
[   10.985614]  ? nla_strlcpy+0xa0/0x1e0
[   10.987508]  __warn+0x1fe/0x200
[   10.989034]  ? nla_strlcpy+0xa0/0x1e0
[   10.990934]  report_bug+0x359/0x480
[   10.992760]  ? nla_strlcpy+0xa0/0x1e0
[   10.994604]  do_invalid_op+0x6e/0x110
[   10.996130]  invalid_op+0x1e/0x30
[   10.997498] RIP: 0010:nla_strlcpy+0xa0/0x1e0
[   10.999368] Code: 81 c7 48 06 00 00 48 c7 c6 6f 20 7e 9f e8 d8 24 b8 01 48 85 c0 74 1e e8 9e b6 57 ff 48 c7 c7 05 03 80 9f 31 c0 e8 b0 05 31 ff <0f> 0b eb 0c e8 87 b6 57 ff eb 05 e8 80 b6 57 ff 49 83 c7 04 31 ff
[   11.008282] RSP: 0018:ffff88804f40f4f0 EFLAGS: 00010246
[   11.010942] RAX: 49a9dcd8f7161c00 RBX: 000000000000000a RCX: 0000000000000000
[   11.014387] RDX: ffff88806c751d00 RSI: 0000000000000224 RDI: 0000000000000224
[   11.017898] RBP: 0000000000000002 R08: dffffc0000000000 R09: fffffbfff40a8bc3
[   11.021416] R10: fffffbfff40a8bc3 R11: 0000000000000000 R12: 0000000000000010
[   11.024911] R13: dffffc0000000000 R14: ffff88804f40f5d0 R15: ffff88806a2c4820
[   11.028454]  ? rtnl_newlink+0x2cb/0x1c00
[   11.030341]  rtnl_newlink+0x2e0/0x1c00
[   11.031689]  ? arch_stack_walk+0x7d/0xf0
[   11.033314]  ? __is_insn_slot_addr+0xb0/0xd0
[   11.035497]  ? stack_trace_save+0x150/0x150
[   11.037262]  ? kernel_text_address+0xa9/0xf0
[   11.038980]  ? __kernel_text_address+0x9/0x40
[   11.041148]  ? unwind_get_return_address+0x48/0x90
[   11.043497]  ? avc_has_perm_noaudit+0x29c/0x360
[   11.045736]  ? stack_trace_save+0x150/0x150
[   11.047796]  ? __is_insn_slot_addr+0xb0/0xd0
[   11.049935]  ? cred_has_capability+0x136/0x330
[   11.052187]  ? cred_has_capability+0x236/0x330
[   11.054495]  ? arch_stack_walk+0x98/0xf0
[   11.056665]  ? mutex_lock+0x71/0xc0
[   11.058383]  ? rtnl_setlink+0x490/0x490
[   11.060516]  rtnetlink_rcv_msg+0xa1d/0xb90
[   11.062614]  ? __kasan_kmalloc+0x11d/0x1b0
[   11.064545]  ? __kmalloc_node_track_caller+0x15f/0x370
[   11.067549]  ? __alloc_skb+0xde/0x4f0
[   11.069492]  ? netlink_sendmsg+0x76d/0xd10
[   11.071266]  ? __sys_sendto+0x608/0x620
[   11.073074]  ? __x64_sys_sendto+0xda/0xf0
[   11.074610]  ? do_syscall_64+0xd1/0x160
[   11.076423]  ? entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   11.078427]  ? do_syscall_64+0xd1/0x160
[   11.079829]  ? entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   11.081738]  ? __kasan_kmalloc+0x17b/0x1b0
[   11.083368]  ? __kasan_kmalloc+0x11d/0x1b0
[   11.085274]  ? kmem_cache_alloc+0x11e/0x200
[   11.087765]  ? security_file_alloc+0x32/0x200
[   11.090235]  ? __alloc_file+0xc6/0x390
[   11.092498]  ? alloc_empty_file+0xa7/0x1b0
[   11.094789]  ? alloc_file+0x58/0x4a0
[   11.096634]  ? alloc_file_pseudo+0x1b0/0x240
[   11.098760]  ? sock_alloc_file+0xb4/0x240
[   11.101060]  ? __sys_socket+0x139/0x2d0
[   11.102964]  ? __x64_sys_socket+0x76/0x80
[   11.104968]  ? do_syscall_64+0xd1/0x160
[   11.106882]  ? entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   11.109667]  ? alloc_file+0x58/0x4a0
[   11.111455]  ? alloc_file_pseudo+0x1b0/0x240
[   11.113635]  ? sock_alloc_file+0xb4/0x240
[   11.115736]  ? __sys_socket+0x139/0x2d0
[   11.117680]  ? __x64_sys_socket+0x76/0x80
[   11.119734]  ? rhashtable_jhash2+0x1cf/0x2f0
[   11.121878]  ? jhash+0x7c0/0x7c0
[   11.123533]  ? rht_key_hashfn+0xba/0x150
[   11.125544]  netlink_rcv_skb+0x196/0x3c0
[   11.127556]  ? rtnetlink_bind+0x80/0x80
[   11.129558]  netlink_unicast+0x872/0xbe0
[   11.131605]  netlink_sendmsg+0x9ed/0xd10
[   11.133775]  ? netlink_getsockopt+0x930/0x930
[   11.135818]  __sys_sendto+0x608/0x620
[   11.137880]  ? fd_install+0xe6/0x230
[   11.139818]  ? sock_alloc_file+0x19d/0x240
[   11.142082]  __x64_sys_sendto+0xda/0xf0
[   11.144197]  do_syscall_64+0xd1/0x160
[   11.146071]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   11.148867] RIP: 0033:0x4168c4
[   11.150574] Code: c0 ff ff ff ff eb b5 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 8b 05 ae 1a 87 00 41 89 ca 85 c0 75 13 b8 2c 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 74 f3 c3 66 90 41 57 41 56 4d 89 c7 41 55 41
[   11.160491] RSP: 002b:00007ffe783bc188 EFLAGS: 00000246 ORIG_RAX: 000000000000002c
[   11.165003] RAX: ffffffffffffffda RBX: 0000000000c82200 RCX: 00000000004168c4
[   11.168791] RDX: 0000000000000044 RSI: 0000000000c82250 RDI: 0000000000000003
[   11.172527] RBP: 0000000000000000 R08: 00007ffe783bc19c R09: 000000000000000c
[   11.176254] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
[   11.179962] R13: 0000000000000000 R14: 0000000000c82250 R15: 0000000000000003
[   11.184202] Dumping ftrace buffer:
[   11.186093]    (ftrace buffer empty)
[   11.187866] Kernel Offset: 0x1b800000 from 0xffffffff81000000 (relocation range: 0xffffffff80000000-0xffffffffbfffffff)
[   11.193259] Rebooting in 1 seconds..
