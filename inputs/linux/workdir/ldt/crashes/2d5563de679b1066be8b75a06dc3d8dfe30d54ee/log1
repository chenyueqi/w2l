Warning: Permanently added '[localhost]:62919' (ECDSA) to the list of known hosts.
2020/04/20 20:37:34 fuzzer started
2020/04/20 20:37:35 dialing manager at 10.0.2.10:40133
2020/04/20 20:37:35 syscalls: 4
2020/04/20 20:37:35 code coverage: enabled
2020/04/20 20:37:35 comparison tracing: enabled
2020/04/20 20:37:35 extra coverage: enabled
2020/04/20 20:37:35 setuid sandbox: enabled
2020/04/20 20:37:35 namespace sandbox: /proc/self/ns/user does not exist
2020/04/20 20:37:35 Android sandbox: enabled
2020/04/20 20:37:35 fault injection: CONFIG_FAULT_INJECTION is not enabled
2020/04/20 20:37:35 leak checking: CONFIG_DEBUG_KMEMLEAK is not enabled
2020/04/20 20:37:35 net packet injection: /dev/net/tun does not exist
2020/04/20 20:37:35 net device setup: enabled
2020/04/20 20:37:35 concurrency sanitizer: /sys/kernel/debug/kcsan does not exist
2020/04/20 20:37:35 devlink PCI setup: PCI device 0000:00:10.0 is not available
2020/04/20 20:37:35 USB emulation: /dev/raw-gadget does not exist
20:37:36 executing program 0:
modify_ldt$read_default(0x2, &(0x7f0000000000)=""/102, 0x66)
modify_ldt$write2(0x11, &(0x7f0000000080)={0x8, 0x20000800, 0x400, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000000c0)={0x0, 0x20000800, 0xffffffffffffffff, 0x1, 0x3, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000100)={0x2dc, 0x20000000, 0x400, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000140)={0x2, 0xffffffffffffffff, 0x400, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000180)={0x4, 0x20101800, 0x1000, 0x1, 0x2, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000001c0)={0x7, 0x0, 0x2000, 0x1, 0x2, 0x0, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000200)=""/228, 0xe4)
modify_ldt$write2(0x11, &(0x7f0000000300)={0x2, 0x20000000, 0x0, 0x0, 0x2, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000340)={0x10001, 0x0, 0x1000, 0x1, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000380)=""/202, 0xca)
modify_ldt$write2(0x11, &(0x7f0000000480)={0x4f50, 0x100000, 0x4000, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000004c0)={0x3, 0x0, 0x1000, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000500)={0x0, 0x100000, 0x2000, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000540)=""/98, 0x62)
modify_ldt$read(0x0, &(0x7f00000005c0)=""/65, 0x41)
modify_ldt$write(0x1, &(0x7f0000000640)={0x80000001, 0x0, 0x1000, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000680)={0x400, 0x20001000, 0x2000, 0x1, 0x2, 0x1, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000006c0)={0x3ff, 0x20000000, 0x4000, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000700)={0xffff, 0x20001000, 0x1000, 0x0, 0x2, 0x1, 0x0, 0x1, 0x1}, 0x10)

20:37:36 executing program 3:
modify_ldt$write(0x1, &(0x7f0000000000)={0x1000, 0x20000000, 0x0, 0x1, 0x3, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000040)={0x3ff, 0x100000, 0x2000, 0x0, 0x2, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000080)=""/18, 0x12)
modify_ldt$write2(0x11, &(0x7f00000000c0)={0x2, 0x1000, 0x3400, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000100)={0x1, 0x20000800, 0x400, 0x1, 0x2, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000140)={0x3ff, 0x100000, 0x2000, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000180)={0x6f, 0x8040af862bef45a9, 0x2000, 0x0, 0x3, 0x0, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000001c0)={0x7, 0x1000, 0xffffffffffffffff, 0x1, 0x3, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000200)=""/213, 0xd5)
modify_ldt$write2(0x11, &(0x7f0000000300)={0x0, 0x20000000, 0x4000, 0x0, 0x3, 0x1, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000340)={0x10001, 0x1000, 0x400}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000380)=""/95, 0x5f)
modify_ldt$write(0x1, &(0x7f0000000400)={0x4, 0x20000800, 0x2000, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000440)={0x4, 0x1000, 0x1000, 0x1, 0x2, 0x0, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000480)=""/56, 0x38)
modify_ldt$read(0x0, &(0x7f00000004c0)=""/68, 0x44)
modify_ldt$read(0x0, &(0x7f0000000540)=""/146, 0x92)
modify_ldt$write(0x1, &(0x7f0000000600)={0x5, 0x0, 0x4000, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000640)={0x7, 0x20000800, 0x0, 0x0, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000680)={0x98e, 0xffffffffffffffff, 0x2000, 0x1, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)

20:37:36 executing program 1:
modify_ldt$read_default(0x2, &(0x7f0000000000)=""/153, 0x99)
modify_ldt$write(0x1, &(0x7f00000000c0)={0x6, 0x1000, 0x400, 0x0, 0x2, 0x0, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000100)={0x5, 0x20000800, 0x400, 0x1, 0x2, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000140)={0x1, 0x100000, 0x2000, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000180)={0x10000, 0x20001000, 0xee637f7ecff32091, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000001c0)={0x6, 0x20001000, 0x400, 0x1, 0x2, 0x1, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000200)={0x7f, 0x100000, 0xffffffffffffffff, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000240)={0x6, 0x20000800, 0x1400, 0x1, 0x2, 0x0, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000280)={0xa1, 0x0, 0x1000, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000002c0)={0x80, 0x0, 0x7000, 0x0, 0x3, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000300)={0x4, 0x20000000, 0xffffffffffffffff, 0x0, 0x3, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000340)={0x9, 0x1000, 0x2000, 0x0, 0x2, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000380)={0x7fffffff, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000003c0)={0x7ff800, 0xffffffffffffffff, 0x4000, 0x1, 0x3, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000400)={0xfffffffa, 0x20000000, 0xffffffffffffefff, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000440)=""/93, 0x5d)
modify_ldt$write(0x1, &(0x7f00000004c0)={0x1, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000500)={0xfffff67e, 0xffffffffffffffff, 0x0, 0x1, 0x2, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000540)={0xc3, 0x1000, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000580)={0xa85e0d63, 0x0, 0x4000, 0x0, 0x3, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)

syzkaller login: [   11.079061] audit: type=1400 audit(1587415056.084:8): avc:  denied  { execmem } for  pid=340 comm="syz-executor.0" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
20:37:36 executing program 2:
modify_ldt$write(0x1, &(0x7f0000000000)={0xd8, 0x0, 0x4000, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000040)={0x40, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000080)=""/71, 0x47)
modify_ldt$write(0x1, &(0x7f0000000100)={0x7, 0x20000000, 0xffffffffffffffff, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000140)={0x1, 0xffffffffffffffff, 0x4000, 0x0, 0x3}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000180)={0x4, 0x1000, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000001c0)={0x6, 0x100000, 0xffffffffffffffff, 0x1, 0x3, 0x0, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000200)={0x10000, 0x20000000, 0x400, 0x0, 0x3, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000240)={0x9, 0x100000, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000280)={0x9, 0x20000000, 0x1000, 0x1, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000002c0)={0x4, 0x1000, 0xffffffffffffffff, 0x1, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000300)={0x3, 0x100000, 0x4000, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000340)={0x9, 0x20000000, 0x2000, 0x0, 0x3}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000380)=""/41, 0x29)
modify_ldt$write2(0x11, &(0x7f00000003c0)={0x9, 0x20101000, 0x400, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000400)=""/158, 0x9e)
modify_ldt$read_default(0x2, &(0x7f00000004c0)=""/38, 0x26)
modify_ldt$write(0x1, &(0x7f0000000500)={0x1000000, 0x1000, 0xffffffffffffbfff, 0x0, 0x3, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000540)={0x9, 0x0, 0x0, 0x1, 0x3, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000580)={0x9, 0xffffffffdfffefff, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)

[   11.186615] cgroup1: Unknown subsys name 'perf_event'
[   11.189629] cgroup1: Unknown subsys name 'net_cls'
[   11.192060] cgroup1: Unknown subsys name 'perf_event'
[   11.194186] cgroup1: Unknown subsys name 'net_cls'
[   11.200036] cgroup1: Unknown subsys name 'perf_event'
[   11.201065] cgroup1: Unknown subsys name 'perf_event'
[   11.202302] cgroup1: Unknown subsys name 'net_cls'
[   11.204988] cgroup1: Unknown subsys name 'net_cls'
[   12.231383] ------------[ cut here ]------------
[   12.233703] Found allocation of ldt_struct
[   12.233789] WARNING: CPU: 0 PID: 2121 at arch/x86/kernel/ldt.c:74 alloc_ldt_struct+0x50/0x1a0
[   12.239628] Kernel panic - not syncing: panic_on_warn set ...
[   12.242606] CPU: 0 PID: 2121 Comm: syz-executor.0 Not tainted 5.5.3 #57
[   12.245675] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.0-59-gc9ba5276e321-prebuilt.qemu.org 04/01/2014
[   12.251335] Call Trace:
[   12.252539]  dump_stack+0x15e/0x1ae
[   12.254142]  panic+0x228/0x700
[   12.255565]  ? 0xffffffff9a600000
[   12.257065]  ? alloc_ldt_struct+0x50/0x1a0
[   12.258984]  __warn+0x1fe/0x200
[   12.260472]  ? alloc_ldt_struct+0x50/0x1a0
[   12.262291]  report_bug+0x359/0x480
[   12.263934]  ? alloc_ldt_struct+0x50/0x1a0
[   12.265819]  do_invalid_op+0x6e/0x110
[   12.267520]  invalid_op+0x1e/0x30
[   12.269008] RIP: 0010:alloc_ldt_struct+0x50/0x1a0
[   12.271098] Code: 00 00 00 00 fc ff df 42 8a 04 28 84 c0 0f 85 02 01 00 00 83 3d 40 80 32 03 02 75 10 48 c7 c7 fa 16 5c 9d 31 c0 e8 40 53 0d 00 <0f> 0b 48 c7 c0 50 ae 69 9d 48 c1 e8 03 42 80 3c 28 00 74 0c 48 c7
[   12.279305] RSP: 0018:ffff8880635d7d98 EFLAGS: 00010246
[   12.281539] RAX: 19b9d91919a49600 RBX: 0000000000000000 RCX: ffffc90000169000
[   12.284883] RDX: ffffffff9a600000 RSI: 00000000000002d2 RDI: 00000000000002d3
[   12.287920] RBP: ffff888067c1b4a8 R08: dffffc0000000000 R09: fffffbfff3c68bc3
[   12.291209] R10: fffffbfff3c68bc3 R11: 0000000000000000 R12: dffffc0000000000
[   12.294325] R13: dffffc0000000000 R14: 0000000000000009 R15: 1ffff1100c6bafc2
[   12.297516]  ? 0xffffffff9a600000
[   12.299020]  ? alloc_ldt_struct+0x50/0x1a0
[   12.300878]  write_ldt+0x310/0xb80
[   12.302216]  ? __switch_to+0x52e/0x980
[   12.304248]  ? _copy_to_user+0x8e/0xb0
[   12.306064]  ? put_timespec64+0xbe/0xf0
[   12.307924]  __se_sys_modify_ldt+0x57/0x270
[   12.310112]  ? fpregs_assert_state_consistent+0xac/0xe0
[   12.312651]  do_syscall_64+0xd1/0x160
[   12.314573]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   12.317034] RIP: 0033:0x467519
[   12.318531] Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48
[   12.327618] RSP: 002b:00007f6738c10c48 EFLAGS: 00000246 ORIG_RAX: 000000000000009a
[   12.331305] RAX: ffffffffffffffda RBX: 000000000074bf00 RCX: 0000000000467519
[   12.334698] RDX: 0000000000000010 RSI: 0000000020000080 RDI: 0000000000000011
[   12.338122] RBP: 00007f6738c116bc R08: 0000000000000000 R09: 0000000000000000
[   12.341517] R10: 0000000000000000 R11: 0000000000000246 R12: 00000000ffffffff
[   12.345010] R13: 000000000000074a R14: 00000000004c8710 R15: 0000000000701640
[   12.352643] Dumping ftrace buffer:
[   12.354360]    (ftrace buffer empty)
[   12.356148] Kernel Offset: 0x19600000 from 0xffffffff81000000 (relocation range: 0xffffffff80000000-0xffffffffbfffffff)
[   12.361493] Rebooting in 1 seconds..
