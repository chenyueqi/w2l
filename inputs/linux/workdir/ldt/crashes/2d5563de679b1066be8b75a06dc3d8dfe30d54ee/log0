Warning: Permanently added '[localhost]:51727' (ECDSA) to the list of known hosts.
2020/04/20 20:37:25 fuzzer started
2020/04/20 20:37:25 dialing manager at 10.0.2.10:40133
2020/04/20 20:37:25 syscalls: 4
2020/04/20 20:37:25 code coverage: enabled
2020/04/20 20:37:25 comparison tracing: enabled
2020/04/20 20:37:25 extra coverage: enabled
2020/04/20 20:37:25 setuid sandbox: enabled
2020/04/20 20:37:25 namespace sandbox: /proc/self/ns/user does not exist
2020/04/20 20:37:25 Android sandbox: enabled
2020/04/20 20:37:25 fault injection: CONFIG_FAULT_INJECTION is not enabled
2020/04/20 20:37:25 leak checking: CONFIG_DEBUG_KMEMLEAK is not enabled
2020/04/20 20:37:25 net packet injection: /dev/net/tun does not exist
2020/04/20 20:37:25 net device setup: enabled
2020/04/20 20:37:25 concurrency sanitizer: /sys/kernel/debug/kcsan does not exist
2020/04/20 20:37:25 devlink PCI setup: PCI device 0000:00:10.0 is not available
2020/04/20 20:37:25 USB emulation: /dev/raw-gadget does not exist
20:37:26 executing program 0:
modify_ldt$read(0x0, &(0x7f0000000000)=""/193, 0xc1)
modify_ldt$write2(0x11, &(0x7f0000000100)={0xb2, 0xbda990e3b0077b26, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000140)={0x7fff, 0x20000800, 0x0, 0x1, 0x2, 0x0, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000180), 0x0)
modify_ldt$read_default(0x2, &(0x7f00000001c0)=""/212, 0xd4)
modify_ldt$write(0x1, &(0x7f00000002c0)={0x400, 0xffffffffffffffff, 0x2400, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000300)=""/4096, 0x1000)
modify_ldt$write(0x1, &(0x7f0000001300)={0x9, 0x20000000, 0xffffffffffff8fff, 0x0, 0x2, 0x0, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000001340)=""/135, 0x87)
modify_ldt$write(0x1, &(0x7f0000001400)={0x3, 0xffffffffdfefffff, 0x4000, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000001440)=""/228, 0xe4)
modify_ldt$write(0x1, &(0x7f0000001540)={0x46f7e890, 0x20001000, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001580)={0x3f, 0x100000, 0x400, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000015c0)={0x1, 0x20001000, 0x400, 0x0, 0x2, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000001600)=""/226, 0xe2)
modify_ldt$write(0x1, &(0x7f0000001700)={0x7f, 0xffffffffffffffff, 0x1000, 0x0, 0x3, 0x0, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000001740)=""/109, 0x6d)
modify_ldt$write2(0x11, &(0x7f00000017c0)={0x2a, 0x0, 0x1000, 0x0, 0x3, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001800)={0x100, 0x0, 0x2000, 0x1, 0x3, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000001840)={0x0, 0x20000800, 0x400, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1}, 0x10)

20:37:26 executing program 3:
modify_ldt$write(0x1, &(0x7f0000000000)={0x2, 0x1000, 0x4000, 0x0, 0x3, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000040)={0xffffffff, 0x0, 0x2000, 0x1, 0x3, 0x1, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000080)={0x7fffffff, 0x20000000, 0xffffffffffffffff, 0x1, 0x2, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000000c0)={0x101, 0x0, 0x0, 0x1, 0x3, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000100)={0x100, 0x20000800, 0x2000, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000140)={0xff, 0x20000800, 0x0, 0x1, 0x2, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000180)={0x1, 0xffffffffffffffff, 0x400, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000001c0)={0x5, 0x1000, 0x0, 0x1, 0x3, 0x0, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000200)={0xffffffff, 0x20000800, 0x0, 0x1, 0x1, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000240)={0xffff, 0x1000, 0x1000, 0x1, 0x3, 0x1, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000280)=""/221, 0xdd)
modify_ldt$write(0x1, &(0x7f0000000380)={0x269, 0x20001000, 0x4000, 0x1, 0x3, 0x1, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000003c0)={0x3, 0x20001000, 0x0, 0x0, 0x3, 0x1, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000400)={0xffffffc9, 0x1000, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000440)={0x68, 0x20000000, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000480)={0x3f, 0xffffffffffffffff, 0x0, 0x1, 0x2, 0x0, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000004c0)={0x0, 0x100000, 0x1000, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000500)={0x7fff, 0xffffffffffffffff, 0xffffffffffffffff, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000540)={0x0, 0x0, 0x2000, 0x0, 0x3, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000580)={0xffff, 0x20000000, 0x4c00, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)

20:37:26 executing program 1:
modify_ldt$write(0x1, &(0x7f0000000000)={0x80, 0x0, 0x400, 0x0, 0x3, 0x0, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000040)={0x7ff, 0x0, 0xffffffffffffffff, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000080)={0x6, 0x20000800, 0x2000, 0x1, 0x3, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000000c0)={0x7ff, 0xffffffffffffffff, 0x2000, 0x1, 0x3, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000100)={0x0, 0x20000800, 0x4000, 0x0, 0x2, 0x1, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000140)={0x9, 0x100000, 0x2000, 0x0, 0x3, 0x0, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000180)={0x100, 0xffffffffffffffff, 0x400, 0x0, 0x3, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000001c0)={0x401, 0xffffffffdffff7ff, 0xffffffffffffffff, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000200)={0x1, 0x20001000, 0x0, 0x0, 0x2, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000240)={0x7, 0x100000, 0xffffffffffffffff}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000280)={0x800, 0x1000, 0x2000, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000002c0)={0x4, 0x0, 0xffffffffffffffff, 0x1, 0x3, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000300)={0x2, 0xffffffffffffffff, 0x2000, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000340)={0x5, 0x0, 0x1000, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000380)={0x1, 0x20000800, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000003c0)={0x81, 0xffffffffffffffff, 0x400, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000400)={0x4, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000440)={0xb3b, 0x20001000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000480)=""/71, 0x47)
modify_ldt$write2(0x11, &(0x7f0000000500)={0x4, 0x20000800, 0x0, 0x0, 0x2, 0x0, 0x0, 0x1, 0x1, 0x1}, 0x10)

20:37:26 executing program 2:
modify_ldt$read_default(0x2, &(0x7f0000000000)=""/81, 0x51)
modify_ldt$read_default(0x2, &(0x7f0000000080)=""/154, 0x9a)
modify_ldt$write(0x1, &(0x7f0000000140)={0x7, 0x20001000, 0x1000, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000180)={0x80000000, 0xffffffffffffffff, 0x2000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000001c0)={0x824, 0xffffffffffffffff, 0x2000, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000200)=""/138, 0x8a)
modify_ldt$read(0x0, &(0x7f00000002c0)=""/74, 0x4a)
modify_ldt$write2(0x11, &(0x7f0000000340)={0x6409, 0xffffffffffffffff, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000380)={0xff, 0x20000000, 0x4000, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f00000003c0)={0x20, 0x1000, 0x400, 0x1, 0x3, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000400)={0x800, 0x1000, 0x3000, 0x1, 0x3, 0x0, 0x0, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000440)={0xd83, 0x20000800, 0x400, 0x1, 0x2, 0x1, 0x0, 0x1, 0x1}, 0x10)
modify_ldt$write(0x1, &(0x7f0000000480)={0x7fff, 0x800, 0x1000, 0x0, 0x2, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000004c0)={0x3, 0x0, 0x2000, 0x1, 0x3, 0x1, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$read(0x0, &(0x7f0000000500)=""/210, 0xd2)
modify_ldt$write2(0x11, &(0x7f0000000600)={0x99, 0xffffffffffffffff, 0xc00, 0x1, 0x1, 0x0, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000640)={0x8, 0x0, 0x0, 0x1, 0x0, 0x1, 0x1, 0x1, 0x1, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f0000000680)={0x2, 0x100000, 0x2000, 0x0, 0x2, 0x0, 0x1}, 0x10)
modify_ldt$write2(0x11, &(0x7f00000006c0)={0x8, 0x20001000, 0x2000, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1}, 0x10)
modify_ldt$read_default(0x2, &(0x7f0000000700)=""/210, 0xd2)

syzkaller login: [   11.238249] audit: type=1400 audit(1587415046.245:8): avc:  denied  { execmem } for  pid=339 comm="syz-executor.3" scontext=system_u:system_r:kernel_t:s0 tcontext=system_u:system_r:kernel_t:s0 tclass=process permissive=1
[   11.307727] cgroup1: Unknown subsys name 'perf_event'
[   11.309970] cgroup1: Unknown subsys name 'net_cls'
[   11.363958] cgroup1: Unknown subsys name 'perf_event'
[   11.366490] cgroup1: Unknown subsys name 'net_cls'
[   11.372841] cgroup1: Unknown subsys name 'perf_event'
[   11.376760] cgroup1: Unknown subsys name 'net_cls'
[   11.379288] cgroup1: Unknown subsys name 'perf_event'
[   11.381943] cgroup1: Unknown subsys name 'net_cls'
[   12.332270] ------------[ cut here ]------------
[   12.334862] Found allocation of ldt_struct
[   12.334947] WARNING: CPU: 1 PID: 2053 at arch/x86/kernel/ldt.c:74 alloc_ldt_struct+0x50/0x1a0
[   12.339830] Kernel panic - not syncing: panic_on_warn set ...
[   12.342857] CPU: 1 PID: 2053 Comm: syz-executor.2 Not tainted 5.5.3 #57
[   12.345387] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.0-59-gc9ba5276e321-prebuilt.qemu.org 04/01/2014
[   12.350440] Call Trace:
[   12.351434]  dump_stack+0x15e/0x1ae
[   12.352912]  panic+0x228/0x700
[   12.354202]  ? 0xffffffff90c00000
[   12.355743]  ? alloc_ldt_struct+0x50/0x1a0
[   12.357573]  __warn+0x1fe/0x200
[   12.359017]  ? alloc_ldt_struct+0x50/0x1a0
[   12.360413]  report_bug+0x359/0x480
[   12.361713]  ? alloc_ldt_struct+0x50/0x1a0
[   12.363376]  do_invalid_op+0x6e/0x110
[   12.364969]  invalid_op+0x1e/0x30
[   12.366117] RIP: 0010:alloc_ldt_struct+0x50/0x1a0
[   12.368099] Code: 00 00 00 00 fc ff df 42 8a 04 28 84 c0 0f 85 02 01 00 00 83 3d 40 80 32 03 02 75 10 48 c7 c7 fa 16 bc 93 31 c0 e8 40 53 0d 00 <0f> 0b 48 c7 c0 50 ae c9 93 48 c1 e8 03 42 80 3c 28 00 74 0c 48 c7
[   12.375612] RSP: 0018:ffff888052bd7d98 EFLAGS: 00010246
[   12.377785] RAX: 80c7028831b81a00 RBX: 0000000000000000 RCX: ffffc90001780000
[   12.380677] RDX: ffffffff90c00000 RSI: 00000000000002d2 RDI: 00000000000002d3
[   12.383287] RBP: ffff888069040328 R08: dffffc0000000000 R09: fffffbfff2928bc3
[   12.385777] R10: fffffbfff2928bc3 R11: 0000000000000000 R12: dffffc0000000000
[   12.388831] R13: dffffc0000000000 R14: 0000000000000008 R15: 1ffff1100a57afc2
[   12.391377]  ? 0xffffffff90c00000
[   12.392435]  ? alloc_ldt_struct+0x50/0x1a0
[   12.394130]  write_ldt+0x310/0xb80
[   12.395494]  ? _copy_to_user+0x8e/0xb0
[   12.396810]  ? put_timespec64+0xbe/0xf0
[   12.398490]  __se_sys_modify_ldt+0x57/0x270
[   12.400419]  ? fpregs_assert_state_consistent+0xac/0xe0
[   12.402173]  do_syscall_64+0xd1/0x160
[   12.403433]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   12.404948] RIP: 0033:0x467519
[   12.405978] Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48
[   12.412616] RSP: 002b:00007f94a1a44c48 EFLAGS: 00000246 ORIG_RAX: 000000000000009a
[   12.416100] RAX: ffffffffffffffda RBX: 000000000074bf00 RCX: 0000000000467519
[   12.419276] RDX: 0000000000000010 RSI: 0000000020000140 RDI: 0000000000000001
[   12.422427] RBP: 00007f94a1a456bc R08: 0000000000000000 R09: 0000000000000000
[   12.425593] R10: 0000000000000000 R11: 0000000000000246 R12: 00000000ffffffff
[   12.428760] R13: 0000000000000749 R14: 00000000004c86ff R15: 0000000000701640
[   12.435858] Dumping ftrace buffer:
[   12.437459]    (ftrace buffer empty)
[   12.439113] Kernel Offset: 0xfc00000 from 0xffffffff81000000 (relocation range: 0xffffffff80000000-0xffffffffbfffffff)
[   12.443883] Rebooting in 1 seconds..
