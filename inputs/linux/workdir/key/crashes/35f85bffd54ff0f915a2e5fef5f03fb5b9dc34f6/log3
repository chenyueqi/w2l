0000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="2c78e5a72e0dcf443a2505d1f8674950a3b66b745f67044e1a1e23525e19552af1a64179ab2761c7da2852b0a3e1d388431f21b5b1a8e9a86d7a4f3cc88baeafbc278db5a515f177123b8784f9840cd428a1db74ec4ba1a1b9ff379c903ddc592d133e6ee6c1df894520d3104e22e9d07ac8960b4d8f90b74cc3a0b049b724a8fcb44a0fd7397ffd826f41a02ab90a5c14f92178f231ae2c7eed3406edfd88e965245ee413cc4ab193e55dbac721792596365a73c660754780c8d75272210d044d", 0xc1, r4)

19:20:26 executing program 3:
keyctl$restrict_keyring(0x5, 0xfffffffffffffffe, 0x0, 0x0)
request_key(&(0x7f00000000c0)='asymmetric\x00', &(0x7f0000000000)={'syz', 0x2}, 0x0, 0xfffffffffffffffd)

19:20:26 executing program 2:
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, 0x0, &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$read(0xa, 0x0, &(0x7f00000000c0)=""/174, 0xae)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000005c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
request_key(&(0x7f0000000240)='user\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f0000000580)='user\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1bdae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000740)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
r4 = add_key(&(0x7f0000000080)='asymmetric\x00', &(0x7f00000000c0)={'syz', 0x0}, &(0x7f0000000140)="57e73a", 0x3, r3)
keyctl$link(0x8, r1, r4)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$join(0x1, &(0x7f0000000100)={'syz', 0x2})

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_MOVE(0x11, r1, 0xfffffffffffffffc, r0, 0x0)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffff8)

19:20:26 executing program 0:
r0 = request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000940)='-\x00', 0xfffffffffffffffe)
r1 = request_key(&(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='procproc\x00', r0)
keyctl$instantiate(0xc, r1, &(0x7f00000000c0)=@encrypted_new={'new ', 'ecryptfs', 0x20, 'user:', ']', 0x20, 0x6}, 0x29, 0xffffffffffffffff)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, r1)
keyctl$read(0xb, r0, &(0x7f0000000280)=""/93, 0x5d)

19:20:26 executing program 3:
keyctl$session_to_parent(0x12)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r1, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000800)=ANY=[@ANYPTR=&(0x7f0000000680)=ANY=[@ANYRES32, @ANYPTR=&(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT], @ANYRESOCT, @ANYPTR64=&(0x7f0000000580)=ANY=[@ANYRESOCT, @ANYRESOCT, @ANYRES16=0x0, @ANYPTR, @ANYRESDEC=r0, @ANYPTR], @ANYRES16, @ANYRES16=0x0], @ANYRESHEX, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b7420ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d347e4897a2bec0fd8efff4dada7aed56e6f37420036bcf0990325e6dd529456ddc52873cea74790e12c959278abcd1a980f5d5177faaca7df94bd0274cfa20f49efc4f9714919d5738c78ad85629fb68edecb4ffd4636206", @ANYPTR, @ANYPTR64=&(0x7f0000000640)=ANY=[@ANYPTR64, @ANYRESOCT=r1, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, 0x0, &(0x7f0000000080)=@chain={'key_or_keyring:', r4, ':chain\x00'})

19:20:26 executing program 1:
r0 = request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x2}, 0x0, 0x0, 0x0)
r4 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, r0)
keyctl$search(0xa, r3, &(0x7f0000000000)='big_key\x00', &(0x7f0000000040)={'syz', 0x0}, r4)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000000100)='key_or_keyring:09\xe0>&M(\x87;x\xa7\x8f\xfd\xaa\xd2a\xb2?\xbc\x14\x90N\xa1\r\x8d\xb5\x11\v)\xd9\x8c\xe2\xb8\xb0e\x98j\x00\x01\x92\xd6\'\xfd<[\xf2o\xc1\xc7\xf7\xa5T\xe2\x93\xfd')
r1 = add_key$keyring(&(0x7f00000001c0)='keyring\x00', &(0x7f0000000200)={'syz', 0x2}, 0x0, 0x0, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
request_key(&(0x7f0000000240)='ceph\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)='mime_type[\x00', r4)
add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000180)={'syz', 0x1}, 0x0, 0x0, r1)

19:20:26 executing program 0:
r0 = add_key(&(0x7f0000000340)='encrypted\x00', 0x0, &(0x7f0000000000)="00008549", 0x4, 0xffffffffffffffff)
add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x3}, 0x0, 0x0, r0)

19:20:26 executing program 3:
keyctl$search(0xa, 0x0, 0x0, 0x0, 0xfffffffffffffffd)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r1 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r1, 0x1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = request_key(&(0x7f0000000200)='rxrpc\x00', &(0x7f0000000240)={'syz', 0x2}, &(0x7f0000000280)='#\\\x00', 0xfffffffffffffffb)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x2}, 0x0, 0x0, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r5, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, 0x0, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r0, 0x0, 0x11c766fee135f159)
keyctl$search(0xa, r1, &(0x7f0000000000)='rxrpc_s\x00', &(0x7f0000000040)={'syz', 0x0}, r5)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, r0)
r1 = add_key(&(0x7f0000000100)='dns_resolver\x00', &(0x7f0000000000)={'syz', 0x3, 0x2}, &(0x7f0000000200)="1d1ad732d4eb7f3652ee46e39383af62cce15cf21979c899ae544810538e8b8e82f71c6cc5cd03d1d6719772b7ec6aa7dd0a02e8818a9f497dcf34efd463e8858f6c14f7a25ee85f034f37971b19d8a8aa6eeefc5fc2bbe3fd30759a918117bd91e0a60d2b4cf9d51f2600", 0x6b, r0)
keyctl$describe(0x6, r1, &(0x7f0000000040)=""/97, 0x61)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r3)

19:20:26 executing program 0:
keyctl$set_reqkey_keyring(0xe, 0x0)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, 0x0, 0x0, &(0x7f0000000300)="b7b43f3a8742d025cc7fa60c9fc66a92eb5e1bbdbe495bede94eadcc3eb67f2323", 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key(&(0x7f0000000180)='syzkaller\x00', &(0x7f00000001c0)={'syz', 0x3}, &(0x7f0000000380)="faff56c4d0544b8596084622c4e08a2aef092464329e793a4203cbadf8c8a5b9fce0c918380086ae0a195c00ade31ca3eb5452b3d041eb40564814f72f7cd3ec9eea40bf292b5795fa7b703eac050e8b0125bc90b28b2741b32a6844d74c76d9e21a1050aa2f0fb8c5ddbed9939288d43ae626e543dfd73e07b8cf64d8e52ff4e40ada75fe5d2eaa15bd9551163c4710dbbfe61b3a3cbe2fe24b73ff468e022a5ff383ad8707f54d0de1245b1b553bed7b9a18d1b240de92d1289b91c726c16665c05b0125ea5115f902ee95a5ee5d76163d4123cebb4b7409be132f3e56ab30f7f21855c311614abff783", 0xeb, r0)
keyctl$invalidate(0x15, r1)
keyctl$get_security(0x7, r0, 0x0, 0x0)
add_key(&(0x7f00000000c0)='trusted\x00', &(0x7f0000000100)={'syz', 0x1}, &(0x7f0000000480)="61c3ec29c8ca812d9181eb974d17858ad73df3fa6a68d58eadd99a74fa17f13a68e42aa1d21bb859a6b78efbeb78f586cc81d6b9bb4df454e06ca7803d92f244b388c7a7fc02db01e7f82a87ba659234f0af639d513e5d2a26e3c40fa1ed78d232a85ec11b5ba2869738496075da651bd9c7a3aae5e7e1bef32913c03d9acca08923b2c1343f110dd4ad239d3f43020075b1e135c174914ad0d9dfca24d2c3fa80d84f1a6bcd8ae8671df2d787fc18d9bbe578458a14f7db538de4898a3d54eb07610e68881cfd22276201bacf5d705047cc855c581ecb70511ca29b711d1e0aaa866415287662518d17bf", 0xeb, r0)
r2 = add_key(&(0x7f0000000000)='rxrpc\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)="e6796a758d774df5bf1642d4900b55e015fe1176fe73ecc3252dae22708d3f16c24407a1555713fb86043a46e76009b78cdf6f1fdbdfcc0e9c3fd8d5560f7413246efb4eee996d39731fd111804404a3815eba56065fa6fb7d2a23dab7a087eb867966773603e0d00fc986bdfcf970ce0987a633ff54bcdd3036590daba1b54aa9769d73dca21772d2b4726ee8977917ab55a369c6bdfbaa87cd310e2f82c8a706c30bae56e7ea0de4fe2e2da077c2c1d5c2eaf09cc4fc5e2b88a53c0ced0bf7144db669bde034a24ef8dd2eecf7a47ccd120e6b5422c9", 0xfffffffffffffff6, r0)
keyctl$set_timeout(0xf, r2, 0xfff)
r3 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)
add_key(&(0x7f0000000600)='.request_key_auth\x00', &(0x7f0000000640)={'syz', 0x0}, &(0x7f0000000680)="523677eb1812c38b22f5820e1add98b875b918e6ecea52b908892502f093e32fa1f1979d3401e4152590479db3980a979acc6a75231cdea2d8c5c2d119122a1df6bc137270213666bcaad04e2ab79a5a2d2785499dfff507fa4c4a1b862273036c9614b3d6b586308a0ec81420cf649389748fcf2f2216ac4f596fba651aff8beb7940adb27878efdbddba24543c127668b288d4824dd9eed814cf46a03cad03dd180eb043af2a209f735f459ab0f1f920c24c489e5718ea26f20938f97462014dcbfc8c718ffe61a037", 0xca, r3)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$invalidate(0x15, 0x0)

19:20:26 executing program 1:
r0 = request_key(&(0x7f0000000000)='syzkaller\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='\x00', 0xfffffffffffffffa)
r1 = add_key(&(0x7f0000000140)='ceph\x00', &(0x7f0000000180)={'syz', 0x0}, &(0x7f00000001c0)="2be7a830ad75b53ba13b7807e5a0de52be783c7a10a4672e36ac8f3709de1578ea384cf5879612c9ad244fdcdcb9d9bbf531214285eea47425baaea090072d1695d08af20a6916", 0x47, 0xfffffffffffffffa)
keyctl$search(0xa, r0, &(0x7f00000000c0)='.dead\x00', &(0x7f0000000100)={'syz', 0x2}, r1)
keyctl$read(0xa, 0x0, &(0x7f0000000300)=""/157, 0x9d)
keyctl$describe(0x6, r0, &(0x7f0000000240)=""/192, 0xc0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$setperm(0x5, r2, 0x801)
add_key$user(&(0x7f00000003c0)='user\x00', &(0x7f0000000400)={'syz', 0x2}, &(0x7f0000000540)="6b1ba16bc60a9aed89ac902f4157d888846d38995c4c65db793f6a40a73c7752acef56ccf7f8a7f69ec5c69405783804d922aadf580d37dc4dd3affd9cbea6d6973355f82bb1c11fa857257cb366bff9daa13945201e3738ff1e285e80faa2054decf241290ecd94bac5ea630e9d", 0x6e, 0xfffffffffffffff8)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
keyctl$set_timeout(0xf, r6, 0x3)

19:20:26 executing program 3:
keyctl$assume_authority(0x10, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffb)
keyctl$KEYCTL_PKEY_QUERY(0x18, r0, 0x0, &(0x7f0000000080)='\x00', &(0x7f00000000c0))
r1 = request_key(&(0x7f0000000100)='logon\x00', &(0x7f0000000140)={'syz', 0x2}, &(0x7f0000000180)='xvboxnet1GPL\'\x00', 0xfffffffffffffff9)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f00000001c0)={r1, 0xb7, 0x15}, &(0x7f0000000200)={'enc=', 'raw', ' hash=', {'rmd128\x00'}}, &(0x7f0000000280)="79c03608ef5a84d07766cee7520813abe8323688bbff3a6364e09c39e4fc1043d9c00863d8c4ede670d8495ecf690c245f137b9899403489125a7d29740d94c1e8e80499bd6cb5a039373b0003adb5f44b97c3abb0b22702c0be96a9601a73d9869c83bb9da705402a37b2384c7bd94ee1ce271fe724b2a35c84866e5103e094f66abf748d0914e57d2a0385e51684a17e56a914a34e4d4e295f9ef4e3b68e51aac2622c1bca442ab705e4c0581710d64b60d477e214ba", &(0x7f0000000340)=""/21)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000380)={r0, 0x1f, 0x62}, &(0x7f00000003c0)={'enc=', 'raw', ' hash=', {'blake2s-256-generic\x00'}}, &(0x7f0000000440)="201dd99e23f445b67ce5f9a2cb44eeb9029561114f2c306233d50dd65660ef", &(0x7f0000000480)="85699de4811ba33ae11d35dd74beb0e5e6af32a2ed17a057dabd459131995cc4a9143347efcea1fa5c80260c71a3cbfe665b383450f724d98c996a38e297dfb4d73fbdcbaf740ca37e4313428c90d15321160659892fb166481f214ad53558a52e36")
r2 = request_key(&(0x7f0000000580)='blacklist\x00', &(0x7f00000005c0)={'syz', 0x0}, &(0x7f0000000600)='!eth1\x00', 0xfffffffffffffff8)
r3 = add_key$keyring(&(0x7f0000000500)='keyring\x00', &(0x7f0000000540)={'syz', 0x0}, 0x0, 0x0, r2)
r4 = request_key(&(0x7f0000000640)='encrypted\x00', &(0x7f0000000680)={'syz', 0x3}, &(0x7f00000006c0)='.@nodev,{cgroupvmnet0\x00', 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_QUERY(0x18, r4, 0x0, &(0x7f0000000700)='!eth0+\x00', &(0x7f0000000740))
keyctl$instantiate(0xc, r3, &(0x7f0000000780)=@encrypted_update={'update ', 'default', 0x20, 'user:', 'security-\''}, 0x1f, r2)
r5 = add_key(&(0x7f00000007c0)='cifs.idmap\x00', &(0x7f0000000800)={'syz', 0x3}, &(0x7f0000000840)="e2476340ae7a062730fd8ddba30e2b027ee5b58bba846eb23d75e5a46ee73873066bbd44a017770211f981994fbac9bd28ecb1e814d5c072c60effaca2cf00749e32fe6987ea7a33c05a8e4bc1a90578569d1662eb742a293eeb39e2bc0f99a76ee8ef0e3069fc9c11c077bbfc7f82c34404ad4e8e8a64fa28c4f7705d973247e5dabd4ebec964351cf2c213567582752ad473de20d5bcfc496cfab6e195c7fb17f8d80480e7080610ff226ad6ecff244628d1b076a8c0852f23f14bf2b0fa5fd7ae7a311bbea82ff6af10fcfb564ba125028120f281c515569f2bf5bcd67a6b2dc46a7a0838f56ca850905c9053f0aa461e550213b93a68a8b1cd351e99f0d613ee6f2093da23c06cf52c2909a12840e3c85ee7e22dd1b03bd44bdb2acd6dcaf6619b44dd6546d1df583f29cf26ed1c345e82ce1aeb774b79f30d3c3408cf80837fd4de45f07b3c081036a080c1ef1d4e3d56f3af3d66602c6225d33a7aab9bda68ec43934da7ff3714429ad1c1cafb2cd786d3904c0c367d2ef55530bb3067a9f436503ca52bbcd4e50988a2f6f3f7f0fa0e053d8d6a5e929d18cf84fa4181db860da82f17f99589e2d7339878747bd357b5a4b3f5f3ab85531265f766bd52455d2e2b39a55926ce4f453c2128099f8e0eb5cad51ad2ab9885360f18a29ace0cf1766ea9b8427710d31d5cdb1cb58e48210077c106e41bca25410b836c3b4912ea709eae1d50c51abf1a6bd501472942b14846e0be361665b3504a3c6fc627154fc6941534d9bf28098f6197ff50d11afd904c9cc653f9ba36a868e3c733bff75c225b3a5b7442f5fc6f49a883ae6becc37eb79847e8e35f1d335a9ebd20d265b17e046eb564975dba3ec9e1667c298090f4a7c70100e4751cb9b0810a35d066e91c26ea074e1e30ffc8450ff97858535bdd4b25fc18f2cbd491ac58a26b922aef6396efb7c12ab820e9da788a73971ef2e8f81c59413881c2c59442321fe364c266e60db091046cfc0f0fe5792a0256f3abbcb59e9f81eac5bfa2d3546fee7a4b5c7493394fef9d5b988c849b17c5a27fcf974466b58be40b89fef1a318cc862126815fc90cf51aed9017f882908272e49ae6466ea380e90b0a0c1bcf601fd7bde3630589ee2dc576af4ca18811eb299770b815db492f5f54fe4c38116b7e96857898849133fb4a4a9339bbd3717add4d5f361574c41cf3c2318de2985ac15a5ce31192bc0854d98c463dfbc7fe039ac39860323f65a06ca99668964f31738b1cd4d10d0ed2df3db44689d76e26692fe9b837116253c8113d3bfc4ede7afcd7273a233ba13920020175126e47bfb9cf80e312d45618ee8ddef4235523254d000b357c46c359784cc45c97560d2d4cbbea96f6321ae60e33625240cb15e0d4f78d44e762e15a7466f44e6299c74b60e889509901fe98e28cb62a1d87c51cf34bb028feae3dfb3e6ebb3f2276661feb243cc5da76537592482d53877eb5d5d6dfa00fd38b9f9471cf2e472c34246eef2e8d87b87dd83586b2fb85c7ef3b561edda0061a7157525a037cb0d968eda0b3a097fd3a9e69adfd218b5517a6f71d84644deb0d53653adedc0d2d068e2ac29d72a2a3c4d0c9d26d082ad683acc1ee14536057ad950bff8ea9fb0a2d68e7204c711b69709860088c15e61d29500a2d1dc65244f29285a448c48187e380fc4a67bf55dfd36a2485983e365b13d08e1a256b4e8451c839ee76a9cba7d58ad24da6ddf4b2fc7d46a8ce940675dea18bde9436d71080fe8038170dfca76139446d342fd5d969e47ad32548f8a1a604045976504c1f4051c32851037591a2a7fa5d3be634a84458ef757c0133508255964983ae8a22d38a0858e18f583c3800a8b82bca8b5dc5722b207f368fd11b80a413e83b8a011bf2cdc7d3e24a880a630701f89dac374a8026e336658d7aa27d81ba26d4c7185c03ab5ec7ebb2a34d9936799068ff34317bf7e623eae71a49d5ef4a995a5505a84ebff698e3b777770bbead18acc3196d88de3b5ee2a747433ed366b7d1e9b3ed02cb5c53d7a920d8fdc1850b6a2588596757a2980bf50e6a7cdabda5c4a267718f72785f25847356dbcf92b4e803aeb6902ed95a1f3f333e24bb45d9c2b2c6bf0b5025e682da8f4c4dc7f40d7dee0f22e351494a5449f8f640b440455c6af8150b1d9ad627bd0a0feec4be29f6335ff49669b1b630f799e6c6cd485e471bb0ef08b168c2415ecba68f82e2046e448155ed71168b43e198074ee17cb0b90e73bfa7cc9f877484f16ae3cc04fc728c2403198baf548a0c670fd07ffb4ca9c6abe6887b6551f2a4b0f1089c6cdf6399a18faf793da7f43f3921036e0d593078d3bfd11068b55131134e6d44df7826e20e83818346a894687f66b361dc8ab8b2de8ac4db383edb9381b031de87064ece235257afc97dde2cc0c6d01a46e9595632dcbfa1357ea639fb9d943e7730476767383a61e08089fc082018c9e3e51440b144c290bd83552a6c9b254507b6f42b235e1f13dd3bcc9f03df577be5ba60c2e1a2a8879a0dcbdb2d79f28b1bff9a3b3d623991b6d90d82d1db9e08e929777b84282d84e05a81d8cc23b814732553f9182e35b07ffcc9b63c6c326d1718dc7fc580d626882487eb42d24bbb15ac85927857397bf2e880152bf56f3d42544891cc75c642ddb3c91baf0f092ebbe181510a03d6fdf8668542260587521f1a6a866c2c97075bccff31773acabc9ad7e48e3e45ebf2909f44224d94f2802d1a0228fd0151485728f31c73e26db45a7a37f0fc5eb1a7129ecb5536fe31ec055cce662b27fdb677b430827a5afd49abaee98d88aed3a5c41f66c082d18dded8d2864d10b5f830fac338007313dec5e28fa92dad3a22fdeea02b9d6dab6f8bfcd8a0a71925297c66b4e5ec7800a1dc8650dfe91b49f94b1fa502da45a953b030dfa201adccd5b1f0db5d81d9acaa30bcd22d2632155607dfff99b516f0defeed35d819b9237f5b9702d758028934267b9507eba1a8d11f71dd6e80e282868c0171167da78374d45119a68b2519b92e663887a88563df77f80daa630276dc518c02fc314112b53ec039c450e8b6886a578e5febdb5a9eae939fad9739c51b466c53e6574ee6128b7a0424368d3060f77d9fa7272b168c019de1355b2c436268010340e2d784da17f904427b473f9b9dcb69f66ff5dba13a5d6cf369a37dc80aa3db27bc4d59bf3b5b1651790ff0156c57ffb494d191383ed98e2cb8662775bb4f9b4187b872155b3bca34ac4d9f8af7924aa7c4f970d5f2fa45e1a5b2481be7c6e0a612c5dbea2fc9c5defe78dae8cbe17747093ae82eb53279d766a1f2768d16d112de6af4a5148a342906513b36e6b5e260fb78d9365d9763a1db38590519e1db57e98d4a2f6c2d3db89bf9d40ea28b9bad54e0e0142aad5f9c7866c321a257deb40cd0b3e8bfd279e57686ba8a4f77e0fc156077c3343b89f001bd1b239f83330d246bb28127d31b8bf06a848131f3f1e55eae88610473fa194f2bfd6ea34cc530749df15969b466fce46a35711e4a82554ae6ad82d37d7e466981ce91bab835ef639c8de3fc075c9d6ba46e3a62e2876a6601384b4fdb9f399f0d027142875a27b19522da8f67ccaa9f9bd4dcd035868b3ee66a1927f907206aab7e8b905360b1d3ebf7264da72ac75bffaf92c696af6d2ec09880af4e308661cf05b9c19d67c558be321928796b7a4b7980b7581dc0ffbf198df193b4b5d197b2c1c732bf55897a21a1559d117c501adcda358c6ac1c4733287954f123018fe454c853e822e9d5a20b59205060be0762410f4de758505e62127bac7bf6c2ffb6765b978854ffab538dfd25a3612e2f28bf1419f348b1fafcc3dd1f304419b6d72f01182a2096f8ce2235cb31e19853e68e52bd5dcd36db6d77c6851765ecafe5a4687fd2147b4965d9bec430d42cf2f1f0939e8481721cbbd3b3b779bb4f4d731c0b5a6b6c8dfb84c13c3c653ffd6c6d06ef9eee12e8152c8222377719c27d6e2fe3dddd4766962c3c081122c3c8367a9461b56f949d0a6af8c3184b99b936bd9c8ba35a2be6bba8880d4dcc5a0a99551e57210c051fc96e9f770f2b7a624e072ef3c07f35f47b7312fe92c5ee8621e363cb85a7d671983eaf6944fe2f3220362f7c2fb6c11d38a4e1db65f15f12e90d92e1866b6c938d7434f6bc57edd7182689b9e0aaf876370dac63b44fce87280379e4b6e5ae64b728f6f3c6abed8ed1b4c900b237b8c74adf9fcaafe31bddd944181939c1e505d506df74d0a12bb92eb028a8883b390e03e6ac03c3bcb5cd550b9e596ffde1d5c140d21d027cdfd438c4a43a9bc1c563b8d7d3f620e9227a45e5cb3f1a8989b278d40ad1837c06d4e02c43e1245b412a21e43218bd8de6d80910c541c87602ac150104693ff9172a604363a01d48ce8ac6d34928938e1570738d9132b9dbc0d256cf3d4cfaf7cfe40b797c327f96ae70391b8c487d8be6145bfb54ec0718e7f9e2d214b57e3337e520e9cc1cc0bbb2e3a047a11443c79a94e22b3f5be59aad9409422cfcc058f9b52fe9692efb5cd7b21f60a5c78e530f828eb031ff4bccaae477dfdcb5aefface802441ffd00ac3e4606c13e40c4ee70ff3c9f5811c75e440ffa6348e4cbc2e49bc22e1c7bf15cbbbab7e06fffc5316f331b7fcf668fd08b97601652488fba7fa583db5725d1b4fd8d395f4e07c0739afefcf7e8ce2de473c0508ca4e3367502d94174f6d3694b2082809b09d60365145abb6e7ef13ee1922c97a9bac720236a86cdbd894523dcf14c01eebfc89a04160a2c60e6f234aebadb36aa86f0925edd52e38f88ebae1669cc57180b79a22ae52c5102691b10828ec3acbb3dc3bf874e53828bdf32c94e8f7e261eea35e831fb6e6fc54b818c6548cd5e991ac95fdd70d1428ea6e2a61181594c814f7ab92a63931a4e309a3af07c9110bee7b4e2f8b54d99bdb3f27e81b126579ace6f8b8d85dedb661fa5a4e72dc684b63a834ef410a1356c1b87d8886b8ca4ec3eaed61ad5dda9651f92d75df0393eece71c47b31887599529b0017856c2950c7a06985e4197b8fdb01e1b8029a4a6205314b3be027ca3c5f89af5e6abbe9fe05744d64252dc1d698e20954e410589501fea873f2e331ae417073c77ef960333bd7e73d5f0cf926c06f93305b2c29ce40bc24569d85eded09b72c40a0273a30aa0b7e9b4c92348aecea36527d8d29061f98ee5a8ffd54894e38d6651bcb0a7dec3fb41a66f477457cd97b8cbea948f3a781a2f0f6c6bb1c36568ca4ae01f9097c1be57755de46ee3b160be76e3d82879de3a72791e6f0c8670b030e970a5bcacf75530c91d1138fea9bb1b567b94087c403c92c372a6b8a782e05157cace1e35da7e4ae98902cc74b80112862c64ced1e90f07cfd005c712940affbf000fa9d4a4656f5745a7378b94657cbc6cce9261b21906453643ebd8fac0ca49c62075e461280334ad3f1c0be7cff949e6a621d8c51317caee250a39d58f7d5108f8e5e95fd52be66239a2ea4a96d7c80f4fbc558c3d38e38b74aaf991e8ae2082ec11dafbcc35e068d546b79ec96737ca62f057fdd73cfc9e0a983f7227ee95aa697daa37fcf40a03bb43c796226f087e446a52a5f42ebc3d2d04fd9ce174aa07fc833f03122e451988cc98c5aa17852626ba2798640d24c83173e7cf5f8718334ae023f3706567a57f6175a18142cfad1d50fa60b6ec7f2c9f9d182163099ad4a1b2e2a2386e9e31d26c04291f45aa25196738ff3a5bbbcadb8173575e1293ef6", 0x1000, 0x0)
keyctl$setperm(0x5, r5, 0x20)
r6 = add_key$keyring(&(0x7f0000001840)='keyring\x00', &(0x7f0000001880)={'syz', 0x2}, 0x0, 0x0, r4)
keyctl$instantiate_iov(0x14, r6, &(0x7f0000001a40)=[{&(0x7f00000018c0)="dd2b45960d14da68c1401b9fb7e9fa7e8104ae6a077b01c13d5e29b2783b04854c68b926087ab3ded98978a19dcacdd6d8a47e5dd05a788346dbbdedc9a5c1f2e8a944c266c148b8a8b34725b17ad68d7d5390c74ffbf7a485d1c9b4f4294a012f65a4347acd4298fc8bb64266017763f9b33b", 0x73}, {&(0x7f0000001940)="f3c123d2e9f5aced29a4eae718817d129da1f8bcf990be6dff7276c94e08f01488c0693e859681b89a419f8d9315aef8228c64810e0328b34875ffad3ace9b2d929553cee1454f317e2ff704", 0x4c}, {&(0x7f00000019c0)="5b25d4bc690f76abfda2ef42f53dc3b0cc137db09e395d16cf36a35b9b5b138e756afa9a029cf42d415d4f67c17e2c448cf1b47ca6f70c4b7edb87c121ccdb5e6ca607b35ddde0ea6996962c1eb30a", 0x4f}], 0x3, r2)
keyctl$restrict_keyring(0x1d, r2, 0x0, &(0x7f0000001a80)='cifs.idmap\x00')
r7 = add_key(&(0x7f0000001bc0)='rxrpc\x00', &(0x7f0000001c00)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffe)
add_key(&(0x7f0000001ac0)='encrypted\x00', &(0x7f0000001b00)={'syz', 0x3}, &(0x7f0000001b40)="2574328a64664c9856d7b6f9f6b1de36fba1e24cc6bed7d242c8a4274fedddba547634207087bfd2d060e4f6259c1de671d6d2bd1e73ef84b2d7d9cf2e427776918830f3bde96b92833186ab49f07b4d2e539a5dd688f38811d1962b0a59e5be008e9e1969a999e5ad", 0x69, r7)
r8 = request_key(&(0x7f0000001c40)='dns_resolver\x00', &(0x7f0000001c80)={'syz', 0x0}, &(0x7f0000001cc0)='xvboxnet1GPL\'\x00', 0xfffffffffffffffa)
keyctl$KEYCTL_MOVE(0x1e, r8, 0xfffffffffffffffe, r6, 0x0)

19:20:26 executing program 2:
keyctl$KEYCTL_PKEY_VERIFY(0x1c, 0x0, 0x0, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a4f8ff2e8b0abf1930bc5781d3e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f0000000480)=ANY=[@ANYRESOCT=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r4 = add_key(&(0x7f0000000140)='dns_resolver\x00', &(0x7f0000000180)={'syz', 0x0}, &(0x7f00000001c0)="c474ab7a7d75f9bfa31de83ae868b813bea6cc6b507a1cbb91d0ff8dfaff5015fc0040d1883d14f394353424adbc216364b31dc78684b3fe2322e07bc14a82581ea32971c475ea6e1eb99d6de54eb4a17e839976cc458bd6699964e8da9fbbeda6be46d8b61937e050094189fd3aa7f94c7126fb373baa119be0174d603b8bae25f8f4a1adb6055dc26fb83818ab97bd449c6a5d943bd7bc4aa7619f1808a830d61102a95eea1e78d4e09bfea8b5c04f18f6908f02a40641a97604a1b53f3d9f6de626795aeacbb30f4912aa0ce203871eda07bd1169c0a8e2f3da0a1bc08eaa6e9ba0e232cb90f37644cdd3a0902f", 0xef, r0)
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)="6953cc2c7d9f2102d4cdc15b80f3cf90f02a3826e26faf3fb149caa7a75ca8dbe7093455d6746340dab10cc12c24be96802c82c32dcfed1b7909f762c4a930083f5f13dd74a9efbf294e0d3dbedf7ec3c36703b1562b48c5e2185890785f7d5c73554586d5a6208c96fd31ddc703c96d8ce257c1c1204d2e8eac988006a251b9aa02ad5eb8a58855b4c80460e4fbf550eb9ae2c77e4ce840e07346d9a2969a847125eeab40a14e5e5a546557", 0xac, r4)
add_key$keyring(&(0x7f00000002c0)='keyring\x00', &(0x7f0000000580)={'syz', 0x1}, 0x0, 0x0, r3)

19:20:26 executing program 0:
r0 = add_key(&(0x7f0000000640)='user\x00', &(0x7f0000000680)={'syz', 0x3}, &(0x7f00000006c0)='h', 0x1, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000900)='keyring\x00', &(0x7f0000000940)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffe)
r2 = add_key$keyring(&(0x7f0000000980)='keyring\x00', &(0x7f00000009c0)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_MOVE(0x1e, r1, r0, r2, 0x0)
keyctl$restrict_keyring(0x1d, r1, &(0x7f0000000000)='ceph\x00', &(0x7f0000000040)='keyring\x00')

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key(&(0x7f0000000040)='.request_key_auth\x00', &(0x7f0000000080)={'syz', 0x2}, 0x0, 0x0, r0)
request_key(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x1}, 0x0, 0xfffffffffffffffc)

19:20:26 executing program 0:
keyctl$session_to_parent(0x12)
r0 = add_key(0x0, 0x0, &(0x7f0000000380)="c3543993f40dd2514632455d209a097a1a0edd08e790ffc9c6c4a7ef210ebeab632904be1875c8ead727775629e2f664662f57c3e85275b895c45070b322a45cd794cdf381b11d4d33d75679e9e40d5640c459fa0af8dbbae323", 0x5a, 0x0)
request_key(&(0x7f0000000000)='id_resolver\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='syz', r0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x2}, 0x0, 0x0, r0)
keyctl$restrict_keyring(0x1d, r1, &(0x7f0000000140)='cifs.idmap\x00', &(0x7f0000000180)='id_resolver\x00')

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
keyctl$search(0xa, r2, &(0x7f0000000000)='pkcs7_test\x00', &(0x7f0000000040)={'syz', 0x3}, r3)
keyctl$set_reqkey_keyring(0xe, 0x4)
keyctl$join(0x1, 0x0)
request_key(&(0x7f00000008c0)='asymmetric\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000940)='-&\x87cpuset(-\x00', 0x0)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f00000000c0)={0x0, 0xf, 0x69}, &(0x7f0000000180)={'enc=', 'oaep', ' hash=', {'vmac(khazad)\x00'}}, &(0x7f0000000100)="1af2d0050de88d0466ce6597fed8f9", &(0x7f0000000200)=""/105)
keyctl$unlink(0x9, r0, 0xfffffffffffffffd)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000280)={r0, 0x23, 0x1000}, &(0x7f00000002c0)={'enc=', 'raw', ' hash=', {'streebog512-generic\x00'}}, &(0x7f0000000340)="bdbb32c10fe9d0787db44155fd5ec70762bf2b8f2e0d01b47cd707589a4d63f46eed05", &(0x7f0000000380)=""/4096)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0xfffffffffffffffd, r0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
r3 = add_key(&(0x7f0000000280)='.request_key_auth\x00', &(0x7f0000000480)={'syz', 0x1}, &(0x7f00000004c0)="bcedf5a9aadb85da5e1da7736d57921607613b1db9fe3df7bae818290d59d72a92ef666e6dbd85c86c0bc841279d4a10c78289ab52c710b2087ba44656c3f4d1f4fd5ad6", 0x44, r1)
r4 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000580)={'syz', 0x2}, 0x0, 0x0, r3)
keyctl$KEYCTL_MOVE(0x1e, r4, 0xfffffffffffffffd, r1, 0x0)
r5 = add_key$keyring(0x0, &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$get_security(0x11, 0x0, &(0x7f00000005c0), 0x0)
r6 = add_key$keyring(0x0, &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_MOVE(0x1e, r6, 0xfffffffffffffffd, r5, 0x0)
add_key(0x0, 0x0, &(0x7f0000000040), 0x0, 0xffffffffffffffff)

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$describe(0x6, r0, &(0x7f0000000380)=""/175, 0xaf)
keyctl$session_to_parent(0x12)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000000200)=@secondary='builtin_and_secondary_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$assume_authority(0x10, r0)
add_key(&(0x7f0000000240)='logon\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f00000002c0)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a76c7e96aca1f8bbfd0930a0f3a7b3127e7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db8d2da71bae7345e00b108cd9077d31c0d57ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9b", 0x100, 0xfffffffffffffffc)

19:20:26 executing program 2:
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000840), 0x0, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r1)
keyctl$get_security(0x11, r3, &(0x7f0000000080)=""/53, 0x35)

19:20:26 executing program 0:
keyctl$setperm(0x1d, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000000)='logon\x00', &(0x7f0000000040)=@chain={'key_or_keyring:', r5, ':chain\x00'})

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r1)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000100)='\'', 0x1, r2)
keyctl$update(0x2, r3, 0x0, 0x0)
keyctl$set_timeout(0xf, r0, 0x2)
keyctl$read(0xb, r0, &(0x7f0000000080)=""/56, 0x38)
r4 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7602b725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r5 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r6)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r6, ':chain\x00'})
keyctl$reject(0x13, 0x0, 0x0, 0x7fff, r6)
keyctl$invalidate(0x15, r4)

19:20:26 executing program 1:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$negate(0xd, r0, 0x20, r1)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffff9)

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, r0)
keyctl$reject(0x2, r1, 0x7e0ffd, 0x200, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da07e00d71860cd4aba323edf738f0573cb6ff9a5a74727c5a44aaee8f79b471326749ce7b9e0188d246ec4ba844d794edabee8c405f2a98eeb47fa3b858a8e2e63b", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r3, 0x1)
add_key$keyring(&(0x7f0000000340)='keyring\x00', &(0x7f00000003c0)={'syz', 0x3}, 0x0, 0x0, r3)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000300)='pkcs7_test\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000380)='\xff\x00^s\xf4e\xff\xf1', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
request_key(&(0x7f0000000100)='id_resolver\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000180)='keyring\x00', r5)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x2}, 0x0, 0x0, r0)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000200)={r1, 0x9d, 0xf8}, &(0x7f0000000240)={'enc=', 'raw', ' hash=', {'streebog256\x00'}}, &(0x7f00000002c0)="5f08cfc2b40a509e88483c692f1b94cfc2eeaadd778a3a02964119be8dc91a0366375e9eb227e4698fbd60881248a8a7b6fcc5043836dc26d0cadb026f9bc1c4936bdbd77aa2ace3226c08c66e9973425f35ccebf7ef2379cb1b207c5794c01e43c3eca4d8fb1535d49a48241c47318a54602470247dcdf0d8d3618152f45dbaeba3d71d4a9489c9c64f1c3f0172213af6dece4b64a6e9c4f3320eeba4", &(0x7f0000000380)=""/248)
r2 = request_key(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x2}, 0x0, 0x0)
r3 = request_key(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0)
keyctl$KEYCTL_MOVE(0x1e, r2, 0xfffffffffffffffd, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, r2)
keyctl$search(0xa, r2, &(0x7f0000000000)='cifs.spnego\x00', &(0x7f0000000040)={'syz', 0x0}, r4)

19:20:26 executing program 0:
add_key(&(0x7f00000000c0)='dns_resolver\x00', &(0x7f00000001c0)={'syz', 0x3, 0x2}, &(0x7f0000000200)="1d1ad732d4eb7f3652ee46e39383af62cce15cf21979c899ae544810538e8b8e82f71c6cc5cd03d1d6719772b7ec6aa7dd0a02e8818a9f497dcf34efd463e8858f6c14f7a25ee85f034f37971b19d8a8aa6eeefc5fc2bbe3fd30759a918117bd91e0a60d2b4cf9d51f2600", 0x6b, 0xfffffffffffffffb)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f00000003c0)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae0410314052070acd5ce928430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c48420376fe86584e703926c179b7dc7601d725caad81c499abaab0647ba92fd9defa1b5ae820000", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$setperm(0x5, r4, 0x65000)
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000100)="c5049f7d5612d5d448bc02a7131c0609cc0858064c48974b246eae732eeb12a56c9584e770d046f8be49aee04b5793046ab028af9a90ace00196993ca2c19a96668cdae4546b90998ff1cff5e226cce099a1c7fc329437f1e447c45124502f0bbc1e63b6fa49e2605b0dae1fe53935eb473cb5b8ee314390", 0x78, r2)

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f00000001c0)='asymmetric\x00', &(0x7f0000000200)=@keyring={'key_or_keyring:'})
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000100)={'syz', 0x2}, &(0x7f0000000140)='\b', 0x1, 0x0)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f3fdf3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
add_key(&(0x7f0000000080)='blacklist\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, 0xfffffffffffffee5, r1)
keyctl$restrict_keyring(0x1d, r0, 0x0, &(0x7f00000000c0)='user\x00')
r2 = add_key(&(0x7f0000000140)='big_key\x00', &(0x7f0000000180)={'syz', 0x3}, &(0x7f00000001c0)="c5fb0082a300bd69f4e3ad1440449bff755ad71fd684b005a7092cbfa2f1d9c554098a3fd8b850cd0a114ec50db1c52d0b6345cd5bc19ecb67df0e011ca8c7da26c9b24e8be637ffc3fd8a19dfc7c9b44320b40448b41560e71e7a934d71b5cec9c8bb1a09de36354aba670184bfebb16cf578194ef93736c2226fced211", 0x7e, r0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYRESOCT, @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
keyctl$link(0x8, r2, r5)

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000001580)=ANY=[@ANYRESDEC, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000480)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
add_key$user(&(0x7f0000000240)='user\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f0000000580)="9e63a26e1d4c4724afa5fc79e5c5185d5ab8cf0a1557045cbee43649c85898f7f3adab3ed24419c50fda51ce46d529401281fbc15d22316ecfff832aa29463bd77e48f166f2390964043f30b97b4eae11e1a9cd61b2b1a1fb54b000c6501deeda2f02705ab0942f7c193dbd99c712962c317155d76188e9d2de04cef3a7606d443a4f991f2df53f4aa0b34e0387b81457caa5b6b7bfce229d729df7edd1d8a4d98f4decae91f1434db979a5ceaa6b93fab56ff206c590dd7791c3777e08ba470c0f3434e3b15dd2afc15145934844f90b770705c535bba66e985e82d9976cce05110727b3bb267ac7336d281eba1d339403bbcd80e55059f6c8329a5b4e4fd453aa046563be765e4b625d98af6ce66736e4abed5582a18efda4895fc12e088fa872baa3f6eff4c95b3d1d82756a6f94c2e59aa3ae78e92ba2bb1e4c17ae9b298b2c497bc44586782be3ad5ce95948e78416fa69d0cd45e3d432d311d1c657bae98696c5bd9d03dd85f9d57f5a4db0720d6b2ae7baa412be6fabdd8e94aff52f9984c62d024f2c0b203835ef87073396f8a0b7766d4eab51b8a11bab9af11ae91a0a909785173b681a1a4a497b99bee802ca1ca42d1a30284e1708790402684b4b88087c54aa13b3e996f32470d156f660d4131a5a7597b02f77165ef696e7b8ce14cf30efd4baf77fa1e9d952bac54d855663fd4e3771af8c3eb089fa91c4ecca278e2acdd845f75a2fc553993b28ae89d5244b2a4d805ca173da5ac64b93a9f0e526236729379784068d5d100eaa138a8667db9b822b64f155520ebc27ba922bde18c39875022842a3a9e6a1f8f8ef4c5fd7c2869e3a2113c0b03e22c53032ddbe4ddc3e954f80de23fa617e234c3d566687381b2de2cfbbc95e7204d3cd3facd81f080bfc4063bc14b8b1fbf7440647b940ec0f2556090b187ad018dd431b1531922e68a6581f55f7d1d516e9af3ccac3c8024a36c936bcca1b00a989889907053a6764b149ac318bd4923016a8847cccdddfdddd93e691fe65f6dbd13e9b20b07d22385fb4e250e2b529d6beab3f7373db76f0be07487a1d99c7ab3b6f9edcc333128f4f7acf58f5d48f345635cf923a2994e05ea5bd992da7435c537234adbe0a07fc8820201e02c96d931b349f10f7eafb6912cf963fe28956e47cdcaf3491ae2b96c1fcf2a85e8d60c8c95b4e95d7aba9a8f8def8f0754e0524f1cd4c8950c53b710cec758361695f9b093c7717799b936ed0143d356783bb8f86b2e4b0111a7e181ff74dfcd95bc3dc64789015477bbd80f527f31eda60c0609710cf3291250531959d81fca865543951b4c7320f9b62ebbe8a2c423919a39b7e9488b35189859f4e144f209239755e59fb85f431fcf51b777fb9580f1a69423536420942f9e02f09e8b42ec7dded0e1f78273be826da70e3a17d837c8e402af197c53a140b509e2c161162c46705616a136268e977503ccf67c8e6616ee8919ca171479ab67e3f04128f548c421814a359e318b0c8648d84384fa73451b0048ac402a3e038dac0141a4f3819bbec11b9ca51f5a88efc530861792168e878028db6157623f26971fef02918b5c8d7305d904711bd9bff8901599df96dcc2fab2ea33d6c3d9d02cca677a843b2b493ca299a4d7b17ecb6004374e8935ed807eb96f6947e2e1b1432831d6aa6c8b102c959766d2f0a63aba36bb6a142ace69829799482857febca083b3f68504c9a87d6d7bbfaff4a99a4b3821dc0088f044e591b99a85e0339f8e16bdb2bce10c10660963b8dfb5a2ef9057502e3cc99a7e6ca412a8d68de068f80d8f307655541a529ca2e5289021645975752d2db7dd5108ee9f32a779340ec11866ba954bb03aeff3a211e4e257a944bc2faa47dba831df9434e8a9385e300b4327689325c6e386eafba47768f672988d76c845cd1e167277158972538cb1e3bcdd7ba7f05e82cde484d485f9fb8e2c817ac8946c009253ab2924df52bc59877a93177a0b2db6f3aefcdc425473906158c4ca79acd19a910a6d8deef29337377fd461d4710cfa0c146d59c6c19c7b41d018c0ddfe4cde60496a60fcde445e4a89fe13a12ac0c719155f0ac0c21135aaa2c6874cfd3f82a0e99cc6c1c19c8b1b4aac01a995442e0b2c1bbaeffd9c0cafe095ee9f62ee1219d81556e2f105f608ea306ff9c31edd1487f185c8cf430f23e0b0545308f08dd23ce52e1b41297b593aba6736514f3236a8a6fe75c64986c53813fc3a86f2445d4358c2a513805999e2477196c5ba7912d617a8a62ca6063f455aff9f5b09c893a0674f46b81d00555aee8df48c3e742c13ae3b170ac98f7dd9396be2bedee89c97fb994e3060de7e6daa7011598d81dc88495ab0ecd80432caff8d8abf272dfea0ee261b46e12092a3fcb84c156b93b52db08de877e15868bd96677763f88d23e775c5bb06e8349a30d2aa4c3a8cc0e3394ddc7bd69e3dee5f23dda97dedba79044835ce99923eff111c4ac378477c253a8e73773f8cfc90539935369716c3e77b96629dd0afe034e0b73f5b2a731aa8b03ee847892bc02cc355449ac72ca075add01addc78ce392d7d635581db16efb4dfb9422c4db74b37a17bbef279534c4ef422cdfa965d89c82ebd0dd4796594dc1fb3777480311b1e911843a3043261e247fed3587949e13ce75d155f4765c64358590e0671c7776ca871b44d1dd4762cb4655b54c188aa7e494ceb792f8cedb3ea9e07ca6d9a59bad18f14bba8b6d161071f3930e1de348593392b350a3ae18f944668e12b97aad086b42856a2bdd0bcbb623e07428c41545393d58d6e5c571a7bcfabeb69414b515f967164cccdf6b0d5e2d2e382f25b882769de9d633e16875e18b89412af496c3dc96f79412d88693c87c650b77c37b64b56da6439223d755d45c233a4cf0b04ca1953ea708d36312113bc68be776492bd7f76f5a8f46b6d4b890dceffc3685595f2333989f52579714bc56bf50f7be607bc1513455a060dfaa32297bb515b832718a32cc59af316318de297d3f0cfce1590b47590e58ae0faa48bd7996b87fc322c9d9468148984964a0d109e376b23032be6c940414ef09c9bc1bfed2dec2bbe0cf54a9d7561133004ff3fdff7288e31eaeb605339d442eb8171f39145c29a258d3eebd18364e7f498a1eac120ed49b9560cec3de58f1b906ce2da903a59e4eb01bfb37be815d6d410b2b1f9512825f860ac1a4cea968b5670e1a073c61f0b70f015d10043281579cfcd26b62bc97937c28ab6328c8053620b0f34763df8112cc2dd09fd0b50b4d1a8f630b6ee72183f7edd0ca67ec0db1ef8c1164c9d5d56c0980755c15084aff09862a6f2dfb48a2a4229b7b14c58de50b8cfce2bce14a5795b25967f83c1bf6414702d95beaf57071ccb5a6e60260704b5f67543e6bd05126f3d274fa83057e2a870f495c289056f97be68bb47c9694de8765ad7e97f0c9eb22e602c8c8033235a96581d66f60ad8bbe16ea0225170d6b7897f70eb15c9a6759dffa2c51c2c31ced9fb4d8282b9f74aec764197d6cd30f2af23b2489d85cb7da32ac0b4124380fbc1a4634ab8a321c67adf4059ac0064dbdb104c531c09a51d1c44c11e4b9daa8fa1d37eb84bb234ac35200bf1c2bc6bd2b0e8be50fc403d60192d6413393bc5901251b0c7824bb4f2403b665415dc748d946f72023fc1aeb0d3a9caad3f96bdf1dc4418a81584c0af257a93d7d7e2c8b93c85464c4bf24389cb7ad539b585562719773a63745ffc53cf5eb8acf91f05364814ec90c379605b074be794a1571ab12eb4ecb8897a749954d61bab157be0f07760b80e282ef792c1386dd0c14aa513446b6a43cf76c8b3d563ba329a7ad645f241b968fa1d238be8a709a34882fec94f6d7030a93b5a5afb2ee52da616c0bd966356d58eb4e684df449adb2c6d074e133d6b1d6ba0a1a246e36c0fa4aeef42bbaed24f6676a017011844a16cec15541bab1764d15de4908d7f7ea551372f2c8343294142714f738806b370d9c7550dbd82199baab5a64a5c5712f33ec9a8a87aa29c1abc7d5d64b5bc238c2ae9ed373f9dc0aa2838224acb109461388617afa2401a27a39684e67035bdbbfd51b285dfe2a10fc573b4de400df7559d1780655b8fa522849122d96dbc5a0961dac7fb670ef35eb8f2e84d57adcab87fc04febd77b424a1f4a028bef2626a05b061443a76a407c885261214a7274b6af220374e170297ef948c1ee4a44f78be1fe9f5663880058cff139fee647172faa4d48f53e93443d35cb9a87723ac7158588bf41a23c35efdaee4c94fd8a9c64347a557d98eb26da1a0a62c002637ffc32c7f975aac915c85a4f228185b14a961243939ed38c962d2e87c3729020349ac192f60917c0d5ac0b49bc2bf9d99e8a4e1ac9f4317fcaa711662359651d0b2536bfc56a5cedfd54bdde33d843f615df8c8fc5c8477be0eca3dd454e9f8c3eeffed315c97320f865d9e832ba068c2780785924737e8e43ad5ff2e3de0ba411209162b792c71c57377e39936304d4006fd5e6685c6ae901332057a3bbf7225afa5f3dc22c3fe01367cedff927f6830e0e9313cf40d8edb68c7edbec2c9c1fbc3a3bf5491cec1bd3addef5ac913cf2f1e0aae734e76b5028c3c2305c313addebc886c50e77aa2b4bcda7aa64ff6d9dd5dc91668926b26a4a6e0ed2811ddd5b5b5daee99d99e8f33ee640d2be3833cc960a67190dfbc754321fd58ddb0b388f548329110ce30c43cd4f5888d2bea1755ddaa192409c6c6e965460e1ce9b7084a4caf75558dd319c8d3657c3187a4cd11cbfc4160271092f2d63cb6df544e088a782cba1e3d1635ee0c23a887dc2ce1e2180172dff991c9c624ae7196bcab0b9fd0147cd66e1f58829fe53064d30351ea74ffa3a0b3245533703a4cb9e592f38502b59c31d97ea3b83396b52a26edc8b83938076dd647c4a17c6fe53c6696db43efb5055a99f3389fd7bf023aa2c2a83755951bc6a94ac914e684ef1cf0a4d870c53cb62e2abe65ebed1c6aa8db3ef05865b88d6a0e5e2fc755b17aa265415944e30e2a5ba2090f2d6d2c07003cb9052020a7fb25e7f0a1272283f12c0f87d2b488808f66f7173d7bd02110f7cc1524fbf0ed062064b765070f31af30054f9788ad36350d3f2d8a24e7142ad86cc260ce8e9354cd2f1c858669730ba932aedbcdd5f77cd9bbd3a2ef787a2edff8af62b2eb9c65f40b76e098c1f4a0e0b0df302a8f3230d270759f2487d84934555945f444b1c11c19851c03f3b64866fb25d3043ee0fbf94681032a7e4e1e8a3e25f3517ecbb1f8b5513cb182716b0a141fb0b6b82669630508564bff1bf310dcce58534b75484c9182d87274d7ee401b5d04bb406bc095f21b103c8bc91d264d3de4df6e23a23cf5d94f791df397a6674e639ffd5995af2d0c60654443b00d22cd723a2d154b1e6931e577f45aeacac9feb5c8c3dffb8cf4a9aedb0411ddba3fdfb6f1bf37f4ddddad1acab7f326d30b79f3e0835c3eed9a076b22e18ad7ff27de2df551c49fc87965d13105d53c3cb5417815a97c2c2e6bbf4f74eb779eee2c6f773c7447885c953017c3edd058df9280a5abe57dad3324cfb2b48e4981cccbc8340ed5a8563a98375f056a96f533eb5da491a3b9064ff0324df06870e8cf0ac9369e007f40220ad974d966352e72d847af6b7d38e9ef0feb4049d42bf94837f502c9b82a0662f5cfcf7bf970b1b0bbe86e2868c74bb76ce9047758a53cc1436c4779bae30c74b9474e8077d88303b840c3e7940a547cba9991", 0x1000, 0xfffffffffffffffd)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$reject(0x13, r1, 0x5, 0x1, r2)

19:20:26 executing program 2:
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000280)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYRESDEC, @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='pkcs7_test\x00', &(0x7f00000002c0)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000000580)=@keyring={'key_or_keyring:'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='keyring\x00', &(0x7f0000000180)=@chain={'key_or_keyring:', r1, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r0, r4, 0x1)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000940)='\x01\x00', 0x0)

19:20:26 executing program 3:
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000001ac0)={'syz', 0x2, 0xe}, &(0x7f0000001b00)="bf", 0x1, 0xfffffffffffffffc)

19:20:26 executing program 1:
r0 = add_key(&(0x7f0000000240)='rxrpc_s\x00', 0x0, &(0x7f0000000280)="b74520af7410b65484187b8fbd575b20", 0x10, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000580)='user\x00', &(0x7f00000005c0)=@chain={'key_or_keyring:', r0, ':chain\x00'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
keyctl$KEYCTL_MOVE(0x1e, r1, r0, r3, 0x1)
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r4, 0x1)
keyctl$describe(0x6, r2, &(0x7f0000000000)=""/88, 0x58)

19:20:26 executing program 3:
keyctl$assume_authority(0x10, 0x0)
keyctl$invalidate(0x15, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x2}, 0xfffffffffffffff9)
r0 = request_key(0x0, 0x0, 0x0, 0x0)
request_key(&(0x7f0000000080)='dns_resolver\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)='vmnet0\x00', r0)
r1 = add_key$keyring(0x0, &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000780)='blacklist\x00', 0x0, r1)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000940)='-\x00', 0xfffffffffffffffe)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$link(0x8, r0, r3)
keyctl$revoke(0x3, r1)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$restrict_keyring(0x5, 0xfffffffffffffffe, 0x0, 0x0)
r1 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000080)="8f", 0x1, r0)
keyctl$reject(0x2, r1, 0x7e0ffd, 0x200, 0x0)

19:20:26 executing program 3:
request_key(&(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000300)='B', 0x1, 0xffffffffffffffff)
keyctl$setperm(0x5, r0, 0x0)
keyctl$get_security(0x11, r0, 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$restrict_keyring(0x1d, r2, 0x0, &(0x7f0000000080)='-^^\x00')

19:20:26 executing program 1:
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f0000000100)={'syz', 0x2}, &(0x7f0000000140)="ae", 0x1, 0xfffffffffffffffc)
r0 = request_key(&(0x7f00000000c0)='pkcs7_test\x00', &(0x7f0000000180)={'syz', 0x0}, &(0x7f00000001c0)=')\x00', 0xffffffffffffffff)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r0)

19:20:26 executing program 1:
keyctl$set_reqkey_keyring(0xe, 0x3)
keyctl$join(0x1, 0x0)
r0 = request_key(&(0x7f00000008c0)='asymmetric\x00', &(0x7f0000000900)={'syz', 0x3}, &(0x7f0000000940)='\x00'/12, 0x0)
add_key(&(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)="39f7640fdc9d9e889e919859cf725d11fc1aee715a3bc323414c79965c18a5f527c554662ed7c3641a197c76c6faaa5dbd9496ded33fbf8eefd5f1e6be7a0fb403d8f66d35886bcff45b9d4632ceda7ca1a81d41cf73f1a140ca3e3e285d7332341e1c0a0a9a4b0d679b26090140c5f0febfea017ae9a9b7d69aed42590bd099b3e9fc64806ceb738561414f278c3033c0c9a80ca6e0ce5d538b2a4d7c4e89f889baab7d6844e78dea56721bff9572797a5c6e2f", 0xb4, r0)

19:20:26 executing program 2:
keyctl$instantiate(0xc, 0x0, &(0x7f0000000600)=ANY=[@ANYRES32, @ANYRESOCT, @ANYRES64, @ANYPTR64=&(0x7f0000000680)=ANY=[@ANYRESHEX, @ANYRES64, @ANYBLOB="2a70ed430e07337a6cf0565e536712ee4d4639bdd54017fd91ac7f4c8cb413a4adb79e87978930865b12df945fa12414a2cf5efea2fe83c2aa02bcb57a2a90616c97a53d76ae4b2b666924e07287f4cffa5f9af0923520628f87cea649abd3440a84cfa5498befaf1e3736ede772", @ANYRESDEC, @ANYPTR64=&(0x7f0000000240)=ANY=[@ANYRESHEX, @ANYBLOB="e41e7a05f035d31abd0582674467ae9c053630fbd44398115f87b660974d5fee56a6c2469e7a7e1f53e8664e9030f5d838d937fb225b869d4f7884717a98fa084bd189a4c1"], @ANYRESOCT], @ANYPTR64=&(0x7f0000000580)=ANY=[@ANYPTR64=&(0x7f0000000540)=ANY=[@ANYPTR64=&(0x7f0000000640)=ANY=[@ANYRES32, @ANYRES32, @ANYRESHEX]], @ANYRES16, @ANYRESDEC=0x0]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
keyctl$link(0x8, 0x0, 0x0)
r0 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f00000001c0)={'syz', 0x3}, &(0x7f0000000180)='h', 0x1, 0xfffffffffffffffd)
keyctl$unlink(0x9, r0, r0)
keyctl$get_security(0x11, r0, &(0x7f0000000000)=""/89, 0x59)
r1 = add_key(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000100)="78a1cc3f0cedd086785babe88f929052885f2d7dea844c82118cd6572113fc2622da89adf5a6a19d43b6084cf3dd3a5cbf3dd9ff1f844e93cd49e60e0ff18ca33a421d69c885314d166f2cf34b5154d9521b99a89439d4", 0x57, 0xfffffffffffffffb)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$negate(0xd, r1, 0x1702, r3)

19:20:26 executing program 3:
r0 = add_key(&(0x7f0000000240)='asymmetric\x00', 0x0, &(0x7f0000000100)="5f9c", 0x2, 0xfffffffffffffffb)
r1 = add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000280)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffe)
keyctl$reject(0x13, r0, 0x1, 0x7fff, r1)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000000)={'syz', 0x1}, 0x0, 0x0, 0x0)
r2 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f00000000c0)={'syz', 0x1}, &(0x7f0000000140)="e92113e7c6b2b917b63f0634922f8ff08ecddb5d3dd05f84597153f4215056a4ede159865429478e66aca49266e79fd420e2c40e6c9a09c5804dd940648f079fe40ca036f371df2dc8bce31fa17d6cc94dc4dc04a91699e3bdc9f25de08ad709f855b4a48d5b3dd5240a49f23faa5aab7ceeb48bed8665f154143087a171e05dde1cb7ef2dcea77e0c09eb49ffbeff771e01f3822cdf330fc0ab80985d8a7a07dcf62aa55fdd510c7c", 0xa9, 0x0)
keyctl$set_timeout(0xf, r2, 0x9)

19:20:26 executing program 0:
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000002380)=""/4098, 0x1002)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f00000000c0)={'syz', 0x1}, &(0x7f0000000100)="3b23a78f717c5a3d40e86a847da9a1f09219ac75bbbb9c304d6d29c49ad2a4e3a3c68493a341a85e9a0c116043422856675c70427eec39f6a340eef937f61d891470cd25131e4a9ab18758a2d680020b5d17d183392c75f48aac5960eeb0352906633e2b1636ae90d715584c67965e39ae3a84fffc3f32f6a9c7ba739d0cdf9b7feb896c4d93143f20233790c769d5f2886b7165a7d007afa2c5047ef18030b916", 0xa1, r0)
keyctl$revoke(0x3, r0)
keyctl$setperm(0x5, r1, 0x10000000)
request_key(&(0x7f0000000080)='cifs.spnego\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0)

19:20:26 executing program 2:
keyctl$join(0x1, &(0x7f0000000000)={'syz', 0x1})
keyctl$assume_authority(0x10, 0x0)
keyctl$assume_authority(0x10, 0x0)
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r1 = request_key(&(0x7f0000000040)='big_key\x00', &(0x7f0000000080)={'syz', 0x0}, &(0x7f00000000c0)='vboxnet1\x00', r0)
add_key(&(0x7f0000000180)='dns_resolver\x00', &(0x7f00000001c0)={'syz', 0x1}, &(0x7f0000000200)="0eb79ab0f474be6ea19d73a70b9aab5158cf63fdc9233c6daadfabee19c98caadd170f0769efc28c97dbd46aa595e323999bc3af04634ac387a30f64d128aa77b9e68310995c815ac9294c51d7969118013ba9b97c4ad472728adf0f8bfd4a9d5fec4482c39b0abfbb9bdcfb879dcf0a9b5b669784d26044d5eab736c3a6b279e31753021152645c141b423ddc1a4cf3c48d2c028365a1f54830f60a1450c787accd68a3886957731d901be9841fd60c7d5c42ae269a59988983f3669a6fb4d6ea33e3b4aa42a9714f23ec68e472896de8963c55187bf0e8725b48eea1d476e98edc84a4cac52e", 0xe7, r0)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000300)={r1, 0xe6, 0xdb}, &(0x7f0000000340)={'enc=', 'pkcs1', ' hash=', {'blake2s-160-x86\x00'}}, &(0x7f00000003c0)="1fe56d93a27c09cf4daa15e6d3c9d728715afa485123afaa391c605049d46cdd9ebfb2e0d4eb003df5edd83105d0db369e7ce63ccf0351d6205ebb2568f06ad1f305dbf6fdcd7f3f8a307dea3de6f714a5ad346a61766e9d86dd2ab654df1db02a2e27694d9d36fa410a5fa1ecab40b8bc0cee0331abe7f465b5b5bb91723d592f4830e0fee8e8def491e8f7e110fe0e4e4d360c01e95bc54e58e89214db7dab22255f5bf966a7ecf4e7a6ed915d3c3c62d28d09ad34ec9b4716caa40c47ae5d53e39a75413b11cee1367c6fda0bc5e92ede2c55090aa1f58dff1aaf06adb9bd882fe46ee3b8", &(0x7f00000004c0)=""/219)
r2 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f0000000600)={'syz', 0x0}, &(0x7f0000000640)="32aaa07a388c7b22a2e30bfc1c5c70fb25ec34d05c1737f2628109b8105d776878c534ac3332b82dce34a1990534175b2abc42c0a89a2119cb49c4a1004380b1e9fbbcff05b05f5554cfdc46ae98b94191bf7686596d28506702159716801e571c4cb31fc51c4da5951f2a8e9d4985253836d19f75c381ba24d139c2159ff6055d3fd383dd59551f64ab25b890dc88ff036c1fa57d1d09182d9aedc6c4228283a2a4964c42a497a21eb21e5eb679a242495ef144136fa4a7f873fdf5ed1168e296ad63f0c103cfc61c715e8a544a93d9e0cad965afcb024a3a4f6a", 0xdb, 0xfffffffffffffff9)
r3 = request_key(&(0x7f0000000740)='rxrpc_s\x00', &(0x7f0000000780)={'syz', 0x0}, &(0x7f00000007c0)=' hash=', 0xfffffffffffffffe)
keyctl$reject(0x13, r2, 0x11a, 0x6, r3)
r4 = request_key(&(0x7f0000000800)='dns_resolver\x00', &(0x7f0000000840)={'syz', 0x0}, &(0x7f0000000880)='\x00', 0xfffffffffffffff9)
r5 = request_key(&(0x7f00000008c0)='ceph\x00', &(0x7f0000000900)={'syz', 0x0}, &(0x7f0000000940)='pkcs1', 0xfffffffffffffffb)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x0)
add_key$user(&(0x7f0000000980)='user\x00', &(0x7f00000009c0)={'syz', 0x0}, &(0x7f0000000a00)="82db1a37191323721dad9880d4bdb0900c7d61b9eb9917e9d15c368ec5822def1e428b3315abc79c3fca732a4348b7c2534835d495b71320506b02323387e99c44bf0090687bb24cf3bf4298871b74e1a01f7ad6b20eae15ddecf33670d854b990f49b4ae8f5bce2b2a95dbf928796e7effc1e0890eb9344610cb41f8fd3323ab93d4f521d80d52516291f741546243120cfd520dc4b93230ba9ecf64f4f9b02bc8cd20b758f363c3ff88e96856bd7ed2532926a3069202d2acbfe1d6f9b5ece2e2ffdd771a3bd62493c1031222548920fe4fa5e22046562c370a382cc268b10b1469c385dd6d0cd4b338b0e7b3e528109fdefd801a865e5f6ba02ba44eed9efdecf99121e25820ddcd6aa66dd77240f620b0bffa5fdcc5322f9bf61b254584a455692add213d7bfc50307d708fe0fa911c02596303107379865b7a8fba060efb5b6ca3e8da5158b89c93136de67baa1c913f3a12a6db0c9a81e7b84592fb595fb6b693e78b2512ec6c6e7af357689b30ee4c37791968d75234468d445ecf5bf3756fe34a0a76cb29b7e59683e54ef80df4f5d7ae1bac95a4a4e5ff1138a09a6eb44a00fe2f1ea8a2969e8c0792da9f1212038f8c3066cbf3b4365ad3b0388e00552cc8030f48ba3b1cc709569b240f6704ce21b36281c5fa5929a02763694ed390757f8540f16cd44591e07728e2a5bd6cdb7fbc3b22163a72bfd64732a0a54cb434d5a1046f33c522b32bc08140dba9e80343be625a970c62566bbd3f2dae6e462d116fe60d44810fed7549085c83c15f0aabb49b3c3c33409da39e1dba9b8b54f4c8cc1035ae003d739ca76259501aa9b7fe6b7f98c5e36d5f6a2ad340c3d7de44a0cb54ddfce77419e504209c0c2125d2555d7909c238bfd55ad326365a7f59918d9235833cd40976eac1dfdae48076d2b94ebb4c8bd1d9eb08cef27f0343fdfdfc6f69307bd198de7e70c876caac6661b531d9007c8761c9f5999cde63ae5bd6b20ed7fe81e689902f835d1ea77dd245b5d6cc438edaf65ebff689cecf934c09fff9c0b4d3389c406b0489a67b4bc0f273443e832227731506d560e90e7e8a9d82d8bf9ee615c35c183cf4b172f865eae7dc331731e085149a25766e33bea9c57a5dfa388f2add65789e01c84eacadfc0f41b64c397b9b380a37b1c957982b228089219810ef6bf185578345cb2b6a4284e3527e9509b06917db8501474d044ad9e0c39076834e03bd319d2436f4888e3f00981a002c737a250a49a540519a40bf868af4f612692d45eab410d77681a30480b2a90cc32f73f6a4d7eed64ffd1abb939013f51864fd58ff3aac9ba4832810933a75db0dc95114117c21c67162fa493056fbfce8e5eccd5d02280f41ea935fcb77bf50c62d06d48e42a9022cedc58fb04d976d46b09cd2a53581ccb48913b81ba66669882e8b6193a524053f95d1e0a252e725b8b5ff2c99a0000b20820a19b34f7b829a4c2e3fd86582c1d8253dfdf714fd524ea78e6b254975d5488ccb88ecefc032d8547d8cdbf750abdf122d71503313207f1d7bbf331a6776c473aadebbab47d2839f3238b7f828827f503fe389429633b7ccec29992c60ab3f4057f94c4b5aacd8e9b9b0fc5f4b927d11a9ee251ddcab0009e8b32d66dd66af6c36054ab2b72836b01ccb63955fac2c6b5a7f24c650b94a36cc1b68fe27f97ff7eb862b3c66075267cf183c300e7469e933f36571375d4f17ae5544ad7852fc53b857b23a2924acbe30bfe3936c9768e36835855ea4835a3d17c8b469373988ffa7144afcc9694731c95bd51448d5cab28573114c2237f256ad0c3a1a7fc07b914b03c9a2df6e8782bb98b96813ae56f73418e1b1c1620c2a6bb18cf70d00942ddb04ba3aa3c858ad5774f4f4091911427cc54991b308cf28bf821672729c6cc19561afd3653a93941441101c18d6015206738e5a815da5efb76f3d697b20f86a481c26a08476b8dc57019007502f44f4caa5f374ca857a3e5247c2c4ade8406920eba46147583648041074f6be7591c1fccf36e2d3a6842835644ea9507b066ef03dc1935b6a69a34ea7a06a45750dcad1dc59cba2f945662500b56076f30ce818349b8f8153d0b93cb8aef9fdd9ed4d033ed2b7204b9dc9f41b73f46ad3191bf7f8e83e5b67b2ce23bca0933f7726a3ab3ab46ef1d1ce448ab89671bfed58f2d328bd97272ff1537abe786be0e13375ea8b6ab5afb8546440189ae1776588fa56ff80a102978f130ef9f425f929fe69ad9b4241a7ea88e5800caa76c0cda2250a886baffb4b275a9a53273a87b2324eb237c496f92df092c0adf1101739580b7bc9c309dd2b99d41f9fd4b02b434626583f3113f2d31e37378c5b15dca8ac107da795b3a7a2d9f7cb2e4f23608cfa6dea712eb791c665a207473adc6d82e93ca0b86a8ec55735b660fd6c772bdfdb4642898067d7133745cce7c4111584c555b41e17a4788bd30f27115ff0f2f414a6d64d42782a815db97c6a1f7c609d3623525df199df66fbaa9557b0c390874e738b1cbf48e795ae7ee99cbad88cbf6f1229d6671a6654498d6cc6f894e619d68ce63899e4f46637afb8cf6be0bedd34ebcdacb583ea4c76952433bbf788d048f12fdc4e35246cc4a6ebb3532b6f8229957df8981baaff1c52316510e34c8b8027a82bd49de7fda1d456c46d970b03437d527bea93f580a0ac3b8a1604ce7e308c246d7b946be95605859c86e1c0cf71213b1269d4dc4b8075bc3c70542eedeb28d5c74958bc66db8989d1a0b1cfdd5e9fdf9a4483f2355a89f3276353b27ed4efb02f02fbdc7b46fd25ae66d7a8244a1362692a04de9fef8e576cef24305a89800bb782d239f2ca3556e9d60dd9336d35927aae89c060d961d9f150dde1f26f32e29940d530539f311ed401113ea6f63ea15cb01ab35138ed1699f7004d9a7a40ee73a21a13bbba6e8e12277f97f2f1fec181c81b48c52f746857b959caac2a482a9053e5cf78166ab0982816daa1fc40ea180aa99ce72af8638c4682a28625c4d0225789fd6933a70ac7d6c0d0a57e534055b2fbbde9512c82cf205e883e793e08bd318a5c49f4f0c4d66b9d6a4778878ba50e8e2beb0c54ff89c2801bbf392ebc8d5411cf6521007256a34121c112e5b141674493e3b165eca11c3863f21c00c794214da1e2c81b37f4378a8d0a7a40a97328e017765f569cfa6e922afe5a9242938d2cd7fcd7271aa272cbccec7b0737916b2a8503fa8553960d468ad3a147a6b13230403612e0b914ddce50cb2f0feb5d18063c7619f02e7b5b3ce119fd48b821c4972dea96f5c4eaab0c8502e03e5ef6282a95e6bad18fee032a63ac99d83c03f9e2aca68eabee77c419f700df8c962c3a235ccb22abc2615bc8ae1915776da950e23f3b6614851e54d33201985fab474ccdde36f6a06e036ccceab722649bea4aa761f59909ebfebfef3bcd2a36dace411bd6c2ef292470dde47db3489853d9da32eae091e81852a522023544a71744990f00ebb762659349ffcca1f8bb0195df5f4245b8082a5a48273bb77f7e8ca23826ce429f03955df8f608cd96aebe250794d96d8bd4e313ec2f519c1f85a4bc785978586283538b06a1b9b81540ce80ea2791509d74670457dd13d96370d1fb352475aab006081c68803d35baef2eee48f48173734fae9552f3513b3d5fb1e23693271d78fe62b41eeb671e92fbe5d1c8522d502c01cb65ebdc5dc0e22c42ea9dba438618589d4f55a60c5633b215d6f16a86ebfc318fc3729a7f9457b6d41dc4144378288cae7c2ea27dbc5276d35d515079989574b29572f4bfdcb5e3e653f5937c8179f15195587a8b560554d72ea40093ed3d9fb15c97a88669f432b06e73771a15e8f5745ee547a8280a24d97ede86784482c23a4c642a953b053910c4819d3893624ad74aa8d055a4e5783bbe3c9470c34353da00eb634d71452253bca3238fd5c28b5eb593f7de9acadc0308de37cea968e4ea06dc2872ccadc68235d58e0b52b67a25733cbbcf3fda2b150338d7073dc5e80a3f96f59ab786545257ce507ad0ca004a0d278de1bbcd8fe33f0f1e900e448390e58fdbc7d215da8d410c5d6617e57f97d8ac66b00f1898ed752aedf05666c16d6b1da6713b561f1f3ded2de090ec2aacdaf063b46ced1fe898a4e20eea7dfd674988b3a55deaa16cfb87f747246a2552b5bfd6a159b4e1f7d0469239fb2d687915af4f7b5ad2ab710151f0cbb698fff11d2545c19be151ec1150b2b2702a6e13c93217593087b56c163caccd6ee4f0c597194ee1c79f91136b7bf382c19d4e398739d4ad8febb0367cca03575fec67d4a7f559169619a8fc2def8e1411cddade03d7a62d1331d220ac17ef23760bde78340698da6b87bf6c618527c3c35ae0c47daa78733eae56dd5d2a0729a6416b45f335afb33166348969ec97cdf6b5bd14262c892a0131723c6b988776f281a81e97873993ed22d46b7768adadf39c4c83efa5b030137ffa8412a99098a06c6eddd5fb5aec2c2a850d58227ea153d08ab00fde519ee1bc9ef21f3bdc0f77d8d0b17624efc24859c083355da5476336358b4e921da79385f7dc959a8a284253caa7cebbbba5af1cf882727bd8dcc7e818c363b794da1952c57fa025942aeafcc8ea327bafd3abb75b02cd66a64562e3a786389bc92b97bb75e518fee8750cc2fed381f1b53ab2d4b2eeea7d6df084ef9dc46c507bc30ac8ca177fa509a3fd073239b35b8fce27381b50ff228033a638361aec6eabc3dfa4a883edfecdbb260e323b7d5df02d58b6da1519e1aaca6cfa1b6c215683110853b9e12c9d6c7d80821462b81dfb13e4dd447b1aa35720dfe77baeeacffa0641b3a51a30f573f0646dc1cfc0ab64f01a4e94fdccf9a0de5e9866ae74cb861262807cecdba8ad4f7b542a87e78dc00d5c61afce013dcbda43fb69b63151fcc1d822e7119f82b3cd2ce2de0e27a5421cb02c637cf7738ae08f03b125c5753cf6fbce2c266fa05c79c8f294f3c3c76bf1b7393b5e1492247ea8d8640272e6210dbe5d14569ab4addaaf88465d361f3d22d089b3562bbb28e3a2653c0482d17d100d5e55c430eb49148984d0bae9a21217a46ca4db68226789ce6b1b0b7bdaa4c045dca4219dabefff18970dcd243b40736360c813ffd1819f586437b96541fb800918ed46ef1d48faa6d4cec3518a7d192ab14fe7d0baa18e3b6b50184a5e3b1e55b70de092f9c6dd3cae6fbfb5739a659df11016af58c9375b55323f6a391ea39e712be227c413471fc9de69e4147eb7789709e6c963769405287840b460a7c14edeae0b5688a4ce6bec0a014d7af5d9e4bc8e5e8a3d30a7697966cdb3e7e5658caab08616880c3b5cede197111051591180cb7448ee51b05a43a2a4d215665dae562b5a99f0919c477999ea3752a869578ed059a4300c1110d50384ff43c6d0a8d85648e0b5d37b376d1d0ac03e771c3cf5e0d84019c8110ca25844627e8c3b6a69ec44f10c5d528687555d772bae5077a0ef619843e142e2c01d3668fd56e82ee955d102e8568e524747c9bb1a7cbe54cc07d7c44d0dddda44993b13dd4d87e1e4c8cf8cea5eae857da51363ca2c62566117fd13233d6d0562c94c1e51476a0a36750e056d13ef358d80af9d6a56775a789635d3c29e80413b360fc07735871b2288267435e10726199b205ebf748cae8349b8bebdb974a5e79af4c13771378d99d6cf53fe2da5152b49277918e80fa421a88d7fc7566ad3c39c6652a732b3e99e6d972ce62dcd0474db9a229222c2bf4", 0x1000, 0xfffffffffffffffc)
keyctl$link(0x8, 0x0, r4)
r6 = request_key(&(0x7f0000001a00)='id_resolver\x00', &(0x7f0000001a40)={'syz', 0x3}, &(0x7f0000001a80)='\x00', 0xfffffffffffffffe)
keyctl$unlink(0x9, 0x0, r6)
r7 = add_key(&(0x7f0000001b80)='keyring\x00', &(0x7f0000001bc0)={'syz', 0x2}, &(0x7f0000001c00)="b283a8a0cba8048b31d519762baff72dd25e4e1e486b030e1f4641d19a08910fe188a723efa92a5a903225604033ffd876ec4badac24a74ef970c7c537d36e5f188ea6f9047cf75531cbd35551ffe978a3d9050386b0a68e125c41c628631d57e99cdda43ac63ecb2758ae623159740686bad0f289da076281d2588fa576aa36097cc7670c003c041931e7634a23d708ad16eab5ae375370aa38a22e58cb58ffada5361916d597ac52d2", 0xaa, 0xfffffffffffffffe)
add_key$user(&(0x7f0000001ac0)='user\x00', &(0x7f0000001b00)={'syz', 0x3}, &(0x7f0000001b40)="a592c50889c838103a1961c1bde604364a5c7f0d7257af62afa99c83398296cad9bf77a26461e90db292d5355a", 0x2d, r7)
request_key(&(0x7f0000001cc0)='keyring\x00', &(0x7f0000001d00)={'syz', 0x1}, &(0x7f0000001d40)='dns_resolver\x00', r4)

19:20:26 executing program 0:
r0 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f00000001c0)={'syz', 0x3}, &(0x7f0000000180)='h', 0x1, 0xfffffffffffffffd)
keyctl$unlink(0x9, r0, r0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='syzkaller\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$search(0xa, r2, &(0x7f0000000000)='syzkaller\x00', &(0x7f0000000040)={'syz', 0x3}, r4)

19:20:26 executing program 3:
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$join(0x1, &(0x7f0000000100)={'syz', 0x1})

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$search(0xa, r1, &(0x7f00000000c0)='dns_resolver\x00', &(0x7f0000000100)={'syz', 0x2}, r0)
request_key(&(0x7f0000000080)='cifs.spnego\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000180)='keyring\x00', r1)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f00000003c0)=ANY=[@ANYRES64, @ANYRESHEX, @ANYBLOB="e697ca7ee929268d744bb76282041837b84ceb9a4e088815949c36b116fccef6dc485cf9e81690f6391bbebb2e42aea9ef7adf67731d658aa3ae7d0e0a7353e68f23b0c5b096ef5b7eb0b3a72093a5c019028b"]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$KEYCTL_PKEY_QUERY(0x18, r2, 0x0, &(0x7f0000000000)='%}\x00', &(0x7f0000000040))
keyctl$set_timeout(0xf, 0x0, 0x0)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = request_key(&(0x7f0000000600)='.request_key_auth\x00', &(0x7f0000000640)={'syz', 0x0}, &(0x7f0000000680)='vboxnet0\x00', 0xffffffffffffffff)
add_key(&(0x7f0000000440)='dns_resolver\x00', &(0x7f0000000580)={'syz', 0x3}, &(0x7f00000005c0)="28a2235e6a398e9e914666aa06990228b4cdfb86", 0x14, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
request_key(&(0x7f0000000400)='encrypted\x00', &(0x7f00000003c0)={'syz', 0x2}, 0x0, r2)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, r2)

19:20:26 executing program 3:
r0 = add_key$user(0x0, 0x0, &(0x7f0000000380)="f683652e8216e52240eda8f1ffd7e794a988abf3e573f44ce0845a59d82eada15dde8c37ae15b3d70a659e81f4c271d380d445524ef63d0eb35db543c4d2e5779721282817da3f4096655a49ecc8ae0f7ebfd2cc62b8c9098e4ebe8075231e7d290c76ccd67c31148b3679651b59672d4393f07d467bbbf0a7d3ab5ae3aebc1febf7200a26d487ba09d18a1adb6eaea52431041b5943dc18a35a52df69968231d530f27ed53cd8c0c5c7fbcfd7a9808ae177784a68823cbf3c328df146383fbcc05f927355003cea06dce4ae23", 0xcd, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$instantiate(0xc, r0, &(0x7f0000000000)=@encrypted_update={'update ', 'ecryptfs', 0x20, 'user:', '\\\''}, 0x18, r2)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000140)="485341c900", 0x5, r5)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$unlink(0x9, r0, r3)

19:20:26 executing program 1:
keyctl$session_to_parent(0x12)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$invalidate(0x15, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$session_to_parent(0x12)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$set_timeout(0xf, r2, 0x61ee)
keyctl$get_security(0x7, r0, 0x0, 0x0)
add_key(&(0x7f00000000c0)='trusted\x00', &(0x7f0000000100)={'syz', 0x1}, &(0x7f0000000480)="61c3ec29c8ca812d9181eb974d17858ad73df3fa6a68d58eadd99a74fa17f13a68e42aa1d21bb859a6b78efbeb78f586cc81d6b9bb4df454e06ca7803d92f244b388c7a7fc02db01e7f82a87ba659234f0af639d513e5d2a26e3c40fa1ed78d232a85ec11b5ba2869738496075da651bd9c7a3aae5e7e1bef32913c03d9acca08923b2c1343f110dd4ad239d3f43020075b1e135c174914ad0d9dfca24d2c3fa80d84f1a6bcd8ae8671df2d787fc18d9bbe578458a14f7db538de4898a3d54eb07610e68881cfd22276201bacf5d705047cc855c581ecb70511ca29b711d1e0aaa866415287662518d17bf", 0xeb, r0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, r0)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffff9)

19:20:26 executing program 0:
r0 = add_key(&(0x7f0000000040)='big_key\x00', &(0x7f00000000c0)={'syz', 0x0}, &(0x7f0000000100)="d72ad70df73d7ff825a2042687862abc51bf7633180863575f6bcbbb4df6fae641dc7346206ce5b7b0cbdd4c5b13eb", 0x2f, 0xfffffffffffffffa)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
r2 = add_key(&(0x7f0000000500)='dns_resolver\x00', &(0x7f0000000580)={'syz', 0x2}, &(0x7f00000005c0)="0cea58c45445885851ce664af3ed3ac3cd1f040b00ea102212b82eb48e2a5142d90f4d439006495e5de281655cb7a8f83f26691a470209963799fe73afb7d17347b8c7e50340900d12b698b21967cae0890eb120d5c3d71e5459a84977e78aa9478791626ad73183129d7541a7", 0x6d, r1)
add_key$keyring(&(0x7f0000000480)='keyring\x00', &(0x7f00000004c0)={'syz', 0x0}, 0x0, 0x0, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000640)='pkcs7_test\x00', &(0x7f0000000680)='\x00')
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
r3 = request_key(&(0x7f0000000140)='big_key\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f00000001c0)='\x00', r1)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000000200)={r3, 0x91, 0xf6}, &(0x7f0000000240)=ANY=[@ANYBLOB="6572617720686173683d7368613235362d67656e657269630000000000000000000000000000000100"/77], &(0x7f00000002c0)="e9f26dc450f00415f1273ca94660b68677bf59234714038475f660483110266a11a7967373cd96971ccc99b449e55c30f25ce75d6d686c3e550eb250dbe7a7451c89e97288b4432fec82e3e2251f0bee3377c769b1b12c592e80e5ae2128fa23d2a83bd9a85a4a376d00b1907015af76aee3bae49085b4b20437aad282c6ceb545546bbf535b77834fd57e061cd01511ae", &(0x7f0000000380)=""/246)
add_key(&(0x7f0000000080)='pkcs7_test\x00', 0x0, &(0x7f0000000000)="78f633a9dfe9a7200aded1984d6f45a7e5b535c0d719f25d02b50642a8c8acdbf6873e1ba05fd06dfa234b378d9f97f707ade4f66c8b", 0x36, r0)

19:20:26 executing program 3:
keyctl$reject(0x2, 0x0, 0x22b0b9d3, 0x201, 0x0)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000001c0)=""/197, 0xffffffed)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffff9)
keyctl$reject(0x13, r0, 0x3, 0x3, r1)
r2 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
keyctl$reject(0x2, r2, 0x760fff, 0x201, 0x0)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = request_key(&(0x7f0000000000)='id_legacy\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)='vmnet1\x17+vboxnet1posix_acl_accessvmnet1\x00', r0)
keyctl$update(0x2, r1, 0x0, 0x0)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$set_timeout(0xf, 0x0, 0x0)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, r0)

19:20:26 executing program 0:
keyctl$set_reqkey_keyring(0xe, 0x0)
request_key(&(0x7f00000003c0)='blacklist\x00', &(0x7f0000000400)={'syz', 0x2}, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04107e5aaa6cbd49b73140430e4438ef0cb57bffa368132280d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8bc90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ea820d343e4897a2", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x918201c)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$search(0xa, 0x0, &(0x7f0000000440)='encrypted\x00', &(0x7f0000000580)={'syz', 0x1}, r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$unlink(0x9, r1, 0x0)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key(&(0x7f0000000280)='cifs.spnego\x00', &(0x7f00000002c0)={'syz', 0x2}, &(0x7f0000000300)="920cd75134568e21f0f2c34196", 0xd, r3)
add_key(&(0x7f00000000c0)='syzkaller\x00', &(0x7f00000001c0)={'syz', 0x0}, 0x0, 0x0, r4)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, r0)
r5 = add_key(&(0x7f0000000100)='dns_resolver\x00', &(0x7f0000000000)={'syz', 0x3, 0x2}, &(0x7f0000000200)="1d1ad732d4eb7f3652ee46e39383af62cce15cf21979c899ae544810538e8b8e82f71c6cc5cd03d1d6719772b7ec6aa7dd0a02e8818a9f497dcf34efd463e8858f6c14f7a25ee85f034f37971b19d8a8aa6eeefc5fc2bbe3fd30759a918117bd91e0a60d2b4cf9d51f2600", 0x6b, r0)
keyctl$describe(0x6, r5, &(0x7f0000000040)=""/97, 0x61)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$reject(0x14, 0x0, 0x60ffffffffff, 0x201, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d69c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da9fbd44a245eb183fb12f90ab9540548d09e1120e5f5ff85d153a7e9cc95a31840f551842e58dd84624df1dc622d15ed9ae3033f93995b34e6dfe7648f98847c2cc5aeecae598834935677eb44fabaa9c6b11364018c498cb7aa369dbcb6b635ad5d7970114173209d9ac8cfee1d53051b39123c675c829236d3b", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000240)={r1, 0x3b, 0x35}, &(0x7f0000000480)={'enc=', 'pkcs1', ' hash=', {'nhpoly1305-sse2\x00'}}, &(0x7f0000000280)="b1d03a52c1c26c540d5d0f76bb64b2557bd57d0a3a040e33d3abd4280e85bd1d47a3d2d27824098d1159a1f4052868b84cc099a9de2b34ed4cfc7f", &(0x7f0000000500)=""/53)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$instantiate(0xc, r0, &(0x7f0000000000)=@encrypted_update={'update ', 'default', 0x20, 'user:', ':vmnet0mime_type'}, 0x25, 0xffffffffffffffff)
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000002c0)='\x00 ', 0x4, 0xffffffffffffffff)

19:20:26 executing program 2:
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffc)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffa)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$read(0xb, r2, 0x0, 0x5b)

19:20:26 executing program 1:
r0 = add_key(&(0x7f0000000080)='asymmetric\x00', 0x0, &(0x7f0000000000)="100710000494020037", 0x9, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000100)={r1, 0x1000, 0x17}, &(0x7f0000000140)={'enc=', 'raw', ' hash=', {'sha512-generic\x00'}}, &(0x7f00000001c0)="f78bdfea1888247048e5d80d3e02ad1518065751c05ffdf4108abdbf91bed92c0f6f9c25231f0b63666a35eb152a111f629fdd6289df642b718b430466e3fb87aae12ee6cc3f8556beba783cffcfe0e163cdc71c0c954b1679e0c9cac7d7de5eb3469b5c9abfa05e690cd5d453791e87300f7384c2e0675ba17ad1ed5898c68f5e40cf6f9ac848b6f272fcbf33f3471c200f7626988343d1496665b478e685d1794759356303c30da5a233dbb08074a62227f96e82c21ae0c53096aaa05b244504020d6b266adb12a02c54bde2e99d83fb288872d022d75acb2497510123d1b1a6ae822ee32dd41d00ac7b0f4982c133855a798b6733f5b3930e9e7537074b977f39eff9781553cba9aa49634a0a431ac144a9097930f2d551732a859b4a26ac19d7e1478fb4160952bdceb46a5e83143d98622a5a8bc5baba4a21d03c60e17e03d0107c3d623e611af1ed2d275c0f8e65e18041b126ccb29a3a3b19037652666f12b817ff337e8d40b4a5de7647cbaa9a714ee3cca868fdd314564ab4b2b03914b1dc00c70b1ca6169f88824b9a4f871752ff31eab0bd26952d97563fcf2ed175a357edc68455c5de631f24f9e2187a9b96acaba23a0da20ede12426f55b89e0bc53eca04c99e53bc12c04841614c9b553fa2bf2b21888b5b1d46e528d1b1f6188edc1350968b70022d9349c65e71e5c2de99775fe4fb251c85cfdb93fde0a797ed3d9cd479ac95cb44ce3a22b6ab2029ae34347466d10ee280bf771de837a03d2a399731f57599593904c262efe3e3f942c1a3fc5193f9813296a4a46ae92c1eda8a92beac26c9ccb911c3250edf1c3b674b8d3842152f104183a20dedbc071a44cb99cad59714977347791bb08b6b6cc7647876fc288e18fe74369d5073da1a36967103d70ccf6708ff6c74c5d212d8f21465e02c368e3159a3ee654621fa694639cc706f077be10d6a97251fb0929f3dbf6482129bcfa6a82ee7fcd741cbc037f3476b429877afe3b265bb8edce9ad7e4a00aa6b2540ce8e0019e007f0aadb25af3c8773d77bfd57dd79d86fedd1068fb575979467d4d668e10b2f4c30eb2d1c14fd7a22f1a1c74f607f5b07a402cf905bc05fee5a72c561ee6e9547fcaf2337195a9e4f79723a363da160bb6c32c8c59c0ab9095040bef08b06e633a089917c70a5d1d16e94a5fc41e026669d6f879865f1c6b35fbad86b2e48cb71a55f552b60c3a28c0ebed95aa4cdad50077e4bc34d44c9bcabe888c1f8e2c4425da4424d0ff42d8d067a4be6b2de952164b1727d61f1fcc891c61989d83ccd5644d6e2e86e51c81e8e517f1f87cb4b75d487dbea87eaf33c21a1b51c276d0e788520a45854bf9800a0db834c87a42ec782db3d0f1bbfefd3406c8c052e66186bc7f19a897e110bc7123be056104bb4308f08fddb5699ed449a6ca895ad1c49074163745d7c7bf9ec594638f68cdbee47c6cb81d9c7b63788c5ff7fd991d0d514a6afc80d5b5f89fe42168586a92fd0e1e251efc5f6457b27dbd48f801b657311b284c0a5d9eda14479526e51395164581963682af3cf89ccf68a1974d7d4de070d355cc5353a6b73492afea6a551ff7691cf0d8a5fd42a749af03e99d1c1b6e4f144a9855a7f3a3f5604228d845bd2a72656e704f10b45c18687ace28a57487f4e838cfd0f209d23915e802a4dfe4aac73803d2d75a694dd4d9f9203c294b8087ceecba68352c08a51b815fc96431d99e3f1e809d0cbbbc08fb8daf88324f4a2a29c12d4801e97fba3a8748b71a22cea7e9fe3afef5f3e4255439583447691d62af84f37a7c608f4bf7c7a132dd33bfa99e0a034c1fe8e94bb00ee66dd89b22f138603752033f8d0ff74e3313f4d5eb1fd542e120d05cbaf3f10a485a08a37c18cbe769e027eb953a2d92b6cfaf4d560e3b813761a7081081950ba505d699d9443467f7c286ef27a6dbeda7af433dc820addc5b7859429c5e50f8ced153a99fb26b40627e5fe24a3e6d4277b3b327d2217ba0a469013888a8014f5ad936b8e7231b7d358a9c2dcb4552c84eec2b1bde6eed61cf2eed6d4fddd6ac9af73186ff00bc9ab9ef11832a29c27f936d06fe4bf87c8b219ea4d0f6c72da7a0ddf5b867a3e253ff7fdfe58c13adb9f8dd718465953141a73c57de629c2bc314dc83ef971c061885100b87dcc93d5631c4e90eb665d05e2d7219b032a967599a1803b4bc11b3e39f5f459fe2e703f4c750b0b50350b50961e351007393c8c7a119857b925a298dead2419cdddea1f67b5d054bbc7c98999cc37f0c353c04b6fd98944fb16c3581590f1145ddb4f5246472b4cb16360c520473260f6b77aed976c4bc9488231d3ea20170f936cdc6a95351ce51c7b4d157afd6d60250077765543e1ae442fa7d85fe334315802ddee662efef8c3a8d599e2c627328ed33f6fa15cc2a0b9ca1b4b9b512c59491d28dc106e01738e01bf19530a721b8dcd92dac1cbf88754d604314e0c98248d65709567ff69b102acd1252a300343c0df49e7bd2ae41f9895dddf112a9463a0788743e77e4b13eb6cf1fe8efef89495cb6c26d825b10798685528ab6629e22555e3ab7130e59dd52eb3034709c0af1a8de74a38cf9a00aef2d21d25163ccd0caae1b117ecb4c54237c58647cd0c635b22217fa2ac2b622ae5c018c0419340e483d03b5e9cacc53e95f7638dd78e80a819db3eb924d1de7bc4ea633b417a2b30f62c5e1ed7b9a97b46d660e6f826e2bed27d81ef35c054a6a83ac3b37d7c26b4c7d9a3e35037b60f27e7bb4e7a53b63a7253983ec4989b8c07ef54160a351aadfc9119ea95909e23c3a8e10321e6561f2e2cb4c926a99a6eb4b6c641380897be73a2ba56fdfd75a96c900e77de2021af0d7a6542fa6af7233463a57dd3f3e0f7150bced580dba106876bf9d1000068607ee250f35b96bb03f6359c9c7f162a3732f3655da99596c62031074196b4384e982f5eb9518b6b181354f3fb45081871556986d70fe8e1590107ec91ea9423f6cf6713fee02bad3602984ed748868a30eff8849cf13c17c887eba3efe2dc976a7bf869ddded7f78659d3305881318dae195928b3c430211386158082705181656d82a770b72e72cf1edeb50d0a11f3bfa9f1e436c08a7b1c7032d490eb6d3f7a7512487c6c9433cdd27ffd4b408eb09189c599e0691049ffedcc0f9c496a2cd227e92985355fd821559792021a3179c2fb99c2eae60bc616bbca30c3ae992d9735eaf7fd38ac42a55044eff1ab0f78248cfbe19440f22da0f9cd466ba50582b33685ac2b9821956c22d2074afe5a4986885bf3bff4ce25bcc21088a60f9ba3f8ca0db5315530ea6cca517f14daba419ebf2d965d22028d17ea397e24fe88c8f7bb3c26b0bc2f807636e11916254d359b7d124e914af3161a2701274ccfdc1c569c15d0aa4df8d57f1eb0960919c501ed4e266a99c27cac263a5d1b3a19304b1a956491f74ec5de14e5a43a97be3e5e2c461e9a93257d70a995a42682196d6c16e12994906122b461dc89f315242c51c34ab070e42831d3c8c4360cd4d9c037ca6dc77ebeb1488c0eea51085117759b22fe8508003fdfda1ef8b57d8a29fcf04c3f7c89f8aa3bb26e507f7ead40d54df470d9cd4835efbb698c0c936a44624aeb77243aa52ddc7f348f4ee451a1bfb27e45506f42bb3744581504d52830547978b23c2419698e3dd9728851c0afa659179a8464b22fcbda56fcd8c85e34fc6a4e19256f91c71a26c27b8fb65117df80de038912a78c5e3607e130b31a178daeb37ece05aa2805f60d4fc49da763fa144e490173793fe4bff5b026f12cbe52139a1cace0bb252d95c07b2d58604331a2a0841c3ba1e02f1edf1cd235252be1342d935a1d7abfd2b37342e37b6e09a39d5c0e65c686cc79eb3c4c7f79d6f2bc96cdbbb48d4fbc20b82c9cf58f8e06666f5023967b43eed25b12246ad378a399da08a5a6f6c02eb2aef9fdadc2889c1dbc993d23b24982265723a12410691a804fc207b95539dc68bc8ee98a57d3f8f5f3d4b01105a4b577dc6c019fea2dbccd91da686ed6a5a1945899f0a707ef59a917751175270b252fa5f9a4a34cff59dc3d8f0292819c5e71702a9becc9746ead20f74afabab083f5ba1f90c1fb5c579993b663afb5aac921cb58dae87ab1746013370f728efa784ec2b91dd76aac4207f2de5bff33c8aa29508947303acce7fff0d3c7b30903bdb34480f9f95157e90b295dddaacdf8d060a555c135e95a73607db240e1ec676ed5eddb7469304b4b25f93a71de0f147fa2f809ece389929bf4a9e4f4254d4fcc6947f28ab72fa9be528105b4b48eca08cce741b75f0291b701c5212740391b3d9f5b439d2430dbf608339dc3d2b4146c378733ac953a34956c439a73789e7e6aaf3181c5f65f31942fbf619c2ecfb6ec4186c6be09f002a257f0905f716e15847cb3504f6d3230ec49f556f19b6dd146d89ef57922518dd4a7d1ae68cfdab68c19dafd362e560ed6b898981b859fe78d032a4a6e74139d1c0917d807d3f270e10d7ae05daf11ab06eed9c673348bf888b62834426f9819529b1f8c62bfb16294847f4d62108e6fc9524e09f83744d11de475c010b04b68376aea2ce7f0525a5606688786744f00e82114fc81468c146d64e33c9f121093465f73433be4584ff83e98a930de1047e4af8ec691d4e1727d6129c220e21872da61f20521f0556ef927ac0313ec852d73eb2f587b44bbf9eef1139e271992397f946542028959818d5774d3b3256b2cf12c39ff4e00c75b9e22dcce7655846597037fe3f81772bd894854aa319182949b7d60953656319dc73375b1fd11f5ce4da8e3337aa4e5f0f79dfb401a898b6b0d246ad868bd08b61f48a8c4888e014f04ca8c48a92029555e69702cea59a2cf6aaee48046dd7893053aa76a87649f6b551e64eb3b9b3fb1282db0ccd88f6ff2f6902b211ee45c10d305af1a3a2c84fc1ce9499904b3e8c8c6d80405810b0ca301ca214ddc9c9a1b7b215f436f0026c461fb58236e0f4005622f1e01140abe529a383ecf426fad037948c8dfd96babf846d582567a9ad79f25c1e122bc713a027e04bfd0b0efe826cf9f7d6d39fd46f88ef19d6f3a67ac29cedbcc88075765de5e78ced720129dd823866161b63cb807209a112d259c5093c4e5156686a6fe43b71908349786e17a8970890b0a33233995609e87d670716f3d237612d52dedebd78145a6062eb951287fd1a7d555be21d850bedd51063c736650ca6dbae7bf967ec42c287778d71696e4302e35da5b45275a3e44f2b5f3fd0fb88af6d8ba958bb54b745686a86c868ac62329ee291c4499c73f93f0f99be829ae03e649903b5bb4b581651ea39a75cbf123727995a828ad19a22821ce0d7c29f602bdf280ac2db23ac2cc57fa08c8bb8a646070ac2411eeb9c5a18ff4d14287f9962aef68da744a95df7b8dbe6cf5839b81f1d308da716c6831a6c002493f2d382603e288fd2e19a3ed1fb5c67c1a8eb2176c9a18ebab3ed2bc0abc79629516bb309140c6839cb6af61a202060ecdf5eea835499e19d9a4aa1f2a24edf4dba236749df78f619625c5b81acb91695f6050c29e2c67676c803cc348305faf47a89c5284cd4081af4e12500cde1961db96421e40c23f4d5799fea72440e936605eeb8f62c0b86ff6c288f0759a2352ba3085698808cd89e334987feffa6b99642485073eb27a94296804a0a751f9afba31d2728b744be03f2641fd2b8647f8f9df3c1d0dcb1b6513d6919ae9059a6213b7d0618a2192eb", &(0x7f00000011c0)="25fd6797ab30f66b563cefdf9e1aa219dae485eb04a447")

[   14.788394] dns_resolver: Unsupported content type (32)
19:20:26 executing program 3:
r0 = request_key(&(0x7f0000000000)='big_key\x00', &(0x7f0000000900)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
r1 = add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x0}, 0x0, 0x0, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$search(0xa, r1, &(0x7f0000000240)='cifs.spnego\x00', &(0x7f0000000280)={'syz', 0x3}, r1)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$negate(0xd, r1, 0xc3b, r2)
keyctl$instantiate(0xc, r0, &(0x7f0000000480)=@encrypted_update={'update ', 'ecryptfs', 0x20, 'trusted:', '.'}, 0x1a, 0xfffffffffffffffd)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$user(&(0x7f0000001a80)='user\x00', &(0x7f0000000180)={'syz', 0x2, 0xe}, &(0x7f0000000200)="bf", 0x1, r2)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000040)={r1, 0xbf, 0x1000}, &(0x7f0000000080)={'enc=', 'pkcs1', ' hash=', {'sha224-avx2\x00'}}, &(0x7f0000000100)="c4b4a49701b2f7e365fb4ae2097d7b8506356fbf85e770b2c124dc0f1edefe24bdfe12304650bc7f5d2e706440ceb2cf4b74122f3e3fe4002f351e9ff79dc2d73aa2a0b256501d025cafb72b1b10eddead5ca76738a3d2cf9845ade3e8944e2c9f9e6df87ffb295792c21de9252f0bd0d8145c1fc5584a10dc058e0415f32d4b7e5be62c25836f7de35e6501e39aad071c51f885bbe8ecb471086e3c39e4d1cf1986b2764fba09a7c2a92f1b3a42d657e59a87143e18abc064fc30855789eb", &(0x7f0000000680)="c13fc99c0a2737fb3d50c0c508291cd38a6e34fc95c6b3cad525681432f70801bc7694d38b0e9d294fbc7c76371d11c80f3eff97fdc397373d191245661e16834b42d68b144bcfd43cbf6b08fb61f771cd116c11bbccc2a0ca630d0575848be182741418303c093e61f3f9a5fad42c8b4f7d46fcdaff182dd070be444740825044f30e8ad1f0cbc7aff1187b0fb5b96550454d2a3e5de78c62b9d0230de74a5dadbb2c163ce726ea45453e3a7fd51ac658ad5c5d64539e8e499edc5ad1a1b7d3654f0747608afabd7109fa1e47302eec10f15e0fa16d057ecee0ae6eb900cd717b3cf892231c28d654393035fe60e8f9c3c812ce06a7e58e073c56ac403c82d167a6c99ba64350f2c92a2a5b457985a42a5f16c4363425ba2a87511d45ed106b4e5b9550a223918629ed8bd4d2e4d2e74e6268098d5b912c64b0bda2091e130240b32296d88cb8d64fcf52237169438cc3ae6de91cf1cb34c936be56c1bf86601c37225a566ac24827fa31d4ee5b6b2c1ab17d023d0830ece84b56c440e8a473554d8f2cb1c610f87569c076274d03fb1f29d091505c0a6e8d6475613ad46a5efc51f8440ea458316f6c364ca8131dba1d32a39cc8fe0b02f963243c5f3cd32cf79ffe19dcc2810ff28a6d8f2a1d15ca03a38feb488fc0195d68a6bcf682d2ce9f66417b11fd1cbca9eaf19b4d675c75d8b4dfca61bb62d6ba3ccd7f629dff56f242c33c25986902772c6c617d1950dff12dfe14ab8348dff7df1e57a6c3d56cd04fe386421a928abc0e21fe25623f08f00a438105142bffc363d25ca4ec6b845d9d1d72b14f04c0489ff294faeeb99a177fccce573d89e85ca7593d21d83904cc8d4a781053ed08848afbc67fde9211ce5034b8210935976e900e64ccf65d27a2af840810da3180a864c18ee252b1b3b255e58cf049fd4e1288ae27953ed14f3ef6b4e4dd2031472ef96c71c33245376f6963b310d04423947c71acd034f59f2e324bd4d9d23d6cf5f3091e108bc823a93d9bd818f5f0517fb1ceb4d0ac6e5abd122e60dc13576f0a75e4b672afe82314ec9180d9f88a7f757a0efe8397c50a3104ca1cb188a5a81bf8774d557c6457034e9f288fc326b3a153873e0334edb62ef8755e9ea541bae8f1fd6688d5b0e55d2e5e84f44799616a6b7cdbfef2d3ba45e89d669e2eeb7f38f498d0bc8ce52e4c6f6b231a96dd0cfd9f4b33d07dc02141e01a7212a82f531386029fb7a77c6364e35181ac350e1790d6a741b49049e16c64a1d6dbb2905e85f965e0499eddac8a0bb91263a10796306507cbacf654f167d5ecbe18a8204d1d64ab1f91d8cb94fdabdfd0d5a954fa7dec4f2e304992616f92c3ba1ed3196b1dc6505f073b601051ac3489dc09be26b74cb74a06b4ff1e71386a4d9e29ed65ba4027f602d3a88d838da47ebde782e4d480d71f8adc0ee5750c319f24312af9ebacc6b612a051e23dd4a1931abc8a9f0b3f34d78929a85bf601687cea10d2193d0ee2b15c18fff059bde4beee5fbe9f238faef4e95ba3504c9faa70821003424b5c07c9435b68ab6f24b3ff210004a5bc0674fa6ebbe3d77010ac91bc849955386900c84c215cb14f3ff5c5f65b87273231dea9638c134cb34769939c3fbfcb26b2d5cda3f3993aebafe6a7eb06b154c1575609cdb4223b4aa77e6a616862503622fa01b966916b7033a444fba2907cf477a1cdf8cadc97224823ef24c2b1d98479b2cf0dc35a60b2a34be4c4536b87fc2c2b1c56656303c0d6b444630e89668a79da9a9cb868b27457c55a969c7700ed6967bc34d323e6833872819eee2eb0dd41f29b51d0147e4ed8bf42706955bf755d5896eb0840801488a87a6557298092155d4563524c519892d98071db6252ca0cc3b25eca73bc02881ec1d246cfc914074521a3d17eb83cdd1f83690d9079bd595a8a61086599b039416487c7a81f9d3453c977d213e62610383b55e2383ba9c0a803fd39d78baac49e936b381570193098677e1371717b11cc5ddb35a02a37a28ed4bf76aede23891584d5d686ea4859281296b2e36fabb5cb98013f7460ef8156ca7f7a88d24c8ba6b6ed2bf5a303f7165974742e407b73c9d02533da42b02cba676056a5c7c4537a269654b1f180610d74bb3411ed0f79e818e66ba5bacc92448790f1aacf886115de02b6e995649989f994ff6820916309472af3e8ac9d2d7023e4e33183101293de1589d57385c6bc5fd24b19912c48118483237ee0cc4a6064f96271be8a02e078a95f401d92f202c5860657f64aa706dca8542aa34aec26d0fdb2b6f3c46d7d44b593067c2584106d2bb3eaa26d51cd5c211167b45ed20bddf21f2d0ae88e8c234c27fc764a8b71041cfc2a31498f838df32ad73900c72481c22263be1025824f6edf78eb863e6cd12f28221d03d6883785d97c42f0bd5496ce798a54805747871d9a95adcaf04aa3ebdb2bd71241509d11755228d5e1a079e588c1e188e407660fe5ff00f485f95e5af9919176abfa652d48a97349d66ada29de6f5b958de3498149bcdbddc694feee225c1b032ca511809333de0d066781c371978a69b5522e0adccd6c2650fd7de63f43e4275cf757318110d19fb0e313c5354fd967e18d75930d8a085aa6e5fc1c6215e6154f5d7714215f2e87faaf3699a9ecdb2fbc28a5cad70508e53c8778a0123004cc84afeead0b527cd97d1bfb756b34fe2b16cb33b44a92facabc176e303f71c59dc20efefeaf7ac7820d3ed0ce8fb92db9685055d3c2f3ec4046e9c85240daa09b30a9eb5cff583544e1c9ced995c1d357443b0fff2ef81a764486cb68e260b064b9939c6a55d53e6d72f348dcc367d69cb0d5bcd527e66b586d481f8d57f93cf35442e29baf1037a3835ab9d509d7b51a8c30cf3cb333f2cc71e9018c0d4d1a116025e489f5a9ab5c3390137876f4a9a6a9e3933c763736d52360dcf6f1b112fe33857862e51f7d99e0b75ed48b060837a2828eace3729132ac259e47d6235e524ffa73e038c8569b9f2e75edc6319d472a2d602efeb7c4c810f3443602ca7e3e38045399b383a236555f6c5bd29641175f62c578827ed74296dded478efc61473c9a4f57322b5e442a2011d1a1fdfcc87d3ab85d3fcd0dba84d3c5d7258603d4bf44f8a9fe663ed96716e77a08349e0d19745f7e627b7eba544ff482c4372e2525a05c2166e257ec812178eb96ec483ef1dcdfc367cb20cadf76104507f4b0651f3ec8e6ac60e6337def0b41f1150a6175a4b1c2139b967510548ae1f726da8ca2c4b5a8b8f624af2107b87a1661cd7258e8427f1ea2739ca7d67cefa44e06eaf746f5088e9e0d18769d4564b7d23af70599955d61e51303923f1157661d7db43108b0d65556bc689d864e7cb732b8eb36997bbd9d13a51c309d1c974ae135caed3baef461dcc4cb3091b7b5ce8d333391670e306620a9f234d246ac9fb6bd9d0eb6934688531d8826a9a22296686442d4b22e5de13b850529263c73e687124b26f44fdabd6e540769bb6d6fc301b6c0fd650fd0af064b7a61dfb6f9ab0d0023bd08226ad0df55fcd550c560b6c36344f05854a6b360ac1304f051b75c5c890b4defdb8f3e2e4d2d09af44a0fe35ad18b674118bda99a12c1d45414c1b91b13a0b6000b01b49df783fde2e1fa2cb7e1ec7b2c3e3a1d36c6835ec709adbc6c68605f45298555d10e58ff0b340567beab7c0b31b1ceffaf77b60952a9d5ef3c58f3ae834456d9889975d4b141b2f1b370ae40144630a47232d519e125bcad14319111b2370664870d9ad4316928cf388dead8078242b97b2e82b0c87a967e18b66b909c9f44fe4b98aaa92a6d1b3a8ed5f1f9c6376b91a86caaec5f17945f5bab33d4793662637d624349f1403a584cf3d7986224d91813764faadf26f3a423fefc451fec254523da0d9cd3b888fec2560858280a4e8a822ebdac297535d170a9fdf40af86d112a5d73315c1f3b458240745064c1b5c4be8d200ce866a2602096d5dae1e0ff11872094204c04a80ba9fcbaf6ade632b990334c73360f257d1f0a3bf23d32ac6f8bfee89aed806862405b763e5b8b9637527ef5ca035bb3407e10af5889ac87dd52e746a6cd61bb268553b33ebab48e0040e99ebe72c0b4109a7dace99aafd592ef74435091929bd97449b01549a4113dae418af2a33bbe093de7f24a28907c339af288571703f7ba1d891004e672bd963e84bcabcea0cef315c1f67d073b8cd76822350fd41a8abfee1f14db8043079cb5406c250375fe5da4ebc79287a842a564d67f6b263c0fc6d76d056d38165e2fd4572731f7ada3f4d89331719c909f8063148957de52ebcc15ade520d9e90c15718cffd7088a87ac7a44bfc94e00989b152528e6d3e4a6bdcc207d26c7fce163c92d3e9f9fd6b5881de5cd3d1d4af428096d8858c9417b5ba16e1fb13ca878a730bc4deda653462102f52a63f74f6e8b1a3309ea04034f0e11f977f071374621f024bbaabb8f2ad63a2609b339bc691c07d4d781907cfd6c0286f8c927d4bd0c6962c31a6a3f4f0841e499054ecf09f23c07408636a8937cb4a9e3240bf7801bab410bdb00ecf324131137a3493d5c363fa4696ded71928263b4120ac337d00f0a3d4c163590c7aee18f30c70296b79eaa4024ad9e3c3536db8fb3df14ca61bdc3e79737e5bcaa188d42fda1fc7d0499b88ef0419f12d832cada9d07a9083237fd1df0d86f62b2476759826e574c4c8987c4c6e12742e2c4a041ed11fe2728bc0164dff80dd788caacb8758d02ed32054dd6ca125828d587de163df5376bd58646c719b1ce0f12fbf5af621ab999c99304a3fd9a0cd1a8d87177559f35ad142d083a4ff250b6737fa4e7c469d17058dd429444f7bf639ad4c2f51ca7a96c76094f54481d90c5ea0c763e79360bc434490b41fdb09ac2a18f53b822e480e4f65c6131c153d1e9e9018d54027cd093d4e302f1e7c93ccc037877d64fe257c74dad2fce52ec3ea1923d0000adbcbaa8dabf735d9ddda8d16a4be8a1a47a7b23c455d02542c7d95c35631eddd9ec6f80fe0cb04c4eae4bdd76c7a1ad57e414aa13331e653abee26e05fe04c147943325df9a5a221dc4f2fa2290568c2502b15ee901d9e3f9da67259087a067d464ca30cc9d9280cff6240dae6027b225ad93611d166c6508c1c00c1dae2b1f97da95c6fc48aac01ee804b9cb38a9eac04c03c5bf3b2ff48af624848e131d213093afde482942312123e707744f90121e9c56c2d4120a8133e4de74eba8ba902239f2ad847f66d7ad115f0c118b6a85ffb5de747b74f5493fa403e0f3a4748e2c1a23ff60108f7b2bd55710e80b0af54483a416c5d507ce9ca35857a24d9e718979aeb0e34572075ff3592c1d94b3f8d9d58167b534224667f81cf7d9ac2071a6e3497516005d20ab79707cc8ea1d0201e5e3ffaca94dbc175f8b3f0199d8d950912170e042d787d3183084e079a216dc1adc1334e9d7a6485365baa9142f9743279968ed8351fe9198069c5c7c176436e93f3bfe808529b8b5b2de162bb32554121a97fac5a56ca697d4a83ee878b81730d2c7fee956aba88e5ab70132822c491788504f36ffe6d5b23907492e650a432ecad89a598e22292efb6fc210f8159f217988d811e8c4a38c0da3fcc9cef8955995c833db4670897b2071f8173adc90b95f98177018f2e34c85bcb9651bca2d51c7381c785acf7d7c8bda808cf2df5f25f3fcf418694cb65c16e33c7532bb2932e614ca3299ca14e0b9432883d33d3ed5a9c5a0b0862ff702cabe773d645")
add_key$user(0x0, 0x0, &(0x7f0000000640)='O', 0x1, 0xfffffffffffffffd)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000000)=""/52, 0x34)

19:20:26 executing program 1:
r0 = add_key(&(0x7f00000007c0)='asymmetric\x00', 0x0, &(0x7f0000000840)='[', 0x1, 0xffffffffffffffff)
keyctl$negate(0xd, 0x0, 0x62, r0)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000300)={r0, 0xf, 0xbc}, &(0x7f0000000340)={'enc=', 'raw', ' hash=', {'sm3-ce\x00'}}, &(0x7f0000000580)="6803592a3c026cbf8b7a5caa78aa5e", &(0x7f00000005c0)="7a6e722a0b571c23145e8b6fb0f1b3c8f736cad006cd9a5239cbaf68173f3942bbfe5947bffa368c3c8289ffc48ddb0500c5d592a841d2f65baa0b7f9480c3ca8f41fec635febadfe990c7bc723f648f171ced6b0003b18217beeaa6b60067b5f2c0ebfd0377b50d741a8fa31cf7eff33ce84461fed7cfbe9c8e35e40821dd9db17014c6c3185f309cb71c4e95f027aecd7738278e82f697145ad011e084dcdcf69e7e10cd4d66210039a1d139db98412d2a0898298e0f953857863f")
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000480)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e727584f6af4e1a045c4a61d61390ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffa)
keyctl$search(0xa, r1, &(0x7f0000000000)='.dead\x00', &(0x7f0000000040)={'syz', 0x1}, 0xffffffffffffffff)

19:20:26 executing program 3:
add_key(&(0x7f0000000080)='trusted\x00', 0x0, &(0x7f0000000000)="308253aa", 0x4, 0xfffffffffffffffd)

19:20:26 executing program 1:
keyctl$set_reqkey_keyring(0xe, 0xffffffffffffffff)

19:20:26 executing program 2:
keyctl$setperm(0x1d, 0x0, 0x0)

19:20:26 executing program 0:
add_key(&(0x7f0000000000)='id_resolver\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)="b3585441b9ea7796018cba8686f1e10113a6401b9c2b1e08a5fc386c3a6d2a8376573f124cff681c5c401be4b6dcecda894c67ae43c0f7b49e150a67a2d38aeccc3c804832995c7d90b1968cc2ddb193ad01b9905ea9633a9c05c4a66b262590b64709b887d5757bea72efa766152192ae9c13cd7d98ef996396f1d6f87662cda5e285d3c99cff9d31db33282869f3486f18663881b4217d956c32b209200deab65689e34ebaaa1f1fb18a47f0ed3377493f907c113dfd6965c6dcd300f616ea97be35473f01a209f016bb5e8d81efe999d2194c0f28be70564f51bd07a94210a46db73ecdace9309c2f31d4a153aa609c5c40af3be52fbbb8", 0xf9, 0xfffffffffffffff9)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
keyctl$clear(0x7, r3)

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$get_security(0x11, r0, &(0x7f0000000040)=""/177, 0xb1)
r1 = request_key(&(0x7f0000000000)='pkcs7_test\x00', &(0x7f0000000980)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
keyctl$invalidate(0x15, r1)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000000100)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$negate(0xd, 0x0, 0x3, r3)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f00000000c0)={r0, 0x1000, 0xf9}, 0x0, &(0x7f0000000100)="f2c61b2e22175423cddf948c028a9818b84a9330eead692a3320d851ba8e22cbbfbf3bad79e40aad519bdfb940df55ec2d8966460099fe579144112794d10a470fe8d89fa9587dc439867751e8e3993ab897083b0ef43ed09f69fadb0b67799421c8998cc3102a443bc77312cfdf5717a5d6d4070ca4e9ba3d5ab1997301dad9787aebf8ad321c3d1c30796123cd8b919b542c623757b5a6ab20e32fac6790f313c511719142222b5c3d70c02afca63a200fd94246c1ec75549042cb9448b8e19f35c48ed698e322b872d776068583628d9565f03de13378fa2881f27e7b2255564b760a0041b2e4ca198da3287e2dc4cafc61f6bc1c6b60e61985ca5802618b75af5ee82857e1cea0f5fde17c74cae339b07e3c5f5ce85101dc62216aa68d4db3f751ebe372abecf7bdb713e3bfca3612bed9a12bf2f0802fe2e95237d734dd67d43edd4a7a34a0394133b95cea40093e4028415fa52ccb2f5d3f22548b39f1c25b245fb181bac1f3e08c8c10e23489350e36cd7737eee5b4d1f7ee541b3cd2bfd58a1fa7cc4385cc79e0b2d72163957fd607f6bdec1575342a0dc7e6c1985869d49170c3d3fe830e6e06701d0797897bce9cfd09c3f42ec14e9db5c8d379e0e8c6302eab6e7e25e9a140596cbae110a80b11202bc76d1ee76b40c3ce7646cd5a89f59a065c3a9956315c8192d5a299cd59137760eb15a45fcb4710b9a3bb20be019ad58faabd34a6216a8adfa43a57683183a5df009e35ceac5abeef85f917ee5e8cff50640dc10400b0222763231c299b710c2fbf50b0a178b02907ebcedc181b555e477a3de029c289efa2aacdab20b6cf2da2dc383aa15a83234ec28432cf5a6e4a58b3c9faabc4e941adeda3f13c568b120d1baceee1cc31471a32aef44971bcb0b282e43f80948a37ceaa08695b251b8bb9a524d5cadea07484e269727e5876b14f3ab04ffbab7cf5ab7ffc51f0720fa06501a49ded084a11d7979cb951155a600d34082ff635606d941feb1fb7bdce3cd39528bc809a3bb35b46945a8a9403be5347058a4f60cc64905908e22186eb2df2bb03e5b93a6109e922c8b55fdecaa4ba831672e1d08b720d5fdedc2f9744e0967c2012c4e9edffd29885d98c2dc05a3ec32357a7a622604372e886ad534fcae184dc07ea85f22f9d4ab97a68a0a5714de2a41bca2e1bd9a834af98d97a11127bb3db23f9ae8de1f20336425b7e9ef78483abd9309e3cff9819a6bde24d96cea64005cad60de554e83b3a56e98e416f85b807a4ab99e01407e569c0b22312e7a2a202142269e6c20f0287703d99036605ed465d16fd97fd5ec5eba7b3a699d5567c05e0ac3bced180e571beac14d2c12120c3987d7a945af40b20d2c788e2d298fb1abd01ed23b589d1f2abf441dd7508161af535604d12d5bedb1330928bc0ab68bd39b55d28b22629b172b6b3f7af01f03f1154bfaa7f1080ab4483fcdcd468afb2d8c07f855445863fc7a25fc6f04e15a209b405425abab4a82ee59d4deb21abe10ac2e869f0d78940420fa3ed55271c1d3339460785043fe386d37c18065c628603e6123ed47d63546e9a7450a1bc39e7814564386c862c5b9e74df237ef722b879858a5c2b859130941c6f4de732b4020aca87300db80c5864f15a9a702fd568a81d5cc2e7ffd5c182dc08815a62e0822bd6ab59896ddcada8270dc6a5433e28e7b79921e6c0e3f8bb0222f0f2892076b0a5967c7cbe23d6ae143827dfdcce0ea464aec1af8da3ff6943833894557d3a9b518c25f160923a4dd10fcd961b2cece5d3d6d5d1f53e315a6ba743dafa5cb8b8e53153d332227aa1e4c5535cb0a68d2c199fd18116ad39fc59de5ce90970dea80e21ec1a7431a6f684719c998577d223a4efb89ea04e0e33c3e85ca0332736316a8e4cfa4ae06c62c9fbd0df102a01d76d9b50f0a7cdf543659e21d38a73d467d472844b345c408306de54e61edc4bac6a33640a050b06e7cc343961411a79601fa8eba09e6d18dee86b3a2f6b0fbcec90bdb6cd577186c00597cce753d3f132d638366a1caf6e9afdee1afc0d3e037cda638c4c8da31f0826c5044b29ee175886f499b9ff66a1db0998f097338eea4dbe8bea65b7f97ac03c56a7ac97e373ba3d44c3c994f763b28d566bdb3657915c05384e35f4e80278e7d476d284618a02e26ad33396e0e6e400057c9a56003c64f4b402d3b8a3e127b6b786757d743e0aa7aef9c58c377f01853cb1f5e5232ee09631d775eb66dc9a3861e7a5b0a06c0784f2028d5c7c623fc54ea90809f061eb8e92407223fc522215c0aad1d0503b5696171a60715211793f427389823c4c95e659c7cad27423e3e3cccea3fcc0e6ffb1ad8d1ebead3aeb8519205b0d23243c488999c22adfb02881d6c1614b8942f6339742bb0d3bf85a3c1d9e294adad7d744150db3ce701d090e4d90d735f4c049e012d01378e84293e74943fb6de2689de3e2201e4b30fbbe4a5680224b3598b5d5ee99a2710f5e6b1bd6c7d782008b9017002bc39f567940bb0eb0cdbbb98367085ec1bb12a1902985ae79b911ad49429c045194178f9ce806f1f705bacdb1e2fb7130c1f78f52f560de9663448b18a2b9695e87688ca1c384bdd1067220be7f6cbc23370725b3adaa05f802d19c8540de59c3f7cc8dd6cee60929a464c1a9461ce16673959e9d37e8691d5b785d7d55f56798300eab4f6b579c2b7cfa61e55ab7d3733bfb786ba8547f66541bcee38aef6a4b2e6dcde1fdd4e1ba538243548fca9583e3a29641792352b6d18c4d60b0918387ea89027e5df85ef0289c1e41ab4ac96142100ef423e76334aeb481a12b7c441dd51e7fd00ec821ab8516e7428845cf83bf8c630ee32a8586eb31082129738cbcf114f8d06303e8be1aaa733362c94d6b48720ef1762ed60bbd0cbf355dcb95ab4f5e31aab6ef89f9a3a82806cf3635bd51fab86aa581f6892a94a51b706de5d6e8ba71508e4c078a2e46b74656e77d32f27ecc3f2e19f099085e037dc4b8baf1171f0a9e9b8220d87c645c9f68aab18d5ad8b371d7d363a380a5a1269dfb1eb51f1676c554ee6fde9acfb6682404ef2d25678dacd5a80991119f28417b8b8e495fa1d812a3093c2417f588d6677cf1f8a8aacf0ca74c7eeac344e32ee3220b08a6dff5b85739ce248622c7a3f7c8abe4f93d9a7bbe9f6be77364e9b42805119333b633f1d8f0b607306f9a8052d80963dc83596a5527e87cb8a83a238b11de91ad9e3c8b90b9ebe7d27574fe55c0b648c92c0c520d81a11108f4824b7777d60139b8901700c4bfad41b2cc0816709ca82337a0c592003385678510c6e9b256540881f577b5fc0118d5602d5bf15e068847f818dd6b6513de0d2fd2475d571341d148f80dfa3cc9bd55c1e26b85237a7603b9b0342449fbdae929ad9e3b6dfc45a4e9749c78c9cb685e4e5683210f2cdfadae686c253285d22225e859228d627696b208503193790f03315ea8ad38afc550855586bda9023ff6b37bc8b4c040e8c435819ef2b075224e84ed2a4ac5887e9d447d2da1c0562a9ce39f1d995f61dcf2a48d06d35acbe8e2d44a436bfb794c8eac22dc4657560b23ff52256fbc2437d0a964563f37e13cfffbfdcaee2094c23444e0b5afe26fbd731fd5248fd848a0d1ccab6a4b6b72caae27362e9541d8191148adb3ff63f86d61c253f7845b8d71c6a207af8db4abb89b4fc7990cb83515e16c90d8a13a82ed4add8156ce7e1af79c3fc87ce154232d8981623410aac25bb4e0396f3cd14787c914f63f361acec9d435646624ad429f8212307dd4712a4d405d54191d6e52f6fd0469c6f007e5149a1ffff7b82dbdb418da6c3f409fbf54f563f2376a212c816e07af2360672ac6e55b23f008dd827ea35353e473664e9bc178a759725554f5c8efab8b25697ba795130ad11c109ff1fa534bc321888d8744805062aedcecdd880a15c6cff944d8ee66bfc6e6827c6d01abd5baa261b4cce2a0b50ba2bd21a580e229e1ecfa283aa12afd37ef7e07f5df3bc3cdec3bbd41de6c48690ab753e52e97db5f33a7d40cd0453a85a3b66b29dcfc43a6d08ebe69f51f0d5dd676306361d67353aaeb4ae3b41ef721928c225562bedbd71685c6e424a892d6fd82652c220bccdaabe7abfc1344f73933fb7e883a961d0db0d3c2f20175faf6675733a92493d8192f2bc633ce35d409151f8727562a5f5b25f78f2d0cb3fc6a5dcb0ccbe3ea21c99753e0919dee70ed7333df814250723446dade2e809690473904b86ba851f18f516facf28535141f223dbeb2431e73cc9a52492856fe802f04a1e3c217e3ac6d5083ff233a4dd082f527ecef0fe6b2c3fe7ebf955e43ec7c6fe8c173217d738a7be2497902643ea7bc18df702a6e0d74a77478c67f1e579ef846a8a3d97e585c2c4e18afe56b721bc4d59f35b979db475aadf362b9f22180ddfac18e282f21b262f4c58e125a764c94b8b22f5e5ea061733ead7f2794d4a7040249957438e26baf5f2697b0d013dd416f4c1453593a621b8400bd44c1f8f69d2b68e04b8e8da2683d458994092488aa1210cff8ec2ce4d26541a89f5f0e7543980dd104d8802ed940ef2c6dd52fddbf81f9964c451f317359ae9572d75dadbebbbba9963990a94e14a4b363e4fdb4f57ca33a7dd8cfc6017cbcec4fd94f328d7433bbb6ade564d38066e34755f6385dc256fb9c8322ec0d10d7f4872c843aa322a85af7be0a132a2845a5f18133f55af26665c67561e7f0c97e0bf1a9bdb0fd100da75fd5fa33de221b0eda89f073af9837a3f6244279e5bad55d3036ce20f7b0b32740cf3faa419f86e2c979b807035a68c33afeeac41417c1a82fc7661909b65d3312883f8c5b9c794eaa24ccc3250bf829d03806cfa76da00404f83a1d9495557bab2fb86d0aef91d0027f469cac095445dc8e345d3026a73aa9a266fbfedb7672a66b3fd6cf1d48f5c69680a10266ed7090e0af97b3a02513d5ffab2d6024ad1ca11920cb191f55c2d9691191a83c44f63fb346407c1106a5285ddb640c2925c7ce56f2fef1c7af8b2224e26451159b89e616090a5b63ad739644c05304698d39e6be4cb93feea275e3f81af86e83a4ebab6af250ee0956c53b81c96df9125d0fb7b804b3569dbc034006c8dfedbcc351c6d3a29585274b710c5ab9f415925a4e86a29293fce4dd0fab01b8c348e3a0c20ef3923e280035e425b6f528efc5cd8a40ae8866a75e91c30c6d6f2231e92687a220fde701d462f96d01c2c50acdaed1a72995331dbf1c866f7614fef334ca0ff48676131bfe514ac323ff23966e987d74fe419752f6b5b9951feffbb3b00bd5d047cdb3157d9d708a9a3e84a34cfb62a9724b5ef6d938d5e3e8dded9dad380175dc7c3b4f19dc9a83d260afbd111d8f84cd55af7ec29a9bae4de586761df91eb3fa3bc56332704eeb319a26fd5fe7a0616644e34b4a901a49c5227fd4fdffd97f06efc013ee83144c41a5d8b32a2c3a253c13416592bcbaaa3836bfe99c4ddbe8867e052f13890cdd8f38565421777affab377615ec0a93c6029217b66b8df7d1a98f9fa4d4d9653c303b5ce6f13e97801806bd666ea6276559ab501a562b94ffa29579302569836cc91e6d333f91865c9c53db091de23d825e75715d4170a5f6e9a27aedf31d4dbd3e970baea65b0adf3431b8b3a1e01bc47b2b037eff32d27b5fc255ae139ee581fb38f8b111e41e5d10d429508fcb4894565d63909b75cc9baf42f2cb97dd3cce1e057182f228e4302d4a862ae1eadf19c96e0cb8", &(0x7f0000001100)="1db82a86d625fc433e1549e461ed8f9f8af3d10be3ac2836e56bd29c8ceacf778010fef783705e651af5f382a3811aa1f39fd109df69b05d7e5dd24e15f8206cee6c7d90536b38e517859c43e80f641c32da8570cdde9fac31c0f48a6bf0ab5d9008b692d9c35fa1d78656978144a574b51e63cf8e464abc5d5628aadf8addea027368f4c6bd34e1a92fc7a4637865e24c0355ec16ec29a98934a90c29f6905859fe31d903558fef973c528a03b890f748887c9f5ecb02c84e7601e0ef4f686afd71725ab8e88505d1b9a41ac94b89728004c569b340d6ab52f11e6ae2d898863e5bf7d5fdb3883949571b68303e6d1cf630e260b2e81e4db3")
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000080)='encrypted\x00', 0x0)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r0}, &(0x7f0000000740)=ANY=[@ANYBLOB="656e633d72617720686173683d7368613232342d7373736533000000000000000000000000e7ffffff000000000000000000000000000000000000000000000000000000000000000000000000f550686f668ce20079b2d84713e4f49500"], 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r1}, &(0x7f00000000c0)=ANY=[@ANYBLOB="656e633d72617720686173683d613232342d737373653300000000000000000000000000298a4a0d29595abb98f6279400"/75], 0x0, 0x0)
r2 = add_key(&(0x7f0000000140)='.dead\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f0000000380)="c3543993f40dd2514632455d209a097a1a0edd08e790ffc9c6c4a7ef210ebeab632904be1875c8ead727775629e2f664662f57c3e85275b895c45070b322a45cd794cdf381b11d4d33d75679e9e40d5640c459fa0af8dbbae3237d011a74e7def839a548ebf73fb93611f498e89f9d6fda8d46d8df54c8fd271a908b8c7127129f922565216c2bf4457e61d4e52004997c491d871b84e217874a49ce9ffa91eaae8fed4651d1a8615b2993a00bba364406dadda7a396a39c130f87459f0541d0e26976c77b7dbc27b4f22e72e1adf5b8bf6a1ad94549d978c7fe9fa8980007dc9b9ccdd64cc95111a416", 0xea, r1)
keyctl$negate(0xd, r0, 0x4ed439bf, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000240)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$setperm(0x5, 0x0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
add_key$user(&(0x7f0000000640)='user\x00', &(0x7f0000000680)={'syz', 0x1}, &(0x7f00000006c0)="9dbb708a00523b8dda85efb2f80677251296e7daedcebbb3c9443dd4494bb58e1f0dc30092da9c23169265c5dd0991c24fc95a7ab6bb2e0c96f175b75220a6e52ebc0d1b1361fdfffff284814a00e13baf28", 0x52, 0x0)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r3}, &(0x7f00000000c0)={'enc=', 'raw', ' hash=', {'sha224-ssse3\x00'}}, 0x0, 0x0)
r4 = add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f00000001c0)={'syz', 0x2}, 0x0, 0x0, r3)
keyctl$join(0x1, &(0x7f0000000500)={'syz', 0x0})
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r4}, &(0x7f00000000c0)=ANY=[@ANYBLOB="656e633d72617720686173683d7368613232342d73737365330000000000000030000000000000000000000000000000000000000040000000000000000000b100000000e46271bcea6c2ea434"], 0x0, 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x1}, &(0x7f00000002c0)="fb3f", 0x2, 0xffffffffffffffff)
r5 = add_key$keyring(&(0x7f0000000540)='keyring\x00', &(0x7f0000000580)={'syz', 0x1}, 0x0, 0x0, 0x0)
add_key$keyring(&(0x7f00000005c0)='keyring\x00', &(0x7f0000000600)={'syz', 0x3}, 0x0, 0x0, r3)
add_key(&(0x7f0000000300)='syzkaller\x00', &(0x7f0000000480)={'syz', 0x3}, &(0x7f00000004c0)="a1111c0430cc60f4886766af8ce149e657c57e9bfa64ef4f8727a591da47ebc2ffd422d29a2467eeebcd20024f1c2b3b49", 0x31, r5)

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000680)=ANY=[@ANYRES32=r0, @ANYRES64=r0, @ANYBLOB="ae04103140430e44385e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601db223f16f7bb2f6d7820d343e4897a2bec0fd8efff4da785e20f91e08f38f13dc1f25fd315b629ea28516b8c572786b6e20e5a10dfd2ad3ec88972bc100a015de29fd412ee7e0a36a57ee9e413517fbf3cc52af6d3c2667bbe9dca9c524c78a9961fe00"/183, @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000400)='blacklist\x00', &(0x7f0000000640)=@keyring={'key_or_keyring:', r5})
request_key(&(0x7f0000000440)='blacklist\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000580)='\xbe\xd1P\x84\xef\x97\xf7\xe6\xc0\x83\x18\xf6\xce/y\x92', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000000040)={r1, 0x2e, 0x1e}, &(0x7f0000000080)={'enc=', 'oaep', ' hash=', {'md4\x00'}}, &(0x7f0000000100)="06c3c85fe728bba2067a5175eb0392b47a2300280560ad7824eee1f6b0c82d123da46c4946904ed8b32c05cd8f34", &(0x7f0000000140)=""/30)
keyctl$join(0x1, &(0x7f0000000000)={'syz', 0x3})
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/189, 0xb58b8a)

19:20:26 executing program 1:
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r1, 0x0, 0x16}, &(0x7f00000000c0)={'enc=', 'pkcs1', ' hash=', {'sha256-ssse3\x00'}}, &(0x7f0000000140), &(0x7f0000000180)="3efe415f25f068c555d72d6437148d60ec453b07ddcc")

19:20:26 executing program 2:
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r0 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r0, 0x1)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$negate(0xd, 0x0, 0xd539, 0x0)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', r4, ':chain\x00'})

19:20:26 executing program 1:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)="1aa557cce938ff390b98771c7665a9990739ebb6f02290d39ff7412a0fb64473c3f39d7a98b1aa31559f0f89b9c00409b568d4393b58164de74e9b8310f2e36c2822ce788454cf5e21b42c6e3d1492a1fb6a28a667ddf5c53e0475a05f0c2a61b06440518919030ef158a327edd0ae620340bce41a7ccb42ebe339aabcb6f2bfbf31dba9a190a8ed5a46e647212c84efd6e5d0338b658518d1b49d90a2da1b5e2893bdd233f743e40e7c31d715da26b605abcf1f2293deb24f1c608b9ba261a5ddd1901d55f36cc9ee0c5e8ab39043c9ec4b99a2c55c7dc8be717bcd01e35b11d83f2ed5cd6d6272fd61e871acdece7d143f7ab0b0b237d99d98", 0xfa, 0x0)
keyctl$describe(0x6, r0, &(0x7f0000000180)=""/51, 0x33)
keyctl$read(0xb, r0, &(0x7f00000001c0)=""/83, 0x53)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='keyring\x00', 0x0)
keyctl$read(0xb, r0, &(0x7f0000000380)=""/162, 0xa2)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, 0xffffffffffffffff)

19:20:26 executing program 0:
keyctl$reject(0x2, 0x0, 0x22b0b9d3, 0x201, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r1)
keyctl$restrict_keyring(0x1d, r3, &(0x7f0000000080)='id_legacy\x00', 0x0)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/189, 0xb58b8a)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$assume_authority(0x10, r2)
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0)

19:20:26 executing program 1:
r0 = add_key(&(0x7f0000000000)='.request_key_auth\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000080)="849114c90ee68d5faec2812da6571a5d6f3ef1e65808806cc2993721d21f6ce6d8803b5d60ab515ead56af3afe499aebac", 0x31, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000000180)=@chain={'key_or_keyring:', r0, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$set_timeout(0xf, r3, 0x20000000400000)
request_key(&(0x7f00000000c0)='id_resolver\x00', &(0x7f0000000980)={'syz', 0x2}, 0x0, r0)

19:20:26 executing program 1:
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r5, 0x0)

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f00000005c0)=ANY=[@ANYPTR=&(0x7f0000000580)=ANY=[@ANYRES64=r0, @ANYRESOCT, @ANYRES64, @ANYRES32=r2, @ANYRES32, @ANYRES16=r1, @ANYBLOB], @ANYRESOCT=r2, @ANYRES32, @ANYPTR, @ANYPTR64=&(0x7f0000000300)=ANY=[@ANYRES64, @ANYRESHEX=0x0, @ANYRESDEC=0x0]], 0x5, r2)
keyctl$instantiate(0xc, r2, 0x0, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
r3 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000200)='syzkaller\x00', &(0x7f0000000240)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r4, 0x1)
r5 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r4)
keyctl$unlink(0x9, r5, 0xfffffffffffffffd)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='rxrpc_s\x00', &(0x7f0000000300)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='.dead\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
keyctl$reject(0x13, r2, 0xdb8c, 0xff, r5)
keyctl$KEYCTL_MOVE(0x1e, r0, r1, 0x0, 0x0)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000500)='keyring\x00', &(0x7f0000000540)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$instantiate(0xc, 0x0, 0x0, 0x0, r0)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x2}, 0x0, 0x0, r3)
add_key(&(0x7f0000000040)='asymmetric\x00', &(0x7f0000000080)={'syz', 0x2}, &(0x7f00000000c0)="2d21b40d9d12e2cb6d08eccdf6834ec90d7b4e917e8614d5e1d625f97a627331630421eea6df60dda9b078bc2085e08fbf16a468b1ba512eff90fd4860463a63f9", 0x41, r4)
request_key(&(0x7f0000000000)='rxrpc_s\x00', &(0x7f0000000980)={'syz', 0x1}, &(0x7f00000009c0)='cpusetvboxnet1ppp0]-', 0x0)

19:20:26 executing program 1:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/189, 0xb58b8a)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4dacf857e3953e20539afc195bb4c9e493ad12ab84ee80c85524889b2921d07ac507ab5594fcd3e3d917a5ef123deac6a96f1ce82c895433ee408a48d534087e8992acaba913e8a89de7853bbea9558a0eac605fa210253beda818ba84bff37b8b1f0f3c2ad3a682b5cb24b676b59c901af3e8cda2d92624c03c4e6ab02f6b2f896bb169b9196d08d99406ca9cb49e9b17af3261d4a3edcb51eb9b5276c8d2e18e18ec4f89f0000", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$reject(0x13, 0x0, 0x9, 0x200, r0)
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000480)={'syz', 0x2}, 0x0, 0x0, r3)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
keyctl$link(0x8, r1, r0)

19:20:26 executing program 2:
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000080)={'syz', 0x3}, 0x0, 0xfffffffffffffffd)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000880)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d254f92d61c90d5ce292c484203761e86584e74daa367c846f9eceb1cf6a6103926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da8bd286c3372fa7cdec4d54f2a759c8883961e9cfc4ad3337c7ddf6798f718314a2b5bdda825dc3f3355819419b63286b50b1564981561899616e78c468d720559d23ab25330de932062f346653843f5e8df61734c8c62a11150a0e649c8827baf0594cc02498954707379333b5cbb1e43409af1262b6240d99234ce0ba7fd47ad03a1fb24d9b3dc6878e029b4c78037b448b61d474c4bda7dfcadc07836ab947d96b6a82da0ee304b1ec541ad635e25d90e5672e20408f7fc7f85b566e509bbfbf31c8f6c83a3f2b2c98053f57bf05db86e7c054008fa2085ce1fce59cf9f7b0583df85efefa52fabea7e46d0f3022336571", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000340)='big_key\x00', &(0x7f0000000380)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYRES32, @ANYPTR, @ANYPTR64=&(0x7f0000000580)=ANY=[@ANYRES64, @ANYRES64, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x1}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$setperm(0x5, r0, 0x0)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
add_key$user(&(0x7f0000000040)='user\x00', &(0x7f00000000c0)={'syz', 0x1}, &(0x7f0000000100)="8d9e78830af8c64f3eedf48886ccb0b74d6eb35100b4e097c48700a41af2cf922f3ecdf31d8d1824360311fb37a1c13add77a952d02111789a105126a217a311cc0e3d1a573e8712c6798a40968d8b0e2a72bb8784f1a5fa487fb5a4fd902d69f009898bd3db60212f5cfff3e6bfa8003ff615e0a1683874bf027d18faf80855aae1b1e28c2e8774424399e9bf3e16c98b0cbfe40a9760e1696b934c43318d3b8f2bdfb3f65534941e5a9155f26ba82c493e27ccf495f98360f8556c09b9f9843591f0d95a3d28856f1c4a0f389e8d20be8c0401e274b677ffabde4c3fe58c2f17782de56254b814114a005f7460e2b5727d4d83b0925c8d4403", 0xfa, r3)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f00000006c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da3dd0385984a80756f65cb4ae1a8ee0ef70e8bdb6e8f27a6e28d7f0f31a2ad79d105e9ffea55fc08c046d7b112ea2c2327ffe0c0ba8a88642b9538c67a36916a9fe02d558c66732f8f936a16ab18ac92fc8f8a804", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000400)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000440)="66649ea12b560000000000000092283087a5eb7f5de3864b59e7def6e412f1f7181d37600d", 0x25, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='.dead\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r4, @ANYRESOCT=r4, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r4]]], 0x5, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
r5 = add_key$keyring(&(0x7f0000000680)='keyring\x00', &(0x7f00000003c0)={'syz', 0x3}, 0x0, 0x0, r1)
add_key$keyring(&(0x7f00000001c0)='keyring\x00', &(0x7f0000000200)={'syz', 0x2}, 0x0, 0x0, r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000140)='asymmetric\x00', &(0x7f0000000240)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_MOVE(0x1e, r0, 0xfffffffffffffffd, r5, 0x0)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000100)="78396b7cabbe38505b3f9499022619433cb981d58e09b822c349e4abf9bb858ad13a95aece5532f474121586988343d4e41eb6bb3765d9d11149acb50c36111d3612abffb0f47f89c667f1adb590466c65e145fd08b284a233827f601bbe6a91c2a202ed0f68684d070bf2a3be82910f17b88a9e57d084c444e1cec1acd09bf23130ffb999ae93be6d9468352760451dfe46839ab329ab95d870ac52629187cc38c3738edf92169d5bbcf11de95af51d1fbea881176c4b27fad243c574b5", 0xbe, r0)
keyctl$describe(0x6, r1, &(0x7f00000001c0)=""/39, 0x27)
add_key(&(0x7f0000000080)='asymmetric\x00', 0x0, &(0x7f0000000040)="308253aa", 0xfefb, 0xfffffffffffffffd)

19:20:26 executing program 3:
keyctl$session_to_parent(0x12)
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r4, @ANYRESOCT=r4, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r4]]], 0x5, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r4, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r4)
keyctl$read(0xb, r4, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r4)
keyctl$instantiate(0xc, r3, &(0x7f0000000080)=@encrypted_new={'new ', 'default', 0x20, 'trusted:', 'wlan1:', 0x20, 0x60db}, 0x30, r4)
keyctl$read(0xb, r0, &(0x7f0000000280)=""/93, 0x5d)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000480)='keyring\x00', &(0x7f00000004c0)={'syz', 0x3}, 0x0, 0x0, r2)
add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x3}, 0x0, 0x0, r3)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$read(0xb, r4, &(0x7f0000000140)=""/118, 0x76)
add_key(&(0x7f0000000040)='dns_resolver\x00', 0x0, &(0x7f00000000c0)="1081ba880126b773d7fc21888b7a9d29717af4f96a3ff941ff66a0e53f61107b1519736fcc1f03d4765514a224f64710fefb45fbe3aaf86ed148e0ada516b7170c11d4f1e0f5d9c6de4ae27d8e4f09971f", 0x51, 0xffffffffffffffff)

19:20:26 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$negate(0xd, r2, 0x231, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000200)='id_resolver\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='\xfc\xff\xff\xff\xff\xff\xff\xff', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x3}, 0x0, 0x0, r4)
keyctl$describe(0x6, 0x0, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r5, 0x1)
add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x3}, 0x0, 0x0, 0x0)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$search(0xa, r0, &(0x7f00000000c0)='big_key\x00', &(0x7f0000000100)={'syz', 0x3}, r0)

19:20:26 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="7fe5a84bbabc1b04288bb16abbce7ede31a36244c30c20f505aed914fad6f82e11876dc6ed120865bad5a94570ed639cae43bbe53749b95ec71886c939df9a3fcfdee5a425eace72607d98a20c7fcf61252e0b3de72af4c63556e2e2003cd6aa215c5df647af754e2709cfe6b7bd7ca17d49cf38293ffe8e4d02", 0x7a, r1)
keyctl$negate(0xd, r2, 0x5, 0x0)
keyctl$update(0x2, r3, &(0x7f0000000100)="209931eb7e3456e17e7dc38face0073db7b9d8b301cc51ef6d53c323e3f643e158b0fa4f07ea7378ea335ea4c13cfada40bb75343c72122406fa", 0x3a)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/189, 0x6636d0)

19:20:26 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r0)
r2 = request_key(&(0x7f0000000140)='cifs.idmap\x00', &(0x7f0000000180)={'syz', 0x2}, &(0x7f00000001c0)='vboxnet1vboxnet1\x00', 0xfffffffffffffffe)
keyctl$restrict_keyring(0x1d, r2, &(0x7f0000000200)='syzkaller\x00', &(0x7f0000000240)='keyring\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r1)
r4 = add_key(&(0x7f00000000c0)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000100)="9a", 0x1, r3)
keyctl$describe(0x6, r4, 0x0, 0x0)

19:20:26 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$describe(0x6, r1, &(0x7f0000000000)=""/49, 0x31)
keyctl$instantiate_iov(0x14, 0x0, 0x0, 0x0, 0x0)

19:20:26 executing program 0:
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000840), &(0x7f0000000880)={'enc=', 'raw', ' hash=', {'sha1\x00'}}, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x0}, 0x0, 0x0, r0)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000000)={0x0, 0x51, 0xf8}, &(0x7f0000000040)={'enc=', 'raw', ' hash=', {'vmac(khazad-generic)\x00'}}, &(0x7f00000000c0)="2c63fb707fdec77cf9aad53e7a77518074f901adede5d92c39c3619fe0ef5e6e168633a55031a052c0d84830b89cb446979eaa9b04fb36f9274f8d26d24926ae94b80dfbde68c5a0649ed6b583b5aff101", &(0x7f0000000140)="1a8edc1d50a17f137f00f127c8a28bae3079a9d3dea482d34539a6e2b5b96ca476b934fd9cd2d8dfc2c2a9c25a5fe7d61c48cb3069c61ce238fb5b3706a676cce4a98ace636a665483c584da58deeb77a35f273f8b2f737ac03cce92cdce6a2a0740ecb0e042a7d13e4df5e0773e6a5e933a97d2cf531df5d78adc0cb2f40dd098fec666f070216d650006ba95de7c39e882a8c70efc914bb1f72f029dca9270ae32692e73faea56bc8f82aa14821e4bf2b6f3ec7d5f7e9f8fd2136e89bffeeb5df8fed0fb2ee6d2d3fc03a32f2f9fae696125e9a71278d7128c84663563444e1186d280d573449099619c10838660fff4cc9a6346bf27c9")

19:20:26 executing program 2:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
keyctl$reject(0x2, r0, 0x7fffff, 0x8, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x0}, 0x0, 0x0, r5)
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r6, 0x1)
add_key(&(0x7f00000000c0)='blacklist\x00', &(0x7f0000000100)={'syz', 0x0}, &(0x7f0000000140)="ef6e188c728ef6a94ef7061bae8462dc677a43ab2f60582ee2640741dbc11739917f59beb6b1008b63db71215ad8099a57fd70cac6d58cb65f8687c13880097f9bcad004", 0x44, r6)

19:20:27 executing program 0:
add_key(&(0x7f0000000080)='asymmetric\x00', 0x0, &(0x7f0000000040)="308253aa", 0xfefb, 0xfffffffffffffffd)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r1, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0x0, r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r5, 0x1)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$user(&(0x7f0000000140)='user\x00', &(0x7f0000000200)={'syz', 0x2}, &(0x7f0000000540)="697c77110d44126948433b93ce8032a71894e523dd21299d4d155cdb5aea9f3504cadb2dcb082a349de258a6b40e8a8830da878fe9b87d0dda2891400aaecb0fe8b2a7e2cbddeebb9670daa23124701df703d000000000f3a9db91d4dbc05320969033f626dba986bad2ba2cc47b0a08a2505f03f3c0dab7400c26e29781070ffd97a851c46c4d2abe9f1b0e6cb2cb8dd56adb8cb90eb2faf00d702eb0f54b47c2cb01ba1a4ccf4134686d365456251a9b337aca6e0cad96cd120ffa1bfd856d2439d04e266966bb5df9f27861b77fdcabcf208b56f36f15a25ebb249108a411c9650d85c2f3700994731fdd41a912dcc5da27c60d62c2220cdfcf5c97800e8feb3ae207dd54315b551589f16fcc9946a8b5328a8219905c96759052b71ffad4bdc1976ded3b0b74c22210614830ae7735d2cca871dd2135debcbcb03f13570018ec61a6b474162728a7279fc502c141a01dc6f4162a4ca5dfc3106a063409164ccfed36bf6dc122401dd1aa3770c33113f3b86a9315ad93a5c2705a27cb218ee05f4c2769eee3d23f593b7e5fec6bfe1ef3012bae4e921ba3f75393d774894dc6f8e868c7b57aa7e9f469d1cf76900a5d1d54240000000000", 0x1b9, r0)

19:20:27 executing program 1:
keyctl$KEYCTL_PKEY_VERIFY(0x1c, 0x0, 0x0, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$update(0x2, r0, &(0x7f0000000080)="5c1f91bd1d192eb1f33effdd0e21d180fbfaa2d276f7f13233414dfce01c83a1f55f1a64f551a57fab3fa5258f2ed7b4ab645ef31c87b7cd09fb1ba89a0817c4f6871c831ab585ad1a844382ff064c5bc6d5baf8cb7c538ab7dfda7f6729c12c7b1d9f9a2c2a215900bf8b9a3e4fb890aac94cc0dcc49fd453b19d3c1a1fc91a45fcc7fc166ab603d819eca5be483012baff10e295", 0x95)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
keyctl$get_security(0x11, r1, &(0x7f0000000140)=""/64, 0x40)

19:20:27 executing program 2:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000200)={'syz', 0x3}, &(0x7f0000000080)='u', 0x1, 0xfffffffffffffffe)
keyctl$reject(0x2, r0, 0x7fffff, 0x8, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000280)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x0}, 0x0, 0x0, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f00000002c0)='rxrpc\x00', &(0x7f0000000240)=@secondary='builtin_and_secondary_trusted\x00')
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000380)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000340)='.request_key_auth\x00', &(0x7f0000000300)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f0000000440)=@keyring={'key_or_keyring:', r5})
r7 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r6, r7, 0x1)
keyctl$reject(0x13, r4, 0x4, 0xfa75, r6)
r8 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x2}, 0x0, 0x0, r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r6, r8, 0x1)

19:20:27 executing program 3:
add_key(&(0x7f0000000080)='pkcs7_test\x00', 0x0, 0x0, 0x0, 0xfffffffffffffffe)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f0000000600)={'syz', 0x3}, &(0x7f0000000900)="0b0d4014fa849952512239cd0c827a72a1a96bb3b843a026b3e766a75ed4a0725dd631c07eebeeb3b23226e982f08908903f3e205c2fbd92056bf61d7a101433e9929831d6265d85c3e43149b1649d1bb7008917a468e272ce686d11ea21c491f73b5c6a9821227889c87eaa367e25ce67ef9ad4e799b415a2c9dee714869a08b84429256b67bc3c7cdf63f54d57d6feb7104d25416c16b306284cf23431abb6eb4b9dd161cf53fc6f2058b1eef043fc243c184caf324471ec9e8fe0d465243f7aeffa0000000000000000000000000000935ccd78ab861a044a23bf78192bc764810fee53455e1671c00441fa1c4aee64e151066ff3383d3d314654348eff5935d7b6604606ef036f8024087e7dcc88d28e07fb7590c8efef214a501e7fdaa31a9ebfcd60ea73fcc8ba6521b79a5e88b435f613e4f2f08753cd6b1116a8b3b14d201b11977cd981179d816535aa08f993875ec938da5bf63b7cc55cba385ee87e261c5110ff696fd72698175d15f3d9e3e7994fd7a02e2d8b9b434d7f5c64ffc6de3d1c2fc2e1", 0x187, r0)
keyctl$revoke(0x3, r1)
keyctl$update(0x2, r0, &(0x7f0000000240)="a97e8f9698e495aa0c", 0x9)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000180)="b9475b6bcfc68304e441404f7f629ad55edd181fa18a84e73add5e25aea935731ee583dbff515da7d40288aaf8289e7c7b6891e33787c0a72301d322792e7d2c32e4d1ee6c4d2857aea668fe3e3a4acb099eedbf26f36b16aa71b0e95c5f4ea572c3a4820ead40f31e24f57ce05a4c1b5b02924237aa001fd501567677c15630ce6c414037defb22f48a2dc7fceacba229e17b5fda503a0decc2b83c432a5a20efbb1b20ba31385ac3e3f16dba5a3ff78070e3002541454e62903dfbfe00e3c4e8d93bac0c240cefcbfb5c13d5738eeaf90be65e", 0xd4, r3)
keyctl$search(0xa, r4, &(0x7f0000000280)='id_legacy\x00', &(0x7f00000002c0)={'syz', 0x3}, r0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_MOVE(0x1e, r0, r5, 0x0, 0x0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000380)='cifs.spnego\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000340)='logon\x00', &(0x7f00000004c0)={'syz', 0x0}, &(0x7f0000000300)='e$\x80\xf2\x87\xdds\x9e#/\a\x8d\x8cP\x17\x84(+w\xef\xf9/\x05\xd0\x8c\x13\x141\x04Pk\xce\xe97\xc6sO\xca\x02\x99\xba\x97[\x8f\xe1\xd8\xd3\xd9\x03\xc0G\xaf\xef\b5\xbf\xb0\xfd', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$clear(0x7, r2)
keyctl$read(0xb, r0, &(0x7f0000000280)=""/90, 0x5a)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000140)='user\x00', 0x0)

19:20:27 executing program 2:
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000000)=""/102395, 0x18ffb)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
r6 = add_key(&(0x7f0000019180)='keyring\x00', &(0x7f0000019300)={'syz', 0x1}, &(0x7f00000194c0)="456b93036434f62accd66e6801724fdfb38e66cb0c3568469710207b3d53429e75b80a969ed2918c1292f890693a820bd889bf08b4212b29e5490608d8809208d959ab07b708556aa6cecce7a52d5d842718b82d5da56150579cf64cecc3f41a3800e4a30e640bc070c3026696f06f28ec2184a647d6a617c5f6e59b0e4a39957110d21bd60db04a67000b54114bdbe427cc892229b3150468c18412c32ed566281741fb7f1718dae85ee4140595fe66db239a9422bf533870935c053f74842e53d758f2fdebb9e088272a45a4e17def7828acbba9a3469626724c4560da1baeea848cde84030d6bf473ef129b6339bc1a7a311cc2c0379d7c371d0da9bd5fefaa529c0bba4b62c0ca464c795430b0e22c21f0364eb297c8f9732917804338f98f697b8fe098a3407dabbd5c179801b7e7faaf8f32a6dd061c0a25c0c635ba9a00edac7bdca3c156cf6991f3ddccd1254cb33634be87fe73a60c39669705ea8899bbcbf397db8b7eeccaa956e2a004b02173e19c510000000000000000000000ef38b910ce27b712170c8dc90b07a474ab86227de2cdd58213b67640f1", 0x19d, r5)
add_key$user(&(0x7f0000019000)='user\x00', &(0x7f0000019040)={'syz', 0x2}, &(0x7f0000019080)="3981f3f6857dd94a08f131459b0ec3de88d23b592e0a09aeebb6b5f14677499435aa890e1b4bf8992d34e11d54b5daa148146bea337f3e29f8b87ec21ebac34afb13a8f5729ac766b27c82298e371f904c15dca848b69b591d5a12c49c4b1ee87ba98633554114367828af452da05800ed6fda7acc04a647ef786867b0cd20c5795f2f94785f6dd8c63d56539df6cc2fe7ef633928ba5377b1db499e01e56ac8070106c8cf19094d9df5bd3049946109e22a29b2c2a31eb2fd05bd99eb1dcc9bbc118a98b6087c6d69079af941e0c02bea8ded", 0xd3, r6)

19:20:27 executing program 1:
keyctl$instantiate_iov(0x14, 0x0, 0x0, 0x0, 0x0)
keyctl$describe(0x6, 0x0, &(0x7f0000000000), 0x0)

19:20:27 executing program 0:
request_key(&(0x7f0000000080)='encrypted\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f00000004c0)='keyring\x00', &(0x7f0000000500)={'syz', 0x2}, 0x0, 0x0, r0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430ef196e4c39640f9dc7ad7707dd9b742e440bafdc35f37df3568f4e048e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d22d61c90d5ce292c48420376108170000000000009b7df0fa6388e97c5a03a1b5ae820d343e4897a2bec0fd8eff0000", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
request_key(&(0x7f0000000240)='big_key\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f0000000480)='syz', 0xfffffffffffffff8)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$revoke(0x3, r0)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32, @ANYRESOCT, @ANYBLOB="ae24103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c4849bcdda62203761e865d73e03926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4dabfba7a473d4702741b4f357f55a45a0e2c370bcf4cd7608d7b3d4420bf8544c9f6d4fe2a74f95837d3e8fbe41156ff084b28e329d568f6610215d709241af682898211473aa0397cb65b51db73278cc62f0a0ab571053d217620161aaad063ef2f6aa2e0ec2e07fd2e154aa6519b993125b121a081c9af20f295d60e79df9f3a7c6db9aa662d995049b400000000000000", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
keyctl$unlink(0x9, r0, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='asymmetric\x00', 0x0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$invalidate(0x15, r2)

19:20:27 executing program 3:
add_key$keyring(&(0x7f0000000500)='keyring\x00', 0x0, 0x0, 0x0, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e4035e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4daa10d4a30d7e09aea20722eca26777ee01b305abc7facf674f3f060679d690118da3fb0b6562bb459d36b8d0c01407df0dd7aabfc21b55654e4a378ed88e960dbba42d0ba88edd3bb7537c7a5982c9c7656b9bb0d968b41b5a2bd07dec1181a08f2f14c0edc4672fb3facbbc5d20607dbddd140482d5a6a3b6b9eba3e1a62a8bca1047f24bbe40d4350560b51fe4bfca8f038b815b6accbfad0c5d6ee6d82d01227d83b453825d6ce18164b", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
request_key(&(0x7f0000000000)='.dead\x00', &(0x7f0000000080)={'syz', 0x0}, &(0x7f0000000100)='syz', r0)
request_key(&(0x7f0000000040)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0xfffffffffffffffe)
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$restrict_keyring(0x1d, r2, &(0x7f0000000300)='rxrpc\x00', &(0x7f0000000340)='#\x00')

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key(&(0x7f0000000180)='rxrpc\x00', &(0x7f00000001c0)={'syz', 0x3}, &(0x7f0000000200)="7cda39a3eae19636a2b64c55f011eee4eca69b369ea5a5d07dd8b561442846325320f4479951d96b76b19f6608e6e0bdcf240372366a49912bdff2fb2ef7d9015b784597f70f5de0f322b1f904aa26a5d10824116212643664a68177e780f9bfd14ee5b8df7102b5fa67b181d6f262d8a7d973a20733b401fb9ea4f8ae034b15c5", 0x81, 0xfffffffffffffffb)
keyctl$KEYCTL_MOVE(0x1e, r1, r0, r0, 0x0)
keyctl$join(0x1, &(0x7f0000000100)={'syz', 0x2})
request_key(&(0x7f0000000080)='ceph\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000140)='#+\x00', 0xfffffffffffffffd)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$get_keyring_id(0x0, r1, 0x5)
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = request_key(&(0x7f0000000080)='id_legacy\x00', &(0x7f0000000180)={'syz', 0x2}, &(0x7f00000001c0)='vboxnet0userGPL\x00', r2)
request_key(&(0x7f0000000000)='rxrpc_s\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f00000003c0)='\x00\x04\x00\x00iKg\x00B\tfRo\xbek\xcch\x86\x8d\xce;\x95f\xa9Rq\xf9\x1dU\xc7\x01\xbe\xd8:(.\xd3\xa2\xd8+\xde\x18\x8d\xd8\xea\xf4\x18\xea\xe2\xdb~qZ\xb3\x80\xdb\x13-9y\x985\xc6\a\xbf\xa0\x03{\x9ep\v\xcb\xc9\x81\x1f\f\xb0\x00%\xba\xab\x8a\x80\'\x00\x043\xc4\x13\x02\x00\xe3\xa8\x96\xf5K\x97\x13A\xcc\f\xed\xfb`;}i\xfeu\xed\x8f0\xfd\x9d\'x;\x12x\xe5\x1a]\xdc\xa6\xfbH\xc8$\xb7\xc2Yp5\xaaC\x1b\xcb\f\xeb\xff\x00\x9e\xbf\x87(\x8dp24\v=\x1b8\xd6\xfe$}\xa9\xc3rA', r3)

19:20:27 executing program 0:
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/189, 0xb58b8a)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$revoke(0x3, r1)

19:20:27 executing program 3:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)="c2", 0x1, 0xfffffffffffffffe)
keyctl$join(0x1, &(0x7f00000000c0)={'syz', 0x1})
keyctl$setperm(0xb, r0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c9179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da00000000000000000000000000000000c99601c01b745eba101751129c26c1a569616c73571584708912d2dabd9a64cda0a14407229ab878aa0cf1de697a794b6f67602e847cb7681a87976e4007480657c39c3e9637f4cdaee9bab921e0b4a3cf0cfe", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r1)

19:20:27 executing program 2:
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f0000000240)='\x00D\bK', 0x4, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
add_key(&(0x7f0000000140)='blacklist\x00', &(0x7f0000000180)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffb)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$link(0x8, r0, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f00000002c0)='pkcs7_test\x00', &(0x7f0000000300)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000280)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r5, 0x1)
add_key(&(0x7f0000000000)='encrypted\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r5)

19:20:27 executing program 1:
keyctl$set_reqkey_keyring(0xe, 0x7)
request_key(&(0x7f0000000000)='id_legacy\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f00000000c0)='{\x00', 0x0)

[   15.072506] dns_resolver: Unsupported content type (68)
19:20:27 executing program 0:
keyctl$set_reqkey_keyring(0xe, 0x2)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$restrict_keyring(0x1d, r0, &(0x7f00000003c0)='id_resolver\x00', &(0x7f0000000400)='\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000440)='cifs.spnego\x00', &(0x7f0000000580)={'syz', 0x1}, &(0x7f00000005c0)='trusted\x00', r2)
keyctl$negate(0xd, r4, 0x6, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
add_key(&(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r2)

[   15.079702] dns_resolver: Unsupported content type (68)
19:20:27 executing program 3:
request_key(&(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000300)='B', 0x1, 0xffffffffffffffff)
keyctl$setperm(0x5, r0, 0x0)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000080)={r0, 0xd6, 0x9e}, 0x0, &(0x7f00000000c0)="d8d4810a2aac1ea4897afc1665592ad0819056184c357faf0bbe228d7462d5a1a9a8f51422eeb393d5ab984cbdc21e80ed32e89f0babe453a87e1e90d3ef530ffd7107ebcad388de478c53d8d82a935337ce982f0c701c8a1a988a889ec984189c1de0420ec27e544a0a006d77c0699783e7f3583df0dab73c2c3bd7bf512bb1ec41d5353c66218f0e0f938bace888fbe14debc773f6b3cc24fc716696c8eada815c5649ff85a8a5a342f005be2c8a869eb372e4ac6861af150a5046dd405507b6a1eb9c3f2550d9016f82c6506e5db878fc749ab3bf", &(0x7f00000001c0)=""/158)
keyctl$get_security(0x11, r0, 0x0, 0x0)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r0}, &(0x7f00000000c0)={'enc=', 'raw', ' hash=', {'sha224-ssse3\x00'}}, 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$link(0x8, 0x0, r3)

19:20:27 executing program 1:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000800)=ANY=[], 0x0, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='big_key\x00', &(0x7f00000004c0)=@keyring={'key_or_keyring:'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0x3ff, r1)
keyctl$search(0xa, r0, &(0x7f00000000c0)='encrypted\x00', &(0x7f0000000100)={'syz', 0x1}, r1)
r2 = add_key$keyring(&(0x7f0000000280)='keyring\x00', &(0x7f0000000240)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04d23140432e443844226a8c4a57885d1f9c9cef0cb57bffa368132207d9b742e403878997cf80bc034b27bd0fe568abaa4e9b248a140c5f1ddf3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c4842037393d84e7037dc7601d725caad81ca1b500000000edb082d2000420276ee361dae3e621ca7df247343fbedd26f31e1908f16be70fcbcbd0a9a43fa2c9410c0cd49bffb980f8d5439b66406be893332146455299bde72a62c0e4fb5fbb28025c2a3d17ca29ddbcd1f5d4e45cff2b2a99a7daaf04e551e881fc9947babbe79f3e23d36cd554aece541ab7a83f5cb287002ad5d9980f6d51bfcb96346d4cdef0aa43939da60d9181717f15ed7b03e7f65c0ee07b08b3b32af3a970cefad7b3fce871cc1f1e6f1f4a945b38e1e3b7b050b48012ba927f0caa3d7ad8968103e4823376c75090118be35f4f389d8588c09aaf5f1c9ff4f34e5d89785ad28283043bd0d640fb298e1091183c892bd8613b746198331c6be75f765cd9967325901a1eb243b53cb2234d0bb1d30e15f6f821d620003cfd854243e249a05d5a437c8dca6a6b3a416043b82d443e6f9eabea03ec9d909120678f487868be898cadc3114d3f105a1f3353b11dcc5e3c5bf5646e33d1b3b65f508f834f2621e959fd64ebd1348865daf393974e7b754b76c40512038b46467838bff2d6ebc4c7e39f7aba61816abb2a3ebd638985f1d1959545b1327a67f35f4f251f8b832b79a6ac84a2d86442", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000500)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$get_keyring_id(0x0, r2, 0x2)
keyctl$reject(0x2, r0, 0x800006, 0x203, 0x0)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$instantiate_iov(0x14, r1, &(0x7f00000001c0)=[{&(0x7f0000000280)="d658c554b43003d930e1eeaed67a6045b206b3a3c97fb1b0ec676c234d85c340e37237ce5ef37442dd5ed062e42b959a7bc93a000000", 0x36}, {&(0x7f0000000340)="70d4ef0ef662de6a6a6338c5759abe9a56893dc1d90e314a928bf9ffffffbfffffff545abe0cefadf6d936279a68355cd4ab97d7d18301b51c8b0a3cc16671b534452a00000000df0000000000076d21a6e767a3defa3385e97b1809bb113709ccceb58ba1db910f9b2b7c916ba02e8b31f332a9d342e74619430cbe41a02817561795c8e4cc12599e62481bd90b73ab2f186f81f3037378f25edde391b48c1469012d8d576f5e8087f719a86b5e109c499166f025", 0xb5}, {&(0x7f0000000100)="9a19acd92ff9fb4132d48b6333f1468a0fa13e3bc15839334218f04646363dda8fc68a694180ec4c4b165ea3e82d2ec85181642021e22c5d4470b1b0ebff618c023b9a1dd46f6dd71310f9b31bd7cf75e88e03e90f474c09beed7de73dc4df5a9432191834a64cea9fd0b9087babe1815bf677044ed849fef44658e1b653b03c630bd5577f753239d7168edad102da3f50e257d7c450a8407904ede78e6725f5e5e2a63b6c22860393704214f1caa086d07624e8852c4e263c8b67a787", 0xbd}], 0x3, 0x0)
add_key$user(&(0x7f00000002c0)='user\x00', &(0x7f0000000300)={'syz', 0x0}, &(0x7f0000000400)="35c10cd132634332badc9fdaee0de99705bfa93c1c83ff0cb39bc7e818356b6598bc064f69d07315fad5e1618c806aa8efc4d7cd9f486288a5c97984494dee04435e19926afdd6a435f664f304c66d6200a99a19a01880daca570978ac6a2932edcfad741742d3", 0x67, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$restrict_keyring(0x1d, r3, &(0x7f0000000200)='asymmetric\x00', &(0x7f0000000240)='key_or_keyring:')

19:20:27 executing program 3:
add_key(&(0x7f0000000140)='cifs.spnego\x00', 0x0, &(0x7f0000000180)="81b9e09d0977983223712cfa193d2208000000000000d7b2597fdef7b9b3cfccff8247f87fc188b3be8d31780f485c6575ae976b418278573718a9eb26543ee251efad4c3e827ef9", 0x48, 0xffffffffffffffff)
r0 = add_key(&(0x7f0000000040)='syzkaller\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffb)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000000)='user\x00', 0x0)
request_key(&(0x7f0000000100)='id_legacy\x00', &(0x7f0000000200)={'syz', 0x0}, &(0x7f0000000240)='syz', 0xfffffffffffffffb)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000000c0)=""/59, 0x3b)

19:20:27 executing program 0:
r0 = request_key(&(0x7f0000000000)='cifs.spnego\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='keyring\x00', 0xffffffffffffffff)
keyctl$invalidate(0x15, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000140)='rxrpc_s\x00', 0x0)
request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, 0x0)

19:20:27 executing program 3:
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r0 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f0000000080)={'syz', 0x3}, &(0x7f0000000180)="c63d9aab5abc8f4a8087478f8daf6dfaa45c91c7edbb0ef654e2f3eb98270d199d1891b23c87ae0d8d7aea6ed78b62e0ba62ccd94ac41ba6e342c0b65e924483d67d9f134fc2220a40772b41554998c8f784e28ee1e7641ac1dfb3babae06d0262432e82a269cd3cad84859b143900e66d579fd9fde412430af070cf95a930403a2c81edf1746d4316048382e3364d74a051544805c5b7d37f03658f1b2488ad150c3cf7f040a4f8a167581d12dac42b95a2f63c6d7b3db98f3c7ff1445c2465528db6a15a082cf01d4870b3d82f71bec3990116cf98669e9176fecbce18f5c2909e902bc663aed6e5a97eb6abd66ba2bd0db1a901f78b0412f0d27325d17ed47e7854c5169ea79b7adee60d37d905a5ce59c94693e3b871986c4eba86417b91f615c2278fd8959053ab2cf27141ccb05b8e1d50dfc60e4dc1005e96d7383a77eb0aa8a91a9fccd148cedf00dbaf6b46f35944f081ad7a9a07b512df013184375cd3b4321b5a0c92888e2332d0d70714ca7e7ef5153b978d160409fe62ce32bd48e534f09c8e42e47aaf7c28567e1bdf3fab363bed61fc6cc44b67edb231b386e7c7d20d28a2ce2e6cb226d7bb163ec584d411672ef4f85acf54c1d7fd189377fb62a2798466fafe4143fb0d22bd6b6cc1b7026438c549af687580885cc355c5fda6459cfd208714ebd35ca3a5706fdf71122cfa2e155c201ae1cda5e701bf754d3db90e65cc54dfe4f88a4a44e3a4edf94ce309e20949e82062e38ca0af104bce0cfdce59fba6964057c94b252e388f998313a1bdcaa05eccfc938309c8f4d9f58cceab455ff10cc6f735555e6f8a78f5f0cf1a9fc8d8d582199f9775726e32838d059ead10f7fb214e44a08e6e2c2893ed9ba1ee2a5161757b7abc59ddf1a52c5c31ba7dc34924080072e08ac4afec1f15bf7eb4b73426273b65dbbb9a02f25ddfbf86fd0f6b3de4ef8dbc364af9ab0aca56b4f58dbc900e1f6de1b72918a109b357b4d0fc31a5de55f0d611feff00ce9a3ba05d96a904efb21291b753fea59843a4f3d9a60860b3ecf763bea938f61652ef4a61b5f40717506378c82d1d85ebae0a1d3ad30efe8773ffe07fab2c5418447a2689a285e31c64e9cfa66948f77aafee3e110ff967319016bcbc116ed4e4cf23cc66c099370c3e2398641bf0c82e29aed9056ca086084ab33f5a746bb2e7a735cfa3d06403fd996a5b26dd4309f049b6e5b9466353b36826d6707b173d8c4dd3998265818f677009cbe10900223e56152b7a84bba50ca16eebfe268e4d3349ad10808c110b2467974a19c53b9af6c8beda1e80897df4063b418a27e0f54ba1cf403378aa72f2f7ce8eeebb82557ebefd720e0220451f31513db9bf3de32087a96cf0688a47a9e85452a443bc48e6038ad82ea07a24b36bdb680fd3333e51cf7e9255d612cdac1bdaa995722f1fbde86017ed30e360ba3e281e8f07f3a15afd153812322dde52484bfcf9122327b6babdfe8c83a1c72618720b8d11d50aae7d1427035bbf62dcb119728012d66b7a296c20edeed4840b69e1c808d4fa62db5a23ddef618cbb67d5ef9a4019e9b8efa0b59b9cf7b049fb88e3ae3ecbca3d56d45399ee022f84b597f5c68580c6e549891b2d9428fbc1e731bc2ef9199899a651f8d2f51ae388a1a02578b4f20083da02f5f2707198d8025abcf5b9a33d318bc5e35da3f6550b96939db1b3f859648350407c502a73ccc137975cfd1ae316431a5feb9c5f6496c199edab1aaa64694051412630398c93471cc9de16542fdb5da6823e8f63c6a15f1946960312c5901d10567ba2c113f7bc39d711f48e1d39e9149c55a5aac0f1802720e048a7a8fd55b1b1e63543d80c33421e5cfbf813f2c1f25a1a943688907939a9295f8bb76e4d5371edcd0cbb734fd315d81cb908edbd6974cdd5e2f6ecd56ee2aaf62559e610e5775db0fe60132f66b66e466c6d02fc69c73f3e22dbcdade458891787c245ed451264a8e86a6015cb54b1d7f354aab56d5682ed2d6008000ac92049eae2c6c3542bfd3e95a0ebd254df7fec20a4e72b10d198c3d57596716cb5e2d2fdad2e7a41aa9ca406490974bc6a0e2cca36e5b156e9c2e2d2bada3dca037966fd3c226c5845da6f580571372f85ebd2a9f897b3ed61c1b34145b1fadf66e2a452ee26a41b80a0bf18e0baa89a5ad0bde4081031ed5089f44c3406ee8bc8c5cc77e49cf8e686ab58c5f0df23d264d99f858bc884fe1ea24ec08a82f58795c3a0b740faf54cca88ba0f5a3cfb55a2b9fc92c9093ecce6c6c3e0d9678e297daa4b4bd8c6d51d8162feb942b02afd8d71b1eac7b4e4261e8990dddcb35c7a63af81699424bcb96754c2dfe902e520f0e59bed9171c2016c16bf684b46112e3ed5c4ae5fcfd4218d4471c2b26c72e2d3d1f4444cbe21e6311a5fcb5108c1c2ef1f99d6d89388e0ab6e8f731e701e541bf4ae9d3a0302ceda999fd38bffa06982ef8ef2b0806fcd837debdd93a20cf9f8fc93fe97e274652b3af453e0a6115da83aded22dd299a8dfd2334c19470bb6d52086e1837aec877923971424764e464c0ec917488b617169a1b46719f53e85e8c5dfb08d28b658d2220abd5cb179117d7f8404efcb19c5254fdbdb53d29fbe66ab18d0939da1788b5aeb81b1ba5642eba5cbc222e71994488887d6d796a0663b72396985c2da7273270cbeaac2d84addd51959e71c66960c54cd69ea10f67bd75fa8955c561617d4fc8a4b6f633b8e495070535cdec533ef3a237adb9a1a27065a8ecc9b1c3848ef632667ae88db548cc9f74e2b5da49944e118bfdf806f7731368c07d8d5fd4f1fea906b40cc5576de337b71e22848153283820934a0cbf41b5ae3e39c65edc64f71ab4ce694add51a42e775c55a379f626ad0953eb2fbf1dd945a83ba58e26b41a2a7a8e28bb4c199a81d3310febb97241d2ae11d9832b85478d8fffdfae24b344c736e4256bf41fe4ec31cd3fa81fc32427b102e93e1fefd50297c9ca2b87b87d890218c4eb106a00afd06f737b922184a72cc3b5955b013a989d4d254d46a1e3cd4bbddc521692b07e91e057da9601dccedfc9dce953d247d5ba4226b1a84385a1557ecdf988b3f7816e98f51a2e19f8f0be5886bb8dd4846e23a5c9bababfab21afce16ac497d152a66792713abaaaed1d6918d98568c53db4be020f83c222d4bff4723cfbd327b3a0212b958f64a3e2ca7a6d26ec465c7a200ce2a529b52cf1ebcd4f46ce0ac9df0942b271877a0bc1335db8587680a70f873334e64169b9c135219eff75eb11766b331743398edad116c51901e0cfb54845583712cc9631c3f1b6e1be02b5a8e36a897f6dc865c9202907114e50b83d924d5bff475fac3627955bb740f18938db22564e364b984ebb24aa689805872626ec8180e3bf3246b05f97428aa0a1beddc1d25f34c63e0bd2a3eeb01b4b0a2e0bb87746bcd57c83288949ae16df12bca8814a703c313fd31435692a8b9eff365748a98730c92d3b8b10bc9fdeaea483130805217630f3338189f19382d0ff0a0abb2c296de3aee1b7abc82cf124633ede979bda68a68f17ef3eaa0568b7d332cf48fc7742ac63602e2e39dea8b43696ccce7deba8d818ef4f6cc767696dd56457aca45febb976de3229e2e593ac024a9e5db291d87f854bd18015a20d77a6219e7d4408149258786b3c57926e78bf0230b927807f28fe19b3cc2656adb21e108cc607ee6c3318d7746c109bbe246bfb250713b636e7c11606bcd40eb231ce1e925fddae31a18d3bf56306361c599f2f4459fc7f3c7ae35071927d2f7543f41997ddbecd4280fb8a7f41e645705c4a58f2288b71c7b908befe38b7dc9015dc63e6251ded28b7b9176435c2b7dc913e0a345e3fe14053e278ae574c16f58fc24e0de8db59f5e14e2f083d66b7b5ecfc06f329c1aad3ce017aceb44996c12e48e19983b907f5eddeea2c472a899ef3f64b48b9d74d1a234cf36b13b6a59786fc7d79072b199653d3cb094c4e312b013f270abe3f1699a56464fb9b42bb6bfc7240fe5c5fc2149ba25a0ac6f3519de09e59c1bfa9da9778363b42e6a97d7eb5d43a233d9bcdaa3554f005801c6c25b77cfe19ce787876e73fd90ad22568113ecb7a82593cf9f8a0a0834c285ad4839e42458ac57621e7bf7c5e51bb7c0816eb0ee7749c900f4bd2aca64127733b322aecd883205c2c95a7491bb486523595299adca64e27d3d174ef2f545aeff8ce194db8863c745339c106743c0f9e5abc63b765f6b5df22a0739993d7459ad6b7964e9f10df48101f33ec21d3f6ee8203bf1b07bf6a6f7e804f52290417636075d4ebf162e3f3f53934c0f3209572b5279d2a4e93f2400817485fd80328b395543b0910857e28a14989875554fbdfd1022a0b4ae337e8acf947871c0fc3c833e0cf3a51d79a36c868a4b29299b4cc5c0870136ea2bd37ec86fbd8646a7cc45232b54ca008a12843a6c324a45dcce786dafb1bd4aabe2d6332ecc67102edb8b915138969d835ea14797deb720461ca684b2abfe0c2cece8ab44038e79ba84deb80d6ee3fa09c1d10384aec5f73687d20ee503b789e8b0fc960ad7ebe88c42110590124bfe4b9045eba938af6eb2868a2299c37e01763eba5f5c6fcfbd84346bab35b92fcbff3341b9d84c30a2555750f1aacb0e57ccfad8a901abe6b63b93b5fde4e180d2f4adc3737880e5062bbf4f3755237d11780d11cadf34c2528e24c4e4766a75eacd2d4805bfac10d304f3fa825168a16f961d71e8298b88f92bbb395bdfe31ff73a4e1bb7afbc256d059598a6228b0d3d591a12cb5478fdedac33e6a50ffbb5b277a0b520fd3ee447821225bd82f32c5a733babf97798e2ef1abfe138819232693e9d4c7099650c10d45a824b5875487c538f7feaf1cd8f539f7b26849ea8481a06ca96602ea7c7acd4425cba15410127c3c69c7468d3bf1df90d4a3d76b4e5547170386b19f878991ad2c324f247ca71820b3fcfe5a16d71f46fceb406ce2c2a68d84d36572254db7554b5ca6c2430798500380ee492b05319990a73a06843406d9fb4332da3672f2b5eed188782abe5b571dadab26b762ab51b3c30cc30abd0e8bd40addb3688935c63d09b2ffcb9e148bf574f4f58e9852ca26f73f73b59af64172f7526fb98c86813db654d805f06ae322610bcc25c66d33bacf5e4e1a13b7c887db60763aaf744c7966077b4e4f4e6783239a6fabf26d2cb67697e23fb843d0d504491ecee32ad17c003e9464065d7b96ce0f91b36085d67888f4efd92c21fc0060a361af71aa0654bbd95c58263fd7583061db4fe6f792975781edf518b3a5800f8b6b3198bec716af9ef33ff913757b3573771089764a664146d88d54dc02352d7ae9cd1a38eaaf4816004da491741738139d5ac0f50440cb329501e3a3b6613bcbdaa99e6dafb97ff7757f22bf16a35bf0b199be3613c648d3ac380f7860b5d740361da38b13f4dd5f44a42121f930cad1d9af40cc7b81f16544fb8b9148a793f9b7ffb3edc7d940a3f0593269a4cb021210db1c45c1e01b046ce6353b461b59e9191d878262273021961f319488e435cead9b6392c09ac0cdafd9fa2222e8de1e5c7cdb41add5db8d21f839191bee579c02ae619edd663afe7093d7aa3e3711c9d2e783badf60dbb1a4c3aebdc328b5a832408935e970a4ba95b880a04a2968035020c80719ed7086b3b29c4c6e65178819992244bdda9fc9c119d3e3e73c84ccc4391ece1f6f1bc99b60538cd401e44953df0711eb52f8329a81ed103ada1a23", 0x1000, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
keyctl$dh_compute(0x17, &(0x7f00000000c0)={r0, r3, r6}, &(0x7f0000001180)=""/102, 0x66, &(0x7f0000001240)={&(0x7f0000000100)={'sha224-avx2\x00'}, &(0x7f0000001200)="bff5a3af1c", 0x5})
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000140)="1080", 0x2, 0xffffffffffffffff)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$set_timeout(0xf, r0, 0x2)
keyctl$read(0xb, r0, &(0x7f0000000080)=""/56, 0x38)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key(&(0x7f0000000140)='asymmetric\x00', 0x0, &(0x7f00000003c0)="9f3a", 0xfffff, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$restrict_keyring(0x1d, r2, 0x0, 0x0)
request_key(&(0x7f0000000140)='id_resolver\x00', &(0x7f0000000180)={'syz', 0x1}, 0x0, r2)
keyctl$search(0xa, r0, &(0x7f0000000080)='rxrpc_s\x00', &(0x7f00000000c0)={'syz', 0x1}, r1)

19:20:27 executing program 1:
r0 = add_key(&(0x7f0000000000)='pkcs7_test\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffb)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203771e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$search(0xa, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000000c0)={'syz', 0x3}, r0)
keyctl$clear(0x7, r0)
keyctl$set_reqkey_keyring(0xe, 0x2)
request_key(&(0x7f0000000180)='id_legacy\x00', &(0x7f0000000100)={'syz', 0x0}, &(0x7f0000000140)='s\x01\xbf', 0x0)

19:20:27 executing program 3:
keyctl$assume_authority(0x10, 0x0)
keyctl$invalidate(0x15, 0x0)
r0 = request_key(0x0, 0x0, 0x0, 0x0)
r1 = add_key$keyring(0x0, &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$unlink(0x9, 0x0, r4)
keyctl$search(0xa, 0x0, &(0x7f0000000780)='blacklist\x00', 0x0, r1)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000940)='-\x00', 0xfffffffffffffffe)
r5 = request_key(&(0x7f0000000000)='big_key\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)='blacklist\x00', r0)
keyctl$negate(0xd, r5, 0xea1e, r1)

19:20:27 executing program 2:
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000040)="3080", 0x71, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='pkcs7_test\x00', &(0x7f0000000280)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x0}, 0x0, 0x0, r2)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000100)="9553e2e12c64e2b4d1407e5d5ddb68cede79aac6f55858f28a50d3812ffb24a6d96248aea53a3790f7994b802b77d7043b36cfc939f6aa1af07c5021be60e4039a094f16ff9a128acaa706e14041aea99c25550e2cef9992595ee301ba754d95bbf93b9a8d7385892e07a05f6bfead9110889a83f283bcc5e22c061808287a53671aa13f575c6afd89fed0f9c5ad0a55ce89f9a302a5b9333a070e87abadc0204b5d24318b7d7706e74bc09f5de35ad6f1a270959657a5f48d36437c1d31579cb6897c7345b15f0e0c5eed7b4ba0f3bb5b9d8a3f7752c3a39617e290319413cd680d9c", 0xe3, r3)

19:20:27 executing program 0:
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04183140430e4438ef0cb57bffa368132207d9b742e403875e0c5f3751128cc2be935187a03220cf9ddf35e16449280ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4dadbcc084c252ebc74ba03de0530b0d52806c04bdd3234b73754510e6e96b0c42bee440816b33df58fcdb47a26f2034fa727b8e55b647cadf4ad9b4a466fbb0351c8b42bced3b330fa2d4ff50e6d83e3b7802933bcf38809a57a1cb12fefea38b134c64af253ae5c58463757e709cbcf9d184c1f44c0b6da0f7c9128713b81bf3b836c3c76b3b2418379a817d420c6e0d14d2b6f3729484feee24f24e6a23701c3a01d0bf9caffaa0be845a024bcc1808eee82da1c8c25fb826a766d885f387d3063fc674f6226cd000000000000", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, r2)

19:20:27 executing program 1:
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r0 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r0)

19:20:27 executing program 3:
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000140)="1081", 0x2, 0xffffffffffffffff)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r1, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$reject(0x13, r1, 0x100000000, 0x7fff, r2)

19:20:27 executing program 2:
keyctl$restrict_keyring(0x6, 0xfffffffffffffffb, 0xfffffffffffffffd, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
keyctl$link(0x8, r2, r3)

19:20:27 executing program 0:
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000000c0)="000001aa", 0x4, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
request_key(&(0x7f0000000000)='rxrpc_s\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='systemsystem,\x00', r0)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000280)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_MOVE(0x11, r0, r0, r0, 0x0)
r1 = request_key(&(0x7f0000000100)='id_resolver\x00', &(0x7f00000002c0)={'syz', 0x3}, &(0x7f0000000540)='\x00\b\x00\x00\x00\x00\x00\x00bL\xdbC\xa7\x885\x85\x985s\xd6\xd1\xbd\x98\x89U\x14\xe5\x1e7V\xbf\xe6?\xf3\xc8\x1c\xa7\xbb\xab97m\xcfV|.\xa8\xa1\xa3\x00\x00\x00\x00\x00\x00\x00\x00\x00', 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$KEYCTL_MOVE(0x1e, r1, r4, r0, 0x1)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, r4, 0x3f, 0x2, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000300)='keyring\x00', &(0x7f0000000340)={'syz', 0x3}, 0x0)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x1}, 0x0, 0x0, r0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r6 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f0000000380)={'syz', 0x3}, &(0x7f0000000600)="ec211e9a156e8a2cfbe30f1e316f11c56b8dd26ad0125f56caba6265128bff84baf863a3a15cef874fb5c4a27324021fb05fe254eaf84a304783189ca2be68494e45e9b9b27267ff6be6238a26f1d71a31c2fbb1987d5b0cd77e4db45348cdb5b594bce0582091a1fc5d8c312e911091a3966ededbc2ab87778c3ab79b2f1131afaadfe84d82b58eeeca24943f817cf9de557402f0f59cafbb96236900b57e2410ae5fa03f6379aa9877f800007472142b302558d6ad8e8fef", 0xb9, r5)
keyctl$reject(0x2, r6, 0x7e0ffd, 0x201, r5)
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)

19:20:27 executing program 2:
keyctl$instantiate_iov(0x14, 0x0, &(0x7f0000000300)=[{&(0x7f0000000240)="d6d67a6045b206b3a3c97fb1b0ec676c234d85c340637237ce5ef3d759217442dd5ed062e42b9547fec93a", 0x2b}], 0x1, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000200)='asymmetric\x00', &(0x7f0000000240)='key_or_keyring:')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$clear(0x7, r3)
add_key(&(0x7f0000000140)='id_legacy\x00', &(0x7f0000000180)={'syz', 0x1}, 0x0, 0x0, r0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r5, @ANYRESOCT=r5, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r5]]], 0x5, r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r5, 0x9982018)
r6 = request_key(&(0x7f0000000200)='logon\x00', &(0x7f00000004c0)={'syz', 0x1}, &(0x7f0000000180)='trus\x88ed\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r6, 0x1)
add_key(&(0x7f0000000140)='asymmetric\x00', 0x0, &(0x7f0000000080)="15c2b9a06e0601", 0x7, r1)

19:20:27 executing program 0:
r0 = add_key$user(&(0x7f0000000300)='user\x00', &(0x7f0000000240)={'syz', 0x2}, &(0x7f0000000280)='Q', 0x1, 0xfffffffffffffffe)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
r2 = request_key(&(0x7f0000000000)='logon\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='#{\x00', r1)
keyctl$dh_compute(0x17, &(0x7f00000000c0)={0x0, r0, r2}, &(0x7f0000000100)=""/225, 0xe1, &(0x7f0000000340)={&(0x7f0000000200)={'blake2b-256-generic\x00'}, &(0x7f00000002c0)="6bdc85cf804f0dbf4d9e19cb1f7eea4e7e5a0ca27e9df26d0162368b43beb7d03ce0b491eff91bfb6214de196afca6b6", 0x30})

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0x0)
keyctl$instantiate(0xc, 0x0, &(0x7f00000007c0)=ANY=[@ANYRESOCT, @ANYPTR=&(0x7f00000006c0)=ANY=[@ANYRES32=r0, @ANYRESDEC], @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d34338cf519d8a38f1b3e4897", @ANYPTR, @ANYPTR64=&(0x7f0000000700)=ANY=[@ANYRES64, @ANYBLOB="850589886d721a0f91e05882585247d436801cf511361a3ad0f93f5e033ceff4e85773b2947ac1326ab4d8ae6a620bae72e35c3effc2f621633856cee4f483e1bdbe00dee6ebee69a907473a4f36fed1c22eb558dc6b3bb276558399fe840a1f59e38e8342cea7b65979ddce149ab651e60ccb9659e59fc2e7a1e4446be5e6b8249f98b4068e40f87bb4df1e719df3cc168797cc4ed8f57a7877ef1e4509", @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
r1 = add_key(&(0x7f0000000240)='cifs.idmap\x00', &(0x7f0000000280)={'syz', 0x1}, &(0x7f0000000580)="b600582a1398dade062437c4426b72f38337a76ff1e94e1cbc46aa998f4bb912553347723507152613a01c046d27f35fc4cec5d0022a6fe1b428c40599339bbcc2c3a0f391058796225902f48471606dffd35d669d74ae092e3dd6b210966420fd578e8615254ccdd715ae00869c1575af8525213139f7e6ab466a774b30c528bc09c070fa5c93cc781bbfc07d2dcd8ad4f7cebab6cf32eabeb92617cd0b5f0f1c0ec017017c2a6ba8a7122e2dff5f2217359402221e01fab3fb49db55f810328a34ef2e31e54e2ed04df0dbdc36065088baa6ee51f1d2e15949640d86cf0c279b", 0xe1, r0)
keyctl$read(0xb, r1, &(0x7f0000000480)=""/123, 0x7b)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r2 = request_key(&(0x7f0000000100)='syzkaller\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, r0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
add_key$keyring(&(0x7f0000000500)='keyring\x00', &(0x7f0000000680)={'syz', 0x1}, 0x0, 0x0, r5)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0x0, r2)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$reject(0x14, r1, 0x60ffffffffff, 0x201, 0x0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffe)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r2)
keyctl$KEYCTL_MOVE(0x1e, r0, r3, 0x0, 0x0)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
add_key(&(0x7f0000000140)='asymmetric\x00', 0x0, &(0x7f00000003c0)="9f3a", 0xfffff, r0)
r1 = request_key(&(0x7f0000000180)='.request_key_auth\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)=':\x00', 0xfffffffffffffffe)
request_key(&(0x7f0000000080)='rxrpc_s\x00', &(0x7f00000000c0)={'syz', 0x1}, &(0x7f0000000100)='keyring\x00', r1)
add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x2}, 0x0, 0x0, 0x0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368ea75402800000000875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f00000003c0)='keyring\x00', &(0x7f0000000400)={'syz', 0x0}, 0x0, 0x0, r2)
keyctl$revoke(0x3, r3)
add_key(&(0x7f0000000040)='asymmetric\x00', 0x0, &(0x7f0000000140)="108100", 0x3, r3)

19:20:27 executing program 2:
add_key(&(0x7f0000000000)='dns_resolver\x00', 0x0, &(0x7f00000002c0)='\x00 ', 0x2, 0xffffffffffffffff)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df357cf4e7270ac2629f890800000002a42e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da0000", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
r1 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r1, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r0, 0x0, 0x0)
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='blacklist\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$unlink(0x9, r0, r3)
keyctl$set_reqkey_keyring(0xe, 0x1)

19:20:27 executing program 0:
add_key(&(0x7f0000000040)='asymmetric\x00', 0x0, &(0x7f00000001c0)="30f5de", 0x3, 0xfffffffffffffffc)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000200)='blacklist\x00', &(0x7f0000000180)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000080)={'syz', 0x0}, &(0x7f00000000c0)="350a650e02f7cac7dbdf205c4ff1eb8f1d5a3dd6596642348184a36c2b256d75b7ad85df91c8de33ecb38de160fa345a10331ea7fae4062038af37deede5a0594cb3477ae2a5e8eb94987da6aa2dbfb3a71e468884edebfe600994738d6d1fef409b62404021d12ef5dacb6cba62a83c2542cf0c68af1e52b1d168e03043861aa6aaa7570d", 0x85, r2)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$invalidate(0x15, r1)
add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)

19:20:27 executing program 3:
request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f00000002c0)=':bdevwlan0vboxnet0&\x00', 0xfffffffffffffffe)
request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='wlan0nodevsecurity\x00', 0xfffffffffffffff8)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$link(0x8, r0, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000100)={r1, 0xc5, 0xb2}, &(0x7f0000000140)={'enc=', 'raw', ' hash=', {'blake2b-160\x00'}}, &(0x7f0000000300)="f8772c0220744878a5c01e24ba28a6ce8815878da44eac2dbdc8fe56e7e857a936aceae9ebcb3834769dbe6fc7980c79573c07738c75fcda43281f5261463811657a966411126df073580d185e4a4eb0ee7b4e09d1256bb309cb6d395a7e502074d75f7f10e367bad33013be8a83e9faafef80a634a7e54008d8712d3ba3ca285f97fc5afb0a6997862714b7ae2275bce2e6e25bc4a8f894f78d1a7f7ca50d2d65ff78b2ea8f3241eb07f8cedf939e12ae1eaa698078f1c008e2b377357249867723cd0f74", &(0x7f0000000400)=""/178)
keyctl$link(0x8, r2, r3)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$read(0xb, r0, &(0x7f0000000280)=""/93, 0x5d)
request_key(&(0x7f0000000080)='rxrpc\x00', &(0x7f00000000c0)={'syz', 0x1}, &(0x7f0000000100), 0xfffffffffffffffa)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$read(0xb, 0x0, &(0x7f0000000200)=""/59, 0x3b)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r6, 0x1)
r7 = request_key(&(0x7f0000000100)='dns_resolver\x00', &(0x7f0000000140)={'syz', 0x0}, &(0x7f0000000180)='eth1&{bdev\x00', r2)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f00000001c0)={r7, 0xbf}, 0x0, &(0x7f0000000300)="b96b87b4f4b8d62867238de5fd1aa97fcbbdafa410c2a1d4c0879f87bd9ad0fa5243546b3974b44447ecdc315403f713b33bfd36ff2ff78a75f10e0a6d67b67eb9141a18bcbfa036632658a3f7ed7796eacbbfc1c26f8f1936fe9e6aab75834cc9ac694c4863889a0d910ff8217ce8fba725712bf9e21a2ce98ab9ceb88aab7b579cfc182d1806a89795d46657eced4821befd0e42f7ada5c29e52b70756c70a86e75c5e24f26074f817cc58156b58538b9aff59929e8928e3c39545bb502e", &(0x7f0000000200))

19:20:27 executing program 0:
r0 = add_key(&(0x7f00000000c0)='dns_resolver\x00', &(0x7f00000001c0)={'syz', 0x3, 0x2}, &(0x7f0000000200)="1d1ad732d4eb7f3652ee46e39383af62cce15cf21979c899ae544810538e8b8e82f71c6cc5cd03d1d6719772b7ec6aa7dd0a02e8818a9f497dcf34efd463e8858f6c14f7a25ee85f034f37971b19d8a8aa6eeefc5fc2bbe3fd30759a918117bd91e0a60d2b4cf9d51f2600", 0x6b, 0xfffffffffffffffb)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$invalidate(0x15, r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
r6 = request_key(&(0x7f0000000140)='blacklist\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f0000000280)='(loself\x00', r4)
keyctl$update(0x2, r6, &(0x7f00000002c0)="db0fea9e24534afb9ae6cb8ce60a76fbd05c8c99ee37b246864723993ebcdd3334227bc0b41b5e1d88dd706d8e248a053ded0e9ebd0e28fe96cf728dbf14132f7f030cd950b3ed3b78d5ccef3b4390c22d8d1d08005f7758c98f85a5ad2df36d44dde093f0d96d2fbf9b093d5ab2717a8140c00f99f3b2ff75ce9ddc0a60de79ce434444183ff6828de64f5b6335525861db31286c1fd0966dca7b594ebdfaa605f7d577ae2dcc27aa2e98750cafeeaae7999712db4394189e6a631ed74cfbb13cb55ea067558c2c71b0bef3ca994024", 0xd0)
r7 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r7, 0x1)
keyctl$reject(0x13, r0, 0xffffffff, 0x3, r7)

19:20:27 executing program 2:
r0 = add_key(&(0x7f0000000000)='.request_key_auth\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)="3596b6591703feb53dd33773", 0xc, 0xfffffffffffffffe)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f00000000c0)={r3, 0x99, 0x3c}, &(0x7f0000000100)={'enc=', 'raw', ' hash=', {'sha512_mb\x00'}}, &(0x7f0000000180)="53e99860997888aa37e9a5fbdf5426982a237570892d6832f445e02646c321045a0fba9d1e28c7c54285035bea56960ae72dcd424f1391edfb6c157848192d4d46bdcff4e9a37a4279b2d566db75a84ffd3d2746ff02a8168188dc969409d69c9bd93d30e9e23ae466ee8ab02d73530b044777aeb98fbbc158dd95a64a112e2063350802e9d40edf1d134d7660c75d5dc13d6ad2a05b0a5c65", &(0x7f0000000280)="7f7cb9b06a596c60ef7434e57f3fcc5ac1c770cbc3c5ae36fdcbec60de54b47bb296a06ba7211913acf3c0a56e8d0b81e8dd2836b3b7eb3b62e10f13")
keyctl$reject(0x14, r0, 0x60ffffffffff, 0x8, 0x0)

19:20:27 executing program 1:
keyctl$restrict_keyring(0x5, 0xfffffffffffffffe, 0x0, 0x0)
request_key(&(0x7f0000000000)='id_resolver\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000100)='posix_acl_access\x00', 0x0)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x1}, 0x0, 0x0, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$user(&(0x7f0000000040)='user\x00', &(0x7f0000000080)={'syz', 0x1}, &(0x7f0000000140)="154a48de6ab1622999272c32e148026ee546a16c09cdcce8a5d28b5ed5ea37f37e6d7545246da6cd9ec91cbab3d0018e027ee0aa52f232d6be811bc27cac5b3fe8e2ebc76ea5ccdc4d0ee8ceb0cfd2576d20542b8cf2b9c5a2e2fb4d2d047ee26582a4ed34a7cada81bf6878e40a7269a8", 0x71, r2)

19:20:27 executing program 2:
r0 = add_key(0x0, 0x0, &(0x7f0000000000)="c3543993f40dd2514632455d209a097a0800000000000000c6c4a7ef210ebeab632904be1875c8eaf8a24bac2375d514ac68e20e6cca7464662f57c3e85275b895c45070b322a45cd794cdf381b11d4d33d75679e9e40d5640c459fa0af8dbbae323", 0xfffffffffffffdb0, 0x0)
keyctl$invalidate(0x15, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r1}, &(0x7f0000000480)=ANY=[@ANYBLOB="656e633d72617720686173683d7368613232342d7373736533000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000009ab2811f71e842b76b4e59474f7afce4f8e4f5ecd15f2a4b510430be8a4ce5481d0b06c244d42db89342164ffc39669b97cbec8126b1202dc76e894718"], 0x0, 0x0)
add_key$user(&(0x7f00000001c0)='user\x00', &(0x7f0000000200)={'syz', 0x3}, &(0x7f0000000380)="f683652e8216e52240eda8f1ffd7e794a988abf3e573f44ce0845a59d82eada15dde8c37ae15b3d70a659e81f4c271d380d445524ef63d0eb35db543c4d2e5779721282817da3f4096655a49ecc8ae0f7ebfd2cc62b8c9098e4ebe8075231e7d290c76ccd67c31148b3679651b59672d4393f07d467bbbf0a7d3ab5ae3aebc1febf7200a26d487ba09d18a1adb6eaea52431041b5943dc18a35a52df69968231d530f27ed53cd8c0c5c7fbcfd7a9808ae177784a68823cbf3c328df146383fbcc05f927355003cea06dce4ae23346405b62675e70cb1fc0cb2d6582e08f00c36ef6c72d036ce337a16f679bfbaa3fdd88796c7ff30", 0xf5, 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)

19:20:27 executing program 2:
keyctl$join(0x1, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
r1 = request_key(&(0x7f0000000400)='pkcs7_test\x00', &(0x7f0000000440)={'syz', 0x2}, &(0x7f0000000680)='ppp1eth0\x00', 0xfffffffffffffffa)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$setperm(0x5, r0, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$read(0xb, r0, &(0x7f0000000580)=""/240, 0xf0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='rxrpc_s\x00', &(0x7f00000004c0)={'syz', 0x2}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
add_key$user(&(0x7f00000006c0)='user\x00', &(0x7f0000000700)={'syz', 0x0}, &(0x7f0000000740)="d038f50241420374be21192078e2b77dff2a35e0e9d75f102394ad999783b22e386b4d6d1614092850b8cc94ddcb9bd45eda6390d7c0359faa6899cc44b0d4638b339dade8e3f8b38d0bfa22aef6404911bec15cfa810178e3f359799e51ea42a0f387c15f2406eeaffd7130e64e27cb4e2b9ad3f940ede2a707dace6b7ba280372b8d7e0d2864b1805ac9a78ba16423a9b67b3702c6cf7481f61e8dd02c110334b803d41b5b500b6be0df5a34de5809cc8e355f169fc94dc2c34ce92c2a0a0c922bf5b26c073cf7723de8a8688968db983de1fdb051dc35d9ef3b1af492906a98fd1fa7be2636f895a0a390c0287f710127eb89e3ea3263dbc627f77c4b0253d5ac28573c163849f879647bdf519032fa5bfc94204d04ec901e21f0d02119c45de23610e51869bd048792083105881241640f2487307a5ade947f6ef15802c4c9eb007b27143a6714389e89acafcb3fcd6e0e7ed1f58f220d14d05bb9bb0d28c786593f73bc2a994184a5e73ffb2a2c43bc066b0cfc28da7226cf360977d8d4754ac043b99bb1efe0dc809e21a855b6f11da5e62fa9ee17052035ead95a3bfdca63d88a4015a2632acd992faf9a5b2a915076035cac2da6dc38a62d02bd62e43f9b0b4a0e1c15b273f88f0ca00441fcc563f843ba61f2a3ceb63c40867465f8b4dca514529dd477fe14ea23b6e4eb0620bbee8417a2144ec76f92fc603c3c121b8ccfa873e014c4c74a4a24f20af1c8e809d573a1b0517c223b84cbe49e67bebe37c514e8bb0b5d75172643e192774491e134cff76c30d8452e9e474f04d76e81678651413f4e27de48e41421e2df06e1a30f9d3809946d2ad691d7b740cc9b78c27050c0d4694e432735483e71390d52fd674217d2cc4d2dee1d3d6bf22a6297902a1d7f152479933fbaad02a54c36afd8db9803ee3a5c5879a9c44ef50be0ea8fca8ec9275d7c220043e4e019a44cbc8bbfd20b418d85568347388099ddfb1e1812d528629bdda34e698d7b2988b10fd96f048afcfebcb94ec6fb884385782752e2056b1f1372fd985dc7e2ea970eaf3014a7db2212566d1da1ba50c7e71fbe238f09e067ae802ea7cac7dbb94608a151ebe5473d2ed6871333774efc1684f3ddbb427adda7c3ba0be4ec544c7900fca0347566c5f0e54db1321ad572fd1041b189f2f52e65c679e8be5e6fce76d8966df0693c74a329ed064061602335b5b309fb4bb371538de68f5271284773c6f77557919dc4c1fa6d6518056a583596f0890d4d5b8090d1d5c0f64f42f3056bc7a7b5b14efa70020e12aeab0605691522af5402ac3e564e95f70256741a35d84ef90d9b8459496a91f35cfc9fee416cd315cb338e35dbce09fc6b8734abc621b824841fd1513c0e037384720553fefefbd01d28a03cecde993aece8a3ddfa7695cd3811ae5a361993338237221de8627287ba54bc7d863c24064c5055abf278703527ebb60d0e8ab9d5d4cc853e9d85a4ad9cfa025cf0a1ce1720d47b8ff9dce7eb2076a36d807579f64b6b60b9452edca1b587133a3ceff937d4e8ffc1781dcb2f35a0940a7c2c350ce51e9bace192646516644950386a74382a326c51eb1ebf887c9cfb04ed75c86a5a360f900632febc8a3f4ca922361293a9f998e19cc778245805ba8c59d5ff73074653196287d24df8f7f19c214f4bf327d08ee60b4bb9314d8c0b41ab812526ceba9640b6ae9bbf49cd70eda78d92c63c9a6dd8fc94693a57e2065b8309bd2739d77a5e0e5eb1e2410334f6cbd04ebd218718518aadd7d6682117db98445742fe3bdeafbee4055f5c01380bd75919d6176350c66aa4ee315ac5964a02ddc06c3fcdea32a71091830b4f4e51eab2d9226350f60defad5f13b227f70019aaf09513a8180007202ec9f18c95b7df7e0dd7bd2e56f8c8f45ef04990aa2591aa0c9af125b0e7e137405b391608438babd400d3c0d7e1b582e3504b5da27726bf7ea8af792e83d5dffc7bcaf77aa2c8a780ad56af83899003d23331f0053c8e6fe744ae7f6c95f2dd7801174e341f52d3bebdd17714c9f1f8f4c3b7346b94c50e558b5487f3c49bbe54b47c00fd5ecf92107897f7010907ad23f250e79231e815f2aacba6f3a36fed1d7787b363972c58c9b4767ccb7fcad505679490fda5f8d9e2fd69278c8267ac5d2bd9155f6d2a2e3b5a98735613880ddd12fbe05b8276684c75d3b75192323ebaba65e9fb72190cda2cf37378b0535f3415a2dda18b60ee255d9568a4f40ceb7d7c3c5263e3dfb3e4dc7db68612779dee67da9fe7ccd072b1900edf4b3e5b3a7c1945060d3162b6b059eb47d1a260526c6747ef2416ce4481a8cc59fe7467592f804b4dba9219f5d79e7c2a08275fbdcb1df16e64fb18429ecc18b768c8b86da488bb452b422b88a6bc2dae41e4b2bd0daea1ac58b14c88dfa3db6c24f65b565d0a280184a3ff394780bdc1d8dfe25a47d1517805ebd498fd6baea788083c066aad329c91b468faa99ca464888f6ae712767c413fbd6d2ccbd1faca962d069c23fd5e862c1ef444cc09cdf80d98cd20ddaab8e4570bee4f540a142fb30dc123cc26e06cce030f082e8810408f4e279c78129d6b447e7bd63314036dd1860e05427618d7d36c5baeab46e4adba2ea2e3c1e69e532dfc2736f5e3185b6644f77dfd4a6913aabe25e949c9f35fa6b6e3496cd7dedc51100e2222f027d67a79b2f1d578b795410ec8a766e4f9c266ed21c66de2a7424ed43d0a8aea47952b10488d87bcaa87254479261a5bfa6eb030bd165dee18656bbcec382298e2de95221bf31947c4aaefe45c2088b363b34dd9783fa7a968ca78ab637ee2f6f9ec44aebedfd612c8cc1bcd925545541a3230180b0e399b9e37d92024503e581b10f97a6de2e829c4b06191902be99d490f948825fa60da32ca1bf22d49cf2190c0bca85621d55aabb543269effc7ec011638bbbae5161c0e729db61802b2fa2f04e4fe3b451300c5000271d7458baa91ceed9c5c146dd606167ccc453eab156d712f22daff0e9bfcfec0572a63918e566e6fee51d490f82bc4952027725f1c8044f2d9f49d04d1c0da4e6a1ce94f1663a087cdd8e70777555821a1fdee05fb4d9db772d89f43a9340b252d8721e608a1cda8a3ae37f5615b9153f5b72bb6293b46ad0b6b3a30a2f52696cd739c910edfb481f574885b6037e8c1bd28ddc9540c6228b533a8bff3f7225d92a03a1c5f210214a36b8afcc8802dc7341030225e0b83fbe886b096f4e1c97904a8cb0d6c065cf4ac387b908ad51d62ad1970cec50a6d05f0df830589dbb66e1a2b74c98de269a09f039df327d3b0a118be9b6a76938a1e74c2249249b99f2706b0c19e565fb7934ee64dbb904204be6f9da216857427fbf3397f12cb5c323470101248780d7a09fd43b8a9c6805309afa77f6da6bd0a7b31121efb7065f9c7a42856fa705d10931a756dafa13d0558c94150fd5284352696d31a5e204f28c57d50a834e9a808cb5a569a86e1fd62074d647c05ff6407129f20ab825e75065079df00f4aa88e2fd9155d7110f7f4636a5ef958db8e4592d33e74a0012f678f789648ec2c217724f4a7ba18a673546f79a9c2a2564f44d135d31f346a64fa672415a2a8c1dcdbcb4b8ffe39eaf5a4c86663dcb64ef4a9c7f109f51c25435c501becda123327857477e2f862d6d535462d1980e6bc37a27185f7ed9b0bbf3ee7e346e03ef85a8c3a32a83fbc0318192bf4c56ef19ba6658310130cf778041a3954f9b8740609508af21ee995a4496772462badf34d839ca235f1f1812557cc479a7ae6e6b6fbcf5c63616283b09e302afdfa7db512974410fce5f896e75a140762f0fcdfb8e2171d183aa40f16436cbf40bbbfbbea25bd82aa559653582dfbeb932b0f60a5b6dd3f66473b1a4ad220a2777eb3e1c75ef7bbbf22f59a8d1e9cdb1538e3facf0586b27061befc2556b181af478698a105fcfe528e9be4bbf725a737ebb8333c6319cf0c1942655a138a39c2a6c1153c8637ac71ff22f8693d5f119f903ced943a4cb91f499fab2f93df683299c97f62f94a10d7b27ef792490b0e7020cb56d8cc58ecb84e97ba130e9bb228e649061fb08a3ac29da1af0a2fafb966817635b20175b04697cc1594d9da351afbf694c4ace9bf88fa4f42235fb049250d7846d1642da6927fd1240e5061ddc374318e5fef9db6a885ba971f4a90b0860a14531b0e1078ff51c1b19b07960af14d226526fb61d640a03bc0c4d976b3b051d0374cc1d64d56d5d032bb5d5e96d61b11d9cc766e90508826f2109a7eaaf50cde6af79858295315fdffae5d64197f3a48c9130267f01fb207910117e31956b9dac5333182a293cc270a048217aa8d8fbc08397ce433c116c1685caa8881c7c2a61bbdcaa610b1df6033e05da0c97098f9087be9dd1ff793f9a0da8723480e8b85f590ea2e4eb881cb256af6a884a842d311961dad8ecfc772f21f1d75cfc7db9f1ad2eb7bc5cab0c78c94bee8061d4337b53a5bc976ba4bb3f168e129e611f50e29cc5a216192815d161768a5dd52b5e4247e73e5a39e800adce34d484514a3b329e8dc29c05ee831cdaf38668575f4fbb0098081209c0c4939b5a540eaf4b9b1286e878663f53a45d01a2c5bccef6e452dcae9640c4f5867058a8794f901ccf1d8d58bd2c201b31bd79050c56ca562b1e1023ba9550f5bacd549c264d71a6c09f1bb3a1f803ac3b12de46dc733c51665b4faf0c43cf83a1f8f27f07dbad58ce061cf16bc4a7afc211c4a8d4cf0008bb47d7ab5766533a769fd527d38b6025483b80e02ac5d71a6801f079c08d28f851426fb8dd880cd5476771c90ade06060860f84bfeca998023ccd159957486698f0cba11a97fdb4edb930c9f3c077a64a20dbff7714e8c059e6d38538596c7feb647113066af9141178ff6f2277160e2e0cbcf0d7609de2363a2deb7eff713b6db9d2da6316ec5df0974bed5ee1dd16fc2abdc18f30d7c86811ee038fda5be6fb5e85c558371f5e347c792fda6570ca57a52691f880067c207c7565ec65686d335b51b863428b47bc5a3b1221115b76c9c5dcff12b4a8a6c11d37ecdfdd66143cc120fd1d106020669486075b218785a54db286c13e1b12d86cdaec868753c5f766bce82da70cc2a1fe41a6b928320ceee6ac15c2ded98b31a7185ab696a7e04b2da6ba7602bc0f89479136eaa56f8c5a4a57588e207c4ce45e7af9344b2b602c68bf8c78f3adc0697a9967ae2b2f0b0cb4be96472b59cd1521a98e6abd31109f42acb5dc970c8cb9fac16ab87057e7f5d0f55b3145237adf36e3f617a71f58d14fa2da9e5620555538594b613ec75cca888cce5638e1ad258d3bfad554ff104eb165198af5fb238c597adf3d75fc40f5151adff6b9d990bb5a93e1d5a7c836be7c239a779c2e96870d5fb2ae317a1c206d343de23391738989f96378b687406279cf6d703340a4f00ad2ed2dcac21fc5653fb88381059a7636aeb2531800e5dac3189beadd8d6379ddf752817f9910c7c04c38caefa8cfde798ea27c25cd94bedfe8d7cf27ee352816e0dabf8da103ea4ce8d0d9f63d8fc0a72c0f0e1e6a75f21f45481ccb28a65c73766b76ef20b8509e37c638b37ea9f175b516a4ae2baabf8a2f641cbc5f0137127416c720cf95945750af522a18b31cd8f25d738b0fdcfc2cdc7333b21277f146438493f8178feed0c462c747fe3292225de292a9a5504d9629a75653eddf5656572fcb5cfb39411ab0ec2e63b6450a5feea32899e5d7a56638214aefcdeb19bac", 0x1000, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
request_key(&(0x7f0000000000)='id_legacy\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f00000003c0)='eth1?\\systemem0$selinux}[cgroupvboxnet0\x00', 0xfffffffffffffffb)

19:20:27 executing program 0:
request_key(&(0x7f0000000140)='syzkaller\x00', &(0x7f0000000180)={'syz', 0x2}, &(0x7f00000001c0)='\x00', 0xfffffffffffffffe)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$setperm(0x5, 0x0, 0xdd920da396eee6d5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
add_key$keyring(&(0x7f00000002c0)='keyring\x00', &(0x7f0000000300)={'syz', 0x2}, 0x0, 0x0, r2)
r3 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffc)
r4 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r4)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000280)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffc)
r6 = add_key(&(0x7f00000000c0)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000100)="9a", 0x1, r5)
keyctl$describe(0x6, r6, 0x0, 0x0)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='rxrpc\x00', &(0x7f00000002c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = request_key(&(0x7f0000000140)='pkcs7_test\x00', &(0x7f0000000180)={'syz', 0x2}, &(0x7f0000000200)='\x00', r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, 0x0, &(0x7f0000000240)=@builtin='builtin_trusted\x00')
keyctl$setperm(0x5, 0x0, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000340)='rxrpc\x00', &(0x7f0000000280)=@builtin='builtin_trusted\x00')
keyctl$reject(0x13, r4, 0x4, 0x4, r0)
r6 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="3420623250ecfad439e830ca0cbea209b61e6851fdeb77c16a1cec641e4921a3481e3f", 0x23, r1)
keyctl$KEYCTL_PKEY_QUERY(0x18, r6, 0x0, 0x0, 0x0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='id_resolver\x00', 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffe)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
keyctl$get_security(0x11, r5, &(0x7f0000000200)=""/83, 0x53)
keyctl$unlink(0x9, r3, 0xfffffffffffffffb)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000280)='big_key\x00', 0x0)

19:20:27 executing program 2:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000300)='B', 0x1, 0xffffffffffffffff)
keyctl$setperm(0x5, r0, 0x2010000)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e44384b763dfce40e146441767853ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c48420e82e6c67652a3f0e94cf6b59d93761e86584e703926c179b7dc7601d725caad81ca1b5ae820d", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$reject(0x13, r0, 0x7, 0x4, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
add_key$keyring(&(0x7f0000000100)='keyring\x00', 0x0, 0x0, 0x0, r4)
keyctl$get_security(0x11, r0, 0x0, 0x0)

19:20:27 executing program 0:
keyctl$assume_authority(0x10, 0x0)
keyctl$invalidate(0x15, 0x0)
request_key(0x0, 0x0, 0x0, 0xffffffffffffffff)
r0 = add_key$keyring(0x0, &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000780)='blacklist\x00', 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000280)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r1)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffa)
r3 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r2)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r3)
r4 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r4)
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$clear(0x7, 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r6, 0x1)
request_key(&(0x7f00000002c0)='trusted\x00', &(0x7f0000000300)={'syz', 0x3}, &(0x7f0000000340)='id_resolver\x00', r6)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x1}, &(0x7f0000000080)='-\x00\xa6\xb3\xf6O%\xc2F\xdb\xd7\xc8\xd7A\xa4@\x8c\x81O\xe1\xfe\xefaD\x94\xf6\xe6\xe0\xd1\x9f\xb5h\b?F\x13\xdf\x82\xd4<sFV\xe3\xdd3\x1c\x9c\xdck\xe61\xbd\xf3\xfeB\xd2\x10\x9d\a\x85%\xfb\xe8\x9a\xb1\xa8\xca\xc2<\xaa\x8f\x84u\x0eb\xcaq\xd23\x83\xef\xa1\n\x94\xdc/\xb2y\xf7\xb6R\xcc\xc3&\xafy\xfc\x00'/114, r5)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_MOVE(0x1e, r0, r1, 0x0, 0x0)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0x0, r0)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$search(0x4, r0, &(0x7f00000004c0)='logon\x00', 0x0, 0x0)
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)=',%\x00', r0)
keyctl$describe(0x6, r0, 0x0, 0x0)

19:20:27 executing program 1:
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000000c0)=""/191, 0xbf)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000240)={'syz', 0x3}, 0x0, 0x0, r2)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
r1 = request_key(&(0x7f0000000240)='big_key\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f0000000480)='cgroup(self\'!cgroup\x00', 0xfffffffffffffffd)
keyctl$restrict_keyring(0x1d, r1, 0x0, &(0x7f00000004c0)='sha256_mb\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000000000)={r0, 0x4c, 0xd4}, &(0x7f0000000040)={'enc=', 'pkcs1', ' hash=', {'sha256_mb\x00'}}, &(0x7f00000000c0)="9ec3b367d399297a9bea2a771aefe33ce26aed602f8288b366e37c2cb3c305c869c412d3f6287ab5b19a3a879023c7ec698932f8482b1b30b1ce043ffc890d529f3f9987a69561728eb17d3d", &(0x7f0000000140)=""/212)
add_key$user(&(0x7f0000001a80)='user\x00', &(0x7f0000001ac0)={'syz', 0x2, 0xe}, &(0x7f0000001b00)="bf", 0x1, 0xfffffffffffffffc)

19:20:27 executing program 3:
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, 0x0, 0x0, &(0x7f0000000300)="b7b43f3a8742d025cc7fa60c9fc66a92eb5e1bbdbe495bede94eadcc3eb67f2323", 0x0)
add_key(&(0x7f0000000000)='encrypted\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0x0)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000100)="2211710e987342440786662259eb659e6bef3cfb6ead632f26a79addd7691dd0e73496167e7d27b1796eb62b504cc4d9f0613049e54e216db44281d55c970a42647672ec93738b21bbcb55dae2e5f5c4302a91cd4fdbe74a18e839fb648b678661df2b8a6acc4f3b92d2121e1981d4e58c619bc4adc0e089ee329afae4d5fbad0d0b4535f7bb2fca3932c43a6216f3dbf8aa0d27897f7cba8be37777ac22f9603f124ccef5d8918e9c5e7dbc4cf8be2a0d0c1264795350c84abd9be3dd0fe30faa5c7f16f03dd7886f10030abe53ec474ca9eaa8025db9ee5a9bcb6c8aa9cc173da9cff3b5aa3c85bfc6eb0054e9a4811355240d7113130e48c9", 0xfa, 0xfffffffffffffffb)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000200)={r0, 0x48, 0x37}, &(0x7f0000000540)=ANY=[@ANYBLOB="656e4103706b63733120686173783d736861312d61650000000000000000000000000800000055df723b4959ebc7bda465070000000002000000000000000000000000000000000000000000000000000000000000fcff000000008eab53ab835827c3f8a6879da62da16aa2d2cee3404608000000b927218da23eafaf1eadb9f78d8caa5d262152c8e0a02361cc421aee44e42307e7a79cf1466f875bc3e23f615b6019eded6d36170131cd46abc853e8df54c43403c72b38ceb61b23e170dcc77da85777bc6abedf43c9c1dac8de73da697aa1b3ec6348f978f21449d8588d0a3426c549719940b41092d474714250267a739cb5e6db877d7ec440d7cebf0a031bbf9b0cb2d94706e249de9097425f195e2c0c6d85fc664960d4ce5f17c31c886d58c2187c68eb82868bb8f7c96b94f715afc5a9a39a2a37c2b632845e920669cc825a66204551a833000000000000"], &(0x7f0000000340)="69b332c813f18cbcedc74f01e0e2f3cfc0fd25cdb8a3d2e1c17775499e88a1d804be636b2ce0872b9a7c3f6e26dd7707ae2daaca0d850277938cf6c2a15b189f61f4b397b163ff33", &(0x7f00000002c0)="2f942e7fb92e921825d5e891c49b55b790756518fc6f9cc478f75b0122cd091bae9ff075e11d38378d59ffa3857ac9a1aed32bd6ecbbe4")

19:20:27 executing program 2:
r0 = request_key(&(0x7f0000000000)='logon\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='.\\em0bdev((\x00', 0xfffffffffffffffb)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$unlink(0x9, r0, r2)
r4 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)
keyctl$read(0xb, r4, 0x0, 0x0)

19:20:27 executing program 0:
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)="c2", 0x1, 0xfffffffffffffffe)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$setperm(0x7, 0x0, 0x28002000)
r1 = request_key(&(0x7f00000000c0)='dns_resolver\x00', &(0x7f0000000100)={'syz', 0x1}, &(0x7f0000000140)='ppp1^]cgroup\x00', 0xfffffffffffffffb)
request_key(&(0x7f00000001c0)='asymmetric\x00', &(0x7f0000000180)={'syz', 0x2}, &(0x7f0000000200)='&\x02', r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$invalidate(0x15, r4)
keyctl$setperm(0x5, r1, 0x4020001)

19:20:27 executing program 3:
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000940)='-\x00', 0xfffffffffffffffe)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f00000006c0)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4bc5f88968c06a21d2d1a4b8c920794de958539b0f69142b2279e3a5144334bf657ed97acd9770c9bef582bc3ef249f10404081aacc01f50d2aa58bd2ad78c78c82700379b7ac0a6fdc7eeafd53152335576c9965f95f2b46c4a46c69dea2b7a9c654c3e490fdb14f2294eafdef5d3c97f9b04bddc205615acdae68e78e6897052da33637332841a85a6b7a0c774252813e824a0999d828cafa0bdaf813c71500"/279, @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f0000000640)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000680)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f00000003c0)='trusted\x00', &(0x7f0000000400)={'syz', 0x2}, &(0x7f0000000440)=':chain\x00', r2)
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$get_keyring_id(0x0, 0x0, 0x2)
add_key$keyring(&(0x7f0000000580)='keyring\x00', &(0x7f00000005c0)={'syz', 0x0}, 0x0, 0x0, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
add_key$keyring(&(0x7f0000000600)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r2)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
request_key(&(0x7f0000000140)='dns_resolver\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f0000000200)='keyring\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r5, 0x1)
keyctl$clear(0x7, r1)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$keyring(&(0x7f00000003c0)='keyring\x00', &(0x7f0000000400)={'syz', 0x3}, 0x0, 0x0, r0)
keyctl$clear(0x7, r4)

19:20:27 executing program 1:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, 0xffffffffffffffff)
add_key(&(0x7f0000000000)='encrypted\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)="f1", 0x1, r0)

19:20:27 executing program 2:
keyctl$session_to_parent(0x12)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = request_key(&(0x7f0000000080)='cifs.spnego\x00', &(0x7f0000000140)={'syz', 0x0}, &(0x7f0000000180)='user\x00', r2)
keyctl$restrict_keyring(0x1d, r3, &(0x7f00000001c0)='dns_resolver\x00', &(0x7f00000000c0)='us\x986\x1f')

19:20:27 executing program 1:
r0 = add_key$user(&(0x7f0000001a80)='user\x00', &(0x7f0000001ac0)={'syz', 0x2, 0xe}, &(0x7f0000001b00)="bf", 0x1, 0xfffffffffffffffc)
r1 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)="90806367ff0e33446d", 0x9, 0xffffffffffffffff)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57b080000000000000042e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1929bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7608ce1ef4a2809539dae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYPTR=&(0x7f0000000580)=ANY=[@ANYRES32=r0, @ANYRESDEC=r4], @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
r5 = request_key(&(0x7f0000000240)='rxrpc_s\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f00000005c0)='wlan1selinux%ppp1wlan1\x00\x8f\xfb|\xa8*\x13\xa1\xcc^F\tb\x1dF\xf3r\fC\xd4!\x99\ajBB\xe9c\x04\xe7\x93\x9f\x8e\xd9u\v\xcf\xc2{T\x1a\x8d5\xd6(&\x90a\xe38\xf9\xdbo\xcd\xa8\xae\xd6\xc1\xa8\xd8R1\xff~\xa7q\xfa\xe9~\xc4\xb6\x9b\n\xa0v\xba\xc8U\xec\xac\x1b10n\x00\t\x9b\xa4I\xa8\x92\x9b\xc3\xde\xb5\xb2\x01\xa5H-\x9d\xd6Ud\x12n\x8a\xa6\x16\xc0\x8f\xd2\x87z\xca-\x9c\xe5\xfb0K\xf2k}\xdd\xaa\xfc\xe3\x85#\xa6m\xa1\xf3\xd4\x05\xc7i*\xd2\xc1#R{Q\xf5\xb0\xc0\xe0\x1f\x9a\xaa)u\x11\xe5\x8aK#\xb60\xf6\x13\xa0\xdc\xaf(\xa1\xaf^\xb54\x96\x01E\xcb\x0f#\x81S', 0xffffffffffffffff)
r6 = add_key$keyring(&(0x7f00000004c0)='keyring\x00', &(0x7f0000000500)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffff8)
keyctl$KEYCTL_MOVE(0x1e, r1, r5, r6, 0x0)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$reject(0x13, r1, 0xaa, 0x7f, r2)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, r2)
keyctl$set_timeout(0xf, r3, 0x401)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$search(0xa, r5, &(0x7f00000000c0)='dns_resolver\x00', &(0x7f0000000100)={'syz', 0x2}, r4)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
request_key(&(0x7f0000001180)='ceph\x00', &(0x7f00000011c0)={'syz', 0x3}, &(0x7f0000001200)='[ppp0trusted\x00', 0xfffffffffffffffc)
add_key(&(0x7f0000000100)='cifs.spnego\x00', &(0x7f0000000140)={'syz', 0x2}, &(0x7f0000000180)="ecccf193684f558bc9624823a3012334fe1f127c621a09306558c8aef536efe5807d1694e4c48f5a9d61ba5e40e37ca37e394316939acc5fd2bf3517e33abd4141fc2db4411444c988b0864716d98d3680fb814512b410713e54aa631d78844b54857f20dbac8dbe01dc6b11ec54f4601116e1f7b410ffb2f5583fbc6ed7948fd881d0183bdcda7eaacb49f437a6141136e9c85a93bc539e09b31b8a026c9f77daf561cc93b6330fc199373ad04bfb45b1b82710ec69892d43eb9cc2f9fe35f4fe3014ae067983bec2e6dbff10f021d2c4266e8edc34c66bd8ab1693a7f7f8b37892350aad2edf332407579f4ae16108895c043915535eb55da405122e70675fa2e4d1f0dc9c8d3e1b07d2fc652b3a042e1d41fb553afc252a49b098f7340f9c4a324dbf28f76ebc722339453ac56eda77d5241d7ac3b7ba27d0ee8eccd0ed8e0a00184cf4f421e0911d0a80e079cd6e54ab8f8827be8ee010d492120517fd8bd46eb38b9b7e5b724b52ec329682ed865c842908976d26e01530e6b87ca4bca6de78deec70604b53ca8cbc5ff3ef21735f817741c955b780e3147fcbc0050d4cb635a658ee4e99f533649d92c5150f4b6c28ebd40e086bc68f5aa5be0e65f8076729db5e722ac0eeb78d09bff110fb53d9a2055f9f66dd26ffdd0b93a27388a8ded261024985499df1563bac1e5c4a900cd5a01e71b8354ad52b38919d4fd61f6c7b6d71038ae1e0c7582f1406162c988ff433097e861c1068d74cec8431ef73616b865b4b495f21f0ad9c3f5f837b41575c20b171581f59092a9309a951f83941ed903d2ebf599d98546ad695467f5fb4062804a2020507178857fde3addfb93b463ff8d77d4a584259f83514294cfbaae7eb15a6a4afc0ca1401e16986686d0472190dcd26c8c342d08f269cf9473be0228f71873dc01e12ffa49f99b03063708c35b9550e1e4030695c96a54e3b8e47377ab80dffbfd84addc8ba0b4a6163d0eb49c6819cc66da2fb6b921302c60a1e4821906e71ddb546f74a779785a0d3d4aabb413c79e588f149d1423ab784bf91a72cf5bf9c2352500de13e18bed425866ea233d5a4c8f6e40c6609dd999588d7948b5adb8db825cb631b28133b0a2bc9a4a239820145dff743d65ddda503b49acffa638f11b537cc064044365837f3d38c66cde0508b446060c9deeb0b5a82964527a5908d74b6419e669947fda6214485f605a02f40200ee985bd291db10ed77c429432d4a275a1f3f1ef6924c5972df7a6140d146122e403593ba7d760e043298f93d085e0f094305e5bf78987523bf86f8366a81d513b1d808419661f850e00145d77e4ee2f14c27c61ada2d910fcfbc2153769710b2a360f5e3df9d1bde8faf3e034a77cdc9d88b3e837cfa9a483fc3491f1bac4a74202563e67b9f9ff544ceb8596f4f9c99c7014914747033af438001b43599256b7ee9fa6532709404d7142b13b416a57518acb746fd5a1fcb2b3f2fe859b7b6fb3d5230c390e8fe4cdce04419f5f2844bc02d779d0664ee286fcd243e8d9aea68e08b35fa081e844c973abd886159b606f99f2672ec22ac6fd04b72a30726d3c0f70b36daf74953615778e758bbd40a8f85bd609ee189113795dd88dde91f593223d325072e4651df34ea9186c2c6d6b4c780d038d9f11a1ced366be522a227944fe06f4a276e93b5863fd11866bb034da931b6432f8205acc4df8ecdac23c31880cf8918bfa9d83f7e81169bae72a3c1f2c1879e5a667d6300108c106fc6abeac2caf50e17f0a89c7126ebbceb1d8d7a7e6a2f0ef971c698c8a054193b4342a32f906b9e083d54b716ff00e1a0231dc347fa9abf0b58bda2c9738c34d02ae0c52bc1cde7735e0bf44d343616f6251c167fd4cbb91d9e1648f891041bb85e71a8d8d4511305425e08ab2f191e00c2bffb36f46cb1d74a66eb26ba7817c4e0c7f6dd5a3cf00c34a015b885e92b7e89739a02a99c6a8ba9f5fdab8b11177d19c37eccfb9b3aff2cc2ce273c0679e93c9c19a638169a8aad839a9591b8968f771cecc1657f80ee721a7e7f579f74bc7e16318ab974ef148982ec14f699e41c78cbf1d5f504482e406f7d70ee22bc17d38de247afc61b55191cb7b9efc1e7d1c090e407967bf504686aaffc094d946e7ecffee0a88a6da68d145823696d464ec0213f5286bbb570e1d2a6aa0e77d2681e448ecaf5bb45cb994d246348528778c0d5c1344dee6a4c27273d520776c6bc9de4b9506a553ae20da63bc7965341c340a94c4be3cb3748ad936b07a0ea635b54e848aa21f8c59348f19188ace35ea7263e3ed53169af326b5f4e0f51de3c2e7a65d09394a12a5a2bffcb54e86e42e33584a0ec337d2d5389e6d2ddff951719f16583ac3488919fed55228b5b7a9404d3a58c94dc322ea91eea1ad5531a29f0358e168be7d85bb38ad1fab9f20a96ab803f1d4cc1847c2877eaea54fc4f45b8170851af4693f5c13f78055af9cc0bdb6105b1b57cb6f461a6e851a24b6694beb8756874e7cf45f62e8557d657ee703686131fdf5ff2a1dc3a429a97f471d401420dda6108d9db47769ea78638dc24062b26c55e540e6aff93d8cbb579d3f0fa1c92d882bbdc38d0b98a374dde17e69d6888a78445786d2b9aaa1752a3533e6f40cb27b67ae2b4b90f465c1b5bca25b69df817d915cff102f7f00890998e9381b4f976297fe074f7e01e18b18b86ae571f4f91a2518c148856103d0f8b0f6477ff4bf485b7ec8abb69c2df63d20b5d659b9a3e67fd579de3ede5f051a4697b56c4deec81018e0979100a00d54d7aef0ac83c6b70b8e7e48053a09a80a31d79101f2a31b6d93c10162e6596657613bc6f8b95c54d3a71932293fdaf416163b548778aabf9dc074191f5418de36ae1f61bcb9546cde478adb8109cf4af65dc9aee5cb79dc9544f073b5f16578121e88e4cdd43e3df7540f81bb6f40f95b8e4e3f7840d7e75147f53741c5b82bb8751b5c19b00aa7efeb0e0913b5976309b6276656d5779500ea31efa3ff2cd80cff9920e90801dbe623053a69ba5e06a833e2243fb2cc30d846b8b9a402c5350e311076467862db407da3c9c2f2d60203852433c4bd8900c079c6e223e81d7d352dcc2a5213b97d850ff35384ed4ca805e4556a24de4446060c2ead6d58f6e9d34f300a184f3b41deab0c074c85e1952a389995960a8cff011d33200702ef572fee5f0ae94c0067523f68f9a0cf133860a9d2dbdc51f4209d5dc017077c688fabbf57888fdf42f882c0ab0607c0016d10d84e23b99e2112ea6402c389a0b46e6a9fc782b2d6a045f5dc0777f16397b53d07790a5452ee32a637b123783cc5f0951b4b054fd35c2eb2c18d10a5c6dfdde221c107e46f385924e44a70f16833fde1f0ba90c787d26c942a08f593cda8ac1f2940ae40c6af126884d87da45333c1936a7345d7ac08b171bff6b2f631be1dd34e41b24074008e99040aae626567b4e381eefabc4f35ce57464b7f8cc45e48b26914c037048e202cb15a8347eaae0264a83fbf4aa55bd6a2061c5e2c6ee1ff82bd884c59afb2d240e6fa8a082e11f94e941e0b8a9025b117c366b8820bd2e8072536dfffa9955ce61beb1e95cdc65158157f2b95803773f5163cfff5668182d54375c4d67da7531062573c06a7ce5645bfc8faa680552da069ac08fd9349bea04231c97455f20dd9b7dd695d4acaef1679ce72c4b0a6c2d9bf69da625230db06d170d27efa92faef27daad65bea5158b01827ec138dc16a1afc0cc79c1b32a5bab9f9f5c406468b1859dbde7f846bbcaa80d0d837f03a667780593ede54d8e50e2aaeb86ae935af867f63778ae5c7693efaa5b624b1bf07aa70d1e64f9c8716a0be745cf33e435b98835ef7fb89d6a484c89fdc838e0754432ecc43ea6f0573547cc7f7117d6341d5bbfc160f2a3f0319333cec4bc8bf250e4afbd7dde30147f72c8e2c81390e52adea589a19f890715d45088f3b9271a6bd96e700be276cc36ad80a409dac63e8024c4a958ec5055d1054d8d1411bf86fe1c69a4c1e73df88edf555f04337f564ad48ab40aeceb78ad004d1b1675bd444d41b07e3971832a98e855aac3b8d143209ad77057cbe1dc9b5e59ffb2c1f314ba9a2de26d662bb6eeda253c1ce34bc77aa4724a6c2e301dca222d5175fc865944b8fc8f217fad83c344b2615f71b1aade189b7ecfb2d5e2aa9ce8fabfe3dd461b86789cfe588c3e9854f68eca9ba440d4c417ff8798f7aa61259bafcca2a07960c17ec9bc2865bc9488fbc9c4774a48f91caf9018716884c2a88da32b7ac947f3130db6f21f10763e72457342c44b24f65a931123e49314966e6d8531fde1e72b765e324e00e83b712a94878d82da53ccc65cb65abae4db74766cca4965b169449c82f11739ebd2125952a73dc6e3006cf9a772d3d3e18b8dadeadfef29e5971ab18d0cbfddd4f39ee3df4dc5abd1a460385f464cffc3db3f1814ea2bfb2cc65a5c9acdd7d94db71f1023307d5a14037712d634893cbd7175b6d5ccbc7110ec3127ac6fddb5edd060fbeca1a768095f1122215adaec6ec3fc91b6771206348b6a47f3fed1008edcb31a6e66f552ddcd6df633dd5aa36e17401bd3b7c7a7b246ef959191c13ac2525501c5f7ef300b51fefe7f65c103e32f64a1967e48c71eb1c1ffaf9d756500b8666c941352bfd4c2afea4b86654f95a366e8cda8be5eb5c5cc0479f70bec55fd1f7eb33db816339b706166ddebeb6b3088fa275dc06df71e85b88a9b5c4a11192240f5dee2209acec5045ee3e4bb291d6546281663c9b933e41cb7245104e761fe568fb2f27f0f1075c03a2eac49e5eac7ee6cd307ecc63c7dcea96b28c2ccf989bfbc1ec5f139adea1e06f2b9272e1fbd6d9e37413de01320e1b7981bc7344c50cb16da003cc85bc0bbdbb75cc82e9ad1ad17021664ac56a0c1a05acc5d1607ac523c792fe34a552641b84ac9b2dc293b0d1a2128e86798679bd8a143865a5cf26657ef9a126f2dea61dffdc0f1588c7583523bf3768a4f09fb8da0e56f86a7731703f5f0fa71fcca5c7d7f504b48aa544f6653f73005f04927874adef18e2ef85c779843639e8a89e404008f0396b723ba2d7fdf5990945cee2a230550a7ffb984c4ebd50bb6f03b3548a30cc4ced3c1b0e42059ac688ee2d3bb5102f432688fabba6adbaeeeaf8e772eda09e4187ecf6bdbc1b0d4673a86d4f2882e958456145b76f955e13f9202da8403260d9d4070f68a0684765b7e496c0f1d2ca5f941790f14dcfd243d4d0dc8538a6cfd52c2f93aaa0603e5d3e20c4dc89b9430bbcc7eb0fbdcaee7090d8f0008ec5a9038561fc13c67745caaa5b2c00e8f23166afc3a5e3d977b3decdeaa3ecf62dd00f7d012c7331461aafea05496d1bcb3adc2b8886124faa3fcd69b722b56688c533383382a8e16fc2586db44be5a4e80de27fcc5c3b65ba5d4fd73e67d04e2ee4c09ce49cb143e40f5a98d1f1b76c53b5155ecb8e8b11db0eaaa8e92db54ec26e97f0ca14f020db3f4bd77efebd2be080d7c354056c336e02d6e17792e5920a0989798505d5378c99073bab4076f3ac65fe237fc83a894d8e36fd79cecb1dd7399c60d503cb936664c00c54a8c75e14e3726c08165d56d261e442183a850f3d856c25f88a12578a5b657226ac4eda48e545e511889ec9d8513f549a2467c75e47a1b82baea8402c9742486dc396c30af268ac116dce00159ae0994c3b8b3c8b652362769d9957fd55c500cbf61d7eb29124d479b29a133502905bf5c304d2d85e248", 0x1000, 0xfffffffffffffff8)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
request_key(&(0x7f0000001240)='blacklist\x00', &(0x7f0000001280)={'syz', 0x0}, &(0x7f00000012c0)='keyring\x00', r3)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000080)='encrypted\x00', &(0x7f00000000c0)='user\x00')

19:20:27 executing program 3:
request_key(&(0x7f0000000000)='pkcs7_test\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000180)='\x00\x04\x00\x00iKg\x00B\tfRo\xbek\xcch\x86\x8d\xce;\x95f\xa9Rq\xf9\x1dU\xc7\x01\xbe\xd8:(.\xd3\xa2\xd8+\xde\x18\x8d\xd8\xea\xf4\x18\xea\xe2\xdb~qZ\xb3\x80\xdb\x13-9y\x985\xc6\a\xbf\xa0\x03{\x9ep\v\xcb\xc9\x81\x1f\f\xb0\x00%\xba\xab\x8a\x80\'\x00\x043\xc4\x13\x02\x00\xe3\xa8\x96\xf5K\x97\x13A\xcc\f\xed\xfb`;}i\xfeu\xed\x8f0\xfd\x9d\'x;\x12x\xe5\x1a]\xdc\xa6\xfbH\xc8$\xb7\xc2Yp5\xaaC\x1b\xcb\f\xeb\x8a\x01\x9e\xbf\x87(\x8dp\xfe\xf3QQ\xe2\xe4D\xaf\vk@\aI2\xe0@l\x88\x9c\x99\xb1\x0e\xacF\xa3)\xf3\xf6\x16\xb8A\x94\xfc\xa4x\xf81\xbe\xfe\xbd\x8d\x87\xf1\xabN\x94G\xe0\x8fn\t\x18\xec%L\xb3.\xee\x02x\xbf\"$\x9c\xb9\xb5\x9cf7:\xc8_\xe4\x13\xaf\xf4r+\xd1%\xd6\x86\xad]\xc7\xdc\xd8\x8e\xdfN\x9fNL)e\xa1~\x1e\x8b&\n\x87\xf0\x85\xbc\x05\xce\x90Fo\xa5\xa4\x10\xb9\xb7E\xe5s\xb6\xb0i\xed\x8e', 0xfffffffffffffffb)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = request_key(&(0x7f0000000080)='asymmetric\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)='pkcs7_test\x00', r0)
keyctl$get_security(0x11, r1, &(0x7f0000000140)=""/48, 0x30)

19:20:27 executing program 2:
r0 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f0000000000)={'syz', 0x1}, &(0x7f0000000180)='h', 0x1, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$unlink(0x9, r2, r0)

19:20:27 executing program 1:
keyctl$session_to_parent(0x12)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$invalidate(0x15, r0)
keyctl$get_security(0x7, r0, 0x0, 0x0)
add_key(&(0x7f00000000c0)='trusted\x00', &(0x7f0000000100)={'syz', 0x1}, &(0x7f0000000480)="61c3ec29c8ca812d9181eb974d17858ad73df3fa6a68d58eadd99a74fa17f13a68e42aa1d21bb859a6b78efbeb78f586cc81d6b9bb4df454e06ca7803d92f244b388c7a7fc02db01e7f82a87ba659234f0af639d513e5d2a26e3c40fa1ed78d232a85ec11b5ba2869738496075da651bd9c7a3aae5e7e1bef32913c03d9acca08923b2c1343f110dd4ad239d3f43020075b1e135c174914ad0d9dfca24d2c3fa80d84f1a6bcd8ae8671df2d787fc18d9bbe578458a14f7db538de4898a3d54eb07610e68881cfd22276201bacf5d705047cc855c581ecb70511ca29b711d1e0aaa866415287662518d17bf", 0xeb, r0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key(&(0x7f0000000180)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000380)="d74bfae54864d43b12ee98c06776ccfacbfb4c4d95f2987b65fa5e918c9db0cdffc45a3ebfc63ef84f13b2bd9cc6bc164d785570d38e0ed7f8207798386222d788402a6111709363eb837fe2af01a393a16d3bd17f9b136bd7753a366acd64e231e5c2d983aac628062b85764658efdbfa550b4759f80d5463e90eacf74329856810eafe9d135b28daf81bb4abd5087a77ff05bf79daf1c00dafa27946a90f99c32f13b38695255d00afbe8569d5f27c", 0xb0, 0xffffffffffffffff)
keyctl$search(0xa, r2, &(0x7f0000000080)='big_key\x00', &(0x7f0000000140)={'syz', 0x2}, r4)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, 0x0, 0x1)
keyctl$search(0xa, 0x0, &(0x7f0000000280)='pkcs7_test\x00', &(0x7f00000002c0)={'syz', 0x3}, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key(&(0x7f0000000140)='blacklist\x00', &(0x7f0000000200)={'syz', 0x3}, &(0x7f0000000240)="191bda8a5a76c1a74abe7b8e28a14c55", 0x10, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='ceph\x00', &(0x7f0000000100)=@keyring={'key_or_keyring:'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r5, 0x1)
keyctl$restrict_keyring(0x1d, r3, 0x0, 0x0)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$get_security(0x11, 0x0, &(0x7f0000000540)=""/4096, 0x1000)
keyctl$get_security(0x11, r6, 0x0, 0x0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$search(0xa, r0, &(0x7f0000000440)='asymmetric\x00', &(0x7f0000000480)={'syz', 0x2}, 0x0)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r0)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$set_timeout(0xf, r2, 0x7)
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000000c0)="00008549053593e1c84f897b0c3b90c33d58cdf0b1f586756c41af55692ce273180a2837a9c0ee050321a8786375acfc49e01f809d39c95ce36528f5f89f5d5ae6f36774608462488870ecfc6ebd4f6d3fe414ce3a2f5225661a56f2c36f68caaa231834872bcb3abfa93445dd44ccf8d278412e8e36feb8a63e63b50a3d25369881cee97755279ac0af7ff7dbf5dc54e3c7eb74eb503ae908775741bad848a7748b7f7fb00c7cbfa097ddec1ffa764b4584b0b502bdd01f778c9bcd12b874341506e4ba7a", 0xc5, r0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000200)='keyring\x00', &(0x7f0000000240)=@secondary='builtin_and_secondary_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$restrict_keyring(0x1d, r3, &(0x7f0000000080)='syzkaller\x00', &(0x7f0000000100)='use\x84\x00o\xc2S\xbc\xd7\f\x11-\x9a\x01\xdaO\xe2\xc1{p.v\xa5\x1e\x13\xb1\xfa|\x84]?\x04\x8e>\xae\xc0\x04\\\x86Z\x11\xa1YQ\xdb\xe9A?1\xd3\xa6:\x9e\x1ee\xdd\x992\xf9\x14\x82\xf6)\xdc\xd0/\xb2B\x99\x91\x91\x1c\x83\x10\xeeW\xac\xef\xa5\x8bO\n\f\xd8\x03\xb7\xd1Q\xd18\xffvQ3\xc0\xd0\xf5\xc7a\x8e\x99g\xf5.\xe2A?\x11I\xe6\x0e\x1b\t>\xc5j\xe33k\xee\xa6\xe5\x80\x94\x92\xda\xb1V\xd6\xe9\xf1C\x945\xbbo\xcd\x00\x00\x00\x00\x00\x00\x00\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
r7 = request_key(&(0x7f0000000280)='id_legacy\x00', &(0x7f00000002c0)={'syz', 0x1}, &(0x7f0000000300)='self\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r7, &(0x7f0000000340)='id_legacy\x00', &(0x7f0000000380)=@builtin='builtin_trusted\x00')

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$invalidate(0x15, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r2, 0x1)
r3 = request_key(&(0x7f00000000c0)='.request_key_auth\x00', &(0x7f0000000100)={'syz', 0x3}, &(0x7f0000000140)='GPL[^:$\x00', r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r4, @ANYRESOCT=r4, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR=&(0x7f00000003c0)=ANY=[@ANYBLOB="9d90c16bfd7fc929b14fb6d2348e4b649471f615b94bca99af895082d435c82a84c8ed8eaeed0e74aafaa7707cd35a55e80b27f661cdeadca34d0b7fc3ef82fe0ff03e3d64f84768d5ad166e69", @ANYRESDEC=0x0]], 0x5, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r4, 0x199a2019)
r5 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r4)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r6)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r6, ':chain\x00'})
keyctl$link(0x8, r3, r6)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000180)='syzkaller\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000200)='\xd1\xed\x02\xcd\xa5V\xac\xe6\x00\x00\x00\x00\x00\x00\x00\x00\x89\xc6@G\xee_4\xad\xce\xf3{l\x188\"\xe1\xacwv]\xf6\xd3l:\x96\xf0\x0f|\xa5{g\xd5$U\xaf#\x84w\xc4\x84\xbf\x06\x03\xec\x14\x88R/\x14\x89=+\xed\xb5d\x9f\xdcL\xbc\xefu\xd0\xeb@\xb1\x188?\x8e\xc7e/\xferX\x8e\x9d\t\xd2\x04\xe5\xc55\"[\'\xf1\x84\xe00\r\xe3\xa6\xa2\x86\xe2\x9d\xb1\xf4\x86S%\x85\xb1X\x82|\x1c', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000280)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$instantiate_iov(0x14, r2, &(0x7f0000000000), 0x0, r5)

19:20:27 executing program 1:
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r1, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f00000002c0)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='id_legacy\x00', &(0x7f0000000340)=@secondary='builtin_and_secondary_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@secondary='builtin_and_secondary_trusted\x00')
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$negate(0xd, r1, 0x6, r4)
r5 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_MOVE(0x1e, r5, r6, 0x0, 0x0)

[   15.444988] dns_resolver: Unsupported server list version (133)
19:20:27 executing program 3:
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000000)=""/102367, 0xfffffffffffffe67)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$user(&(0x7f0000019000)='user\x00', &(0x7f0000019040)={'syz', 0x0}, &(0x7f0000019080)="f810b12e10ee0baa8f097b86959f99ebac6de6ecb89af8647bc22eaaf3c4faa26e0df5567d15025e30cbaf6a1d8cde68ba36c352ed65ca59f8a6e86eba9ad2054357a8f67ea6a1db01cef2c549dca2e2e18f8ce810f51f60b4fe6b6ee7a58a8eac57add960edbc1aa8e2536ea09f9d002ccb71ac7d3c26701dfd2646a1824ba4b1f5717f672a7ecb0c11788efdcd7125823d78c0201b7762965d997e816d7ac34e431245bfc6433968358cbc622a4574d02c13a9e18ac4436706e2eea456ca967b64372552bdf09a0e3be177a90e83da8dd20e978354967cd1e895022b158a370cdd3a832f3c3c728d62fd3d81670e6aa782322999dd6f910fabf908", 0xfc, r1)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f0000000240)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r3, 0x1)
keyctl$update(0x2, r3, &(0x7f0000000000)="f12e48e322dda6cc19a8e3fd8911c4b8f007a53bd4cbdd4072342c622a755c857eaa6ada852f95375a859ab5f6d220fb09215340fe10d663bf5e60c33dda20c7b428aa4950143b23cd11836e6da8db1b089eacaadd", 0x55)
add_key$keyring(&(0x7f00000004c0)='keyring\x00', &(0x7f0000000580)={'syz', 0x1}, 0x0, 0x0, r3)
add_key$user(0x0, 0x0, &(0x7f0000000380)="f683652e8216e52240eda8f1ffd7e794a988abf3e573f44ce0845a59d82eada15dde8c37ae15b3d70a659e81f4c271d380d445524ef63d0eb35db543c4d2e5779721282817da3f4096655a49ecc8ae0f7ebfd2cc62b8c9098e4ebe8075231e7d290c76ccd67c31148b3679651b59672d4393f07d467bbbf0a7d3ab5ae3aebc1febf7200a26d487ba09d18a1adb6eaea52431041b5943dc18a35a52df69968231d530f27ed53cd8c0c5c7fbcfd7a9808ae177784a68823cbf3c328df146383fbcc05f927355003cea06dce4ae23", 0xcd, 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000480)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e0f070c816b34e5cb0994e25182f14438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89f3ce74aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e865846b03926c179b7dc7601d725caad81ca1b55fab93aa3e4897a2bec0fd8efff4daf410c935a9a887", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r1 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_MOVE(0x1e, r0, r0, r1, 0x1)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
request_key(&(0x7f0000000000)='asymmetric\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, r0)

19:20:27 executing program 3:
keyctl$set_reqkey_keyring(0xe, 0x3)
keyctl$join(0x1, 0x0)
request_key(&(0x7f00000008c0)='asymmetric\x00', &(0x7f0000000900)={'syz', 0x3}, &(0x7f0000000940)='\x00'/12, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$describe(0x6, r2, &(0x7f0000000000)=""/239, 0xef)

19:20:27 executing program 1:
keyctl$session_to_parent(0x12)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132227d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e5797a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key(&(0x7f0000000080)='.request_key_auth\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000100)="33cb2aed68f8de0c40f6ef97be1fb1749f3fd6a7ce4199ef0df89b3fc16f3424f39b7078e42bcd76ee77214f2112a0020275858513233be522cb2cd217c1cd86ccfb6d1876560f1ed52e938448ca554daa06f69e9bbd0cbd773913d504bb1bc650662cd4a93d634ccce4644156f7e0f53a791e3d", 0x74, 0xfffffffffffffffd)
keyctl$search(0xa, r1, &(0x7f0000000000)='asymmetric\x00', &(0x7f0000000040)={'syz', 0x2}, r3)

19:20:27 executing program 2:
add_key(&(0x7f0000000040)='asymmetric\x00', 0x0, &(0x7f0000000000)="02185bf7128c2c6c0d00", 0xa, 0xfffffffffffffffd)

19:20:27 executing program 0:
r0 = add_key$user(&(0x7f0000000ec0)='user\x00', &(0x7f0000000f00)={'syz', 0x2}, &(0x7f0000000f40)='\f', 0x1, 0xffffffffffffffff)
keyctl$get_security(0x11, r0, &(0x7f0000001000)=""/241, 0xf1)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_MOVE(0x1e, r1, r0, r0, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f00000006c0)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYRESDEC=0x0], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, 0x0, 0x1)
keyctl$dh_compute(0x17, &(0x7f0000000600), &(0x7f0000000a00)=""/4096, 0x1000, &(0x7f0000000680)={&(0x7f0000000640)={'sha256-avx\x00'}})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='user\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
r5 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, r4)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000100)={r5, 0xfc, 0xed}, &(0x7f00000007c0)=ANY=[@ANYBLOB="656e633d706b637331206861d29fdf9ce9dc98542d76942f8773683d766d000000000000000000000000000000000000227500000000e1ff00000000000000000051f558022ff0521740000000000000006684cfa76c195f05ee9fa847fcc0ba055a42461527b96513f9f65208bdb5c155012db14466690111ce1e381786e09664e21452af300eaaa9017f35b43134c2414ce575594f1a5b67b74cc543cad964ea8feecb781d95604eeeacb07a83c3474b0612f73eaab89142cb765da39d5dd9c98a4791a22e3cbc1b92455eaec69dc735b44a3c0a3ddf4a872689310540360e60e6f486f841418fa51a8bf88e0c2944d7944403655f649f698c0076b6e9f446c02e020e1db888693cd778cdf52710b681ec8d372fe491751e00221ac37487d1774a093145a267e9859346c1dd64b78a859ce9531bb9a560506f74eaa8fa787f70c8e84161d58ec6125f0df315e0674ac54b4906cbe521d3eca1a0b774cf70dc980405df26f4b125692e7e7d78a65b3f6b02f4e4c5ab328e72b44d1eec9a6f822e131fc10e47f7f53255cede9f4fa8366fc4d971b315022c99105c2ae9164de10590fbbd8d97a4904b4fce1b520000005c0bfa49784b709764e4158192293ef2d5e3a3744a11de86f18d26c3ec816ccabb0d841461381e12b84cd8ad73e63ac5083e599d9d74426f04d263ea692407b03dcd0ed5c2f496c28da1d1bbc2c4f605b51fc2d128d2e803ecaf748bfe2e79"], &(0x7f0000000380)="5f80c91d82acc7be012b64ad2e03b2a44c58f4c5ee1dac4f54358f09ef2bffe31e6550393f912adbef487c59042a1bfb6a9c62b47225c9233d67cbee8dc2927d62bc9aae95bc0c5dbb56436f6c2302c0e7d33216cd344781d8efc2a1a8302dcd12a35db5d9e088096dd6c52acd7f4eea6b537d8e659a712604b8c8217c16e62443611f1093d5c069c3ef6277337e2c108f0a869984a2e7002ff48ee02f8d6da1b4a0fa0183e10b6d0acba7551f4cb21d2348133bef8d733737d82da22b4373b28ec46410b90668a927c3725eaac8fdc33c7b2e1bc8c4462e69d931013325b5a18302d615b7e02c018220f16bc2eaa85b31688335b9d9b9b8cdc4d97a", &(0x7f0000000480)=""/237)
keyctl$revoke(0x3, r4)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$invalidate(0x15, r4)
keyctl$KEYCTL_MOVE(0x1e, r0, r1, 0x0, 0x0)

19:20:27 executing program 2:
r0 = add_key(&(0x7f0000000000)='id_resolver\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='`', 0x1, 0xfffffffffffffffd)
add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x3}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000380)={0x0, 0xbe, 0xcc}, &(0x7f0000000700)=ANY=[@ANYBLOB="656e633d72617720686173683d020000000000000000fb9636d4f448619fd29607f4949c13000000000000000000000000000000000000000000007fecff22000000000000971b61b9c9ec057857e55104248506206d387d0bbac2710ac10da2ea3452973271e7870fac4e8925b8745a3e5bf068df28740aca2be0b4e4d91fc9096db0d28f010ec91dc1389e2f1852196c02552e428fcc296d4fa3f7b5906a5f3429e7fe6fccf8aa6a58fe408173eca7cfaeb5f76258d9e1269286ef22e13393a4ab754fbf3fcabc961ec600"/224], &(0x7f0000000540)="4f9dead734249615c778995f6829650fa733fe33232c67a1d5e305c689eeb3a0a517804f3e4ed3d3269223edd2e663436b88f27d4c13702ed8dec5d0d9c61530c171cb7baf1aeb372e5130341f5c2246c941767baf2a09362d9f9230a5cf54743c52c62396d5cbcac01ff9dfafc4d6e3ffee7394b2c1cc5b5be914bb54cde4c057d5cbeae7bc035e3d040b37b9b95f7a47dd09f4a06d0647f829f1460bd5af067e32923f15e092ccb0367e8c3c7d3073b6b03521dc462867f97a905f8093", &(0x7f0000000600)=""/204)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r7 = request_key(&(0x7f0000000480)='user\x00', &(0x7f00000004c0)={'syz', 0x2}, &(0x7f0000000200)='tr5s\x00\x00\x00\x00\x1b2\'\xdbo\\\xa0h\xc8\xa4\x1eo\xc20\xb0\x82t\xbaQ\xf3p\xe4x\x96\x84^\xa6\xf1\xc9CP~:\xbc\x06\x9f\xa0\xa7#\x1c\xdd\xb1\xe4M89\xf7\t\xc6\xe1\xdc\xba!\xf3X\xd1@\xaa\x0fzt?\xf0\xc6\xc2', r5)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r6, r7, 0x1)
keyctl$reject(0x13, r4, 0x0, 0x4, r6)
keyctl$revoke(0x3, r0)

19:20:27 executing program 3:
r0 = request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f00000002c0)=':bde\x83wlan\xfb\xffboxnet0& ', 0xfffffffffffffffe)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f0000000600)={'syz', 0x3}, &(0x7f0000000640)="e3b4c971d7994e3abbb742f5ca31c5ad0fd8c861335345212df9ac2ffa309f4f2c5f0463d47802664cf3fad2a7be6ade0c83d7c392255b5b09f59c1d3bf7c9222525a09acd8c3d542bba277a4261b119df5aef80f877245947fbff8be2b61f21542cd759f30ef8b466472fa491a9fef1940744d8f0ac9371a86fb4cd4ffb542a6a037b4241337c72edb0063ca075102f22bc39a6729996f0f8b097345484c8259d494b0698ac7a7e516f5ffc9c49d996e526f1d8a5b108e2fe6740a3164b51eb58d01e", 0xc3, r5)
keyctl$instantiate_iov(0x14, r0, &(0x7f0000000540)=[{&(0x7f0000000000)="0d1fbc70d5b35d03750f5d4e469f82f329caf89bd007002b7eaaa4f6e96d20e09f7d9ea6dfcf526ad5f19bdb15da591534b0b6ae9cc724005a1fe0c4b122f7475f4100fcb2a0b95a06a4954e0adf4859373e68cf43", 0x55}, {&(0x7f0000000080)="352d41d05bcf796b5f3d14377d6ee1b5", 0x10}, {&(0x7f00000000c0)="3388827da9d4a9217efc78a685076f192a3b4f09c20baf7472", 0x19}, {&(0x7f0000000100)="d44b86d2a550850d3185b93cc076219184bac4eb5add2f6486ddb57b8c08ca81fef289e60f8de2b85f472148c96573baf76c2eb3889965a430e753344f5db0c02066583f0e8d97dd4e020d1514ec0236e8a1f9074a16ba806f327ea8c2c4be9f6249bb6e41e31aac52441e9c7d56bc208234e90ca27125c4bcc56645472c36a2c1d98f998dfea47c8dbcb0a8", 0x8c}, {&(0x7f00000001c0)="01953e74b5a8debf806166ae92386e10e7d593adbf8a787b98e90c382182feb73083bfcf0f9c8e88993df496d65d307ebd165a5d0722c91d589a0c311c64efec3da4ab3e31730d01e5e26e994e116980e23d11bbca43ee520fbb5a3b00", 0x5d}, {&(0x7f0000000300)="be847c24c51632839a6ec0e45296076d665986fdda573bad767e9bf69f214fc323325de9302ea92ad60dda50c1244b0f082fa2a7abaacd95266d2ec7151b3305e3569e5941eb799039c9b738b55b8a165e7f6247476291291a097448339e57fd1138dd732c13be75ed3574bf3132302ee2413486575548b66c7ba58d6ad89dcb54646cafa206aa60f4d78ddfbc3fd89025fa311cf71804512192ec376705a3ac16f3af859100c7aee33d0493ff0bbf182134443a38f185e205ffcb029d1d3436906da03cdf6aa36c88304770859ab41b6fd68c554c5ac1", 0xd7}, {&(0x7f0000000400)="438849e2b010b62e83d3a48d4e7e7266bac9a1f1184cefb3b3088d77128ff40eac66351e186aab61e7b5b1b3b10f32af39f9e1dfb3d342947517ffdaf08b98cf1f7692ee5d2b6ec17966c18c7933f4d5bf9cf351c2081e29d6f2383a0df1830d4c421f04f4a51f3d5de4770679460085aa42fe92", 0x74}, {&(0x7f0000000480)="ccd0b88cca6ef63a0d73d8b7b1d3309b66ef7c7282b29bec26b8e8bb6918e4d15dbeb0197c99cba673eeb080a854c2b29c051fe13485ad3c4930211a72a31eca47ed53be2fe963bf3cf8d5a821b293879228e5a5907ea88108e62086c4b564cd7c4cef941f97a4fde54b19a7ec0df600c22d4c844fac0652387d73c461dcd399d9290f7dc28550becd4ee4eddc56d59da4bf99f8be8086e4d5db88cf761953d28fbe1d61a332cb0c2f17628d284f1ae12e2768b06b3793f05bbd3f", 0xbb}], 0x8, r3)

19:20:27 executing program 1:
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key(&(0x7f0000000000)='.request_key_auth\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)="6012d9899ff70b2ac288d835e432576cb19484879dceadf91e7983b5162d9ea2ef39583a10cf667a2beb4c5ddbbaccab0ad4ae387ec7a4d3f45356f9ca069864537a35de1b09606a0752075ed15a9cd1c461b552843a8f21438a985fe7959cddf5aa1231", 0x64, r0)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a40b542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae0300000000000000c0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
request_key(&(0x7f0000000000)='id_legacy\x00', &(0x7f0000000980)={'syz', 0x2}, 0x0, r2)
keyctl$setperm(0x5, 0x0, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$setperm(0x5, r3, 0x2002000)

19:20:27 executing program 0:
r0 = request_key(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000180)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$KEYCTL_MOVE(0x1e, r0, r1, r0, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='trusted\x00', &(0x7f0000000240)=@builtin='builtin_trusted\x00')
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f00000003c0)='cifs.idmap\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r7 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r6, r7, 0x1)
request_key(&(0x7f0000000080)='dns_resolver\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000140)='\'\x00', r6)

19:20:27 executing program 1:
request_key(&(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000300)='B', 0x1, 0xffffffffffffffff)
keyctl$setperm(0x5, r0, 0x0)
keyctl$get_security(0x11, r0, 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$KEYCTL_PKEY_QUERY(0x18, r2, 0x0, &(0x7f0000000140)='builtin_trusted\x00', &(0x7f0000000180))
request_key(&(0x7f0000000080)='trusted\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000100)='self\x00', r3)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffd)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x2}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
add_key(&(0x7f00000001c0)='id_resolver\x00', &(0x7f0000000200)={'syz', 0x3}, &(0x7f0000000000)="891c7f9e2dc062b496db5c8ca560d04e04595a81cf1f8e07c93b83464c44afb55257a9592c58eb39616e44345bf66fa987c166079b88365b32d1f7a6011018403170e2c5f717ddeaf8b7caa8bb3c34f8806fb31a526b04e2e102d26a5d06abb6c87bc286fe20bca9d6cd1cd3795ff210aa135eeb2269313acdb2986fc8b4f50a510052796bd4e752c2fdaab0eb2af64f69afb10cd65670cd42", 0x99, r2)

19:20:27 executing program 0:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000002c0)='\x00 ', 0x2, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
keyctl$unlink(0x9, r0, r1)

19:20:27 executing program 2:
add_key(0x0, 0x0, &(0x7f0000000380)="c3543993f40dd2514632455d209a097a1a0edd08e790ffc9c6c4a7ef210ebeab632904be1875c8ead727775629e2f664662f57c3e85275b895c45070b322a45cd794cdf381b11d4d33d75679e9e40d5640c459fa0af8dbbae323", 0x5a, 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
request_key(&(0x7f0000000000)='ceph\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)='#em1}md5sumvmnet0,/{\x00', r0)

19:20:27 executing program 0:
keyctl$set_reqkey_keyring(0xe, 0x7)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
request_key(&(0x7f0000000000)='cifs.idmap\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='H\x1bvboxnet0selinuxlomd5sum\x00', r0)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='logon\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r3, 0x1)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000000)={r2, 0x4, 0xa}, &(0x7f0000000040)={'enc=', 'pkcs1', ' hash=', {'sm3-ce\x00'}}, &(0x7f00000000c0)="8001bf7a", &(0x7f0000000100)=""/10)
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000002c0)='\x00 ', 0x4, 0xffffffffffffffff)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
request_key(&(0x7f0000000000)='rxrpc_s\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000100)='key_or_keyring:-p\xa7\x8f\xd2a\xb2?\xbc\x11\v)\xd9\x8c\xe2\xb8\xb0e\x98j\xff\xf1\x92\xd6\'\xfd<[\xf2o\xc1\xc7\xf7\xa5T\xe2\x93\xfd\xfc\x13%\xe5M\xd1JF\xf7\x17', r1)
keyctl$restrict_keyring(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000000c0)='key_or_keyring:-p\xa7\x8f\xd2a\xb2?\xbc\x11\v)\xd9\x8c\xe2\xb8\xb0e\x98j\xff\xf1\x92\xd6\'\xfd<[\xf2o\xc1\xc7\xf7\xa5T\xe2\x93\xfd\xfc\x13%\xe5M\xd1JF\xf7\x17')

19:20:27 executing program 1:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x3}, 0x0, 0x0, r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$KEYCTL_PKEY_QUERY(0x18, r5, 0x0, &(0x7f00000000c0)='\\]ppp0}vmnet0\x00', &(0x7f0000000100))
keyctl$reject(0x2, r0, 0x7fffff, 0x8, 0x0)

[   15.570697] dns_resolver: Unsupported content type (32)
19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$read(0xb, r0, &(0x7f0000000280)=""/93, 0x5d)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f00000003c0)='asymmetric\x00', &(0x7f0000000400)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r6 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, r3)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r6)

19:20:27 executing program 1:
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000002c0)='\x00 ', 0x2, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d519548de6dd26b7c820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f00000013c0)='dns_resolver\x00', &(0x7f0000000240)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000001380)='rxrpc\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$setperm(0x5, r4, 0x200)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key(&(0x7f0000000000)='id_legacy\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000380)="0a3cc4701c33c6219bccdd79991d180ba0fcc4a7d97a32281780885474f539a7c75c173afa863384acc06bbf2ab5110412367418829c66187c5723ab4e62e038a17eef37cf948038346e4e4c801dd610379f867ab272ed4be01dab9f9db9a026eafdc0c542c5fd8f2b389f186b8ffa342961b53c46f15ab912c0c6ddd676ea5240bab547f2bec2942284e11d857a76a980d0fd998fcab178b37fb8702b2d9ce93f085836d5f2c58febbd427a11fe8923a01ab700dafe2ddf76be3f271df6f245050036a965679e3c7991741d9a40039b803be80c7a62d1d0b5ced14ed898b5d732e3f293a955ad58857a10b79b5590b542d5789ca861433b14afd1b996b58ae2c074628dfd8aeb1e38b19c4ec5c0f5a7f61607f6597186ab8196a7436d39f65d7faf7eb287922f948d46ffb495f73ee74169997f5eb444a0052140baa34ab25ffca1e08bd604bd4ca59d2a3764c1df5dff2a53cfd54bda2820fa04782237078420ddefdc0b9523c2c66fd0e6c5f31d4ed36abbd8fafeec5a10cc09e7c8e751738aae2b878ea4bc30c585818f195aff00ba4f02d6f56edd0c0cc4c42441c56b212dcb90df0a740ff2216d810bdd470408d06cfccc4bfbf291dacc73920c4095277d0db34e55f23f5ea16844ae19c2dab6ea960fd6627a99e0e8a04ca268872728dd293f7e3594de8cf9a81a51205b0acaeba484f9288afcfe483d17c2627bf82c554e7d0ddcad1facc6e0813f0d5173c74dd45cd3e50c026e73c53149c691617b9aa77d7b193d204516a978e4a3e1672687eb1ef91acdd7e19b18816645e656a4f018ee8351f349b1690b58c86822d14919f4fd4f1bf42b1e291be8071a2237ea9ac49b70039c6d76f5fe739e963a43a780e484c8563dbd3a434ec345dbff9ae4aaeba4b55f2d83981a7c8b349ddaec63a9ffc6ad23f5bc3988e830cff2fa92a17faa87d26b75a7117b5b11454217d5a2c1b3464351f7bfef0fcd0c1fc47e6dee0590323f91488b1dc97ae4de220774bf893349fa40b0ac511e68451a2403141a719fde0195250ebb64cabdd21cdf30a7f9dbc3cf49e60c910bb219457ebc454ad244da59ecee1ae7bc8ab828c1eb9e98470c4e580c098d956b05089f35009679c8847dc13a83487c00e8e2cb8ac92ce1b682b4f8deeb0dd614e8f7507d59b899097a7fc74fc8255d5baccf1cbcd59c987969b597e5952e5d613bc4ee7ef20591bd7c82fada061264d0c56aadc810ca2d00a2baf5e18948ef0d9c41e0d88c98c357ff970c5b86d24b814202593c19e6dc4e436a036aa4ce89b95b362e7f503ae8058a8b9db2e04162d6b31f9590d15892ccd2795d1d469ec80c7fd3347d499cf57fb18f52d875ba855ee0b3d212e2cd4159c0692c3e7da29cead262adc6737aff6db4bad89efce171d79ff85f752404cf6a7376d47072311b8029eefe9788005d7389bbce4358d82efe8cbdf68d83c415b6cf102555de7ff5b3301dc56957121ca6fb5ba44b4b672efeafb421610fb6810fd85ae03bd464311c4d8b4b53b1f20a0bf501e98cbc77077f2f3917ac8723a43e8d73a7524bc76e9b736e3298b502f2e7f77691440542f53ee27ad23ff2ba5365194f6807dd758629020f303e2a8b64d57e1dd43202cf5e998581e5c13fb21faf75f8b2da33686d6303a9484092bed7f53dc7bbf6b455379411239e51509a53dc03daa691ddff6b7ebfbb3ab7c8bcf35667427df98bbc93c67f1d696fc1f11dda047ae68f96affdd422258ed1adc6772cfd76c85ac115bd187506ff88b2d624ff3462decd5b356a59076eea5908c68379f145e24a1884ad76926e31166d2ac210b9cc0cc50348e8fb0bac8275fa72caa6e90fa26de0fc486f980f3fcdde169c4ff0f59b54f79d859643cad925762a2721eedaf0054a8fc9fbda1fa72a8358ebe5cfc44bcf994e82b99874b8d4f1d1f6e918e75f966c3383f8539b301d364e49ff354f829ad29badfb4781b0d3d66b83d7e3db89eb5059756e0cce99fa6a0c42e78976fbbf40d8e34690d6fe3e7ad9bb992f3c487a0091c4193320661ddc2b3740aad4ad512512b6725800a19156e257cf5ffeb5ada341d031e86c844b81f6bd95115d2406417bca2f0860f6f60784481c7111d66d62e23140d77b62a8b88a15bb9600e16d284acf184ea48650c29adbae8ad114bf0fbe0c1d799cffbbb29a9256f34e6328e8e0902c4ac7ec7ab363aa73a00ba5818089a7c9afddbe64423bcb8b0f164d200f7ce61bd146d5b247dd845009c89498366874248ea23ffe2945949b97c34a63376510f2ead9b7302be0cb75a09d07a4a8c74d0f768f013b990788c6f93d3c3e1561e6b3151905873053f4455ada9bce0100995caf68e3c089577b5b32c3175d508175c2fa58214aec741838e97203b8364758137fa88385621e17490dd68f94416e2d378865b81b1fcf122fb73c19b2931a5099ed2b40934ba948711fc7059222296bd24019abaed7e6cb3bb3e68f27d6a01450b0ee2135a82734bd1523eb09d5cf4535e91fbbf566907f528352f795c260dee13bedf5d6ea1677de893062f1be7a3dcbd9b454c778a5f1fa997048efe57ba6104ab336ad6cd03daeed879b3c317d5dc9ef3eae6c2bba68c901d8700e35cd945c22d1ce88886cdcb9b3e796f0cea0c27b9378fc47c4adbf85e1790d62e7e4dba3611bef255aedf18542ad630aec90c358bbf804fcae63ad71d59cab1d3b5dd17fc254e6e39ecca2e43bf52f926b8697dc26898d59eab179693522c861ed197d50e2a183a4a3d75ae7fd34429c06b800f088377d7556580730316d6dfbc7c56680d3b882ef6969ce487f39d6eb4e4016971a9dfe17fece802b4ca8b355eb989878a0da1316bb1ace54b2aea5d0ffbae6a426af2d9b0f64c063fa5e9eeb9b9ae97955503d98209ed02a2730a41ca779d237e2dd7e4cb842e6d7dc3ede06338fab26385d00d6bd353a0357be77896aafabae7040a93e31b4edafbfc3f4fd1e63be354551e666f64075ffc9e246985805e5e300a8229122641b668bc7a7a6afdabe3c189234aee25604b2d444a2f5437811256a4d96a38805619191e82fe393935972357a5c463879eebd8723bcba992279a2c598062ec1221dacadcf8e65fbe0ab257f6587b79f7e4d102c8085ffc6fe0b672999d1af856e4dfb8505d8ea6354c7777f8973167cdf1e016d6dac825dae797c99d840b3425eae28221a08d7ece79dc600fd5d886f792ab3ee640603d7615b92d0c124ff8bd452b7c7b567dc1857cd664daa348fba27adce3a89f2e059c8d171df0e6b5c6733ce886640e33737f712c0622271c9f601b4059fe2d000309f62ec3fe40cd8bd8871ede9e7e54d297eff5c9c91765265667203d3abcdcacd6498a85500464df67693f951c17808f837e621d0f67e0ca79a42a497eeb96621eca697f06d59ad54d4509d231d338770e9885bd9a1fb0273c6b34e182d246161f15d48b0e3e68801a042f096f831f2882e7e9b7394208f9a9ddcd09444c05c05bd5c3e9e7cad4b645f042e8a39e36ce4a2a16d8319bf2c9d76f48fa8e810c47a26ac8370848621792a50f49d188be7e02e2e3bd07fbcde7fe542e91e52ad735e83c4c44f8e57473ae8e35fd5b7c5f41d55b23d345466c8d7e6bb4feb09516e941848559dca1f8be8c157de3ba785baa5c049a42a61fed5c5367c4dc23d2c32784d8f2d5d613a7098772c01ae5238bc99c91702c653fbc8f28bdd239c8fb7e5081023260bc92d85b626ca6d6172966965b6deeef8929967ecc7a0ba2af5dd1f82cb6ec8ff4e43374f8d711fe375f4edf5cc12dff5f14316e28ed7a75c9aa79d361b98f89c83df2db7617673120d2b43c51f27a29a9749dcc8779f0cd3dc918af76d117f43952542f3b60467973bea6f37c4fa75d0d32b90a26811d9732d2f26e4f5c80cbb19bc4731fe088577d8cba358d499e1fdcccbbe9a67e8d8175ad3240959d1f3d4d7ae7d019c91efb9acb7a8540aa94429d745f7c687f910e05ab78cf329bddbd70603eb3624e14154c3f4b5c25c90c8df11e09c6a06c3c44ce72ae3691e3ce37d6a154133745f9f67ca15181a1514902bbaeaa9e9c22a1b65b5560f1ef45ce8c4eb53869c4442a4d8046bcf3dd57670d03f59e7ac64f404f75452f0323628bdfd64ee019aba4f07fb0e2d1517948bd1eb7018393803921001b376248c57b952c402c9009f547cc18e41e8d11c3678358a12d645932a644a1ee0d8f8a85dc77ca3e1e440525b70f1cd4be58ac1de8ee276c2a2ccdd365a9c5551a10b5bde5ceae22a807f64f30634f6a7b49f106d50a2adb61c300ee54d21b29c3a2c95b61d49c5e355cc5fdd587ed1494d5b5388f54588f467481bdd6c25347908bc66b04947c0d723aa56cab6844ac3c79b2f949640f59633a0612bb48a2964886fdc6ee0004c65325ac6bbfb61ddd7cf0a11975a0d6339499426755d7df1143d749bded9631e83022491cd22ffd22ba97464d032903c2ab32b6c58942dae2a7200e8852a143bf0cb41a9034330ac7c0ef8b07bdb531ffb39b437160711452840a562a7c2e93225e0b0b065044063397010eda45a7fa5bfcabb8c7c7718504626f0e13f5d83ffb8988c6c5d97c6bcb5493daf864cc00e3d48d007f3169be7ab6a67552fa78d31b9faf25a4e553d12493e97d86dbd51dc2641630d3c9b62cf9e45ebbba865ed268de3d39285595f2edddfff4cbc59b8e00fbf1d43ffea2b5b62d445c9640739daad375afe1f4504611ee8408160251a1beb67c51368a429b179e9ac90f7a1525ab2de659f6ab02b62f508e1437550ddcd1724cdc2ae9312bbb1fcd864e38b2ee411b74a31b865162aa8bd927e4423033a647ac8ac8add025a8ab79c9d21ac0a974016e94f4e99e9f1a2df355d784d0a251c8c35486cc89017d6607817ed5e58bd343d6c2896b66fdb5a405abb7637eda41dcfca73da806af6ba498e05498c1f6af8466700ce21501cbb1564c658b02dc3599f45f161628f1a0fa57b74d7434924fc3fe38a57fb11a914c082fce10193fe4af233f5ec5f57f1896ecaee91bf8254a527e0b789fd29a4b86f612233deeffffcd376fdf6cf784007d6875d1438fc99c54f1279b4f0b77641ec952358477dfc7d7a149159bc9a550229441edd4b07449b6accb81a9d9ad16519f919e1994e0876e2ed4aec8b63c79c219e9761bf16c022e483ab1a2d645c080d4f61592813234b5ad2289ede999032652342c78ce3db5d0fd193620e28c52225e6313462a1a0cae1781504d8c24d7911bba33d799a6f587653f043cea668e6e1711072fac29206c964e28614a78419cedc3995da5570a641609795da53959f2eae5f37dac94a1d23b3bf95fcd07a8fbbfee9f16ceb1e8e9a494934910e0b290856f74f2a63455db177fa92684039eaba2329bfca34b9defaa398fa2dc29162995c6e491065411e61b35d2fa24d70cba950a07fb7dea7988940d495bc8c2d8945850ea9d4473ae19657068f4fd763e1a842c5cbe67837f66fd462e697cfe4949901b2dc2e272d85ff7808537c6c381651d4a27fcec0dcec4a7572a44cba41a79c6e5bf01aa02580402883954589c7304dd6b4699303c15aa659f26da23fb87972e68367e1a7cf4323223a378cc0a1afcfb5ded386bc537f3080e2c62f3bb7565b5530f41a46b2942639018456895864bf45549ca1dfd34951fa1c489d3e4f41ab4c215c9915baeb6feeeb759735dd4c3ccbd00b41710960077301587eee7259c4187637fb9208aac4e2b612c5a9e56ca11f4456a7e89782cada0eb001", 0x1000, r1)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$KEYCTL_PKEY_QUERY(0x18, r2, 0x0, &(0x7f00000003c0)='key_or_keyring:', &(0x7f0000000400))
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$revoke(0x3, r1)
keyctl$reject(0x2, 0x0, 0x400000000000, 0x10000, 0x0)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000500)='keyring\x00', 0x0, 0x0, 0x0, 0xffffffffffffffff)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000080)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffa)
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f0000000140)={'syz', 0x2}, 0x0, 0x0, r0)
request_key(&(0x7f0000000040)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0xfffffffffffffffe)

19:20:27 executing program 1:
add_key(0x0, 0x0, &(0x7f0000000000)="c3543993f40dd2514632455d209a097a0800000000000000c6c4a7ef210ebeab632904be1875c8eaf8a24bac2375d514ac68e20e6cca7464662f57c3e85275b895c45070b322a45cd794cdf381b11d4d33d75679e9e40d5640c459fa0af8dbbae323", 0xfffffffffffffdb0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r0}, &(0x7f00000000c0)=ANY=[@ANYBLOB="656e633d72617720686173683d7368613232342d7373736533000000000000000000000000000000000000000000000000000000000000000000000000000000defffff901ffff00000097b500"], 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000140)={r2, 0x52, 0x34}, &(0x7f0000000480)={'enc=', 'pkcs1', ' hash=', {'tgr192\x00'}}, &(0x7f0000000500)="095fe7e04f0ec5cb90b7e4bad888506471567a4d48906e7624d73fd25eab227a397a85d8a3eceed7660ad161f1b82f72ef72631f14b43cff94a01fd8bce5072f76544fb8d4f3937ef567fec92309adc8f65e", &(0x7f0000000180)=""/52)
add_key$user(&(0x7f00000001c0)='user\x00', &(0x7f0000000200)={'syz', 0x3}, &(0x7f0000000380)="f683652e8216e52240eda8f1ffd7e794a988abf3e573f44ce0845a59d82eada15dde8c37ae15b3d70a659e81f4c271d380d445524ef63d0eb35db543c4d2e5779721282817da3f4096655a49ecc8ae0f7ebfd2cc62b8c9098e4ebe8075231e7d290c76ccd67c31148b3679651b59672d4393f07d467bbbf0a7d3ab5ae3aebc1febf7200a26d487ba09d18a1adb6eaea52431041b5943dc18a35a52df69968231d530f27ed53cd8c0c5c7fbcfd7a9808ae177784a68823cbf3c328df146383fbcc05f927355003cea06dce4ae23346405b62675e70cb1fc0cb2d6582e08f00c36ef6c72d036ce337a16f679bfbaa3fdd88796c7ff30", 0xf5, 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000280)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_MOVE(0x11, r0, r0, r0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r2 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, r1)
keyctl$reject(0x2, r2, 0x7e0ffd, 0x201, 0x0)
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)

19:20:27 executing program 2:
request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f0000000100)=':bdevwlan0vboxnet0&\x00', 0xfffffffffffffffe)
request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='wlan0nodevsecurity\x00', 0xfffffffffffffff8)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$link(0x8, r0, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x1}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$search(0xa, r3, &(0x7f00000001c0)='blacklist\x00', &(0x7f0000000200)={'syz', 0x0}, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$link(0x8, r2, r4)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
request_key(&(0x7f0000000300)='user\x00', &(0x7f0000000340)={'syz', 0x3}, &(0x7f0000000380)='\'vmnet1^#\'em1GPL],\x00', r0)
r1 = request_key(&(0x7f0000000080)='trusted\x00', &(0x7f00000000c0)={'syz', 0x0}, &(0x7f0000000100)='keyring\x00', 0xfffffffffffffff8)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f00000002c0)='keyring\x00', &(0x7f00000003c0)={'syz', 0x2}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r4 = add_key$user(&(0x7f0000000580)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000640)="66649e9b34a726f1197531631192283087a4eb7f5d6372db154934749f021965125619a95077c8b9960de6d4ac3c853990c105ba45882c0c1623c5a5bfb8de478a4ac511c31e156fe887757233c98db0d333fe485bdf93858911d3973752396fb23f605c1209b9ae93888f21b6dc6ce6e44b1e271f5b6dab6734038bcea4326e549b1c3a4158dbab91d148017ad2703c67c8ad70e6ad5cbcd0d6480098d72598be94f1c5083e14db9c40a3de9dc3c02ab9271b74070619dfd7fd17e42d9e9583bb0bb2d5744075e323583bc41622231ee714aa0e5ae20d833c213ab9621df43b2c05c513728fb59f94abc586a7f6b82da65c677bbf9d1f21cf3285689d04485e694f4786384a3fe295a916d56e7f4d64e07fa576ae8912109d8da770ae20ed", 0x11f, 0x0)
r5 = add_key$keyring(&(0x7f0000000440)='keyring\x00', &(0x7f0000000400)={'syz', 0x1}, 0x0, 0x0, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
keyctl$search(0xa, r5, &(0x7f0000000140)='encrypted\x00', &(0x7f0000000540)={'syz', 0x0}, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r6, 0x1)
keyctl$KEYCTL_MOVE(0x1e, r1, r0, r6, 0x0)

19:20:27 executing program 1:
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000002c0)='\x00 ', 0x4, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)="8c913bc41e36db49531a278124e2e376c92bd224b1862d82803798b5566f9a9f82411229c83baffd0ec44310536c320f57774537e92b8e16e10742a04bc2fdb6a5567448ba889504cea7d026fbdff763d9e647dd51fd84547efcdda3cc8189d77ab00a127f512f5bcda9f6f8dafada6c5b3d611f05e044cd72af985676560dcf99432a3246faba9b86ffa694e9102dac75f8d3c22d517e916cc6e41ba33cc8f52849348ffcd78b5bfad5ecc8865a1e946dbce56e183afe36eb0402cd34a91edd7faf275788d357cb8ebd3c63928c", 0xce, r1)
keyctl$set_timeout(0xf, r3, 0x800)

19:20:27 executing program 0:
keyctl$assume_authority(0x10, 0x0)
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$get_security(0x11, 0x0, &(0x7f0000000340)=""/165, 0xa5)
keyctl$invalidate(0x15, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f00000002c0)='\x00', 0xfffffffffffffffa)
request_key(&(0x7f0000000140)='id_legacy\x00', &(0x7f0000000180)={'syz', 0x2}, &(0x7f0000000400)='.request_key_auth\x00', r2)
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r3, 0x1)
request_key(0x0, 0x0, 0x0, r1)
r4 = add_key$keyring(0x0, &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000780)='blacklist\x00', 0x0, r4)
request_key(&(0x7f0000000440)='big_key\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000540)='-\x00=\xde\x8f\xc5y&\xca\xb1\xbf\x88\xec\x10)\xc37}\xe0\xaa$U-\xa28D|\xe8\x12\xa5\xff\xb1\x04\x002\x9ef\x97Q\xac\x8cJ\x87,/\xa5E~\xe1\x11\xbcm\xf7\xf8F\xf3\xc1\xbd=\x93\xfc\xb5\xb2s\xb3m\xbb\x1e\xb7\x03\x18\\p\xbf\x0e\bP\x9b\xbeX-\xa5\t\xd4\xed-9\xd1>H\x134O-\x0e-\\\xed\xaaB+!ES\x11\x04\xcf\xa1w~\xd7Zd\xb6B-\xb4-c`\x1btk;BG\x81\x85a\x88\x11\xb6\v\x00\x00\x00', 0x0)
request_key(&(0x7f0000000000)='trusted\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000300)='nodevem0nb\xe8f0\xe4<odev\x00', 0xfffffffffffffffb)

19:20:27 executing program 2:
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000140)="1081", 0x2, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000380)={'syz', 0x1}, &(0x7f00000003c0)="3015b51be11408da8b7ea83a348c421492d1a0388566045c695ed312dd3722818338c4336bb7cfb5d4c54719545723f4c997855ef4b35d24037aa3e5e5c6411c4b238b18dcc41776394fdb714a2d20ee0157fb699572cf0e6ef5df6cd6a4d9b2765f41fab2badd291c813b2c9265e65b0a0214601a0565cc4c628c4600afeec14d10ddf9026e076879a7b23120bc3f5890fa1a9d6cd6af7f3283cc94c3af778f1c9f4935d22a", 0xa6, 0x0)
keyctl$get_keyring_id(0x0, r3, 0x40)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000000240)={r5, 0x1000, 0x17}, &(0x7f0000000280)={'enc=', 'pkcs1', ' hash=', {'sha224-ce\x00'}}, &(0x7f0000000540)="29047de00918007f5f7a7b2ec2c3be4a059277164a07c5d867d4219ff305faa9c822317ee3d9b05c20e8805b8ee7553db4d6a082fdd9623b271b9b5fec07b069b0646ca1c26dc0915019eea5f06b9ce931bcce0ce6744c304820d04d6edf1798a18ce8e4204192746788e31c73867624308c57069bf23a3864eab29d507df382d22c348be781e24116f744743f5d67b398125646a573a9fe8dc8e9e3d2f80c0dc59b1a71cb3401495e62e05f9013533fd5cd5307873bbe53e0df1080043dc74ae8578a617750dde839e06230179978ba6c7e750478f7ffa7d7b7968c8ea68b202cb4151b92dc05123b29e59357ecffb9b57cb0420decc0781ee68860db21fa2712db627690720e963dd66410c4d280160242286a98c106f280f6bd7b458f5e048a3c0e4414b0dec329312f3e014eccb0dc6a87ac7c833eb2d578ca149139051d6787aa25df94a9d9da80b8e3e5ff511661dc13000e1547d4458b909a55bf6c1e4c1a57d399b52b198caaaed9296a63c8027ff45f0da6ed7e27cf87f9cd138056036d6a9b42133303b95db2713ebc6a3fced4ab342da5035c28e5cc25ed08a03c37f4532f47b585cf2ce4964e4c141c4a83f6026865c8a08ac6b7f7b907b40105c2a9597e22f1d702031b1c322155aae0548100bc4d9d2bc2fcace79a62900c1b60c0cc43d57b3cec4843cb12609656a3bbae3b45a0ff9c71b2e7fb0e6c0c858eea98aef1473feb70a96ff4c10a6135483afc8b05cec1c5e0738c8d591ac2c6e83ff1cb10aed849867bf044a83891c5b2fa6110c40db38166b6beca1426259f7763a6c1fa8428bf6fe889c27943b53ef341ad355f2a9a2adeac6c6d66fe4bba7b1bdfbd1d190f94a74fc0ba525e140971b1c431a1da5f8d93edad49a1de24132cea33fed838be030d67a72b15e02350352ca3f06875a44f5a1e55bd9e79ef251aa33a756da1ed375376178abd908af2d1f906003aa393e6cef0fd32042e64acbdd76cda22a9f83d0812a9d36b3f7ed8329219b0f4705d2a3bedb5b86cb014d77c0c880de73e30df41b9402127f7c943a42db70672b67e7ac9b532279d0b6ca31b3fd5200679a148fbd492468c21c04c5b5c3ea0352c0592cb4fb9eff9fed1ab1ea0c45e0255acaaffc0d6bca5f3937c3367b4f64307ad7f203e117cd24fc4b2f1660f7ca2a112c5bd909c52220026df55f414e9cfe745a0dd5670e99d9a3ddc51cfa324c5d2393168b5107c31387f62bcbe434955df1f01159d0c3bffe1bc1894adc0094551b922b7c51deb4bf0aad4f09672e07a5b7771d88631bbbc4fe540b8bdd7c9cffd1e7d2adad638a39ecb0687f7b73b8482e9c27cdf07b1e07cfca83eeb50d99af0cfac72789ed65b6f922daf3ccbcbe8c9977764d89aa2a17ec0d4dc9ffcb4f208a360e4999f27f7291a54a551b7bd3a8d418d082686660f2f97067b9881e64d283c4ea6ae4b8174b227b72711413d86cf1a2b0fb2cb4b4e4022c50e04b5bcc227040896e76bec114ea8b100a0a081aca0816ea6aca8701f36ffafddf333f7cbbf449ac8640924dc68a6686d9fa1551ca23e8377a48baabe2f85b4c9eda205310ed2b5494d4a31f4ffd086174e5aa9f2869819a4f4436a97f4ff67a1ae8954f72e28a57d05e1b57491a66f12f5be8416f8d31fd975903112718f223796586d64a31be7596149aaff728dd98166f237f36a28fd2a97483d36ef59462166b5d454931790113d995910f4866e5a021df2b4fa7d639a1fc240b58082be18e33aa404a7cca5de0c03af83c5cff6017f8f642a9658fd7e39563ea1e64e35f8e0c6255f28c495041fb143f6992169ff8299bb89e10e0a3fa4e050afd85fe48e93ec64e67e0c223eb885378bcc19555728b4aa2c20513ff54b9fd89c262624be89ad88bfdc7fc328e7cdcf67e97aa4dc94faa6ae4a390e4ffb8ba72f490cc1a743c0a8cfbdea395809eb18cb7e7be011088dd73236a19e05033c4330c5aaef26dbac5cff9e3197d97ab1e95e2b7132ce55a4cd5ca5ae49e38e82b405384397d52271612628bd90af75c7b3323850e4164b802854a944f93dca4be7453d4edfa9258ab7092c9b90b23a137975b651150465af0bb374952d2e1e78983bcc0c1b1b1a0c62446d1c3529b70b0d30605473558ac3b5007c18a52b10c8c0fe690587b3d8485f61481482d85572fadc6cecd52daf1c4ba849ea41740bd191c0f34260554f5b33ac598e8082de7b3cbf41060e205a5fd52e7df671fad85b27b54ca0f5f454dda6b2cf8036d894739601b77acc757547e815006988eaae4dddfefeeff53d5e7a48ceea99e0bc9a7cff5a570034d3e9804677e9e9faeb23553959ee448ae5c6c450fe363f378571ef4e92d977ab8fc75c58fc800dd74481ead01f5dda4e26024d708ca03f76aeedb35f1caba1b13777778e0364ab35343b1f86e2b7ed1ad2b850b136275f8e4688fb3fe615c4652d03cf7d3ea1453f84f5a5ab6e751df3c48eb9a639dc1912320fd3ed29e13b1f10da9f225a178df6aab9e91d7ec0828c09aef828581b63720674bbc7328c4387eda50f3cca89453e192092a9e935b30e3be28371dfbfdafc7e0d64e18647619c637242102d2abc28a0441f30bd42ff1ef25bfe647cfa23d57dfe88deec8442a17584b8073d0acdff702fd3157d50ed72ad3c9aa710d9966da79bf143762067ee78d6190429dcf5d8849dea2bd8ba3b8fc8c04e67c4840c28b2715ae10673439cb29971f1715076348325498b74b9fe35353d4f1c357c4435bf125151ba9902b6e320a8fbbac5ae8e713a95e3a8296c49f5f71f474bee9d033e2054eb055d98fe22609083e8d8c6659183cb2c059104eb41d960ce1c6f391fba36de03d6dfa7eb49685c154be725fda1b4c3d8266d791141823bc54a18a73d6b726c1b56cea498d78ad64dd29d14a13c525b0005816becad785d1969651af8782d9a085f3b4bb873ebed37e575ec081af7a69fae92627db76fd4867e4a5fe5e0ab52509011b555a9b510fee0959f4ee646be8647f20cf67abee41a50518da655e22aaf816a261a21ca8842f0fb1b0b79792db237b980bc3ed30ac55eb75c78b6ffdaaa6cdec85cea27957ce5bbf507000d98102da66838f08f4023c0f2864ec9f7bb4b43ef8674aa7c25641d9f042ee40cef5050a98f3f145e6876e653a56b29ee3aef3aa95d4033763d963035e889279459adda49e87dc5e6b08fb927104bd681d15e057c3d93b29e325d4f2a477ea1a407fe61b02eceee96d8e8b58b5ed4ea5513e083c71fb088b9103e2af64edc798af84ed344e87751283c0d74312b5b2937924215c9e798f07cf59cbbaea59eed1ed8087d7c2e0f472c912613ff881f17eee4cf81eab2725756912f9d0b40099fcac9d010129dbf03a1de691a4407a6c3a10df0138a79f99b8afaaea4958fa7c7e78b14e5357861fda53b6702caf79918dd5bb3f99855e42f80e338ef1be0fdbdd52f97ec6cfdbbb7e88c11770891730588ec85947048debda9977d2e8ef1f67e9c0c399b306134b14523353eb30cacc9d6506670b89807152e639252dc2c2a09141912a97539260081dd021b3d5d9bfa82755f201de59a1736d822df305c9470200c461804b172d001ba68da935f0690f2f6c198636711ee969293ae641ad00e7f38bb0af01014a8a7005b2cc7fa8cfccd75feac6c430bd7e1ab24e53a97bddef56497d319b52872504a120cf5ce5fd5cc21afe825687778a341dd0e39fc2ad3dbc60a3cfafbf3f5931cdb484548ac7c0be51f9fb5ab7549daeeb0072fe543f91fa113727e762672f9a36314be8d08d462f0ea4f30edeb4deadc21dcefd21291be7d09465c150c53030762834f00c1a80f25c0a9a1c2a670c8e76ca6165777b9c40f3477a066c39da1c3e7cebc3446d9a84c8ea3c14b83fe3988143059be8626f788871ff175d7db20f4c14aaf54e32ae3be86f172d2234e95fec3be10445ea99292a3068956d62a575a9814667e258b2c6c50359f785ceff666d807dec244138042466a27a27c6f560c79e754cf43be486f73656830438ae63e319115502121567b4f4894e908f28870654cf6866e3eb0546a1310ad67c7a5ae9a3c53737003dcca835f16f3560e508cf7686c0de67fe7bc4ad15bab84ad05d146d19622c136755ab964882cfc9d85e763e1328a0f7b8b61b6dd591766a368955f12b95d7b26ad6b6d677e403418df11f020650fea00758efff4f8ce6d63e433a56dc4589f8c71e036d34660c6484e3202b1adbd1a18c7b522bef19a024d9750687d5e63fb2e64bc31c31c2348283aa08bde28f3d76481aa822075d5a458bf58e4dc2bac11b95a7babf3ee2d890bdaa775cc4f8449e7951727144f68137fc1d58927055dfdc29865078096d329a2122ba48b148b8b1a64e6b3fe032fb8abd3e95f55137fd958d75b18e89e8e31c468e9596eeeb04ba496b69b6d2e2f013fcaaa5095a88af78e4bf66c6ec4837e69820d882d9c5a0463fa9d62e7c628e2eda1e33b5c823d1c66b8a2c63ae16f542bae61fe0dcc231e8fac730625a79303de49aacc9e79ef6904df2235d092818ab7ed7aa154e1193247485c5393cff6b8d859bc202a1c8fe2c6c77fcaf9f0ecc4007fc07beab670d5ab71917feb7ebbaaa036ff393196f0b639b9db27a135170cfcf1fb64270a66375e1e4f0c61b1077033055b7d7bb13a8496e18bf1de368229a75f21db33ddec5521de1a244db5959e52f3474e8c23c63e0ef6c98fc77b1305b543a8a4455b4c36a60e2609c9cc19d2622a275cfe4a9ab183a2ec06a574da0bd89f94330faaf6a9bc175e4d8bbac1dcc6c22ba76ab34c59dd373abd25c4045a599963beb714ce1624fb9b2b0be7207274cf5a1467efe06e84a640088a89439839fa1bca8f2cc6fb65d52b082e6b25fa3a6ae0f2145eee44750afcbb9b0fb0868b4faff6c325e72e19584a35467efa49306588b6f5c8521d0f12ccbb69872605086451258d38030ec982125126a57499c9d2c592110c78a64a062af607177b592f879ae16cbca56c419a70b880b99cbb7491500e1e84868de5c98cb78aa1e51f5045f67ce28a9c3bf924e17fe9ada3e50eda048f9f8c7d78c70115ed6aae7bdded85f5f8fc493dde06c3198880627e609d05ab2502a8577b9b633fea25ed14420c03b60684f222fe332e240c7b7a1832ca3184715ebcbcaf0337c2513cb844cdb66e38f7f6effd34eff55e4e0c8dd8831b2f228ac4151290ae8a021cc2df11c285a074e628f27bfad36b593f0bba42ee6b225a71de0f051ed3c0ee14a6bd9cea6223c44fe1c4a992db2ba66ae9cb10ef5035a0449e4d1c76790fc5b8f9c9fd63cb3deeb6524fccb517ac74b382916913a6eca0ada8ca5469c76c494c3396f9a0482ad1d35e342b0753bd0d509d9b1b59a2d954395a5c25aa4b64d0414a024454a9ef33a5f037b7cdd6411c20868059be790c652099716d620379eeda6fd671a464ce56ee450f6228ea5880006c26581c14ecbe278fed007798e1eabbbe986e7a52996ad23069e0b59aeb6fa19b2d5e4848688132b7bf76b8e0be1f0243fda4bf91ec0cb84e4b11dd8e1d5c0f07d15797c1febdc41bbd2d0b2ab98426c920928dc6c4d368e6114cb89fd593cce8dcb173edacfc7330c3a4ff9cbf71ffb3e5c51b8e0055691bd4b8c235310e79cf689963ad8eca2e022e1e87ca15e8cb2eed256a89b3f357596d634071143ad1a01a3b7233265255a633be505b58b5fe3dc529a20ec1b730d96fc5b93ff27477b85890340a281de5324c79a0124f79a85f4d21a6a9", &(0x7f0000000300)=""/23)

[   15.639035] dns_resolver: Unsupported content type (32)
19:20:27 executing program 0:
add_key(&(0x7f00000000c0)='dns_resolver\x00', &(0x7f00000001c0)={'syz', 0x3, 0x2}, &(0x7f0000000200)="1d1ad732d4eb7f3652ee46e39383af62cce15cf21979c899ae544810538e8b8e82f71c6cc5cd03d1d6719772b7ec6aa7dd0a02e8818a9f497dcf34efd463e8858f6c14f7a25ee85f034f37971b19d8a8aa6eeefc5fc2bbe3fd30759a918117bd91e0a60d2b4cf9d51f2600", 0x6b, 0xfffffffffffffffb)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key(&(0x7f0000000000)='id_legacy\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000100)="82812fad54f3ed164bacdd3b9f4f57c8cb41c56a7ecf7d095476acb37dc695b01d02824221db65e554eb1fbcfd20a8bbe4aa6f0c55ab94b8ed3b0055204ffa44800e1ac4090c6f2ff5c5e41cd58cd77426e9507a75f5f566b95f90b707cf8ae83484772ba0c95226dd388c024c9df211fd30ae8ef76ed274faff7cae96c926d9743b600130021854df6c3a929809a3617457d208ece5", 0x96, r2)

[   15.642417] dns_resolver: Unsupported content type (32)
19:20:27 executing program 3:
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/120, 0x78)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000000c0)='key_or_keyring:-p\xa7\x8f\xd2a\xb2?\xbc\x11\v)\xd9\x8c\xe2\xb8\xb0e\x98j\xff\xf1\x92\xd6\'\xfd<[\xf2o\xc1\xc7\xf7\xa5T\xe2\x93\xfd\xfc\x13%\xe5M\xd1JF\xf7\x17')
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r0)

19:20:27 executing program 1:
keyctl$KEYCTL_PKEY_QUERY(0x18, 0x0, 0x0, &(0x7f00000000c0)=' ', 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$assume_authority(0x10, r1)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$read(0xb, r0, &(0x7f00000000c0)=""/35, 0x23)
r1 = add_key(&(0x7f00000007c0)='trusted\x00', 0x0, 0x0, 0x0, 0xffffffffffffffff)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000800)=""/4096, 0x1000)
request_key(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='trusted\x00', r1)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000480)='keyring\x00', &(0x7f0000000500)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffb)
keyctl$invalidate(0x15, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000440)='blacklist\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f00000002c0)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f00000001c0)={r2, 0xb9, 0xc7}, 0x0, &(0x7f0000000200)="c5853900982c4e250bc8a467219e04c876b48b971508c14c6ea0f4a7457bbe602b6c0cf0a290003c5b288ecb99a5f7c486928f2c0aedad0dbe0a47aa5705be0d959fff601cfb80c7058934bc743a37b2ff81359581155117c3bac0b9817242f45b5d0adcaf9000a38bcaefc7c94e9491d009a5cf3869e526ee0b8316557c74cbfc04ff125b5f4696458ad05d9ba25a9b4f2c054ca2668c3f20c7ce30dc018cf1c4d9ef6296af6e1a7fa76366841c9ee321fcc0c885f9e2e086", &(0x7f0000000340)=""/199)
add_key$user(&(0x7f0000000300)='user\x00', &(0x7f0000000000)={'syz', 0x2}, &(0x7f0000000040)="0800a3afcd2b0ba3a88857b7f7c57e27a2fa43814dae8d3ee464bc53fb70dcc13d09afe6e3b29a957bac45cbc4d8dea30bc7bd83af589b33ce444105884780309371ead6103d8ce81bdec0b9b9fd1ebe77a4b2816552c1d72dc1cced79cb17904c1271b426d784bbfaf8834a32143550d2e585c11dff620e7d2864f55807714199ac3eb76c6bfe12ca7430fdb0b1ddc012a80c7b25ca6d0f1c3d3eec20ca48212d91bbb597c0b87fb395c56832953fdf8d987a2d071b355543f258ce77feaadbdf54ccb80062746f3d72db49966f647ab7034dc74e93dfbca917b2a8e7f878745455801811c12c4fc379dbbdae0647a389abf64e8faaa07e4b0a8dc72d62feab7a83b86549fdbf9c27c5096a3c65ec2433412262f8e8288709dfa5a6e249e46cb8affcd23e4898c00f84cd079b47297a9c3fc6baf35f7dd62ab5feeacb9caddf218b4780f084c1bba7f4af315fa478ed16a0c431dbde85a60fcf3414b8ff009df7c2d3c9fe441b40f1f326d38b805be717456726f9d66a40dc0ba1964cc40feb", 0x180, 0xfffffffffffffffe)

19:20:27 executing program 0:
r0 = request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000080)={'syz', 0x3}, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000400)='id_resolver\x00', &(0x7f00000003c0)=@keyring={'key_or_keyring:'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
keyctl$KEYCTL_MOVE(0x1e, r2, r0, r6, 0x1)

19:20:27 executing program 1:
r0 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f00000001c0)={'syz', 0x3}, &(0x7f0000000180)='h', 0x1, 0xfffffffffffffffd)
keyctl$unlink(0x9, r0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368139c07d9b742e40387ceab7f42a831b07061905e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f00000003c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$reject(0x13, r0, 0x4, 0x10000, r3)

19:20:27 executing program 3:
keyctl$reject(0x13, 0x0, 0x0, 0x0, 0x0)
r0 = add_key(&(0x7f0000000340)='encrypted\x00', 0x0, &(0x7f0000000000)="00008549053593e1c84f896c2f6173472a3be911071a7b0c", 0x18, 0xffffffffffffffff)
add_key$user(&(0x7f0000000040)='user\x00', &(0x7f0000000080)={'syz', 0x3}, &(0x7f00000000c0)="a627311606eba30dca232c89b7876311700d9eb88e7981dcd7ff21829939f2e01f18", 0x22, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$clear(0x7, r2)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000280)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffa)
keyctl$KEYCTL_MOVE(0x11, r0, r0, r0, 0x0)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x1}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r2 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, r1)
keyctl$reject(0x2, r2, 0x7e0ffd, 0x201, 0x0)
r3 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r4, @ANYRESOCT=r4, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r4]]], 0x5, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r4, 0x9982018)
r5 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r4)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r6)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r6, ':chain\x00'})
keyctl$reject(0x13, r3, 0x65, 0x0, r6)

19:20:27 executing program 2:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000300)='B', 0x1, 0xffffffffffffffff)
keyctl$setperm(0x5, r0, 0x2010000)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000200)='dns_resolver\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000240)={'syz', 0x3}, 0x0, 0x0, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r6, 0x1)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, r6)
keyctl$set_reqkey_keyring(0xe, 0x6)
keyctl$get_security(0x6, r0, 0x0, 0x0)

19:20:27 executing program 1:
r0 = add_key(&(0x7f00000007c0)='asymmetric\x00', 0x0, 0x0, 0x0, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000200)='rxrpc_s\x00', &(0x7f0000000240)=@keyring={'key_or_keyring:', r4})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r5, 0x1)
keyctl$KEYCTL_PKEY_QUERY(0x18, r0, 0x0, &(0x7f0000000140)='key_or_keyring:', &(0x7f0000000180))
keyctl$revoke(0x3, r2)

19:20:27 executing program 3:
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000000)={r0, 0x0, 0x59}, &(0x7f0000000040)={'enc=', 'raw', ' hash=', {'tgr192-generic\x00'}}, 0x0, 0x0)

19:20:27 executing program 0:
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$invalidate(0x15, r2)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f0000000200)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='logon\x00', &(0x7f0000000240)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, 0x0, 0x1)
request_key(&(0x7f0000000000)='encrypted\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f00000000c0)='\x00\x04\x00\x00iKg\x00RoO6\xbek\xcch\x86\x8d\xce;\x95f\xa9Rq\xf9\x1dU\xc7\x01\xbe\xd8:(.\xd3\xa2\xd8+\xde\x18\x8d\xd8\xea\xf4\x18\xea\xe2\xdb~qZ\xb3\x80\xdb\x13-9y\x985\xc6\a\xbf\xa0\x03{\x9ep\v\xcb\xc9\x81\x1f\xba\xab\x8a\x80\'\x00\x043\xc4\x13\x02\x00\xe3\xa8\x96\xf5K\x97\x13A\xcc\f\xed\xfb`;}i\xfeu\xed\xa30\xfd\x9d\'x;\x12x\xe5\x1a\x05\xdc\xa6\xfbH\xc8$\xb7\xc2Yp5\xaaC\x1b\xcb\f\xf9\x8a\x01\x9e\xbf\x87(\x8dp24\v=\x1b8\xd6\xfe$}\xa9\xc3rA\x00\x00', 0x0)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = request_key(&(0x7f0000000540)='.request_key_auth\x00', &(0x7f0000000580)={'syz', 0x2}, &(0x7f00000005c0)='asymmetric\x00', r1)
add_key(&(0x7f0000000400)='cifs.spnego\x00', &(0x7f0000000440)={'syz', 0x1}, 0x0, 0x0, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000380)='keyring\x00', &(0x7f00000003c0)={'syz', 0x2}, 0x0, 0x0, r1)
keyctl$get_keyring_id(0x0, r4, 0x7)
r5 = request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f00000000c0)='\x00\x04\x00\x00iKg\x00B\tfRo\xbek\xcch\x86\x8d\xce;\x95f\xa9Rq\xf9\x1dU\xc7\x01\xbe\xd8:(.\xd3\xa2\xd8+\xde\x18\x8d\xd8\xea\xf4\x18\xea\xe2\xdb~qZ\xb3\x80\xdb\x13-9y\x985\xc6\a\xbf\xa0\x03{\x9ep\v\xcb\xc9\x81\x1f\f\xb0\x00%\xba\xab\x8a\x80\'\x00\x043\xc4\x13\x02\x00\xe3\xa8\x96\xf5K\x97\x13A\xcc\f\xed\xfb`;}i\xfeu\xed\x8f0\xfd\x9d\'x;\x12x\xe5\x1a]\xdc\xa6\xfbH\xc8$\xb7\xc2Yp5\xaaC\x1b\xcb\f\xeb\x8a\x01\x9e\xbf\x87(\x8dp24\v=\x1b8\xd6\xfe$}\xa9\xc3rA', 0xfffffffffffffffb)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/134, 0x86)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f0000000240)={'syz', 0x3}, &(0x7f0000000280)="7f41c92fc7df07383caa913424ab42ed51d4df5e5ae93a7bbcdb925c87cf62b4706690e940b3d1d861b60a29127a5faa17e5e45c69f3fb9b5a8174797fea252b49a515c69b9afcda37671683f5088a34bea60a20928d5554dd47ccb9bd9f3b16e3604b6c58e878f44553af1b823c656d8fd3c0df54c1f720a2026acf14dc7a012f81666f9a6b68107d2d1f57fdf7f044ded5a25970e8d6eb38fbfa6575b49af9e5c67f9f782a35ed9b5ebbad5be35023d82a856991e87486a9c9c54080774ff2241cda4a522ccf4e611af8c93f1678fb060c6a6c31d01b2b52c60ac2ea1cce65c8f9", 0xe2, r5)

19:20:27 executing program 0:
request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f00000002c0)=':bdevwlan0vboxnet0&\x00', 0xfffffffffffffffe)
r0 = add_key(&(0x7f0000000000)='syzkaller\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffb)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$negate(0xd, r0, 0x6, r3)

19:20:27 executing program 1:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)
keyctl$read(0xb, r0, 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000380)="c1db691f677d73f16bb96bed613d5e4d2df623df418cc82ba3b24bd0516e4f88b643cfd459da116220e91a1e1e56160cbbe27b78400cc76b27f2c9b188ec912a2491809825e66d61d7dcbd6afbf084e82877b51ef7e6190918874da2d37815af478fd41cdd08fb0923c1f1ea4734f97f5a39eeb8706921c4dc433cb55444f79242e4195bda297c873d22963523924cd0cb6392f55a1230daa4ec1f1869ccde3b10159cfb828854469bda5c5d59aa1bc3a29dd170fb5113951ac0b1df56e509804aa8b21c5a34ee717699117e91af6a8fd10f8983ec83864de7d9fbf7882eda6c61540b5a12eee8e338bc160dcd7680f9f3d9b0ad12e73760569dcd58665dd183172519bf48de62843cb5a9c825fda96036e689f4c95d7f315405603732727894c7efe3737f1d8611c0c84acfecd33672c6e60016e28d14eaf53ec2ebb4f611e8f03745477663dbb65edd69bcef950416608fb72b959256b2d16447fd5f1d0d29bf0cd6a81933f19b26244c87a743bcf425bf445f492cc84c76219a8ab4fdd506a32c67f8f7510c50ad529313e6ca4144a987aa966dbc7f5fa6688b705be921af5d740e88d0f657d2b791b3696e13b47032f98274cbd4206ec5e705992839ba0170daa463aeb94ec9b586d317a4d7466910c2cbd6cc04e1dbfbdebca67cbeed50a26a3b6ce793ed48ded78f0e71fa7051db13d3e6bdf708d871ded9f5da2a6bc33a3d4a8f6039fd996b4a4e268d1c31f745558b759718b9bafda06d9f7b9ebf2720f2cc934031288a4a6b22847968c0701650f2147acbcb770a87ce0d8b17ee827e1d102ae90910d3e6f9ac57e1448f8d827537bbf8a0811173e32a646eafb9c5f2caaf1fa80983c26b3c52a83abd6a3a1fe2ec1835e15e954e72f49ef5f7cc7338f4949d395b8fe935913fb9e1ca0a91e91ea5a704bfbd334277031c0078f465d52920d07ddb1e563c64d38660e0d249271292056ee900705a053386e184c3fb000615607cc6dd432fb6d14cce21b9143b5e9214cccf7d2a0cf23c285c9c69884e2a1da6ff498b1efe9113df38c98fb9b3355f957e186e9234fef0f8da4f368167770e566e113da3b2cd3c339ff5ee0d610bae46e073ce17591c29a40c969d7b9ff772e6aa868930540f1efe4ee62d9136a976b817c77e10634563aab253d521c521ab040263af033421959c840c11e25c2fca2211216a6770b35213b4b3c7a6b39b347f9a5b25bec71dac4f62180ff0ab7cbe797d283ad8c7cc74841ab252322903556b35bcf31e5e9841e1712b699259380b762b4e468527f87cf3aff2b3fbc82f651b0be0751c11ac34f3b2048e55f58d55b562d38defbb836132a46e099256fdbbac3860852794a78cdbca9e79e8bb44655f8d45125464ca41854aa4285c41a2568a66d9202b7da00523f29de1130ff9c08b637ea832868a026ec95978ec2dc1bd2f8cd6ea2623e8675e0c8fc0697aeaecd92a8e80028bb867646c5af75ee7066e5c002f3c849e2d33ce7c5200ae3e6bce3eea8b62850e10b59bbd3c36cffb72155e4c050f5de8f254d4a523a5b035980768fc0b3b20e10e166fc6efd04b20a7be2a5c0ebbd5b1bfdae02fe6aa0dfc3e11cc975415235e34bd28ed213f30e37810ffaaa5b28543e951edecdb2369821b17d0370033fda62ca6cdf960aee7b06a62f5803c212c7ed34f5e383f80357000ea5ebc8df2e9003b10a2a26bca8120a5acfdbee695f92c0d2c9cf00fa929744215f08d97f5d499894582d29711b1dd4fe29fba1d2e48e6a38422505435127ae64a5b49230d63a280bc069be703b63d2fc93e6681d5e5965a11634e9ca39fffc0c72c198c46442b576e49e3cf8ac06f904b69a008d2afb95d053586266f32bd7a1a3b2c7d594976da558f6be6db4fd85c12cd8776aa611722f0ee644cf5e9045b079476bb97445cd9eb2e24dca40c2843ef767a39afeeee1d41b665b5fc3157ceee9e9e2a2614f1db64e776cc614a046e25bb5321846a327d330b0e1ab376da5a3127c729b616cba6940341c2fce88b2e201a33e704681f3bc82ad90a420b167a8d7417eaa392e0d1e60411ffe533d1a57f85b9e24cb907ac8b73bab25c76fddf1f2925f9be5dc5a092474e4241d32ccaae4bad81b6546ddb6bb6ad3b2a6aeae9c60dee00a25540629733140350fd41e002563bbf401e0fd6736e0b2a3df94492e42c11f3709168f88cb5d1582ef99cbb6c008c9fb3dbecb73239e85cb84604d5efd9aeb25d367afbe24fd9ae83b0d4130581154ca9d6e97cfe482d4cf9ea4899e7754c30a831eb1991b948dc3923abc18b946a61e1bb2cc438f8bee4451ef7151d1904fb3c3aa75582ae115c14e437c62beecddaafc44225a9e039777ba0b6d2ad0f47b5a7927ae718f04744eaaee9f0b87e2cd6879f091f7b3a27e672318193971d266f08e67635ab8f19a95663b3d5a5e982d2c05452bab116eabb0ce272e37217d9cf05abeec4d47894fae240ee0ddecacfd87e0147168d7f2272abc4ef449be54ce17f5c8013a864165c23dad44cde4649102d21298fc1cf739539c0fd2b3ebfe32ea8405a207916dad5ab5d9ff090a312a7ec9d9f95947dc47b82a23cb2acfa9782734d65313904d0fa0d9695e775a9f6dcfa43dafe1d33a40ec0fd971e6f4ea522af4b57a6829a303103361912d74df622153f8bfc7de055eb7b39e473eea420b1a50c129b0e1bc849a5b4ae427ebd22d7aaf697ac8a08d4808ed15f5201586c2724259f98b514c615c653fcc8a03486f117beb46ad67c3d3d2eee0af0852e39c41ae378f54ea016cbf39b7570091256d55ef604b7ec104415dbad32a1744414a9e6b22fb6a128e34c061150979fc5395d39372821d0e3934871bd9a2035a5f386ee49a8dc1ace411f5a37f2105fcecc50499e97493d816e59683a5561c1f631eca20df20f94d2ce59c80a667db1f7a130e7b0ede59334c8374ba93cbe1ab69cd005b23d31dce3bf054eaf6deafe597c4dd6e028d0e7e740fb65f87f5bf463aa99323ba671323236f40c02de9a74ab0de541bf22cb148dc46d2a47c8fe3ee94067b37e3817b14f3884e518f450737a44d48d92c444d4f677808fa98a9d1b2d6f7f0d25f17afb64b7573163e564d316a415fe0da19de0e361c0ff0fede33dec652f2202d845241e597660dab09585ef8f1a7f47a7b0ed0c855beaeab0928a0e0d930f054c8666fe6c58fa12735d90421fc36d29d7d897db9f5eecbce4fda7e67be0efb31f411118277ef65aad529e627c7b25f769241641b5b350dcca892d853ed436c0d442d8562bc4bc1b0ffb4b44c8f140f5c8a4267f8ddb3b3aedd8948ac7a6dbd674c15e282eaa773ab71b88ea8e1bd24cc9cbb0fe566bca3df308cf4a3afbaa57f3d134fe4464d53a445ea23d73d8ba5bcb6740a6c770b50a2e1c5958d9b6259bdf9be1ef6370cac93858a250912d045213cd9576caba2721cba04b0bfdb821f2c3fe49a5f085172491ff4712096ac3e8240eada0727755c98254b27839546156b32437101465f61921c530330e7b6eaefe55257a0ad5b0444d9e3aa5a1352791e2b5ccb5552a10982d2f4face5b889a7b2d78e3a7ffb29596575b5fc6a43e80cc18ded5ef165b2e88484322dd8929ea41ef6be4f55566d004b3380d726975e9decb7c42c0da84fc64cd39b835a9ccb3a77c1521d6c0672efbc833f5fedafa470ac6acc09cb93ed8bd28c9ecee700de04f744a5f270a068115aecc17c707c657a28e49af11db0a3bc4d53d79c9a839941a13153a358ac9e2b9b0654d32a16e5ad6b5f390fff8f7a1b87df14fb89c166128173cfa926ae190788530e3f2096e04184efb0547c1969940ccaf9c759d4984ac3abe68aa1557d96808562f2ab3ca569595640e4947e7a3363f700c05e7a138321c8b2fc7d3eacbf185fae719ac2f9a7c5b0a45efef0eea495c1197e7a2ec7ecd6b7ac4336e4d49a36495cbf2bf3dd7a21ad3b4692b05e0ebd388b5a1268508aa9a2704f1ef0749fcbc171975dfb9476ea431417c6b6301d96d02210f2a6de064edac34a88f7930058d6e1a8166aa218c0debfbf766619e64c4cc65e225ad87b4943466b68b850d289797319aed7b4fe46095dcc7067fb1563f84e3df79573ce9f3e264fa56e8d6d467ad91571d1436e8479887e6815c7ae26e74a1cc56b0bad5191dec7eb3aca68f31c69dba26497dbd4e09cfe549ee8d022103d9d5af2e2a90d34ee06c046565d9ddc1433c3032c8c1bf7a92aee778fc2f522c3d6ca669771d19afc08544988a850bd4fda768316f31e02b8156c4808e518baaf3f9f9e140d745b266e192511ba44e1cd16369c208aea205d9dc94d0965997e5b662aefdb0188cf4eaebee87ae06370b1c5ae73bf04aee1b284b4150a9664fcf58013cba993cc0fbd1fed76fb7ebcd076c4451937c1bc1a8f19759890c02fa882c7609f1154ef4f183ebaa0c07e5b024930a10b66990937a237d11aa1d456bba74bac4d7bd2f40458b222dd684749e4d074d556336085646b33f8f534d940e1fe34b23d0bbb2fd797f585da048432654637cb69dbb7181e9baa5bd8c69df592ea50db80698f1f79d20c9fbcaf43bde38dad19c06d0a8da8260bb76302a4b17578afb75d45cdbd6e9b02d68ca22bc84af6eeecaf1402d00ba9fc98cf65108764b8d89bdc959766edacdec4864f903927fad0d57fe099fd25b0a38782ba1e843ea926ebcfe6e435d1aafef346e489ebfc7007a2cf583558c9b4e22c381bded76330103fc1f6e0cd60dd30c361d422f5136e90420d736f44706ebc0fdb1a913fd64ff0f20d050e78685ec6fe4932c6098c68aeba3e1933022b95abef18af7db7e75d5b99f295103c7986c12846ba6d96c853044640c46516091c1f6953fbfe176bf4c21ab45c813a49aef32a8bf58db0228a159e5455cc99ee960e5b9fc151d0f8c36992a4e524fb5e890363abaa4f1769ab9927907faf987c4643749ad2133b0b2184428d8e0d49b3f7cc7a44d1481f8a8aea80fbcbc94746ed03179e3ac8131367bc59f85d6694afd395366238592df0405b3d33b76a7702ec007dad5672a176c454c2b828eecdeb2c70e9dee058fa98726c29175c02dbdffb98758209daacaed23a6d39412acf55d1092cb5e06c9c273da69356b414e385764979cb47eddda5530d2e571ae7ca6adf87e221965f720ced868c1397f02ed606271408afcc4565f2929d9540a20350da53936af913ed69ac0bce58f643f1effd3bd632dc1e6a8b4967d0efd49075d328099564d1b8cf8e303adc5275199bca63248bbb4b253633e9ebb5b0a8451cb22d51af1c1e1d5419286574f83eee5c9e965b1e0480010bbeb457e7a36373b3f12f6821dce11bf80c80f7db76ed1471b4e6f0c1af1e122a1dbf3d278bb6faa1de3b73de1c226c2d594a332535b07684305a2e6efd002deb17401cdba6c2d7e34a0f8bbc2df014562f23dd1530c3b696f4f7e3d4eb8291cd72472ac96ee41a7177e2d22517aed124a29cbfea813c1135795269d891c667d05500d98329ee1b028f643acfc95c8014d775298c0ff0180d7a0e670a9c3f1a9e1c33d85573f7cdc1d9d4f96df9929ac9b56c9461f6ca996bb832078baf48d1771e79eccdc539c3a4cf20c09cab55d232d81b8b74445e1801e48f38e5b0f5108e1e7f2247e261ed82f991626dbe8155b19ee1a42acfe4ab71b25d1c6a5e99d604b175c15709097a67e25fbea1d87216ca5fc3fb98ab09797dd01198bb1ddbf987edce9bab37f7285e20a8117bb63dce34b5335e927d5850e938ed97129f6df3", 0x1000, r2)

19:20:27 executing program 0:
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000300)='.dead\x00', 0x0, 0x0)

19:20:27 executing program 1:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)
keyctl$read(0xb, r0, 0x0, 0x0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$get_keyring_id(0x0, r0, 0x7f)
keyctl$invalidate(0x15, 0x0)
r1 = add_key(&(0x7f0000000080)='pkcs7_test\x00', &(0x7f00000000c0)={'syz', 0x3}, &(0x7f0000000100)="4db0924dfbf025c84b0a5e6686efe30251e549ae5cfd537866e88350af4253cfa7b183a1f64625cd3c93142369fbe27176c4f7cdad8a379d1364d7928935b199a6a1f60ce3c599e31ed3436cb3fd8a84380d942f094b1c9787871dea04ff0012d10e05e5c92700659b84d90c417f062170904e52f5fee01baa80146ea28c4ef9770b6ded06ab2f15f32a3c030e8a82e98f66972447f510112f147083fd44b3902eb9d8e8cb80e1e18c13ca06987aa671c1022b320d6e79d2386b4ea68869642d5c9869777170ace8bd09d7b0c8f9462cb0a7cc", 0xd3, 0xfffffffffffffffe)
keyctl$instantiate_iov(0x14, r0, &(0x7f0000000300)=[{&(0x7f0000000200)="38199bd8d8f0cbfa5f2e2594071c77e15d478fcfbfa67608246dada908f33c8bd5dbcd7a1811ad72010692fcdc05ef8e8f254632711c59fb", 0x38}, {&(0x7f0000000240)="d6d67a6045b206b3a3c97fb1b0ec676c234d85c340637237ce5ef3d759217442dd5ed062e42b9547fec93a2e200150be51d7c8551f6f151cb5cf1ef4a1261c10a04e43e0b7ce0824fdd9fd3586986c0d40dbc61b7a0744c5af44a3e84486b7a1c0c6def874b4ee47f0f38ef683e34762a071edcd30cd295fbbe54d1de8ae4da0c67dd5f34814e5906e1cc02c4645dc9468b02abb3796ba4f2cbd3e231303cac5ec35f6fab143f2edab9497a3049cb9a809947208c43fea785e6fe6be3aa0285d", 0xf2}], 0x2, r0)
r2 = add_key$user(&(0x7f0000000340)='user\x00', &(0x7f0000000380)={'syz', 0x0}, &(0x7f00000003c0)="41b3c3f0276bf555db76437d1dc71c6d472c04930a9e5c5562e497c6be2eb109fdc56a7b9044649fc9f45b3b72e28594fb6e80c7b5d26cc24b3614aec24a14ca5122677f26dfc67f6907ae47b4ae58c6d715282ad996e352ef1acb52b6d1df4e0c03224b100f3ecbfce615b3f75ac9484edc88d1920ce5f00380b1419c1741d9eb58a1473dbeec264ebe47e3e395c086a6c34a6c2a49989456f626893acddd6ffc5af21bdeb0d0b967b786c3306d7fffb4d6c55fba03daf862864429cc74e783e4511860fb126f15a72a555c5090f82cf03847a53b96ba62fecc4308dd2aca2a87b9cf06f3c2f80f1b24", 0xea, r1)
keyctl$reject(0x13, r2, 0x0, 0x1f, r1)
keyctl$setperm(0x5, r2, 0x10)
r3 = add_key(&(0x7f00000004c0)='cifs.spnego\x00', &(0x7f0000000500)={'syz', 0x3}, &(0x7f0000000540)="a0bc08dd721719552346ee6b1f8583954e2b499ea9fef95bf70b2c8444cd17650fcad32da8844269141103f9a892fc625dd2ace28e6d510545318faf189972f30204bddcb097a4b85ba098c1b79e6f35010e76da4360e24ff785716865a2f86623efc0637be842488ff726de8957dcaa5816b98a57a5", 0x76, 0xfffffffffffffff9)
keyctl$get_keyring_id(0x0, r3, 0xe525a52)
add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f0000000600)={'syz', 0x3}, &(0x7f0000000640)="4fb90e0b6904addf6118f7882d4f48fe7dab3b405f3e1eb125ae9af496d88814efbf56c80af53475d7b9aa1756276a46dc1435c7c508e7681f0f4912dcb0edc85ed1d3f30cb24fea0145ff05e610cac07feb9109802e83f53bb3ec9e12a7c83d5c3c0bb18045549fc7881ebff36301f9e111d548ace8c9b53ac69c1b61bde6989d462341d48dba013d97ddc3a6a952f50e8adff4f40d3bfd1a30d965ba6aac837c363cf64a2e53fb7b581878ba9cfefa0aa704e61ea0112f015428a20ab4eb66c3c6f24b67a9830c8d179215b2b21ed693488b8de7e20123cebec886902ce21d726d78adacc31f3c8b7d524b38e5cbf93e1e5213ce0520ea639a8b8d210b3e4860263f3bbbcbc4331470cbbd544724e2a31691233494dd44c2b408115380051addcbb73f62aa4f2deff0ab810949cfe2de370d3250dc88415bc7bc2bc898c48188b5008e690c46a554455d075ac0938389e478963e78dc9882969bf52c6f4b989deee7ebfc9c0c33c5f51aa425d5d736bd5bf1e176e0ff587abfeaa4031d2f76e165f626610ce4dc254f6dc670be0d7791ca365b897ac851bca095a907af867cc0391299c3fb01fdf6294bfe4bb164481d3fe9517dc1951f34ec2e93cb66dd49527e5fa59bee4a69b05c899e43c7bdc8d8dadf486fae97ee2b139b2864defbbd7f9141e684f20e86689cd52d965b000fc5f7b0e1c1bdc718e51d7ab4a90b92ae88ab705859ff95cf03fc0d7e9025c81af9f8cbf7975c6386eab3df00be62befe2503f8e01ab90646a964ac6e3543406995c50d00cf5ad12db747cd56da20025a3983844b9d68d26180b2d319a7c6e4216fa0094c2cbd5937070aec5d778d0be33c97f0e29aeb573db1791ec944756dc843d92e472a1b4d31e25fe9b07cadeac7f51324fbd7ab55d61125d740cc6e640b8a172cbb2e487503eb6e624a775e876c4865bd430dd864ca96bba67cbad16f0567514293c847f03db1e2c85da513eec08428f16a96d2615da852ab22f6cd5fbf5b28c70b8e65a3842f4d77ea5b29605b0ffb1cb4d52ab0d58609d641d1b6d30a485f8636f4bff028b64102909743de7c4602edfa1015b94271fd963451a7059d558c928ff96a2e96242b9e17337b8b8be1eb4433a01a68f19d7dc892b2dd385246b090e0c21cddd40571eb3d9b1861b3d60e73bac4ee965dab0a92063ba51941798c965251bd5235fb0b40f524e50f4548aedbc517f0f06da7d2c740a49b6faff9cebb247678301af1b98b72494a8f4b94fb1891f279483d228ee0f2f94c90c8fe034674d75fedb09dcd50a0d990efecc08aa596c774eeca494876bc0b0ae11051c0fcfbbce971e66131b0d2eb06690df34f3c3f2fd57bb532cb86ed337d4aab1c750a674a962adb1d92f7af4026444024524e28187241c9d49c14e8a869a0f1254557a62e9e7b6c751bb2def1583394435af94a31f5bde652023f4d41fc8bfcbc30536bbca635ed2f9f90619a2ff1581bb5322d7d43d4dff3aecae1dff0446466c134b3e23808940438a52d70ae9ab8e4889715d3d1a34671db9f81989b2827aa86f035788b077c7a25bf3c11ce53a1ece9e4f052e68d5532098ad11aed00083d13a673217b77db2087d286a3639995b3f2aed5de7cbfd97e9e28c1b58ab32511a2fbe7ebc4a70084f0e4ba12fca6c94c834fe3dcaac06e6371e7f767bdb25f8ccad7d25321acf5d435a5ed4a17ed1ea742a297e71427236080fbf54859ceade62296675a7d075d151b7c029a1e4440bf4171e113a06d3b00f4d3c31da431ce57510d7d718d762c3737e68b4630d5e857e389647e936911271b986daf615d9ae586eec29121326ec81a5fe56130bd1024ae9aea3d1d03dd40dbc1872ffaee4c80e2c1c09221c8032c6b98250a3f4c5360837509dd920d8e9ddb7a77e344b9e2186abf8bd4c3fa5a88736b37c577186e299781004a31ce7879105a11e4176ba92e7f79dd5a817db281d020be4da679e1f48147478d896d1458e91a8563dcb5e04544d271f2bc50c44b69dcc3da163d8a33855cbfd68221530a17f620602c3d1f56e3d6a0a12fe0bc7aa4660bdd7602fa0e688feec3448f54c79c764a88bac6e7ec6266180f172e18dcecf24540d7a563a8ffb389e0a3ba2aecf60e764f2ae7434305b5484100510b095094ac540d90f259fde7d5f25f57c075adf4f196284027a953de454ef07aca43d8ee8373196e51e922c51d970cd7653a4f079363abdcd9852f15e58168f8206f378a02ad733b129fcf0bda33d4ea9d9f4053418fab317199b729a4a858fe83aa50b96bcf16d8fd3d12b4f08091a94d5cc8c0ad335073d59e7d033da6801efe180a72f540d56f875f60acf6212f6070604bb1ffaf910adfa22935297f951e724dfe168a34fe959969dc59a5429502c29febeb755f023de71023bad44bdefe9c78c95407eeb4ce2a093bd328872f8512c5047581f8dd7f400eb4dbb06a3a1fb0db99231aae224f79d99a384594cff1acb704aea8cff4fdb605a4e79f4d88a33f1ad0b12172f6f433c693e992f3016eb57cf048fc69066d1dbc30cf3bf79e552cf61b9a3f088346e8694beac6597513da4a3ecd36dd42c655738089209a9f6aec80b652a2b1a8eb9b1af7112985eea4f91442faa8a6df429264ac4c7c67aa0122d486cc9a7165938854221ca7371169269e42bd69cd2db1be842cd44612b3007268bcad21def06098833968415aa95d5ed9da92a2ef2e22f06a21213f18ea328cdbf971bc3ffbe46b62183212bc8c24bb4dc776facfede1ae0428672e683def8a350b22b0ed7770677f92230506195778acd3db381e5a5efda982192ea904e107e2e6c3c32771bf74c255fc683ad74e789af51f87f7630295beac0b2b01e5933d1693c888bf0d7e303b6164bd216fdbae5610f1114db0154b169c348bc2d3bee859e3fb25726c007b864c1f927f87f21cc96d6623f9cf6b334bd064fade878df0c73c830e0e82a56f54270a6ac355c956e28f2ca1cd98eb2fa1d0405229d7f9ad4aa9ef4fb536d29b904b823edcbf6a76cfc97862c2b28c3ddb33676a98b1dbacfe8dc630823c7f9be14a496c53ea183ac16f4f11cdbbcae6c8991ee9a953c9cd9664dc3f162a41c1bf75fb55130387d2cd2e3b0167706c7e228bbddb6aba10ce0b07334611a8ea1fc0b919e8c0128a4c52f6b95501614d0fe483cfc98525176f831fc81b0d8ee1bd5d56793a5d0a74415394e672543251619df77f7bfe58499b76b08053858cfd6c7118514ec104a833290108278afdf58f53f636af9c200b5478aa17dfc61cda1f86e9c4bbba47e684edcf65f403f2ad0f3061fc89cc9e37ceb6ec871445484944cd8415f8c9d03344f575e553020b39aa133bc658f36694e32794b09e97c2cbb1c28b633354988c769d92a5595622548fcc5f877add31eb60916a0881e6099af588c5fac0dfab8c25ebccc4a3724991f31c6b6ae40cbed699f0131200b9b856e5ddd9c2a4d84d4cde10910d821f58bda56e0bf262ff15255c5899c9ad66fbf8c1a03f33f4ecd4e0ae11c8700073c2666e4b95ff2b9bc084f2080018974662f9d1484dc42a73e384f14915c2b749307e4bdf7f9592248f974f3bc450256d399db37ad00a3b0822149763edab4f40673b0194d946ba8bb18edd3e4cb2f69ffb64742177fc3dc9f399b72753e2363a241983a29f176ebf9b4ec96ab0928c66c2676f642cca36611b17d1c3d5747e7748de07f0d9af17de5c0e49d8bdfda460803c740c78f9e8c7ce15ebf418a5fe4ead0de24df71625071281e65a99b818c5569edadbebf20601cf4eb5cdf88d0150513ce5c5ecbfd8476d9c54626fdad32618b8e51a26d52d3ad515b9281db4df99a5e8f8b51d2cec7bd1fb9688ffe0c2b9f1f44df1f14acf226a8bf425d1fb8b5ff238d4f408a9cca6c881df3cd7f9f33cf25e48b895025315b4fb46625711e5521048c26b67376e7e3cb01a562655d8e28bf23dc1dad4a995ac61657e76c6b896dab7c03f37ab74f518f01f9f9633bcf72b86fbbaadc106cd16fde1d4f7a1b357ec0a49f7f1418262e1621cd7ef6ef0c41ce177d91cda757934dda15d5023e7beb7240467e3a8c98faab78e824329fa0b75b44f1f4228701b8690374be1e487a1550f8f6b43279509d2238d950cf86b1a29cc93cb12b2d16ced976eb5bf8dbc0b7266cf3cd774bfa5389d05a2550cd24a99950a69dbe589a97bb291c948c2dcdf5fc2cc21e17ec994ceb93d4dd8bc4ca26556ab8418518084084898292e5836e50e80c0ad786b27010dca1d5f2e52e195fae7c09aeec8887833ee6cab017b6c3dcde57ab3227a0e11ec4dec597558cb9ea9f5269b2d0b0fbccb1bc0ab63a87431a0316149b43dd4beba08bafe47232cb38e9b58ff732b9749d6c702e80f97a77f5e99d291bad95dc7510905e2ed8fe81550be5397bc1bb465e6d3ac3199a7b8214268c1f66faeff0410841866ae7691205c6b9ed5711eb0eba3421b7b2d936a614676482966fcb322aa64ce83fdd7838306ca30066780f189a28a4ae07842329034ad6e33e381716dbbb6011f484bf37e72e2cafc060ed6dabc0a61db16d4841a28a186e419f2c3e5b8c58a4ec6ec235c1bd4cf441ac94597a9b9ae55f3d60bf9af47a4a29b3d589305eea231e1461e8d84e85cab9f7f6cf74fc39815ec30a232d1e0adad59c710f6148750dc85d4a184f5b300a18950b4e427a675090e55f17087a2ab44c81a87e0b761a3c08c25626625ed235293835f3e4aaf2e8bfad3831fec639060a83fd260cab603d9e203d49adea65267930def12c2986b5df3d2e2f85e1329bace2b9af1160129d286728a441380299bcb1943ab6676028e2c660c6bd81caad680e614c8dcc3e1b1afea8a95e84231f5eb6ccaca1f8c38c625b12e6f8d4fc22148e9e3d2ebbe613a4f69074e71ab868a0e58faa54a5d1452422f0aaba37749aea4cf9d81924b8da50410e0f9ce78c1c80c8a0e4a75ef106c324e8e796cab3f136cb0d318bb374fba4e5ff134c54313b7546caa462a74a461bf9e5291f3532433205e25a5945465ee21bf7a3cc8dc4a8892e2718ba8a550999f62b40146c2d4e11f52e5829e64f44ec55af756c73227c395489f9028508bd119c30b70e7e69b9bbeba846d09680e5cdddc687d07adfd7f2931b7054e376105554e40a17f585a75e1a21fdb5faef1e0b5be718ced84af57c6dde7650cd7ac8c7bfaa42a7574c9ddd89fd7feb420744ab2591a9b07311c1e02182feb90deabf148566ae82fbad4ebcf49341cd3256e26550dc67f2de1e67e3dfc4fc9a598f0fbe1078a49b733a2f6390d5d0b2963c3c2c9d3506616424cbbcd55bb41c3adc6ba386e71267017a127c5c0acb9ae44730e43b5d194449cb2a7935d3975a20517c8fd81ef25e13477f738c6da65fc2c94edadb31cc474be4f2b42f639e1b0f62f7bc2a6d9a3dd4ec0637b56c8295033f41785c3becfd51606efab65ea8f3c4cbae825d153a69d6bd4c201eedca47fcb826d1838518f5943923a1b2bb1d330a27dfb8c800f3a5db45a57473927cb8c9f14e7d9f7d2365580f9e4c595864782d5b8ff36a62ff92e98c977714ebe9fc7b09739b2de61c91898c75c6038de22aee2ab6f1e357806fe9791c45dd478faa194b88df51cf0488f812168f9be5bf6b43f8262f937062492579bb4a9d8ed65cacf6a766e6b4b9ecae0ce6e0f7db9c3812cf2f029d53f2983c118cda1e21e9704a45f75a5c2035a69a10d8d948f8acc46e70a99bf72255fe406befa90763025340440663104d061d068bf", 0x1000, 0xfffffffffffffffd)

19:20:27 executing program 3:
add_key(&(0x7f0000000000)='trusted\x00', 0x0, &(0x7f0000000040)="10071052669402eb37", 0x9, 0xffffffffffffffff)

19:20:27 executing program 0:
add_key(&(0x7f0000000000)='logon\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f0000000180)="611748e36dba07dd03fd69b0f0b86ed892f5f234ac4eb55cc3e69d931c85e1ac6284a648208e751002e9a0fa9f0f1c581af8af1bf2d0d24ef0e935fecb9ce9a89ab171fcc12436e028af25fe16204fb9a04d015dadf8b4a57a9ab0d95dced09ded02ff837c116ea1139501f94ff6b60cad52a4c0193da7a76e495d98ca2ad4bd3b8087a0226392f28f54288f02fb0c60cf196949b7e0a5c7abb0", 0x9a, 0xffffffffffffffff)

19:20:27 executing program 1:
keyctl$join(0x1, &(0x7f0000000080)={'syz', 0x2})
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffa)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000001a40)={r0}, &(0x7f0000001a80)={'enc=', 'oaep', ' hash=', {'digest_null\x00'}}, 0x0, 0x0)

19:20:27 executing program 2:
r0 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f00000001c0)={'syz', 0x3}, &(0x7f0000000180)='h', 0x1, 0xfffffffffffffffd)
keyctl$unlink(0x9, r0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r3)
keyctl$instantiate(0xc, r4, &(0x7f0000000080)=ANY=[@ANYBLOB="6e65772065a9c09ca947826563d5797074667320747275738f2c643a755ff47230303400"/48], 0x30, 0xfffffffffffffffd)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x2}, 0x0, 0x0, r1)
r2 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x0}, 0x0, 0x0, r0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000080)={'syz', 0x2}, 0x0, 0x0, r2)
keyctl$search(0x4, r3, 0x0, 0x0, 0x0)

19:20:27 executing program 0:
add_key$user(0x0, 0x0, &(0x7f0000000380)="f683652e8216e52240eda8f1ffd7e794a988abf3e573f44ce0845a59d82eada15dde8c37ae15b3d70a659e81f4c271d380d445524ef63d0eb35db543c4d2e5779721282817da3f4096655a49ecc8ae0f7ebfd2cc62b8c9098e4ebe8075231e7d290c76ccd67c31148b3679651b59672d4393f07d467bbbf0a7d3ab5ae3aebc1febf7200a26d487ba09d18a1adb6eaea52431041b5943dc18a35a52df69968231d530f27ed53cd8c0c5c7fbcfd7a9808ae177784a68823cbf3c328df146383fbcc05f927355003cea06dce4ae23", 0xcd, 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r1, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$search(0xa, r0, &(0x7f0000000000)='pkcs7_test\x00', &(0x7f0000000040)={'syz', 0x1}, r2)

19:20:27 executing program 1:
keyctl$session_to_parent(0x12)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$invalidate(0x15, r0)
keyctl$get_security(0x7, r0, 0x0, 0x0)
add_key(&(0x7f00000000c0)='trusted\x00', &(0x7f0000000100)={'syz', 0x1}, &(0x7f0000000480)="61c3ec29c8ca812d9181eb974d17858ad73df3fa6a68d58eadd99a74fa17f13a68e42aa1d21bb859a6b78efbeb78f586cc81d6b9bb4df454e06ca7803d92f244b388c7a7fc02db01e7f82a87ba659234f0af639d513e5d2a26e3c40fa1ed78d232a85ec11b5ba2869738496075da651bd9c7a3aae5e7e1bef32913c03d9acca08923b2c1343f110dd4ad239d3f43020075b1e135c174914ad0d9dfca24d2c3fa80d84f1a6bcd8ae8671df2d787fc18d9bbe578458a14f7db538de4898a3d54eb07610e68881cfd22276201bacf5d705047cc855c581ecb70511ca29b711d1e0aaa866415287662518d17bf", 0xeb, r0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
keyctl$update(0x2, 0x0, 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b7425a477b17a4201073e46ae403875e0c5f37df3568f4e7270ac2629f89dcce9083a2780004008b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c598a1de7f33f07cdaad81ca1b5ae820d343e", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f00000003c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r3)

19:20:27 executing program 2:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000300)='B', 0x1, 0xffffffffffffffff)
keyctl$setperm(0x5, r0, 0x2010000)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='asymmetric\x00', &(0x7f0000000200)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f00000004c0)='keyring\x00', &(0x7f0000000500)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffe)
keyctl$revoke(0x3, r2)
request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='blacklist\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000500)='tru\x92Y\xace\xaf', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r5, 0x1)
keyctl$unlink(0x9, r0, r5)
keyctl$get_security(0x6, r0, 0x0, 0x0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYPTR, @ANYBLOB="b446582bd35f15c0e1f6972df637a0239dd3499a8ad8b0a9321447d78b05db85089b67a7e500ae48236532477697242905450b", @ANYRES16=r0, @ANYRESDEC=r0, @ANYRES64, @ANYRES16=0x0, @ANYRES64, @ANYRESHEX=r0, @ANYPTR64=&(0x7f00000002c0)=ANY=[]], 0x9, r0)
request_key(&(0x7f00000003c0)='pkcs7_test\x00', &(0x7f0000000400)={'syz', 0x0}, &(0x7f0000000440)='\xc2\x00', 0xfffffffffffffffa)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$read(0xb, r2, &(0x7f0000000580)=""/196, 0xc4)
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, r2)

19:20:27 executing program 2:
keyctl$KEYCTL_PKEY_QUERY(0x18, 0x0, 0x0, &(0x7f00000000c0)=' ', 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f81dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7d06601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da88710c87c738b46e9fdff70c8a5ec0eb347dee4c54c00d7e5ddd113ae3abb2916d28eceb4cc881bc24b40123ca158c39049c89db24617432d95413b37efb07009cf1cf57005041eccb488df1ffac4881901a1e59b2bd4787cf9b4bcb240e2fd5eec8bcbb6b87ddfeb449cd9c47dd9156a0cb78469e5518ac0719a826e05274683cec42334ca363338a2741d5a161ff4e8681eaaeaffb1c02166f0826aba4", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$get_keyring_id(0x0, r2, 0xf6a)

19:20:27 executing program 3:
keyctl$assume_authority(0x10, 0x0)
keyctl$invalidate(0x15, 0x0)
request_key(0x0, 0x0, 0x0, 0x0)
r0 = add_key$keyring(0x0, &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000780)='blacklist\x00', 0x0, r0)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffff9)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffa)
r2 = add_key$keyring(&(0x7f00000002c0)='keyring\x00', &(0x7f0000000300)={'syz', 0x2}, 0x0, 0x0, r1)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r2)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000280)={'syz', 0x3}, 0x0, 0x0, r5)
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r6)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x1}, &(0x7f0000000080)='-\x00\xa6\xb3\xf6O%\xc2F\xdb\xd7\xc8\xd7A\xa4@\x8c\x81O\xe1\xfe\xefaD\x94\xf6\xe6\xe0\xd1\x9f\xb5h\b?F\x13\xdf\x82\xd4<sFV\xe3\xdd3\x1c\x9c\xdck\xe61\xbd\xf3\xfeB\xd2\x10\x9d\a\x85%\xfb\xe8\x9a\xb1\xa8\xca\xc2<\xaa\x8f\x84u\x0eb\xcaq\xd23\x83\xef\xa1\n\x94\xdc/\xb2y\xf7\xb6R\xcc\xc3&\xafy\xfc\x00'/114, r6)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$read(0xb, r0, &(0x7f00000000c0)=""/16, 0x10)

19:20:27 executing program 2:
add_key$user(&(0x7f0000001a80)='user\x00', &(0x7f0000001ac0)={'syz', 0x2, 0xe}, &(0x7f0000001b00)="bf", 0x1, 0xfffffffffffffffc)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, r2)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r3)

19:20:27 executing program 1:
keyctl$KEYCTL_PKEY_QUERY(0x18, 0x0, 0x0, &(0x7f0000000000)='\xf5tT\xb2(^\x1d\x82p|\x8a\xfd\bD\xea\xd1\x8d\xb2\xd1\xfe\xa2\a\x93-P\xbdt\f\x1a2H\xa0\xf7X\x0e\xfa\xa8C7\xae\xc2\x7f\xa3\xb05\xfa\x92\x9d\xfa\x00Z\xdd\xcc\xd4\xfe%(\xdc\xa5\x9f\x01\x00\x00\x00\xado\x1e\xe6u\xd5*\xef\x84F.Jf*\xf0\x00\x00\x00\x00\x00\x00\x80$\x0e\xe3z\xf8\x1c\x05\x9aA\x9e\x97\x04\xd5\xb2u\xfd\xca\xfd\xfa\x9a\nF\x06h3\xc3\xd553\x815\x90\x14\x90\x13\xc7\xec\xb7\xc5\x16\xb0yGM\xac\xc3\xa1\f\xbd\x00#\x1a\x8d1\a\xa4<\xaa:\xac\xf5\x81(\xdf\xdcv\x95\xb7\xdf/D\xad\xa7\b\x96\xbc\x1a\xf3\x87+j>\x1f\x924\x18\xe9&K=\xe0\xaa\xcb\xa2\x18H\xc0\xf1\xc7\x01\x93\xa1\xfb\xcb\x9a,\x1f`\xbbc\x8esvu\r\xf8\xe4\x9a\xc6\x8e\xc3S\a\xca\x9c\xb9\xc8\xc5\x8a3\xf65\xea\xc7b\x03F\x03BAE\x9b\x9c\xab\x96\x13w\x06K\xceX\xc2\x1c\xa2\x96\xa5\x1c\xcf\x84:MP\xa6RJ\xf5P\x98lg\x9f\x84\xcf:\x99\xd3\x820\xeb\xa4\a\x81\x82,\"*\x1e\xd6\x9a\bfh\x00\xb8\xce\xbf\x16\xadl\x057\xf8\x10\xc3~\xccP\xef\x9e~\xdct\x12l\x00\xf0\xf7\xd3\xd2\xaa\xe7\xe3\x1c\x88\x7f#D\xd8Qvr\xd7\xb1\x92\xe1\b\xf5\xf5\x7f]\xa4\x83\xd4\xe2J`\x8e\x9eB\xf8j\xdb\xba\xa6\x17|*\xac\xf1\xec\x9d\xf6\xbfP\x7fk\v\xe3\xe5\f\xd4\xe1\xc4tx\x9c\xf0.\xa7Rp\xb7\xa0\xed\xad$&\x88}\xcbAZ\xa61\xb1A\xf4\x81\x1b]\xa3\xcb\xe1\xf2L\xc9\xe8\xd8\xc8\x0e0#\xb7\xb7', 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, 0x0, 0x0)
add_key(&(0x7f0000000240)='logon\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f00000002c0)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a76c7e96aca1f8bbfd0930a0f3a7b3127e7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db8d2da71bae7345e00b108cd9077d31c0d57ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9bb2acaff52afa55f349c55ce1380657d925d7118040382421856ba8087bcbc22e70ea44da51858b9d35d8e13c598f525afeccadd79e607835f92aa683ae047539599e1dd1eed4bfaf2c06a2e973f18ad7186e73749119bd144af13a8f39e89b112f1d0bfeb6c1044b5e55ab57f58f2bc79aa9639caa01b348a49605b9b12351dbeb0e38bd01500b717a5bf63eec9e15f617612cc28b36ca3beacb1ba37645010d5bc047bb12955476326c8eaef11181f699a1ecbfd664065f68254fd0dabe77a3217b6aa87c2839ab43506c63e7eec891e30acccb2624143d8bae117b62d9bab98446ebd9e08c3c3f904172f39becf836eda5c339b013a3f387d44ab7cf1f6f67f1ff6e3f3268abc1fbf279a6466922ffa02546e7efa00bdf7c5335143920e6daa175e1602e63603d2706042841b9ba79aa9beabe2019b3df1ebf316a38b3272e936c91cbf0575e5fa0cbc0e992b83192a429cb008507f8007ac49e9b2d3f7ac7f9cb470ab2a011ba0a32e8fb7a3a3a5bffc1ec45ac3a219e53b11c640477eaa28e83142dbc35c084dbafa54034e34b38b15bdda592a073ba4f6c8ef04252efe476fbed0d87dba02236a3cf2fca62684c6b392660be5837fc64b37f6cf0d5b627a58c89a94162b575e76f8c35e18cf335aed0d501f7fa2e98d308e79ae7fcfc8163be7b86b35a8315ee937ba2f235f5c7116eaec99d76413c683a13518aa49e1b7a5366123ea111f8bb08ec6228a0fc85654d9df2d485bc1437e9656751bb44fc648462efe9ae33631368b75a38f72a46b1b9dec5c001f8b67226a5fbb73d565c65457f9a0945c930fc02c0a301860b266108c9517d7f0a861dd0ab5815bd54e43f541ef5fbdafa41c5d6a5d7a284199f9e0a4c8843d6c29725b23a63c73d69aa45439c3dca38d7567734ee75f356d1e86f3c5ab28e346bb9ae81325344aa1ca4d6cf2dcb7a51509fc0f25502e2cd290852ea707f2744efeb1371320918657497697637dc22c3a39551100b74fc1c9c50d0082933aaf5aa5a0bec283e593267de44e68ed751036ba9f3ca47d339fdf214e3908007bc7d966ee10a37f2e7f3435187592ac05ef1ed74a9f6e805630c9a38bc67123d764401791e0bd8c7219f431d01cff5191a0e310065a44c4c56194c270630508814fdebbe1224e31a33f2b1af8d9d93be52fd4088f7e51a40e7af734301287f30adad39510447ba8fc270edfd25cf47fcb9294106789677f2c137bdf409853b0d9506ba7795faebdef8885eba157f6b7aeba314e99d29da7c1d81b613463002bd567e17f616a89f26281a85645400084b0aed930b856f6bc40c763cc1cda1cfb2d37251ca645f8d83425c9423d39af4221f38fefa1efb6cad4352c1735856bbe4164462f6476d740fece7be2bd3e536e6696b798609b12c5d21a46a193a228c2078c4bebb1582ba892628e1690fd09e08e35d9fcc11b03901554f40ae8aadbae91895ee51282863d8da193340c5461054a02cbae8e9ab41b95315d5f2edd7d0ed1349a604094d3e3348529bb0e582b603e39713da528dc7d65029b9c31e3b6631359339a9c30b36a4e586cbee97683bbdd1bfa6f559f1aae230bff6534ac2c11c82763e78efdefec8ae053421796b7524bbc96acde04c5523d523cf0f73f3442b7be45a8710432592b973dd1b59c6ca0c0320ae14f9d64ca0ac3340e66c1e5185ca1473b1dc31c88181605a7b16ec97cb8dceb417a1093730075bfc322e1f2237f8e2cf24ac595f33ebadfd07b7f593851cee9bda2b35e26866bdcf2d682e98c41bd42428083b0571073e4841e867ed0672c8647ead6b849c57503134537f4fc54dd349b23d44ba5267c9e7a924c28adcadbc2b4062339d60f477690448ef79bb494b86c5d412ea9aecbbf319d97bae22f17ff299cf502178303b667e40668a73807905f4e48980aeca937a401c48fcc5232208e2a0ab1199b07fbe8855a9a6b202d339c50031b8cc8274ddf72240dcdc2ab376a31c3b2a54e2fb2d3b52c9f48922a7887cf2c467881686d25cac07b19628bc6c526c2a840c422cb7df44d8f678ba3d71b35bb3660f119a3066b6b41a0bae0b1aec48532389b83f55640152fa2dd1474649118ce730b8651511b2999a0edb0ccb6d4d87d57cb4a2c14337bab2ea0433e4b182ca5b0b83ec22242e7079a2b2afe0a997740011e844ff16e3b81ac178c493c8de3beec7f8eb7404ce48a16ffd4bcd68adaaf1fea5283c40ffdfa6a1200fb272aed6428947b3a33de97fd5e226c2d18f7701700c3e57d42e3b659c26e7af3b081c89da48a112a5754ede6e6dd11f4616a51e8bd5fe0a4104eed631155b1174300a0484ebb3e4c083ce66fe46debcbb237042eb0ce15867cbcef32ef026d0b880f15b6f73a77dab13be09cdd7203581da09b99ab7b2cf49f0981338e72a6265305da3ce69930d1a4e487f96c8386132cba4069597ce07ee7b2878d09d81ed840aca471bd28fec60cfcf7677b5f63c15269667b0bc5388758905f6c515f23593dcb0721a8ff092be1a", 0x800, 0xfffffffffffffffc)

19:20:27 executing program 0:
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000080)={'syz', 0x3}, 0x0, 0xfffffffffffffffd)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, r1)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$reject(0x13, r0, 0x7fff, 0x2, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$revoke(0x3, r1)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$search(0xa, 0x0, &(0x7f0000000240)='blacklist\x00', &(0x7f0000000280)={'syz', 0x1}, r4)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da5f83747871451b60eb1f9a86c6ab1daddcd59b8185e028c7d0e7a378f7649720747fd1ffd5a91788f7b795b48f99df32553474caf2e79b7fd9846cb0022b0c0fb142f40ff2e74282a8df2b80f086d89da9b58f5c7c43a3abc327cc83370163b8a7ddf0ab71b1", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
r5 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x2}, 0x0, 0x0, r2)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, r5)
keyctl$KEYCTL_MOVE(0x1e, r0, r0, r1, 0x0)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cbf7bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542ee114a0c5d124f94a9e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e48", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000400)='keyring\x00', &(0x7f0000000440)={'syz', 0x0}, 0x0, 0x0, r0)
keyctl$KEYCTL_MOVE(0x1e, r1, r4, r1, 0x35b69dc32b18acb4)
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
add_key(&(0x7f0000000080)='encrypted\x00', &(0x7f00000003c0)={'syz', 0x1}, &(0x7f0000000580)="a29e7b4db22b624f60223ded925e888880e67ab81c0bc7f3fd344423278786a36bb68a8440fbb32d0d418e510129b9d8aa834dc4c03d397b4522f4b260f12fdf3fa2e862f196bcd0f2c6fb8b15970e1e2ca7902db3f9022c8887b7461df9ed5ad1554879744c8312dcb2a7c8bd2edd817d20b7bcc49f37c4a5bbb1db5d7b48e38ca134f3b5939c522c41756ea82d268bc7a560722f1bed35a733639e836bd7a61a4eaea7c10e1719794ef398", 0xac, r3)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000280)='id_legacy\x00', &(0x7f00000002c0)=',^\x00')

19:20:27 executing program 0:
keyctl$reject(0x14, 0x0, 0x60ffffffffff, 0x8, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$assume_authority(0x10, r2)

19:20:27 executing program 2:
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000040)="108102", 0x3, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000700)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa36813222dd9b742e403918736e9a4384e90c6a83c841c4352bf5e0c5f37df3568f4db270ac23f9f89dcce90aa02a413542e8b0abf194f5eda8a358cb53d61c90d5ce292c484203761e86584e703926c177246fcf67d56a59b7dc7601d725caad81ca1b5ae820d343e48877533128b90e46f12b7fbb51305bc515e5fdd5309128289864d04542ea1ee635b20913411b87b579b0781630e03f093aaf47e4f8114e8f769722b75ec99555c785428f32b352a61844667778a9d4d71d46f510a397e8a380cb5a4a3ac640318c8444102fb0051b4b0e72643637ce300c2f390d39921389ed0e640e45f4ed540ef9b13853388766aa2fad575b30aa3c8c709e130c64d7ba93d050ad01197249d04ba9069870b34b7cab6e4adcab91ddccc", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000480)=ANY=[@ANYRESDEC=r2, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37dff468f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d20000010000000000929b7dc7601d725caad81ca1b5ae820d343e48fe4097a2bec0fd95ff00"/107, @ANYPTR, @ANYPTR64=&(0x7f0000000240)=ANY=[@ANYRES64, @ANYRESOCT, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000280)='dns_resolver\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r3 = request_key(&(0x7f0000000100)='blacklist\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000180)='asymmetric\x00', r0)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r3)

19:20:27 executing program 1:
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, 0x0, 0x0, &(0x7f0000000300)="b7b43f3a8742d025cc7fa60c9fc66a92eb5e1bbdbe495bede94eadcc3eb67f2323", 0x0)
r0 = add_key(&(0x7f0000000180)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f0000000640)="64e507db3e1f949d9c187bbcb07b500a0bdd7eae257d12da1ab94e357d53e29a45f9a00ff0a651053a884891d2f957a6d2903b9abacc2caff07c91f0a8e443d239efcb7159024895002592b3cb9a93273b2ab38ed4df09d0ce846395de9b23643ab7ae2562e0bc5d2c0728677d27b8938972e1a37cf0cd040be93475552e51875a0688681cf66c2c75fc5a495e22c68642c10ba9a700"/165, 0xa5, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000700)=ANY=[@ANYRES32=r1, @ANYRES16=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da4fe13684106002ca5ca42d8e39864c59d4009b566c0b63188c58b66bb2ef9e6d1a8fe4a15e9fe12bb2eb86816224a9e9b303fe6d2b294afec8ef9ae351", @ANYPTR, @ANYRESHEX], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000380)='asymmetric\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r4, 0x1)
r5 = add_key$keyring(&(0x7f00000005c0)='keyring\x00', &(0x7f0000000600)={'syz', 0x0}, 0x0, 0x0, 0x0)
add_key(&(0x7f0000000400)='.request_key_auth\x00', &(0x7f0000000440)={'syz', 0x1}, &(0x7f0000000540)="6d9261bda8ff5b40f9a9fd20d19d878ebd0ccf9ffc4bac4d86d367aea42f1542397fcd1956aedc681b6a449ed400ff3aecdd8d7d833d8f239ee68852dfc457b3d0ec24b225e232c5d3fb32205af861d8e2e59db62f022191974a83f92013be56975f4a4ef75811cf26d295dd4c0aaecba1d1d0939e323ebf6ca9ffbf77ff", 0x7e, r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='trusted\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$reject(0x13, r0, 0x9, 0x3, r3)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r0, r2, 0x1)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x3}, &(0x7f0000000940)='-\x00', r2)

19:20:27 executing program 1:
keyctl$reject(0x2, 0x0, 0x22b0b9d3, 0x201, 0x0)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/189, 0xb58b8a)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffff9)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000700)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb573ffa368132207d9b742e40387000c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da4faee25f672bd507e3bb8d8277371fe9f02e85679708b04a31efc8f63ed6167803b81056778df0554dd00b6954bda11060d36002a6b97390271a812692d74083ad99156c32f479aee22c88e37a7efed56b9f8ee272793f8deb3914408b8f8b2981f8d4e8f02348bc440c2b2424bb022dd8b26d17ca3d6065968dbe7c336db63be2adc696371910d8be6bff68de5ad8d45c130d99b80337464bcb722267", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = request_key(&(0x7f0000000400)='big_key\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f0000000580)='key\x00\x00>\x00'/22, 0xfffffffffffffffc)
keyctl$KEYCTL_MOVE(0x1e, r3, r1, r4, 0x1)
add_key$user(&(0x7f00000003c0)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r2, &(0x7f0000000300)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
keyctl$reject(0x13, r0, 0x1ada5d5b, 0x401, r1)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e44b8ff0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2620abf1930bc5781d2e1f92d61c90d5ce292c484203761e87107e703926c179b7dc7601d725caad81ca1b5ae820d343ef4da00"/99, @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742ffff0000000000003568f4e7270ac2629f895cce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000400)='blacklist\x00', &(0x7f0000000440)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f00000003c0)={'syz', 0x2}, 0x0, 0x0, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r3)
keyctl$assume_authority(0x10, r4)
add_key$keyring(&(0x7f0000000500)='keyring\x00', 0x0, 0x0, 0x0, 0xffffffffffffffff)
request_key(&(0x7f0000000040)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0xfffffffffffffffe)

19:20:27 executing program 1:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f00000000c0)='\x00', 0x1, 0xfffffffffffffffe)
keyctl$revoke(0x3, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key(&(0x7f0000000080)='rxrpc_s\x00', &(0x7f0000000500)={'syz', 0x3}, &(0x7f0000000540)="cdd152b064b1bb3a848ca677a4b27d6eb9d233df9e1e2e77b59d5f70e3c4c9f21f26c127c29350a9871deebbadfffc574a871086e8993f5c2307c82847e1202f0b8d05d30de483d9e0e8a26b78242670c7f9e946ab352cf132bddd5436813d483f4f38ebc6068e2fa7a2bf7c3476833962bc86ef13f902a82ef55254b65ea5fa467eca6bc8d2e0358c22747c2f86343484dea3fb4bf7ef2a6c4bfc0cc82cbf8bf08f4890d3dabd7b1240a2072db822ba7548fd72b4705ed74a008fe57d79921fe53a5788780be4f2b38573809d949bfb67d37d7ca87b2a4a96e96a15fde9719e28", 0xe1, 0x0)
keyctl$instantiate_iov(0x14, r2, &(0x7f0000000480)=[{&(0x7f0000000100)="e2cdf09c5c29013ef23dafa0d9b5be85a10ce7fdb93f009d0d6c005f92cf21b082f3152ae89046b81eff0be3daa9e548fd22644428058ff139ec1885e11c0a1fc120d5497c5e134f75802147105536a870e3620cce7a400db5bbee3768ea7a04c1af140a711c30c810c7773192487e70d4ae9e86b40e141ece11eded5889404ff197a1981ef9765f5b8ded4219a7b5f287224a4022f12522fa8b1c1dbc372387419203145eb8b634cd56b860eddeff331f10f6d3e3802cce62e405246a8d0a45e549d622a0d0cd8888594e3e10df9df2", 0xd0}, {&(0x7f0000000200)="8fb65202d6b9f86e984fbd68cd2699af26d05a8628b65021ac44e432adabca8a078c736c8e9c5978a3fc176216d37f6bf9ff3d0cb856944d27e00a9e1b224bcc3dacb30213e443ed07418f1b67b1603c5b12ff5f90cf062bfd38ebc1b34914186dd9c60c19a00e5934a9f708ea21f1567cb2e601f958440ff7473bc7b8266d4e79e42348a0b4e56a0f0f56202c3920cc95a317ca0bfdb3795e5672b4f189c47c232a9763ef5046080baba851282735a91b312bc90161e7537a1404d220974fdaec6be2df6c5721a46f90d0f5c288edae55ae5c6a482f1aa08cdf08633ddec7e1f27e0e0531958739dfce5268", 0xec}, {&(0x7f0000000300)="e749cc92164792e6b89bac71059e2f6e12570b0f367c9a0b63601cd67905a31abf2bb8bfd2453692a87a97b343f9a26345f9c63aeb7c7a7fb0402f44968d689cff449d23bc41bb0258064563a2d318990c2e2ecfc12ec148d8baa26ad2f8db98908f1e595194973abd271a0cb94ff344a8c9a04711a9c89967", 0x79}, {&(0x7f0000000380)="87f3534da90dd1baa3f5c047caef2c19d4235382353976800c2838c733ee648d0ca9861609aba2e6613bdd648643c4cedbc138211d86d5a3b4d878fe120c2d772336e4", 0x43}, {&(0x7f0000000400)="b3714f81ef5b29e2b591f04e4b8b7ad221c11c03ed7a6c34971e2393406c99564a7f3155ed7968b5c4c67965a6eafa7dd0ef691f031e510976590d25edf2d2520eaed716f90cb9cc274dc33cfb9c009c57e1b0e4597fd31025edc1f736d0073050826e9209", 0x65}], 0x5, r4)
keyctl$setperm(0x5, r0, 0x0)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$instantiate(0xc, 0x0, &(0x7f0000000640)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYBLOB="d5bfbd619de1b2ec75f91b5241cf6ceec582785b5f561e1e3146def77c783ace414d95bef61c15302dcfe5b72a0b78a9cf9bf7cb3986b8c4aed464b79083fa774e443033028c41e45ab9eea575cb9967b1c77b2e18da9d8b4e3f10b03f6b4d083731a87632788709443fd39d0d45d46d4ea1", @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYRES32=r2]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$KEYCTL_PKEY_QUERY(0x18, r0, 0x0, &(0x7f0000000000)='ppp1\xa8$/\'\x00', &(0x7f0000000040))
request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, 0x0)

19:20:27 executing program 2:
keyctl$get_security(0x11, 0x0, &(0x7f0000000c40)=""/41, 0x29)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f375c5e6fdfed63df4768f4542e8b02bf1930bc5781d2e1f92d61c90d5ce292c484203761ec6584e703926c179b7dc7601d725caad81ca1b5ae0df203ee35109a94820d343e48002675ea1c463ea77030c04a7786f6aaa6afb97c25bdecff0f0000c108488e62f0bebfcbbe32b202ea8d567f9ee9f590b9397b02245e8fabe36657961d153e1fd2e13f16f40b91c7f2b500e41a9d496007015ce1a58c619f753cde6d85c4de06898242ffdc303078a7546252fce26650828a57a05f5f11be88e7a2abc38a8c112cbb8067f8c5ea065ba9ad96970cdb285eccf0c685a18fd16d621a8bfe9b3dc13873dff6a064ee4355f68dcc", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYPTR, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[]]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
add_key(&(0x7f0000000140)='cifs.idmap\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f0000000200)="cc8502dc797be0da0b068386633121b06986fbe9518a93061c880c146b2329bb659bc188d8afdc766e705bd67bfb5c74c1e081cdec1c3a3fa8d96c6df863ef8bb52efa83cc01cf8b93840710c597fe46618746e05178", 0x56, r3)
keyctl$KEYCTL_PKEY_QUERY(0x18, r1, 0x0, &(0x7f0000000000), 0x0)
add_key(&(0x7f0000000000)='rxrpc_s\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f0000000d80)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a76c7e96aca1f8bbfd0930a0f3a7b3127e7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db857ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9bb2acaff52afa55f349c55ce1380657d925d7118040382421856ba8087bcbc22e70ea44da51858b9d35d8e13c598f525afeccadd79e607835f92aa683ae047539599e1dd1eed4bfaf2c06a2e973f18ad7186e73749119bd144af13a8f39e89b112f1d0bfeb6c1044b5e55ab57f58f2bc79aa9639caa01b348a49605b9b12351dbeb0e38bd01500b717a5bf63eec9e15f617612cc28b36ca3beacb1ba37645010d5bc047bb12955476326c8eaef11181f699a1ecbfd664065f68254fd0dabe77a3217b6aa87c2839ab43506c63e7eec891e30acccb2624143d8bae117b62d9bab98446ebd9e08c3c3f904172f39becf836eda5c339b013a3f387d44ab7cf1f6f67f1ff6e3f3268abc1fbf279a6466922ffa02546e7efa00bdf7c5335143920e6daa175e1602e63603d2706042841b9ba79aa9beabe2019b3df1ebf316a38b3272e936c91cbf0575e5fa0cbc0e992b83192a429cb008507f8007ac49e9b2d3f7ac7f9cb470ab2a011ba0a32e8fb7a3a3a5bffc1ec45ac3a219e53b11c640477eaa28e83142dbc35c084dbafa54034e34b38b15bdda592a073ba4f6c8ef04252efe476fbed0d87dba02236a3cf2fca62684c6b392660be5837fc64b37f6cf0d5b627a58c89a94162b575e76f8c35e18cf335aed0d501f7fa2e98d308e79ae7fcfc8163be7b86b35a8315ee937ba2f235f5c7116eaec99d76413c683a13518aa49e1b7a5366123ea111f8bb08ec6228a0fc85654d9df2d485bc1437e9656751bb44fc648462efe9ae33631368b75a38f72a46b1b9dec5c001f8b67226a5fbb73d565c65457f9a0945c930fc02c0a301860b266108c9517d7f0a861dd0ab5815bd54e43f541ef5fbdafa41c5d6a5d7a284199f9e0a4c8843d6c29725b23a63c73d69aa45439c3dca38d7567734ee75f356d1e86f3c5ab28e346bb9ae81325344aa1ca4d6cf2dcb7a51509fc0f25502e2cd290852ea707f2744efeb1371320918657497697637dc22c3a39551100b74fc1c9c50d0082933aaf5aa5a0bec283e593267de44e68ed751036ba9f3ca47d339fdf214e3908007bc7d966ee10a37f2e7f3435187592ac05ef1ed74a9f6e805630c9a38bc67123d764401791e0bd8c7219f431d01cff5191a0e310065a44c4c56194c270630508814fdebbe1224e31a33f2b1af8d9d93be52fd4088f7e51a40e7af734301287f30adad39510447ba8fc270edfd25cf47fcb9294106789677f2c137bdf409853b0d9506ba7795faebdef8885eba157f6b7aeba314e99d29da7c1d81b613463002bd567e17f616a89f26281a85645400084b0aed930b856f6bc40c763cc1cda1cfb2d37251ca645f8d83425c9423d39af4221f38fefa1efb6cad4352c1735856bbe4164462f6476d740fece7be2bd3e536e6696b798609b12c5d21a46a193a228c2078c4bebb1582ba892628e1690fd09e08e35d9fcc11b03901554f40ae8aadbae91895ee51282863d8da193340c5461054a02cbae8e9ab41b95315d5f2edd7d0ed1349a604094d3e3348529bb0e582b603e39713da528dc7d65029b9c31e3b6631359339a9c30b36a4e586cbee97683bbdd1bfa6f559f1aae230bff6534ac2c11c82763e78efdefec8ae053421796b7524bbc96acde04c5523d523cf0f73f3442b7be45a8710432592b973dd1b59c6ca0c0320ae14f9d64ca0ac3340e66c1e5185ca1473b1dc31c88181605a7b16ec97cb8dceb417a1093730075bfc322e1f2237f8e2cf24ac595f33ebadfd07b7f593851cee9bda2b35e26866bdcf2d682e98c41bd42428083b0571073e4841e867ed0672c8647ead6b849c57503134537f4fc54dd349b23d44ba5267c9e7a924c28adcadbc2b4062339d60f477690448ef79bb494b86c5d412ea9aecbbf319d97bae22f17ff299cf502178303b667e40668a73807905f4e48980aeca937a401c48fcc5232208e2a0ab1199b07fbe8855a9a6b202d339c50031b8cc8274ddf72240dcdc2ab376a31c3b2a54e2fb2d3b52c9f48922a7887cf2c467881686d25cac07b19628bc6c526c2a840c422cb7df44d8f678ba3d71b35bb3660f119a3066b6b41a0bae0b1aec48532389b83f55640152fa2dd1474649118ce730b8651511b2999a0edb0ccb6d4d87d57cb4a2c14337bab2ea0433e4b182ca5b0b83ec22242e7079a2b2afe0a997740011e844ff16e3b81ac178c493c8de3beec7f8eb7404ce48a16ffd4bcd68adaaf1fea5283c40ffdfa6a1200fb272aed6428947b3a33de97fd5e226c2d18f7701700c3e57d42e3b659c26e7af3b081c89da48a112a5754ede6e6dd11f4616a51e8bd5fe0a4104eed631155b1174300a0484ebb3e4c083ce66fe46debcbb237042eb0ce15867cbcef32ef026d0b880f15b6f73a77dab13be09cdd7203581da09b99ab7b2cf49f0981338e72a6265305da3ce69930d1a4e487f96c8386132cba4069597ce07ee7b2878d09d81ed840aca471bd28fec60cfcf7677b5f63c15269667b0bc5388758905f6c515f23593dcb0721a8ff092be1a000000000000000000000000000000002b6bf845581dafe2fca34b91cdd08e889e6c95bd573ebebbd735d00cc89198beacc2ae5398f0f050e38e2eb5410cc2b9eaf20b51f52828a4c00445a7bd93bf3ab03c0335f97f04e1552330a83c95677292066d", 0xfffffffffffffff5, 0x0)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000ac0)=""/148, 0x94)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r1 = add_key$keyring(&(0x7f0000000380)='keyring\x00', &(0x7f00000003c0)={'syz', 0x3}, 0x0, 0x0, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$get_keyring_id(0x0, r1, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000400)='keyring\x00', &(0x7f0000000440)={'syz', 0x3}, 0x0, 0x0, r2)
add_key$keyring(&(0x7f0000000480)='keyring\x00', &(0x7f00000004c0)={'syz', 0x3}, 0x0, 0x0, r0)
keyctl$clear(0x7, r3)
r4 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000300)={'syz', 0x3}, 0x0, 0x0, r4)
keyctl$negate(0xd, r6, 0x2, r6)
add_key(&(0x7f0000000080)='logon\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)="20a420912b19b69adea64941de55bd176c9b88f60e00dda6436f13da69cf4c4ebee0fe496106d98e81b31c00ff836a140216fe947c44cfcab1e920dbe7510bf7f6ce915274bcce53904cfea02ab3b6a10a7274f52a08565dfbdba7f5d1d549d41c7a2e58a4fd7f4d2489a7e205cafc07ae7e6d61fb39e4e5e7d9a3ab879891a7a08e130beba7768ea24b45cab4a04814415fc6dd0a9f5e1b573f694d4ebf51719e88acfc708640be9b96b4", 0xab, r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, 0x0, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, 0x0, 0x0)

19:20:27 executing program 1:
add_key(&(0x7f0000000040)='pkcs7_test\x00', &(0x7f0000000380)={'syz', 0x1}, &(0x7f00000003c0)="35d9cfc96f39f28d8386e4cdf665c8c176ec77d9f3e324d18c38e19107388a4fc5e06607f24485dc3f1b63bba3c6", 0x2e, 0xfffffffffffffffc)
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000002c0)='\x00 ', 0x2, 0xffffffffffffffff)
add_key(&(0x7f0000000180)='.dead\x00', &(0x7f0000000300)={'syz', 0x0}, &(0x7f0000000080)="4610bc721230eec6b3aef7dd4dfd930300e4000000000011e772de8f6d15f9184c6d99f6b3b7ae03400c12aef1877c762f96a83d75db118505de5cd43499eed8f62f46c7bd3678f255eb71a2bf1245003dc6f4e106b46566", 0x58, r0)
r1 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x0}, 0x0, 0x0, r0)
add_key(&(0x7f0000000000)='user\x00', &(0x7f00000001c0)={'syz', 0x3}, &(0x7f0000000200)="46f4f58e7ee27db9f509dd82cfb54b385a37bcecafe0ce9575db7daec5", 0x1d, r1)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffb)

19:20:27 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$search(0xa, r1, &(0x7f0000000140)='.request_key_auth\x00', &(0x7f0000000180)={'syz', 0x1}, r4)
keyctl$search(0xa, 0x0, &(0x7f0000000080)='.dead\x00', &(0x7f00000000c0)={'syz', 0x1}, r0)
keyctl$join(0x1, &(0x7f0000000100)={'syz', 0x2})

19:20:27 executing program 0:
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000040)="30f5dec3429813f3402beccbd9cfc3ae76f507b940550a55c91743506ef1e27fddc555b28dd6c40686ccdfdda30ad90b010932535a1715f7845afaa36ac8a734a0367d34515a704aad41414c8ef67e6808c99a308545065a2209b98cc82dbf14289f5a7d4f0f55a98dd08b0da2c353caa33d566cffb0f786d27b81c319efd00cbccaeec01a5454750fd22739f83aaff09495566c8397b8b4f054b3d35bb5389d70ee49f9dc52762d542ba492b2256093a3bcbfc1cca290ed10fc4d25e42be1dfee60a0609c038c2c4f9597f3", 0xcc, 0xfffffffffffffffc)

19:20:27 executing program 1:
keyctl$restrict_keyring(0x5, 0xfffffffffffffffe, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
request_key(&(0x7f0000000000)='pkcs7_test\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='ppp0\x00', r0)

19:20:27 executing program 2:
add_key(&(0x7f00000007c0)='asymmetric\x00', 0x0, 0x0, 0x0, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="9db4ae04103140430e4438ef0db57bffa368132200000000000000000c5f37df3568f4e7270ac2629f89dcce90a002a413542e8b0abf1930bc5781d2e1f92d61c90d5ce492c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e481263bec0dd8eff", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$KEYCTL_PKEY_QUERY(0x18, r2, 0x0, &(0x7f0000000000)='asymmetric\x00', &(0x7f0000000040))
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
r5 = add_key(&(0x7f00000003c0)='.dead\x00', &(0x7f0000000400)={'syz', 0x2}, &(0x7f0000000580)="b57d29d92abdde53b2769bf373a4d65956ccf52dc9e81687614329eeee66592ea737721c77d96b7fd4eed6849af714e0c506a5d456ebed144e526e3e59fcade2fe40630016d714d82df5ff126d516b913a5cb497a891e0e9b6ac69617675751dd11d", 0x62, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, 0x0, &(0x7f0000000440)=@keyring={'key_or_keyring:', r5})

19:20:27 executing program 1:
r0 = request_key(&(0x7f0000001840)='ceph\x00', &(0x7f0000001880)={'syz', 0x3}, 0x0, 0xfffffffffffffff8)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000000c0)=""/179, 0xb3)
keyctl$read(0xb, r0, &(0x7f0000000000)=""/71, 0x47)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$keyring(&(0x7f0000000580)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
request_key(&(0x7f0000000000)='user\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, r3)

19:20:27 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000800)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae102772d95e34ce27514ec9fa6b3104103140430e4438ef0000000000000f2407d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0c79d57194950fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x0}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000780)='trusted\x00', &(0x7f00000007c0)=@builtin='builtin_trusted\x00')
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000000900)=@keyring={'key_or_keyring:'})
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
r3 = add_key$user(&(0x7f00000003c0)='user\x00', &(0x7f0000000400)={'syz', 0x2}, &(0x7f0000000580)="a18e8d89a01b73860e8fa54a0d4d81c62b8497923dc5a00125b2a2c3b14981a8bf8ffdbe147c0674e10c49f82b04ceb9f6c4eed46f80f7919db9b6d4841b6dfb92a6564136e17d99c401af5e", 0x4c, r0)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000440)={r3, 0xe6, 0x5b}, 0x0, &(0x7f0000000600)="829e730c4fd6fe761cd0e3d3c8b99482da473766d33bfa416d4fa102c7fc6a59eb75b563d9f6879d8f051aa406071ea0bb7c3f45db22a405279f29280ef33e132589a589c3b4fab50143c940dc165aa88b8358e5116ad95881a5c4cf9ffe3023ceb1b35e2b9cb6dd8dce3419bdd6f0d1b493061ec466286e2a5218327aa1d45388d6be2cef8ed84833c7c75d2049dcd51caf92f0e9d47e85538288e9777fbe24fbc80e803e916866389efa10a53e0baa3e07aeeb10882a52b16b146730c2a9c5e7b1cd706cb21a54bbec063901d68e05bae7a2bb9a5d98e01678e4a32415f1d6396f83558c19", &(0x7f0000000700)=""/91)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$invalidate(0x15, r1)
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f00000000c0)='\x00\x04\x00\x00iKg\x00B\tfRo\xbek\xcch\x86\x8d\xce;\x95f\xa9Rq\xf9\x1dU\xc7\x01\xbe\xd8:(.\xd3\xa2\xd8+\xde\x18\x8d\xd8\xea\xf4\x18\xea\xe2\xdb~qZ\xb3\x80\xdb\x13-9y\x985\xc6\a\xbf\xa0\x03{\x9ep\v\xcb\xc9\x81\x1f\f\xb0\x00%\xba\xab\x8a\x80\'\x00\x043\xc4\x13\x02\x00\xe3\xa8\x96\xf5K\x97\x13A\xcc\f\xed\xfb`;}i\xfeu\xed\x8f0\xfd\x9d\'x;\x12x\xe5\x1a]\xdc\xa6\xfbH\xc8$\xb7\xc2Yp5\xaaC\x1b\xcb\f\xeb\x8a\x01\x9e\xbf\x87(\x8dp24\v=\x1b8\xd6\xfe$}\xa9\xc3rA', 0xfffffffffffffffb)

19:20:27 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$update(0x2, r1, &(0x7f0000000000)="53000029f6de4b39e1a11d15b6", 0xd)
r3 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000100)={r3, 0xfc, 0xed}, &(0x7f00000001c0)=ANY=[@ANYBLOB="656e633d706b637331206861d29fdf9ce9dc98542d76942f8773683d766d000000000000000000000000000000000000227500000000000000000000000000000051f558022ff052171a9265331ea0981d6684"], &(0x7f0000000380)="5f80c91d82acc7be012b64ad2e03b2a44c58f4c5ee1dac4f54358f09ef2bffe31e6550393f912adbef487c59042a1bfb6a9c62b47225c9233d67cbee8dc2927d62bc9aae95bc0c5dbb56436f6c2302c0e7d33216cd344781d8efc2a1a8302dcd12a35db5d9e088096dd6c52acd7f4eea6b537d8e659a712604b8c8217c16e62443611f1093d5c069c3ef6277337e2c108f0a869984a2e7002ff48ee02f8d6da1b4a0fa0183e10b6d0acba7551f4cb21d2348133bef8d733737d82da22b4373b28ec46410b90668a927c3725eaac8fdc33c7b2e1bc8c4462e69d931013325b5a18302d615b7e02c018220f16bc2eaa85b31688335b9d9b9b8cdc4d97a", &(0x7f0000000480)=""/237)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)

19:20:27 executing program 2:
keyctl$join(0x1, &(0x7f0000000080)={'syz', 0x2})
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000540)=ANY=[@ANYRES32=r0, @ANYPTR64=&(0x7f0000000440)=ANY=[@ANYRESHEX, @ANYPTR=&(0x7f00000003c0)=ANY=[@ANYRESOCT=r0, @ANYRES16=r2], @ANYRES16, @ANYRES64], @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000400)=ANY=[@ANYRESOCT, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000300)='asymmetric\x00', &(0x7f0000000340)=@keyring={'key_or_keyring:', r2})
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffa)
keyctl$restrict_keyring(0x1d, r5, &(0x7f0000000100)='blacklist\x00', &(0x7f00000001c0)='keg:-0\xa7\x87\xd2a\xb2?\xbc\x11\v)\xd9\x8c\xe2\xb8\xb0e\x98\x87\xff\xf1\xfd\xfc\x13F\xf7\x17\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb4f\xd3\xf08\xfbSW\x19\xa4\x13\a\x05\xe6h\xc2\xfa\xc0\x12\xf8\xea\xb0\xa8\xc1\xae\xb8]\xaa\x10q\xc3\x84^\xdd\x81D\xfa\xe2\xe8\x90\xf9Y\xe8\x97\xc6.\x14\xd6\x82\xe9\xff\x00\x00\x1b\xb7\xd6\xe9Gz\x01\x19\xbd\x02\xdb\xcfu\xbe\xd4\xaf\xa6h\xcfM\xc5Q\xe0\xed\xac\xca\xe8\x85=!}\xaa\x9f\xd0\xab\xa1f\xccr\x90-\xe6\xba\xec\xd5#\x8f\x18\x81\xa2!B\xa9\xc7\x99\xcd\xc7Z\'%\x04\b>\x86]\xfd\x14\xfaBI\x1c\x89Sb\xf9b\xd1\x1a\b`\xd5\xce\xca\xb0\xefW)V\xc2R` \xf01\x11\xd4\xd1\xee')

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffff8)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$search(0xa, r0, &(0x7f00000000c0)='ceph\x00', &(0x7f0000000100)={'syz', 0x0}, r3)
keyctl$set_timeout(0xf, r0, 0x2)
keyctl$read(0xb, r0, &(0x7f0000000080)=""/56, 0x38)

19:20:27 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$setperm(0x5, r2, 0x100100)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r3 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f0000000600)={'syz', 0x0}, &(0x7f0000000000)='O', 0x3, r0)
keyctl$reject(0x2, r3, 0x721000, 0x1, 0x0)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, r0)
keyctl$search(0xa, r1, &(0x7f0000000100)='rxrpc_s\x00', &(0x7f0000000140)={'syz', 0x0}, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x3}, 0x0, 0x0, r4)
keyctl$reject(0x2, r1, 0x7e0ffd, 0x200, 0x0)

19:20:28 executing program 1:
keyctl$get_security(0x11, 0x0, &(0x7f00000000c0)=""/227, 0xe3)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = request_key(&(0x7f0000000200)='.request_key_auth\x00', &(0x7f0000000240)={'syz', 0x2}, &(0x7f0000000280)='syz', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f00000002c0)='cifs.idmap\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r3, 0x1)
keyctl$invalidate(0x15, r3)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000240)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
r3 = request_key(&(0x7f0000000140)='logon\x00', &(0x7f0000000180)={'syz', 0x0}, &(0x7f0000000200)='bdev\x00', r1)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
keyctl$instantiate(0xc, r1, 0x0, 0x0, r5)
keyctl$update(0x2, r3, &(0x7f00000002c0)="3504b9f80794521428ebd4a1db7f6edbd3193b8c35b79ddaef8a3d5e02e14ab868e70ae4bf83caa8791e398603b41c17ded3a01088d6059f86bc1923e843090760d8eae7d99e9dcd63a99bbcb3bd79a85562a1503e89c21ef3a724aad8a673d2f09faca3d5594202a2db180a1716717bf2f55a0b998b1dc9e67a4bd9f08d5e240dde7a20776e10998616a8c77a6ad281944166d0f4", 0x95)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key(&(0x7f0000000040)='blacklist\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f0000000b00)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a76c7e96aca1f8bbfd0930a0f3a7b3127c802c835c2a2acf914efe7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db8d2da71bae7345e00b108cd9077d31c0d57ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9bb2acaff52afa55f349c55ce1380657d925d7118040382421856ba8087bcbc22e70ea44da51858b9d35d8e13c598f525afeccadd79e607835f92aa683ae047539599e1dd1eed4bfaf2c06a2e973f18ad7186e73749119bd144af13a8f39e89b112f1d0bfeb6c1044b5e55ab57f58f2bc79aa9639caa01b348a49605b9b12351dbeb0e38bd01500b717a5bf63eec9e15f617612cc28b36ca3beacb1ba37645010d5bc047bb12955476326c8eaef11181f699a1ecbfd664065f68254fd0dabe77a3217b6aa87c2839ab43506c63e7eec891e30acccb2624143d8bae117b62d9bab98446ebd9e08c3c3f904172f39becf836eda5c339b013a3f387d44ab7cf1f6f67f1ff6e3f3268abc1fbf279a6466922ffa02546e7efa00bdf7c5335143920e6daa175e1602e63603d2706042841b9ba79aa9beabe2019b3df1ebf316a38b3272e936c91cbf0575e5fa0cbc0e992b83192a429cb008507f8007ac49e9b2d3f7ac7f9cb470ab2a011ba0a32e8fb7a3a3a5bffc1ec45ac3a219e53b11c640477eaa28e83142dbc35c084dbafa54034f74b38b15bdda592a073ba4f6c8ef04252efe476fbed0d87dba02236a3cf2fca62684c6b392660be5837fc64b37f6cf0d5b627a58c89a94162b575e76f8c35e18cf335aed0d501f7fa2e98d308e79ae7fcfc8163be7b86b35a8315ee937ba2f235f5c7116eaec99d76413c683a13518aa49e1b7a5366123ea111f8bb08ec6228a0fc85654d9df2d485bc1437e9656751bb44fc648462efe9ae33631368b75a38f72a46b1b9dec5c001f8b67226a5fbb73d565c65457f9a0945c930fc02c0a301860b266108c9517d7f0a861dd0ab5815bd54e43f541ef5fbdafa41c5d6a5d7a284199f9e0a4c8843d6c29725b23a63c73d69aa45439c3dca38d7567734ee75f356d1e86f3c5ab28e346bb9ae81325344aa1ca4d6cf2dcb7a51509fc0f25502e2cd290852ea707f2744efeb13713209dc22c3a39551100b74fc1c9c50d0082933aaf5aa5a0bec283e593267de44e68ed751036ba9f3ca47d339fdf214e3908007bc7d966ee10a37f2e7f3435187592ac05ef1ed74a9f6e805630c9a38bc67123d764401791e0bd8c7219f431d01cff5191a0e310065a44c4c56194c270630508814fdebbe1224e31a33f2b1af8d9d93be52fd4088f7e51a40e7af734301287f30adad39510447ba8fc270edfd25cf47fcb9294106789677f2c137bdf409853b0d9506ba7795faebdef8885eba157f6b7aeba314e99d29da7c1d81b613463002bd567e17f616a89f26281a85645400084b0aed930b856f6bc40c763cc1cda1cfb2d37251ca645f8d83425c9423d39af4221f38fefa1efb6cad4352c1735856bbe4164462f6476d740fece7be2bd3e536e6696b798609b12c5d21a46a193a228c2078c4bebb1582ba892628e1690fd09e08e35d9fcc11b03901554f40ae8aadbae91895ee51282863d8da193340c5461054a02cbae8e9ab41b95315d5f2edd7d0ed1349a604094d3e3348529bb0e582b603e39713da528dc7d65029b9c31e3b6631359339a9c30b36a4e586cbee97683bbdd1bfa6f559f1aae230bff6534ac2c11c82763e78efdefec8ae053421796b7524bbc96acde04c5523d523cf0f73f3442b7be45a8710432592b973dd1b59c6ca0c0320ae1409d64ca0ac3340e66c1e5185ca1473b1dc31c88181605a7b16ec97cb8dceb417a1093730075bfc322e1f2237f8e2cf24ac595f33ebadfd07b7f593851cee9bda2b35e26866bdcf2d682e98c41bd42428083b0571073e4841e867ed0672c8647ead6b849c57503134537f4fc54dd349b23d44ba5267c9e7a924c28adcadbc2b4062339d60f477690448ef79bb494b86c5d412ea9aecbbf319d97bae22f17ff299cf502178303b667e40668a73807905f4e48980aeca937a401c48fcc5232208e2a0ab1199b07fbe8855a9a6b202d339c50031b8cc8274ddf72240dcdc2ab376a31c3b2a54e2fb2d3b52c9f48922a7887cf2c467881686d25cac07b19628bc6c526c2a840c422cb7df44d8f678ba3d71b35bb3660f119a3066b6b41a0bae0b1aec48532389b83f55640152fa2dd1474649118ce730b8651511b2999a0edb0ccb6d4d87d57cb4a2c14337bab2ea0433e4b182ca5b0b83ec22242e7079a2b2afe0a997740011e844ff16e3b81ac178c493c8de3beec7f8eb7404ce48a16ffd4bcd68adaaf1fea5283c40ffdfa6a1200fb272aed6428947b3a33de97fd5e226c2d18f7701700c3e57d42e3b659c26e7af3b081c89da48a112a5754ede6e6dd11f4616a51e8bd5fe0a4104eed631155b1174300a0484ebb3e4c083ce66fe46debcbb237042eb0ce15867cbcef32ef026d0b880f15b6f73a77dab13be09cdd7203581da09b99ab7b2cf49f0981338e72a6065305da3ce69930d1a4e487f96c8386132cba4069597ce07ee7b2878d09d81ed840aca471bd28fec60cfcf7677b5f63c15269667b0bc5388758905f6c515f23593dcb0721a8ff092be1a", 0x803, r2)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000800)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b746e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e700000000000000001d725caad81ca1b5ae820d343e4897a2bec0fd8eff82da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='trusted\x00', &(0x7f0000000640)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$reject(0x13, 0x0, 0x0, 0x2, r1)
r3 = add_key(&(0x7f0000000140)='.dead\x00', &(0x7f0000000180)={'syz', 0x2}, &(0x7f0000000580)="e4387304b64d212ed8ba486ad7aff18204be04a257b9fe64fc880378e41369aaaefa2bc5441c0faf0bb76a1f1fcaa6d8730db86a5ed05f76afbb35d2a9e8438a53fab15220c656c00f769fb995c52ed4261177bdbb07173973", 0x59, r0)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000240)={r3, 0xf5, 0x1058}, &(0x7f0000000600)=ANY=[@ANYPTR=&(0x7f0000001ac0)=ANY=[@ANYRESHEX, @ANYRES32=r2, @ANYRES64, @ANYRESDEC, @ANYPTR=&(0x7f0000001a00)=ANY=[@ANYRES32, @ANYRES32=0x0, @ANYRESOCT, @ANYRES16=0x0, @ANYRESOCT, @ANYRES16, @ANYRES32], @ANYRESDEC]], &(0x7f0000000680)="d2d1735f7c5e71c7e3a3c69cb6dff47bf8338ece34f915553371198aaa11513cb5b8acbac736ab732e56454f080062f24a1162d61f096c29c3bc3ca528f4f6f36a45772bdfde50838b04f528e50513dbb8295c8a2c0b489265ede2fc6ca20225604aa846def21399e77f521236056a8e4f104ea5e4a3bcc6d5028fabb8d0a01ed4694e2af766d4ee46ef40da525d1e2867ba5de9eaf8798a811027d837604d75c88db8e669eeef7b7d56d788d42a8986ec74a31858c90d3eb02bce5fe564f9d32f41eec4cbebb5a0f23dd43dd0573b583072bc879df63aeecc34367b67b6c71f4efcbe128d720d028d2ba75193fde0514918b00833", &(0x7f0000002bc0)="fadf129a10510a7bbb589f1106ed5ac1f847e6fa9a8a383a17521da571bf339db60ed3062e2368831e722e36f3e809be1ef7b189eedde9eff42c7f8e37d6c8dcd0d9ae38bfbaad87a9cdd1a3548f3692b1fec56df9933a51cd28c246b85a2f248828f57112dea47a617112884ac70d3b03c970436049fd399ca62aecd5f647303e87b83a82300056f6d823d73f50c991751fa1538bf2965e121845d069f27e3f7ded34d7713d1ed9322769b725295c6742879e7ea17b1f7a0757161c24beb9193338bd6d7d7d478d118a54b5913399b6e923709a48b618344a9fefeac20a4023dc0e8b90043fc091b992593c1d140ea066aa40d184bf6fa5cc7dfb8ee23d498b660947677c4989de45a73ba76c891e35385e1323721d2a8b5a0985d231e1b1c47024a0817aeba47183edda6e9dc32c053a544a0f93ee2ee1d065c51b2af569134c7b492a10d34b1c419201727876fba097faef8d2fb6ca1ef7f721b8794473c0497122f97b75880c2340873ea52a2213c74fc4ac50065a9caef04046815f1c41ac1c541b55b185b2f24860f122816a758784d6c03be4234a6759af42e1ac7a8d4db1c5c94782e601a38a4425afb9760943731519dd8519d6038eb296c36dbcc25524840a21a3a080c4af9df40f3857a099864af373e70b979d5f2f38584df96fb878ce286ae9d5ed9e98cae75197f987131de9deee2367284c177c4434979f90b08d827831d13437338464657dd1b9c7e13d921c9205d07553e9bf93707ac895aadac4f8876bf159cc49ce51bee781a302456271d8b644d5e43f757865d7b2f83971d0b1c55b0d7cde8f78528e37f7f73ff4ccdc28f1249535f29a35230d33f57fa995ffdf3a318577970928a5d4066c07306bbc84b3af9f5e40e5f9fed8c7d8219b56f2cfb889780edd26312e8a1e3b385ea642f93ea179de71d697c8ea5d3a4f36bc957be96ccc1739fc03d1173e2c8b131fbe5d81d3b32a65d0fd7fdfddff3238e428f881ff7a481517fd5dd1a9bf8cc668e5541edd3c26ee9c73eb5668962851c1cc23733e026fc1376f8922de6f8e59cb5a1b0147e705e36933dacfd6767447f45a1c0cfc9a50b6cea16e91fee1184e0b24f3514b3c8f49a1882337ebecff9eaa0f9ada92e200a79e51c70a30b1f2d2a106af9fa03bf9bc33905bff0a5eb28dd567b09947fe673d7c938d747718a27a4255703400d9fada1d5a8fd8c35d00865c4826b2d0693c719a07be41436b5392cd081d0ac58c8ffc6a3a0a56987691a8b1e5a82825338d39af82bd2add022d6baaeae0fe9a5aded3f85126989e6bb68189b715445be30ce0e44e0ec38bf5353fc3eb4c450764c439f1764845d8889dad0d9b34e58ef7f4b1a47627a1f2a44ff6e5352e531eae6b885b985d7a1255dce0e1bd97d9d1cf8587e0bef555ccf01bfe12fdb146bea65b1e03181b03af2c21532313dc0102eb71490819ed51d919ea8a61d1df35e30029034c910e2a5353069d592dc894d210eb2c3db1c07bd884734a921df7a57130422fe0f79fc17ae82ac1fa0cf0848c3ed4c4a4842754861e7b9b6cc38abb5ba9086c6577e231207e4c92e2f018c19415e382b02a2c0527a625f27326a56c345e5e3f9b2c489fa49b92a3ee4ef7272352df040b818710a472118b55740e6491d55d4d28218cfa9abbf3198a9bedfd097303b1155a6f231773fd1c7045ed7b79e9562686891e8fdd60835eb1a839d990d5a716075c41b80a9eca3ea3257ecb7ffbcd61964b4eb1d7b8096a914fe485ec37daaaa34eef7a133fa6e8b4edb8cc2d8b92b98a227cb54bb48323dafc3853b0415b1fa8a9528f1c26d7948de61e13d6df5822d530592f3a4040118095b0b52c51424788f8ca510b52ceb25a53dfb02b154000aa62b7eadf196f82ad4ca5d1f8fe87a02807291200d63417b59136a7e1f1799e6a197e300842f61b160d376b92223ef87e54fecbfb6570f688d087b3114be384f042290e1d76b24ae6c572e1fb7d00e763d217359f4245a23dc8e0d927cbf14ecc16b239037714183af5144a5d4e09eda9282ceaac28915bca23e3eb6547ef963e89d188c692b5528da446c7755307b1b65f4c7b8f64bccc856378a3150170aed4499fad0c9d6cd35cadeb0a5a7c65086cede3c542886aee12ba74171325e75d68cd2cf1a77fea90c9b38812aa0183e3df22c1e76bcd3d3a391f571b609125aa2d6b3447c45beac3e0d3ee82d70fd0cf6b1a08e1cde74ddb456623a7aadef5b86e2aea6fa1023704e0ad718d1bb371d85e24750dc6c0fb2c1a871d75567fdf46957dd4192dfee931c8fc4fdc0300f592b96dc9ab515b6609f8181023dddc2a57e5d02e18b685c741d6beb387dc149775931b957c14bbd0df127b9782cd28bbb1a7deaa9ca8e9d46399e339111b57abe8ed8d909b63c5712109be82521f22f28e15feaf4a66489455e5e3e4780048c9a0c06b8ff92eec85297933117a26d393a2ddfffef0162207aa1a7c8b9cf512067b305c5a44201e28c1486a117ce0b7c98e2af8e77e8136a2f58affb87e8a16d7fcb7d7f14464a59c5ad5b72e01fc00270a6cfdb19e48ef2befe273f8e7f107a72d066f233fe68f9a8de95f9e6d7da471671abacce89ad652de2a29eb10df848998075ea4feaf47eaecf299799e18ad6dfbfbdadac0c24ae4d62852dbceb6b29f87f0e80df04004937618e60f25bc5c23cac3139d03eb926de79ea9ce3d741f23b350b021396a84382195b56ede9d1d1542d84b057596833d7e2bb84c8f8155c9e3b9d1f0ab73dd008af5cf8b1a0394f615026cbd98dd59e1872e402914745e1b70e213caaab0d63f1d256d96f6c3e4cdbae2e979ac6fe1366ceeeb150df726baf674f5349d335cc44572fb55b367e660d291e3955ebb343762b65cb56fcae9a573b656e294a612926d186eeb1dc67aac16868860b7d619f82aff1b7fa35503b1dd69b879410304bbb0525b160ee961b67c77a61c30dc5263f63ad46af9eae3acdd54fe7f0f7104c564999f41fe35c7f9f166344f4c7d99d8b4a07aab24a09b914d1dbdc2458d00841df5806e3b5fdc5cccf32530d14b2bc873490669e6358d2b8ee5ccf46aeb386eb34dc251781b6ad892de3a1fc23ba28818ce06428a920ef573674d59cc3692b05806492da30f609c5e618deb1daa5c0fc98744ac8f1af827b083cb170ff44463d9a03f6407f19fb50040102b8030771815dbd8f4730b5b5a60d677668e6740c049e7856ee235b2d862d51f92dd8708c05d28ac0c710b13cf4d60217ef8232d55402139afd491bd78bb7165a148dd3b677750fde7eb660c6bbadf690bf4059f759e8dfdb5798f1a6d8115818ea35b43725d1096a577e8a58fdc67a890630baed62ddef70b20f0dce7d8d1eb3c4e0514ab614c504ab1b371d6d53c7c004613f95064511ecc150cc498c95778b3f21af3ae6bce7ca725f5797013858c426ab9ef6790ee6860420709633b17641661e6b8b1d3e874e68ba6f44648b1b58e413d1799dd39d231fca503e0f08339cf0a268f7bb248a55b38ff0af14e410e1b161a68d9abe118e355aee78c466e7d2b223dd327b0966a68eb3dc3eac321cf02a1622b01836e7cd827145306b1624a96056898adcb49b69290209e32abdbedfd12a5beec013415ef38fe969134c5ca05ba8893b62db4c710060128d1b91dba5c5104b584814b4d2433ad2d5acf3c10511f1c588ce4e7f3aacf334afc57fbc2f170d9c7315d731d8dcc32df1a841105dced275021d183925ff281c36eca6d2fa7718668cb0816bb1b345627282db8d02312d88012be4f6ee446c2234a21290f4fcdea44f2caea72d1abd7a50fb5c5105e0ff16a42c2a6fd51c1f983800a58474169c4dcf3853de15eca38844944c8c1269306a2b0381f3808f8de9669143fcfb768e2da2ff55e6d46f6c94d27ae11879b1b9b375d59191d78c0b27bdab17640c957eab11c2e197d9ff517cca8b7b78cba3a0f1679c4d4e69743ffa73140d12486398e8167b40ed449a18694058005a8238fc2fdc4352ed8254fd45df81e1fe37562ca511afad943e2082db2ac9dd12cafa0b4de55c3e5523ec4e8ae6e6bfabc40c837323365d95bff0529932074be892a313022afb7cc565340a495b43916ee8ce4ae8579cedef49d72c1cf2390486652d4c7c68904b7eb4dd8ac12998ece01ad5e7a4fd10fa53bd4746030a460a2b8b2ab105cf70000000000000081775e55746abdc79720bab21e419ee05c52f59496467d6f3e3fd68792123c0e5a85c0c807398d56060156eb4d15bc7760c18df3c1d15c9046fe7105920d9dc698f70a1cbc550a02c74cc17a607fca16b7f1168da1af0f9b8404a3000946ea5d155a6c46cdf752a8f3b29605e33d46df98b47aa02eadc80933b05a690d49ab78e3478e20bf3df79ca8a64e122ed43761a4679c4b06b235f102b165422e20cb1875ce6cd3ce11cbb661c33fbe795317ee5fd0b691c1a960e5fe7d1c6ceb1fa35c3ffc61bb9bd0f01d24e3ccbb8e52d635c97a041ca9147764b22d95eefa9f9b9389404aa5b8568a4b47d552dc1efa0607e1d59f1f20cab70734b903500a07be5c879f2394288c7242ba1621ed5c1c996aeb937c3a439cbadf981ab21aa59f040daaca819c061cae497754faf1bce93a643c1255e3dbdfbaa01556703a310f38079889d0ddc0ac164e5a307142b169b3ac7c5d07692badbf4dc56e49133b59024a200f3957f7668c0320c1e501ca41ca34a1dd1b92dad39a03e113ea9efec1d3b0f4d88431091188f8fe911da060d696d327f4ce2a3b5a7555f5c2c4c6d2e04f11131ba766a2f063511f1b2e043846ec74cf2d5a270edd27447b36aad70179fb492f31f53dca4f2ac8990c52650d71b4a9dd44a4854b5eceb55352bbf10b63b0cf54e85e7a7e7366925f8c7177f7285148315a6dfa456d35df0f2d2791a007a87573dc91e0e857fdeb6c0e140256349bdfd046294ec659af22f9876c752d00b14ea40281091ef22134ad770e508c666e289df330d471cde2384d2f4048ca68fbd3f30a130342562f8bb0bb9144ae9140b625dd673b428388d109b952bac05bfc01d03423dab37cd3e975566e80216755da395f9d16a4cf9d75d6ca43f6487814065024b962a622cc6729a00438fe38b4ba39347182cb460365a1cef77097afaefd9d2eca31108b7f80000000000000009cf7060329a94916b28ce756c31c374b23a301ce3c74271e60861bf7123c8d14485993feaad124ea93585e78f4755faeb8eab66277221409136b775ca165e9c542c45436f034642ca4646843c4cf9f97c340c6169d2d3b0c112497a34feba1e5b8f60746296d5389493dfb68887bff22fa91dbdc3202c51eb676d305c542fbc704357ac9a91e2b1d9656d462436609ef27faf768e898e92bfb182a0da00b5f42d16fdda8922a33cef95d6445b30b9c4c6ded77966bbbc8a014f7188ec80e71219ac6075ae7e4291fb3aaeb4cbe4e1f3de805614e6b8c370f45820186073ef775732f48ecc1d1bd425f8cf21ab4fbff68b3481961aa198cd29b3b393e9421abebca787d48e717163c80a0b0a2b5aca93cc4e679155745dfe9ce4efbb963672fe1b13a4fe8f84d6b82dbdb35728c57ef9594d635448c118bbf96a1be3898f03a206738ca1554d770de57d6559006848472c907e6843710f470c43b1934569fcd4e26ed1ae00126383c6638a2b311d607baee8871d6a36e2081b74d24ed6bc926c1b74d5e78d48a6327239d9e8428b561d3bb5e31406f2b51d6e2de5660db28573531ac67ea47e3b93a72138bcbe4ca7259b661d1e84dbe0ea6d995c3bf478a94011dcc7b13870faaf3baf63231cf842f28a18d32067fd25b2d3af1b80cf98e807e26687f4a3ceebc98f56af8edcd40b3ff6532eecdc6e974d487994102b9a3e17dfc")
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r4 = add_key$keyring(&(0x7f0000001780)='keyring\x00', &(0x7f0000001800)={'syz', 0x1}, 0x0, 0x0, r3)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000100)={r4, 0xfc, 0xed}, &(0x7f0000001840)=ANY=[@ANYBLOB="656e633d706b637331206861d2bac378fddc98542d3873683d766d000000000000020000000000000000000000227500000000000000000000000000000051f558022ff05231be9265331ea0981d6684000000065d6e5887bc682924519715130f4c08d8803e1ddf045fb0e71e2e10f5b1e73de72de46eb6266ebd808ddaad85c642ac15a9af3b14f816d48be162fe9fc4cc3a6193424548fa93756f75e6dcec71d0ec98bae975dd4aebf1f1a21a82d40b7e166ee5e951970aa2330a6ebf0b630ecc42d6b263f209d72a1c4746b909ab19ef0f1c43c0da06841a4044c89559c346a510554c8d6f24dc8bfa4b892905ef735511e0d07d0fe84f3650794edd98ac82e4b1c2"], &(0x7f0000000380)="5f80c91d82acc7be012b64ad2e03b2a44c58f4c5ee1dac4f54358f09ef2bffe31e6550393f912adbef487c59042a1bfb6a9c62b47225c9233d67cbee8dc2927d62bc9aae95bc0c5dbb56436f6c2302c0e7d33216cd344781d8efc2a1a8302dcd12a35db5d9e088096dd6c52acd7f4eea6b537d8e659a712604b8c8217c16e62443611f1093d5c069c3ef6277337e2c108f0a869984a2e7002ff48ee02f8d6da1b4a0fa0183e10b6d0acba7551f4cb21d2348133bef8d733737d82da22b4373b28ec46410b90668a927c3725eaac8fdc33c7b2e1bc8c4462e69d931013325b5a18302d615b7e02c018220f16bc2eaa85b31688335b9d9b9b8cdc4d97a", &(0x7f0000000480)=""/237)
add_key(&(0x7f00000007c0)='big_key\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, r4)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYPTR64=&(0x7f00000003c0)=ANY=[@ANYRES32, @ANYRES16], @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$negate(0xd, r4, 0x10000, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$revoke(0x3, r2)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key(&(0x7f0000000000)='keyring\x00', 0x0, &(0x7f0000000080)='<', 0x1, r5)

19:20:28 executing program 3:
add_key$user(&(0x7f0000001a80)='user\x00', &(0x7f0000001ac0)={'syz', 0x2, 0xe}, &(0x7f0000001b00)="bf", 0x1, 0xfffffffffffffffc)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$revoke(0x3, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, r3)

19:20:28 executing program 1:
keyctl$restrict_keyring(0x5, 0xffffffffffffffff, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
add_key$user(&(0x7f00000000c0)='user\x00', &(0x7f0000000100)={'syz', 0x3}, &(0x7f0000000140)="63eb8143dda32d994dc73986e75e57ec000898f94898d8561eab293fb23933177f1a6cea9eaaae4468d578aa09b8263ebbcae3cad4b32bf0e94a7eaa944cef70eaf328", 0x43, r0)
add_key$keyring(&(0x7f00000001c0)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r0)

19:20:28 executing program 0:
r0 = add_key(0x0, 0x0, &(0x7f00000001c0)="efaff6de97433db2154619eb57d5dcf49c3fdbfc55737aca0c7095c4ad89366215f62d4a345bb35cfa245012c5b16883e53f83e1e5626cf209f4b4150a8062e34eac88f95d65224ef361f8d25e5c26b4d2bc3cfc8cf2348d09", 0x59, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = request_key(&(0x7f0000000080)='big_key\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)='\x00', r3)
keyctl$set_timeout(0xf, r4, 0x6)
keyctl$KEYCTL_PKEY_QUERY(0x18, 0x0, 0x0, &(0x7f0000000200)=' hash=', 0x0)
keyctl$KEYCTL_PKEY_QUERY(0x18, r0, 0x0, &(0x7f0000000000)='\x00', &(0x7f0000000040))

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_MOVE(0x6, r0, r0, r0, 0x0)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000240)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f00000001c0)='keyring\x00', &(0x7f0000000200)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffe)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x2}, 0x0, 0x0, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
r3 = request_key(&(0x7f0000000080)='dns_resolver\x00', &(0x7f00000000c0)={'syz', 0x0}, &(0x7f0000000100)='\x00', r0)
keyctl$link(0x8, r3, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$revoke(0x3, r2)

19:20:28 executing program 2:
keyctl$set_reqkey_keyring(0xe, 0xffffffffffffffff)
keyctl$restrict_keyring(0x4, 0xffffffffffffffff, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4446ef0cb57bffa368132207d9b10ac9a342e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703bf4c2d017e8aa1920d343e300286cdbed57c1e0382ab7dd81b844fbdfc2d31803a5f93374053c4e4d686f1e1708b388116ecc3ee26ec7a14bfe5eeadb305bf76696db61ee74782bad198693cb97146f776230f6d833464d80861b2fc8eb3b34b1759f6deef42616a29578c1bd8c379c1acbf6998e771e7821ed3ad76488f87", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
keyctl$reject(0x13, 0x0, 0x3257d4e1, 0x9, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
request_key(&(0x7f0000000000)='syzkaller\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='\x00', r2)

19:20:28 executing program 1:
keyctl$assume_authority(0x10, 0x0)
keyctl$invalidate(0x15, 0x0)
request_key(0x0, 0x0, 0x0, 0x0)
r0 = add_key$keyring(0x0, &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000780)='blacklist\x00', 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r1)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffa)
r3 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
add_key$user(&(0x7f0000000280)='user\x00', &(0x7f00000002c0)={'syz', 0x2}, &(0x7f0000000300)="287ac4813d441b3a1ac1030bebf982f6bc3a573671ff635ced604bbd351213e5a4098c7ce5e936c6d85a2933b0b7849ec734ca7458d97bae883b1f6cf322243febc8c2cdefd133f6d50bc5db3e996c54146b54caf83190ff53225128e7be41633def80ad76759e0a34c55a74f11e1d5356905b7cc0060e9c8f83b0bf2e12c4d1df5c7af8cb697bc7ea7217ecedf3ca3d193a4ce396d5bc12d8ed07e0c9ad0363e250933b4478203474277099b780c7f038cd7e346131b3f6ad577ec5053d5922ced731303e4a97fae71560924928ea118f53f07978ed6095fbc0f05da1db0ccfe4a378dc18592ea18afe48", 0xeb, 0x0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r3)
r4 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r4)
add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r5)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x1}, &(0x7f0000000080)='-\x00\xa6\xb3\xf6O%\xc2F\xdb\xd7\xc8\xd7A\xa4@\x8c\x81O\xe1\xfe\xefaD\x94\xf6\xe6\xe0\xd1\x9f\xb5h\b?F\x13\xdf\x82\xd4<sFV\xe3\xdd3\x1c\x9c\xdck\xe61\xbd\xf3\xfeB\xd2\x10\x9d\a\x85%\xfb\xe8\x9a\xb1\xa8\xca\xc2<\xaa\x8f\x84u\x0eb\xcaq\xd23\x83\xef\xa1\n\x94\xdc/\xb2y\xf7\xb6R\xcc\xc3&\xafy\xfc\x00'/114, r5)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key(&(0x7f0000000100)='dns_resolver\x00', 0x0, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x3}, 0x0, 0x0, r1)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffa)

19:20:28 executing program 0:
keyctl$set_reqkey_keyring(0xe, 0x4)
keyctl$join(0x1, 0x0)
request_key(&(0x7f0000000000)='cifs.idmap\x00', &(0x7f00000000c0)={'syz', 0x1}, &(0x7f0000000040)='-\f\t$\x9e\xe7\xa0_\xe8\xf1\x067$p>E\xa4\x11\x8a\xa8i\x9d&\x87cpusat(-\x00\xed\xe0\xd73r\xcd\xec\x8ctj=z\xe9\xbf1\xda{W\x03\x92\xa3\xd0\x02\xf4\x83rm\x7f,\xc6\xe4j]\xb5\xb7\x87\x13\xc0_\xd4\xbfB\xd7\x94\x17', 0x0)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000080)='encrypted\x00', &(0x7f00000000c0)='user\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x2}, 0x0, 0x0, r2)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$invalidate(0x15, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r1 = add_key$user(&(0x7f0000000200)='user\x00', &(0x7f0000000540)={'syz', 0x1}, &(0x7f0000000580)="30e1004b616a11f22779383c6642d5e0931b67aa5772ca4d5526ae533478611907ab89d6a29515d09ffe9f37e21b640a808c", 0x32, 0x0)
keyctl$KEYCTL_PKEY_QUERY(0x18, r1, 0x0, &(0x7f00000005c0)=':chain\x00', &(0x7f0000000600))
r2 = add_key$keyring(&(0x7f0000000400)='keyring\x00', &(0x7f0000000480)={'syz', 0x1}, 0x0, 0x0, r0)
add_key(&(0x7f0000000080)='asymmetric\x00', &(0x7f0000000440)={'syz', 0x0}, &(0x7f0000000100)="76c91d41e89452784df273a30f6e522f3cea85f7323f146327f4b38b1d2c4f142836e0c83cf336af38b5971e3c465a10fd8c31bac98a56e8b545bd0897a3dfb7563dd8cd0791fa4b9d2eb4a9005f79788dc5d41d0c990a4cd209dc19a9a5411bb3593b348f7a6e1e95ca16991eb5cdc555916436b38b37fd83355fd6cd85c0d0d87d3397f2d377077ae5ebc448301efabfe84b0f9cf58e5a3a1eed86b21a80cec33e355218955185600cb3f91f58b854088e406033784a6434d5599ae61bb6c59272a9fc89eb91503b9a2e5f06280b89061681240e7e366518d44a7b44aa87e8", 0xe0, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f00000003c0)='keyring\x00', &(0x7f0000000380)={'syz', 0x3}, 0x0, 0x0, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000640)='cifs.idmap\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000300)='encrypted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000680)='tru\x04\x00#\x00\x00K\xc5\xeb\xe3\xd8X\x00\xfb#\xed\xd6|>\xc8\xc5\xe0\xc0\x0e\xbef\x17\x05\xf2O\xa7b\xd3\xa2\x9b`\xb8\xa0\xa5\xa9\xc5y\x02\x1dq!\xd7G', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
r6 = add_key(&(0x7f0000000500)='.dead\x00', &(0x7f0000000240)={'syz', 0x3}, &(0x7f0000000280)="da1704186fd92831dd77553afb6bd2e61c4d3c9906dc3ec78735968ee5def6c6fa2016a60dee49d1d10c646c3a201046dc61037a310a899f96f6f6da969320b262caed6d065f841ae16d21af4ab06da1d28a79846b54cd97feb9180a148922c60fae23a70d4a3c17c6b7b1f480405188e888fe35f873030a5d78da13af57a7", 0x7f, r5)
keyctl$reject(0x13, r6, 0x3, 0x1, r0)
keyctl$link(0x8, 0x0, r0)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_MOVE(0x6, r0, r0, r0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000280)='asymmetric\x00', &(0x7f00000000c0)=@builtin='builtin_trusted\x00')
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$get_security(0x11, r1, &(0x7f00000002c0)=""/112, 0x70)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000080)={r3, 0x1, 0x4a}, &(0x7f00000000c0)={'enc=', 'pkcs1', ' hash=', {'crct10dif-pclmul\x00'}}, &(0x7f0000000140)="fa", &(0x7f0000000180)=""/74)
keyctl$setperm(0x5, 0x0, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
add_key$user(&(0x7f0000000340)='user\x00', &(0x7f0000000380)={'syz', 0x0}, &(0x7f00000003c0)="58e9e026a009dafffef14aa9bb939bae2a3ef3a42e1755d13b386e62db78ae7e99ec9bd66296ae7b8184d63f0adeb065383553ce73fcd6ee739af59e8999a33df64967a5a6a078cea3268b980651ea6a7015e20425972dda47813d966f6258ba7073c2eecaa370984376188b27cd02ce2d8f567793e7c2b384e651819f5a38aeb88eda", 0x83, r5)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffb)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000540)=ANY=[@ANYRESDEC=r0, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f00000003c0)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$read(0xb, r1, &(0x7f0000000200)=""/237, 0xed)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r4, 0x1)
add_key(&(0x7f0000000040)='logon\x00', 0x0, &(0x7f00000001c0)="30f5de", 0x3, 0xfffffffffffffffc)
add_key(&(0x7f0000000000)='logon\x00', &(0x7f0000000080)={'syz', 0x0}, &(0x7f00000000c0)="3da2acff3d760e48099a7de1cc79c4e2366976d6f47d74185a58f7aa33994e7ba7354ca9e8860e65255a7b2ed982f5d30d41be2fc60d893d29ee1bd36ae84345b87c905aca36353e6c62b3efa54e730209eea8bb5d2370e4470ee722e5cd8f923cc39093a7a8d64152e45f7f5cbdcd85dc991d33a92323c9847a234aa3694b357b33ae93b74a306c3e487882f7c11f822610506bc81872c721cf3d290f3aa3b5db49f94409e1344a", 0xa8, 0x0)

19:20:28 executing program 0:
request_key(&(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0xfffffffffffffffd)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000100)='logon\x00', &(0x7f00000000c0)='key_or_keyring:-p\xa7\x8f\xd2a\xb2?\xbc\x11\v)\xd9\x8c\xe2\xb8\xb0e\x98j\xff\xf1\x92\xd6\'\xfd<[\xf2o\xc1\xc7\xf7\xa5T\xe2\x93\xfd\xfc\x13%\xe5M\xd1JF\xf7\x17')

19:20:28 executing program 3:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
keyctl$reject(0x2, r0, 0x800006, 0x203, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000200)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffb)
r5 = add_key(&(0x7f0000000180)='cifs.idmap\x00', 0x0, &(0x7f0000000040)="3080", 0x2, r4)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r7 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r7, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r7, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r8 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r6)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r7, r8, 0x1)
keyctl$search(0xa, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000000c0)={'syz', 0x2}, r8)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
r3 = add_key(&(0x7f0000000300)='.dead\x00', &(0x7f0000000340)={'syz', 0x2}, &(0x7f0000000380)="3e2f8f9511e6b3a47ad1f8955513de3254a5169b25f97a69cdb31809a6406971d58e7c43dd74d0df5ec29863962e86eda517eb58e4c9c43030b83c060def0748feae5a86e18926b41744126d3b6cca31fc70bb4799d2e225d1db60d79f4a72e6589f08c59dfa5ededb81d5c4f0ee8c14f70f39482e302105e2ae2b96eb86d995991f00f921d3570dac2beca22eca898fd8a79704c2effaf202f788e808724a3593cec2d3bb093debfb5484d44923af87ab494615cc7ef056663e56c809d1f5545972f7dd45bd818ac01a104cff6c465fe61977c99d48e86cad04656f34c41dca65be678bf09ed39099759501379484afe022", 0xf2, 0xfffffffffffffffc)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000540)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f00000005c0)='asymmetric\x00', &(0x7f0000000580)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000000600)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
keyctl$reject(0x13, r3, 0x3, 0x2, r5)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$keyring(&(0x7f0000000280)='keyring\x00', &(0x7f00000002c0)={'syz', 0x0}, 0x0, 0x0, r1)
r7 = add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000140)="1081", 0x2, 0xffffffffffffffff)
r8 = add_key(&(0x7f0000000040)='cifs.idmap\x00', &(0x7f0000000080)={'syz', 0x1}, &(0x7f0000000180)="8e549871e9f277888c01ae0078cfaee060ba49a7fff3a341391664a4d37f2b7fcfa3bcca732fe0f08a0ae654640d77080556da80c1a1aece455c6a3a14e7af358d000dc157d1ac92ff4426f16bff2afb9a7e9db74f2daed4e0c1bfc386719b866a1847e9694580832ebfaed85aed8f167afaa27e6db535570395522d0d67813cecbea29791b29b37efdc07d89ad7ee45177fb5925c715a14eb5dbe708f25de0de66460ba30991409380a7d816b72f1d8297c01571ba69fdab7e1fbc72cdd453556ebd9f9aa689bc95ff29e94", 0xcc, r7)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r8, &(0x7f00000000c0)='pkcs7_test\x00', &(0x7f0000000100)=@chain={'key_or_keyring:', r7, ':chain\x00'})

19:20:28 executing program 0:
add_key(&(0x7f00000007c0)='asymmetric\x00', 0x0, &(0x7f0000000840)='[ ', 0x2, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = request_key(&(0x7f0000000240)='logon\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f0000000480)='-\x00', r0)
keyctl$unlink(0x9, r3, r4)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000840)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r2)
r4 = add_key$user(&(0x7f00000003c0)='user\x00', &(0x7f0000000400)={'syz', 0x1}, &(0x7f0000000580)="86fbec653fdb15806ddd2cc30004e3b14fc51faff125c9f6c4de9237f4c421bcaaecc9256c246fd8811cb61378d48718bad5d1eeaf37e4972e71f54ffc89bdaa5fc9b4cde9ebbc805b19b976e5d5504053efeee8626e9d636330bcdea8a7e7941e0845ae9dd8df4c7b81f8edda03ba4f201946fb85acc1673f41606b24c5a072ba79387a2aced1bc267a98e9128e2d07bd91104a28e87ada0e2659a80f71cf6ea2b53fc008ececd6871d5d6a8897893dd57a8b635a88e23597b8c1dd099480b20ab69f678f44047a30fcc4da62628932d092d11bad430fb650de192ce6a26a7599", 0xe1, 0xffffffffffffffff)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000000440)={r4, 0xb6, 0x57}, &(0x7f0000000680)={'enc=', 'raw', ' hash=', {'streebog512-generic\x00'}}, &(0x7f0000000700)="16d4d3b324449f12a313cc534ff546e6dd9fa3b93d222b0ecae51adfa62638b26ee4f719418e9a4805c65c062aa45c69b017bc9181827576ba2fc4c1a5824044fdef5d5a8dce90f38060c6fc2ddb0d1bda19a49918cb6f887024ff7ad5c419747db4e1c211f5759ba556dd4869b66297b2eb2c9bda75c048bf54e681ef8f1abd895970f5b27f7bc5b89b94eb45f071e155cbcaca4cb22d56dfcba941379d54c90e69865e90f1e192d6cdd02df9043cc72b2ac06e79c4", &(0x7f00000007c0)=""/87)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, r3)
keyctl$revoke(0x3, r3)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$restrict_keyring(0x4, r4, 0x0, 0x0)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$unlink(0x9, r0, 0xfffffffffffffffd)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x3}, 0x0, 0x0, r1)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, 0x0, r2)

19:20:28 executing program 0:
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000000700)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r1 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r0, r1, 0x1)
request_key(&(0x7f0000000580)='blacklist\x00', &(0x7f0000000680)={'syz', 0x0}, &(0x7f00000006c0)='\x00', r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000000)={r3, 0x8a, 0x84}, &(0x7f0000000600)=ANY=[@ANYBLOB="656e633d6f61657020686173683d67686173682d636c6d756c6e69000000000000000000000000000000000000000000000000cc8eefd6f3029a00000000000000bb6d00"/85], &(0x7f00000000c0)="d0860431456882f70d499b9df57030247a13ad9d16d464c1de6b501db696be0ee664283a7c22160de1bb325d54e07ad7e90b1c54f29e6b2bae10cad6503da051502ec2eacf77413b0155860871047825e5b98d28858fceab77dba77a9c8fc4a02531f363aa3e883e7e72119df0b447bc16343085cf7b1b2dc025b37ef90235d10396d80de685a7ac649f", &(0x7f0000000180)=""/132)
add_key$user(&(0x7f00000005c0)='user\x00', 0x0, &(0x7f0000000280)="215429df065b6942b3fde04530c6590d493537fe972b4fbac0fe7d67900ee55e74dd6e919e9ff1a2c60e4ddd3469dd991a337cfa14ab5dc38e73a27b894b0cb7b9d02693a0b6ea0a711e0d4273ca3fd8db25bb743ecf744f6e70aaf2744038b3aa9411796e7aadc873b89cbaccb56ab770bd022542f8c79dd67da574347f92fd5fdcd40f2e43a48ae92959677ab867322434b3f401e06ddd762e91e54421df66e5582abb07a78dce8622990bf76f7d2c9e601633d787d64f900fa1c83ce33c7edd1c3f79cdcaf94c0f7ea47cbc0719985e51c03658b723d056d9ac9a2d4e44b7b50700000000000000e00a0faac0b5751eff55e4c82ed8f7c4d21b5ba300b37cf6846522d836fdfa412383985178a7f8337a42647ff6c801626d6a3b92e1da6172da9eb45acecb56fb7014353e79e7479480ecb5033e0216c7e5a49b058b021b428e425705fa134d8384864aa716a993fbfbb6a389804a3bb41f86e5b7d449785229498eba0e475c8f5f31c5885e136c2d8f6d4fcfd918478f1f84abe7333d74931ceb4e12f9fd62bab292b4f5c19017c463deaed15a9fe97ef0a44b654c71ccf75a53c265ee42015b98589b608a309601a6d7f05d7a26bf9638238f7877fda1f5b0adda6ce9e1d98d9f4dbbf9330b1a8f30f5ed486b524d9d75b6203673e26a4deb1a571b7e4b88b93213724ed95e7ea383c23ee0af0f4bf2a804925d8ce54397de3b7aae01883bcba4f67e0ec887c8dbb65dd5f9c71e10458120986657bd4659637e0b1dcb4c62a0b2ceb31b56627ca6819c268e031c68428aa62219ec233e1f1dd8d820d4d888edc601c0db22a21cf73c2d6db2f1d15f000000", 0x25b, 0xfffffffffffffffd)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000280)=""/81, 0x51)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r4, @ANYRESOCT=r4, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r4]]], 0x5, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r4, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r4)
keyctl$read(0xb, r4, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r4)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000000300)={r4, 0x88, 0x8b}, &(0x7f0000000340)={'enc=', 'pkcs1', ' hash=', {'sha224-ssse3\x00'}}, &(0x7f00000003c0)="445d06637ff6bb78ef15b23e5f7e9abe440d0cd6474daa18167d5fdc3c13a3d410b066d138e21f0830337539bac6553173236b8009cab39de3ff5a40947201b79221127bbd17a2dc9d9c3e0bb4b524933ca852f355992c51efbeccd1e5858c1d06d4d8719e3864235c40aab2e7bbb57c2b8ff9464dcea0884e0d36b0142d7e316dc41ea8728ebcba", &(0x7f0000000600)=""/139)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000000)={r3, 0x2d, 0xd0}, &(0x7f0000000040)={'enc=', 'oaep', ' hash=', {'sha224-arm64-neon\x00'}}, &(0x7f00000000c0)="90025ba81ed88c389089ee1d7999e66ce1cfb9e5b8e9a9de4f9f9417572ea3679222f63b9b64af4178c49786dd", &(0x7f0000000180)="2d8e5b80e0f27f9214b64c388fddd30e5b08c81b520e2847008b9fc7b6b9858ae14aa698dbd9e049911651253cf45709a419d3b2bd69e4d9e855e6cefb5a8bd9872ed42cd9b42ed9d0f570daeff9d60ebb5f37f9f92f8e37ec1db42a7279b721c46e16e556c909cfdb2df80e8c6dda77b5e3e80d81df58b0ac7ea7c52a2b8986f6419fcc3fa80e55092d887b566ce67da308798e187e05b59da8b2f7bb85f060270a44066f4f17c0dd07abb324a8c2bc5f199c7d63e1ca5aeb96ba2dbafe250cfe2eab50847c5b83aeb3d9e44d1a262d")
keyctl$reject(0x13, r0, 0x4, 0x4, 0x0)

19:20:28 executing program 3:
keyctl$set_reqkey_keyring(0xe, 0x1)
r0 = request_key(&(0x7f0000000000)='logon\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f00000000c0)='trusted{.keyring({})mime_type\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368130107d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da8524a9fc0a3449003a7937de1be92a6a4f3ece7b11bdd941da98060000005e6a0fa0419d4947c31fa123ba263d5346b58d1c80e08f6accc94da6f61c7c80e8f29429eaa8d09f8d929e37d140b0c10f6e6c0065db97d4a985de5582b9d66a3c9014815966f3c2822c5c0eb645f497768d30c3c9d63633a927447518fd231e036abc92ea372dd9a82e3a1c680b31115eaaa794302f04a54e3546378e02fb4a9cfe5078acad1fc6d0eaef79bcfc6f753338b564e48a465ccf61ade2c678601dc8423f6cc2b428d42486d87dd392dc", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, r0, r2, r5, 0x1)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000003c0)=@secondary='builtin_and_secondary_trusted\x00')
request_key(&(0x7f0000000440)='syzkaller\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$describe(0x6, r1, &(0x7f0000000000)=""/42, 0x2a)
request_key(&(0x7f0000000540)='asymmetric\x00', &(0x7f0000000580)={'syz', 0x1}, 0x0, 0xfffffffffffffffc)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$restrict_keyring(0x6, r4, 0xfffffffffffffffd, 0x0)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000400)='keyring\x00', &(0x7f0000000440)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc57819cbaf92d61c90d5ce292c4842037618be44a1f3837e23e9b3dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/21, 0x15)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='syzkaller\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$KEYCTL_PKEY_QUERY(0x18, r3, 0x0, &(0x7f0000000580)='m\x00', &(0x7f00000005c0))
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r2)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r0}, &(0x7f00000000c0)={'enc=', 'raw', ' hash=', {'sha224-ssse3\x00'}}, 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r1}, &(0x7f00000000c0)=ANY=[@ANYBLOB='enc=raw hash=a224-ssse3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\b\x00'], 0x0, 0x0)
r2 = add_key(&(0x7f0000000140)='.dead\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f0000000380)="c3543993f40dd2514632455d209a097a1a0edd08e790ffc9c6c4a7ef210ebeab632904be1875c8ead727775629e2f664662f57c3e85275b895c45070b322a45cd794cdf381b11d4d33d75679e9e40d5640c459fa0af8dbbae3237d011a74e7def839a548ebf73fb93611f498e89f9d6fda8d46d8df54c8fd271a908b8c7127129f922565216c2bf4457e61d4e52004997c491d871b84e217874a49ce9ffa91eaae8fed4651d1a8615b2993a00bba364406dadda7a396a39c130f87459f0541d0e26976c77b7dbc27b4f22e72e1adf5b8bf6a1ad94549d978c7fe9fa8980007dc9b9ccdd64cc95111a416", 0xea, r1)
keyctl$negate(0xd, r0, 0x4ed439bf, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r3}, &(0x7f00000000c0)={'enc=', 'raw', ' hash=', {'sha224-ssse3\x00'}}, 0x0, 0x0)
r4 = add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f00000001c0)={'syz', 0x2}, 0x0, 0x0, r3)
keyctl$restrict_keyring(0x1d, r2, &(0x7f0000000300)='pkcs7_test\x00', 0x0)
keyctl$join(0x1, &(0x7f0000000500)={'syz', 0x0})
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000240)={0x0, 0xaa, 0xa5}, &(0x7f0000000480)={'enc=', 'raw', ' hash=', {'sha224-ssse3\x00'}}, &(0x7f0000000540)="93b1cf7dec3f6df7d8df3a721179f46509f451bce4d9f776816b2f42ecb42d99e4c26a5ba37379ba7fbd5b35da994fdb5ca09321e94f38adb0300c2560ad310aded4397fe05d27a9fd54329913495eeee9e0994b9725c244a5554f4bb42e290b2fc94fcbaaae66200b9e9f01a541f56a81abe29eab0f05c7f4b9c672d643a54ba5c18f85f657854fd335b2e7891612ec7427c703ae2405b73fd1b36ba9f0bbe1cf207a636fdc0b27e846", &(0x7f0000000600)="93617df76341f5329cd40150f34028d293c0d928b6a84ad6bf05b3712b9baf2edca2d11e40e4222f15a3a7ed9d39378cabb8cb7a4a751b64bdc7ea94549c803fbbef296712e0224f3cbad6af309fd288ac4932d2f488b7de067a0cb3fac464224bb2c97d8ef3ff177ecac2dc782d3264b0379084001fc54e8b95d0dd891e155b663ef66bb6a959a0083ce27d4f292253cef14ab7c6cfc87f1cabbc6a67e3142abf2a665211")
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r4}, &(0x7f00000000c0)={'enc=', 'raw', ' hash=', {'sha224-ssse3\x00'}}, 0x0, 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)

19:20:28 executing program 2:
keyctl$session_to_parent(0x12)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000400)={'syz', 0x1}, 0x0, 0x0, 0x0)
r1 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x3}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f00000001c0)='keyring\x00', &(0x7f0000000200)={'syz', 0x2}, 0x0, 0x0, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000140)='asymmetric\x00', &(0x7f0000000240)=@builtin='builtin_trusted\x00')
keyctl$join(0x1, &(0x7f0000000080)={'syz', 0x2})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89e3ce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c174c530ed99a3eb1fb9b7dc7601d725caad81ca1b5ae820d343e4897", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f00000003c0)=@keyring={'key_or_keyring:'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000440)='ceph\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, r5, 0xfffffffffffffffc, r1, 0x0)
keyctl$join(0x1, 0x0)

19:20:28 executing program 0:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000580)="d4aa4741bd26ab3acbfb81f7a3c4acb0e7", 0x11, 0xffffffffffffffff)
r1 = request_key(&(0x7f0000000080)='id_legacy\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)=',\x00', 0xfffffffffffffffb)
keyctl$setperm(0x5, r0, 0x92000)
keyctl$get_security(0x6, r0, 0x0, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r1)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
r3 = request_key(&(0x7f00000003c0)='syzkaller\x00', &(0x7f0000000400)={'syz', 0x2}, &(0x7f0000000440)='nodev\x00', 0x0)
r4 = request_key(&(0x7f00000005c0)='asymmetric\x00', &(0x7f0000000600)={'syz', 0x1}, &(0x7f0000000640)='{\x00', 0xffffffffffffffff)
keyctl$unlink(0x9, r4, r3)
keyctl$assume_authority(0x10, r3)
add_key(&(0x7f0000000680)='id_legacy\x00', &(0x7f00000006c0)={'syz', 0x1}, &(0x7f0000000700)="c1fe23607fec8f952b8312e9c8552390102c109803305627f90a8fedbee71ab6d8ba97b0ccd68e6b72489b0d3651c3f4eb7df2b14a7ff755261633f45e8f46ce3c34bb0f8e1684b4a0f34ab34f30f6f84f2231217f8dd032", 0x58, 0xffffffffffffffff)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r5 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
request_key(&(0x7f0000000140)='encrypted\x00', &(0x7f0000000180)={'syz', 0x0}, &(0x7f00000001c0)='#wlan0:selinux--+nodevwlan1keyring}\x00', 0x0)

19:20:28 executing program 1:
add_key(&(0x7f00000007c0)='asymmetric\x00', 0x0, &(0x7f0000000840)='[ ', 0x2, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000400)='keyring\x00', &(0x7f0000000140)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f00000003c0)='trusted\x00', &(0x7f00000005c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000180)='cifs.idmap\x00', &(0x7f00000004c0)={'syz', 0x2}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = request_key(&(0x7f0000000000)='logon\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)='asymmetric\x00', r3)
keyctl$set_timeout(0xf, r4, 0x4)

19:20:28 executing program 2:
r0 = request_key(&(0x7f0000000140)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0)
keyctl$instantiate_iov(0x14, 0x0, &(0x7f0000000300)=[{&(0x7f0000000240)="d6d67a6045b206b3a3c97fb1b0ec676c234d85c340637237ce5ef3d759217442dd5ed062e42b9547fec93a", 0x2b}], 0x1, 0x0)
keyctl$set_timeout(0xf, r0, 0x5)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$restrict_keyring(0x1d, r1, &(0x7f0000000200)='asymmetric\x00', &(0x7f0000000240)='key_or_keyring:')

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, r0)
r1 = add_key(&(0x7f0000000100)='dns_resolver\x00', &(0x7f0000000000)={'syz', 0x3, 0x2}, &(0x7f0000000200)="1d1ad732d4eb7f3652ee46e39383af62cce15cf21979c899ae544810538e8b8e82f71c6cc5cd03d1d6719772b7ec6aa7dd0a02e8818a9f497dcf34efd463e8858f6c14f7a25ee85f034f37971b19d8a8aa6eeefc5fc2bbe3fd30759a918117bd91e0a60d2b4cf9d51f2600", 0x6b, r0)
keyctl$describe(0x6, r1, &(0x7f0000000040)=""/97, 0x61)
add_key$keyring(&(0x7f00000001c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000280)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffff9)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x0}, 0x0, 0x0, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$user(&(0x7f0000000340)='user\x00', &(0x7f0000000380)={'syz', 0x3}, &(0x7f0000000540)="7e538f2ec565362f4b41021beca8b8ed648c183df37537ebceaddc9fac00ca175b4bc6f63e2bb6019dd1dbe3e038d1e500ce866db494f233bfa725693dc81022b23224e4b2bf95ea24e8145b68a31f165f2d309d6577b39768ee015c14940faaaf729f30d94ed654a6ca63f98c40c931046b5b0db845b3d7ed0c4b17bc6adb79ae5ee795f5b7a754d9bce39a7e5e47d989a52afda7e7e165d6a2cab4e574c1fc0df464f98721d6bd8c496b3724d24882b8ea53c4b71519a3394fcc4141d5f1615f9558f916dda5d354ce47e3f4f72bbe9b5d24a51d85c0b181bf92a5eea2e7c403887123c5654b7e05c7b82171fcbe030671cf7d47", 0xf5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='syzkaller\x00', &(0x7f0000000300)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
add_key$keyring(&(0x7f00000003c0)='keyring\x00', &(0x7f0000000400)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r7 = request_key(&(0x7f00000006c0)='syzkaller\x00', &(0x7f0000000480)={'syz', 0x3}, &(0x7f0000000680)='v\xe5A\x7f\x10<\x12\xf2\b6f\xb3\x00\x00\x00', r5)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r6, r7, 0x1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', r7, ':chain\x00'})
r8 = request_key(&(0x7f0000000440)='big_key\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)=']rusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r8, 0x1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r8, &(0x7f00000001c0)='id_legacy\x00', &(0x7f0000000200)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000240)='user\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)='id_legacy\x00', r1)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r0)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000100)={r1, 0xfc, 0xe3}, &(0x7f00000001c0)=ANY=[@ANYBLOB="656e633d706b637331206861d29fdf9ce9dc98542d76942f8773683d766d000000000000000000000000000000000000227500000000000000000000e7ffffffff50f558022ff052171a9265331ea0981d6684"], &(0x7f0000000380)="5f80c91d82acc7be012b64ad2e03b2a44c58f4c5ee1dac4f54358f09ef2bffe31e6550393f912adbef487c59042a1bfb6a9c62b47225c9233d67cbee8dc2927d62bc9aae95bc0c5dbb56436f6c2302c0e7d33216cd344781d8efc2a1a8302dcd12a35db5d9e088096dd6c52acd7f4eea6b537d8e659a712604b8c8217c16e62443611f1093d5c069c3ef6277337e2c108f0a869984a2e7002ff48ee02f8d6da1b4a0fa0183e10b6d0acba7551f4cb21d2348133bef8d733737d82da22b4373b28ec46410b90668a927c3725eaac8fdc33c7b2e1bc8c4462e69d931013325b5a18302d615b7e02c018220f16bc2eaa85b31688335b9d9b9b8cdc4d97a", &(0x7f0000000480)=""/227)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
add_key(&(0x7f0000000700)='trusted\x00', &(0x7f0000000600)={'syz', 0x2}, &(0x7f0000000000)="970000001d883927ac", 0xa, r0)
add_key(&(0x7f00000003c0)='pkcs7_test\x00', &(0x7f0000000400)={'syz', 0x0}, &(0x7f0000000440)="11ae9108d7b73955ce97c911e8c9d68198192ee64cbbfedffe5c57e4163f8f8c225a23", 0x23, r3)
add_key$keyring(&(0x7f0000000580)='keyring\x00', &(0x7f00000005c0)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffff8)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r4, @ANYRESOCT=r4, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r4]]], 0x5, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r4, 0x9982018)
keyctl$describe(0x6, r4, &(0x7f0000000640)=""/129, 0x66)

19:20:28 executing program 1:
r0 = request_key(&(0x7f0000000000)='.request_key_auth\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)='\x00', 0xfffffffffffffff8)
r1 = request_key(&(0x7f0000000100)='ceph\x00', &(0x7f0000000140)={'syz', 0x0}, &(0x7f0000000180)='\x00', 0xfffffffffffffffa)
keyctl$instantiate(0xc, r0, &(0x7f00000000c0)=@encrypted_load={'load ', 'default', 0x20, 'user:', 'C)mime_type-', 0x20, 0x8, 0x20, [0x63, 0x66, 0x35]}, 0x38, r1)
r2 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x0}, 0x0, 0x0, r1)
r3 = add_key$keyring(&(0x7f00000001c0)='keyring\x00', &(0x7f0000000200)={'syz', 0x3}, 0x0, 0x0, r2)
r4 = request_key(&(0x7f0000000340)='trusted\x00', &(0x7f0000000380)={'syz', 0x1}, &(0x7f00000003c0)='\x00', 0xfffffffffffffffc)
r5 = add_key$keyring(&(0x7f00000002c0)='keyring\x00', &(0x7f0000000300)={'syz', 0x1}, 0x0, 0x0, r4)
r6 = request_key(&(0x7f0000000400)='syzkaller\x00', &(0x7f0000000440)={'syz', 0x1}, &(0x7f0000000480)='&\\\x00', r5)
keyctl$search(0xa, r6, &(0x7f00000004c0)='big_key\x00', &(0x7f0000000500)={'syz', 0x1}, r3)
r7 = add_key(&(0x7f0000000540)='trusted\x00', &(0x7f0000000580)={'syz', 0x0}, &(0x7f00000005c0)="521c7a14e481fef9b8800504c8120b637df0e09b03d1cf7efce297709571abc6f583af998814f394f7fa706a1d3b8f95ce2f637bae905a959dbb3774efba19cdf0116f850ea11a15ffc80eca9a29a85b2c0a6a09abb9a094aae8a69eac0782e0086cea05a2550a429c7c9447aa5e2c4df80182991645742782558119c2cbee71c542f59c279ed4a38712fc05407f527528c29d5d1335f5268cc88a80e88d8ae4b0765e30b9", 0xa5, 0xfffffffffffffff8)
keyctl$search(0xa, r7, &(0x7f0000000680)='dns_resolver\x00', &(0x7f00000006c0)={'syz', 0x1}, r2)
r8 = add_key(&(0x7f0000000700)='.dead\x00', &(0x7f0000000740)={'syz', 0x1}, 0x0, 0x0, 0xffffffffffffffff)
r9 = add_key(&(0x7f0000000800)='encrypted\x00', &(0x7f0000000840)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffff9)
keyctl$search(0xa, r8, &(0x7f0000000780)='cifs.spnego\x00', &(0x7f00000007c0)={'syz', 0x2}, r9)
r10 = add_key$keyring(&(0x7f0000000880)='keyring\x00', &(0x7f00000008c0)={'syz', 0x2}, 0x0, 0x0, 0xffffffffffffffff)
r11 = add_key$keyring(&(0x7f0000000a80)='keyring\x00', &(0x7f0000000ac0)={'syz', 0x0}, 0x0, 0x0, 0x0)
add_key(&(0x7f0000000900)='logon\x00', &(0x7f0000000940)={'syz', 0x3}, &(0x7f0000000980)="8da1d3a0a174886ef0c42def95724b294cb06f3af1b64e11a0b23b854b7329b2bbeb5eecd2d08b93c5af28b6519863c2a279cef90f49aafb3b2c3b7a431a65bff242cdfc7bfdf53e52fe5abb1b6e8288c7462b65b4da2c02cc8bae4276162d92108e8a110ab040715be1488057dca474ef40d2d574f487e2736e5df25e1fc68e1673575b389431bd49ef64165af3accc3ff7385b71973265d8fffa789f38b6092454cb2f056dd252f27fc8cf7063821f27ce0bf119155ad4bc27e7683e26c4e6ea7b1244669bae30fc96f3ee5cc7455ca11e230682e00b", 0xd7, r11)
r12 = request_key(&(0x7f0000000b00)='dns_resolver\x00', &(0x7f0000000b40)={'syz', 0x2}, &(0x7f0000000b80)='*posix_acl_accessbdev\x00', r0)
keyctl$search(0xa, r12, &(0x7f0000000bc0)='big_key\x00', &(0x7f0000000c00)={'syz', 0x1}, r10)
request_key(&(0x7f0000000c40)='dns_resolver\x00', &(0x7f0000000c80)={'syz', 0x0}, &(0x7f0000000cc0)='lo-cpuset\x00', 0xfffffffffffffffe)

19:20:28 executing program 3:
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, 0x0, 0x0, &(0x7f0000000300)="b7b43f3a8742d025cc7fa60c9fc66a92eb5e1bbdbe495bede94eadcc3eb67f2323", 0x0)
add_key(&(0x7f0000000340)='encrypted\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, 0xffffffffffffffff)

19:20:28 executing program 2:
keyctl$set_reqkey_keyring(0xe, 0x6)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
request_key(&(0x7f0000000140)='keyring\x00', &(0x7f0000000000)={'syz', 0x1}, &(0x7f0000000200)='\x99\xa3\xe7\a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00p\xb3\x8b5\x1b\x85\x11\x90\xb4\xfd\xa5\x8d^\x12c\xb6S=\x81S\xba\x06\x00\xc2\xfe\xd8\xff\xf8\xe5\xd2\x91\xce\x8d\xe7ww\xc8\x9c\xff7\x8c\x0f\xd9\xb4q\xa9\xb8s\xe9u$|_Z\xdaB\xf2\xe4Mt\x1d\x85\xf8;E\xf3\xa2\"-\xfb\xdeA^a5\x93\xe2^h\xc3\x06\xa7J/\xe1\xe0#\x0f\xab\xec\xbdCwM\xd1\xbba^\xb1\x8b\xa7^1\x04\x9b\xd3\xf2\x87\xc6Vm\x0e\x05o\xb6\xc4\xec\xd4\xc5(\xa5\xcd26t\v\x05\xfah3\xa9\xb8\xa9\xbaO\xdfK\xe6|6\x95\x85\x1b\xbf\xe6ET\xe5Xmm\x94\x924jz\xdd\x1e\xed\n(\x9b\x10\x95W\xbf\xac\xfa\xcf\x9b\x88\x19\x1c\xee\xa7\v\xa8\x8c\x15\"\xb8H\x03\xd2py\n\xbd\x98W\rr\xf5\n\xd6F\x9bC\xf2\x9eV\xbe\xa7\x1d4\xf5 \xc8\x8d\x00\xd47\x95\x03\xf8Q\x88\xcd\x1c\x8d\x15\xe4\x8e\xfe\n\x8cjS\xf4 $\xd7\xc1\x1e\xa9\xcf\xb07g<W\xff\x82\xf2kr%\x8f\xbd\xb2\xef\xb9U\xbc\x1f\x97\t/a\xa0\x9d\xd6<\xc4\x90\xff', r2)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key(&(0x7f0000000100)='dns_resolver\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000180)="e322aab7a90503a44e3e416520390cea18607031aaacc08e017b1cbbbae0696984042368d84c5131c16fd6b1b78970f34250ec1e4e8c6ae8228b4de28b8e97cc358ee936abc25097e29492a208a7cbd63b138f30bb84dd50a454ea4f1f002b50c5abbb0a5eb7901941ae4a0158b1198c25944f0ed12bbc84cd18f47a75c6036870753f73af678daacc4e30113284e38a59d310d38afbe63591176918309f94c538a2db815008a7754258654b45b235e6bd44c1d9aa51a505196efc6a070c7af51bf7a6c971f0f7fc7638f923c628adb4d147e6060854be35f3a63a413f3c113b68e791738a30", 0xe6, r3)
r5 = request_key(&(0x7f0000000300)='.dead\x00', &(0x7f0000000340)={'syz', 0x0}, &(0x7f0000000380)='{\xfc\\-selfeth0{md5sumcgroup\x00', r0)
keyctl$search(0xa, r4, &(0x7f0000000280)='asymmetric\x00', &(0x7f00000002c0)={'syz', 0x3}, r5)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000080)='encrypted\x00', &(0x7f00000000c0)='user\x00')

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f00000002c0)={'syz', 0x2}, 0x0, 0x0, 0x0)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000280)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
r3 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x0}, 0x0, 0x0, r2)
keyctl$KEYCTL_MOVE(0x1e, r0, r0, r3, 0x0)
r4 = request_key(&(0x7f0000000040)='id_legacy\x00', &(0x7f0000000080)={'syz', 0x2}, &(0x7f00000000c0)='@/\x00', r1)
r5 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$reject(0x13, 0x0, 0x1, 0x5, r4)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r5)
r6 = add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r5)
r7 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000280)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
r8 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x0}, 0x0, 0x0, r7)
keyctl$KEYCTL_PKEY_QUERY(0x18, r8, 0x0, &(0x7f0000000180)='-&\x87cpuset(-\x00', &(0x7f0000000240))
keyctl$KEYCTL_MOVE(0x1e, r6, r5, r8, 0x0)
keyctl$reject(0x13, 0x0, 0x54, 0x4000000000007, r5)
keyctl$set_reqkey_keyring(0xe, 0x4)
request_key(&(0x7f0000000000)='asymmetric\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000940)='-&\x87cpuset(-\x00', 0x0)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f00000003c0)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYRESDEC=0x0, @ANYRESOCT, @ANYPTR64=&(0x7f0000000280)=ANY=[@ANYRES64, @ANYRES64, @ANYRESOCT=r0]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0xfffffffffffffffd, r2, 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
r4 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r3)
keyctl$KEYCTL_MOVE(0x1e, r4, 0xfffffffffffffffd, r3, 0x0)
r5 = add_key$keyring(0x0, &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
r6 = add_key$keyring(0x0, &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_MOVE(0x1e, r6, 0xfffffffffffffffd, r5, 0x0)
add_key(0x0, 0x0, &(0x7f0000000040), 0x0, 0xffffffffffffffff)

19:20:28 executing program 3:
add_key(&(0x7f0000000000)='big_key\x00', 0x0, &(0x7f0000000180)="77443f2d03a24ced16d7a2e238a6670c83c20ce88bc526072dbc67fa7cbfb9a2eda9f24d0859922f26da354030bd328a89f52ea502119b6d7966af394d1c5eca808a2dde895ab446e2e821fe189dedb734c016ba838562579482085968289a05a0578b0caff7b853b20b0f4032bae29afb83b3a2478b884a99aa4129dbaaa77a1d0698c2543e1b1b37bdbbf915e00f7ad7b3d8916d3472c16d8301d3f003b8f5b4963f763d33dd3d95aef9ab3448520d56f70d9b140df2cf7bc8d7f00f22e3a20891b24119265a7a82673832cbf5609694101cb076fe3d0f644ed514de69f7098f079e94bd780d8ba75fafe0f970b22fe3a7d5f027c549ba39ed67125e57eb18dc93d0df7cbb058580fc3c365034c305fcc56e57f30747cd939f8599324ace0ff7312ff5d62d3f6dacebf3c2d889881e3c", 0x131, 0xffffffffffffffff)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000380)=ANY=[@ANYRES32, @ANYRESOCT, @ANYPTR64=&(0x7f0000002680)=ANY=[@ANYPTR64=&(0x7f0000002700)=ANY=[@ANYBLOB="35dfd3b42e965fd9e46879a25085400aca36cda9dbfd10949806809199d1aa687eaee9acf790be846cf2375758962a59caa91350370f661d3e18e087f503458edcdd01e1e1cf2288343641e7830291c10265d9980baf4008b803ee909e53d9a8bd2ac181f8b7835b231c30db929a1c81e4d9a899df85d8c06bffc1588cb014950fa1b67a5ca4969b7643f9a5c830de8c5557ce9aaaec028d6aac80038a6a3ae1fcdb6bb73535aed6fc29669f98b7216328197b9553478a242deadfaaccc4779112a256dbe74949560f77e7069f7d118c5b4a61f72c475a9ea153bca9c43e05ce613d0c01784ecd563efb76429e007f577f40f6c86bd861c734cfee3dd394a72a19c1f6b8949e76a919858684d9cccf27c613e585453d3bc02cf3ece7abdc175050a476bd15167b83a7e00048372779ee20c04bdab8b2a18317978f9939cf77f4fece0f372ffa3f274ab49e9871048cf501002ce47d3771bbcd8d2918e60622c3560dae2bf4e2781e84112fddcf25902c0bca14c2a371c9bef4c33a2d583c2c01b3e5e841eb231429ad8b47f36cd5916ed9406e5d6419882ae9ae1ed8dfa8d237f19975afe1f7bc8ceb54d6802667ec941fa906f8205e34312e1f95c586592a0dc126ee8aea880d42a09206d732855f84d3ce6ad1ba6ebcf5e60a62b80e126eeb3568c13a199f8e6673756954e5835051bf3cb403862a08f78a6572a7e5d1199894294cff973b7486f108e8652c290a9be7e2a29efa8af3e0ddba0f539a771e0916d9b80cf81fbb635f6d75c2f089e0cc506f201761c75755f476e657143f7b35d80aa16680c210d3921f847b1993a1e719957b7e2277654ad7515a6ee35e53c1d417975a7bdc1156234630799e2710ecfa23b78a280476112505a3c8af798e0edbf5760b5361f635b12b1a92c48295f7abc7362051524053428d133df6b2636e4bdb22502d86a1bd612a96a2db7169d59ccb31815e2100758fd9e475d4ff0fa9bee02bfeafa3b9574e5ffb2860a2da0ee76ac0ce0fc248784162ea9387461b6e258a49c675500a3339dfaf2ae8ec9f614303746b271b2df912f479f4be20644c2c2bf4e93935010420f0040a5f073542b20fbe9f472260a171d1b2b529a4ba1c3d3dbe89e743e10357c5c1aed1ac037a5477d0e55453be5cb61c173a00f65741095c7199652f1e95516ab885579496fa76cfd20c3fe28a45a2815d5810c1bebba80f4d101d99217fd05dd6333bb28519d5b99cdc97b79d3e49102ddb55b578619070e0cca1a4871ef2264ddbf02867aece26cf2fbdf5e40dcd40c554623b7794c5baff651a91798b07e126844183a7a75078c09f879f416e4b8a437da8fd34bfe24bf72663d7408586beb6b39b652c1a74d2a2ce707962ad1b888c53648da48ef4cfacabf123ecf5048956566818b5f4ae94e8ade0fe7bf3e157b88fd2bb2391fab9b2e463e3a8184de9759f5cabb483f6322314486e672f24b6b68b638a15f769a09aa9275465013378a8e43a88298eeba80e78f8a438c70eb97dcfc1dd9738e315b2ea85e2b931d22070fdbe5047177ebd60f7c46e27a8fac3129e57712c2b23c3cf6a48b3687b4d8be68a821a5ca59d4aae479a1079ff3adfb170aa5abc9cf38dc695fc531bfdabbed21e643681c8d0b1884294f8fa7c95d87d621a6b5e40b9708d50f2cec8772d52bcdee803229029413922dd7fdc51dc614f09e295447cbee7d23c7c99f565b47b04e1a4b9ea2fe299d51f2bdae8658a2987662d2a73070febddf52f66af13d9361b50d5fa844f552aeffefd31772e8317c74d09cc8600d0d0e4163481bbdc1e77fa93003b90c05d2c3a1106635837f1315f499e6b5472642131d3b802c5b58f1fde162d3d98fc61296ea96b70cda7631d0b302b55f74f19346f84c902d771a6bde466bb603edb3ce681d906b2dbcb264b142f1d229d744272a7992cc5724899ffcd72a68cb3de3ae163178da855da4cff410f2e3d379ae25bd4958a7c14d1c4fb8e821dadd41014c4731be8bab0d219c3f9d314bc788b24414bed72b28e4ce64d5dd5f6b165d4108c7dcd327c136bf88baacc9fa6becba0765256bbfeffacafb2948abc68ae19365bc36af319d73e75e2565a971c1a7b9fc36676c4b2f9da8cd704778e95d9422ddf1a9beb14747d549e8a7d8c4d8e4a0a558f099077bd7e10a99b09d0b174d77991706cb576f0076761f4a29035fb720c54529ee846e8def6a8e5faafcb86c94507efa14c1ab0e13d1b7343a4d1cb8dcc0dd45fcd5865d130ba747349e14aa5e301e24f8344f5b8c95e4db721dff13994efcbe4bcaeca28b59beb70dad1a693a66586ef0793f597fe4f8a31fcbb831c7ed58b8a6cf2aa8852f5e47c9758cb2242f0d4cc3ac343228b42cb4f5fb5e6b826c6aef8fda2ec83f28ac0b7245bd3f64885390f5c995a890ff9ecb54622dc8898e0f6c6809bf760f7df152de7fc4b5c164ebded6735fd398b60233fe47805a1a7fdf0bfbe0f1783fd4800bb9019e4ea2c2706fa6fbe2e8eb20a3a1fe3ecd592b3bb2f0d6ab38ca1cf107d7380afddb88c43776d896cc899df5fb27e9e142d33be4bcded05aadba5826b43995b7b64dd0ce2747d78d0ac72087d0e122422d296b422fd1f08fc2e8917586c493d292121b7bc0bd2914486e9e8f8077e40d0e11b76c81716d13f211330c3f24ef2b1a04e65ce00e779caef187e55d14815e5bc5a14e58adc2f440bb4d8383ef1cd4984b7dd66b86e95b8e545ec7ef7fa39990ea65d2510d28ea7e457b2759dce1135eae070a887b09e90239fa79fb4aad86d12ce07b9ded9c1cf1668ef1e66d5cee1f489dd6b9241fa00176afbf7836fd575446038ee446a1e962db8eae448697b07c1351ae341edb98919661b18d97a6ee13046f61b157709a5092c781578acfe0a15dc10e030d048c1e61e308862897d1f852d7add1d1a3f7b7e2edf99336b8919784c74ea6ee74d2e648e82b6c107dde95087d8c6dbb575f604a17259383071ab384a0df59da7fd650075cfbee8347c798228a2d5f996cc742b7747c69b4a4ec297928401d72fb4a75bace734cd8cc146887525668384ee24ada3b76ce91830f4db643f0e945562f98912a47a8559a1ae87a02a200b8a3a2284f21a4c4b4f600acac81bd06ef11c348ae63901f9e2c4caff492e27ca66a2d724126a8c5c62750123aeba7894b08055767cefdf26faca66df44140e684ec5167fecf5856376195ec83945b5859c3541d91e8cb61e0bac9e9304006a43f6d471afdf1413157b66f2d3ba07ad3f704bffed8e6687711107881a0ec8c52753add159c615f609fe81de166442a7c419659b91cdeccc016869c3a5d870b3cfe7eceed6617f4274d01e60e799889457f49a60232ca76dc8f65fff5d42842cd8897d9018bba5dc289bc01e4992a51556a87484016feeb44f0813e8a2f645029fec5de766a679d43a786766c8f4b8bfc1fee8cb308f1735e5b9c4a3fc59735133b727f9adac0fc38281872ac5df0d735e34ab5cda40feeddd90d649f3c2cf9a113ed338ab53fe50d23803d8fbc33b7c1a7c07f03df3133cd47247315b37934454c4f48b094fb52ed0f4434f1dbdabcc7dfd06aa5b6c6aed809d0f2705255f558714431a998b942a853040977f03ad871ae186f710577ec8beeee978c0da74e58701406268ddadcc5c40f2fb11f87a5b072154c43b54bd9865df74c53f4f538711e3b093547cb235357d702bf8bfbcb1a088710555f17958bce3b14ea7deb49d0b609aa48d9b421f19c70174dc6e22b5fd214b63af49430766a6bb464bc36fc22f9524f2b3e0082120d9218b3516e0b4eaec1ac176e85c3adc1762b8eea1bb937437f4ed6ca3e84f655764fced094f10f9311c276e7d6bf7f7fefb095367b506092ba8d7d321079a372c526ddc78c3a7c9c5e62ee49287cbdc947e8b4d2129be0008a0b493f560fc54056623959a462899b7bd7e9eadc93b8871a2caef47deb656b8208b9c75b8b63ce1a8d9ef20f6cd46a448ce01d28d8d0c49fa3fe0ad2a77eebcb9ab0a7be3db2a33ef0c277b5208950856b7de58bcd4c627a7d23f2506e2a9cc37d3b131da210e7f3d3cff8405d924472589b2e133d140e21b032ff929ffa774fa21e469048ed322d58509ae8cf40e57608732f322b430204f1b83a4334908aaf2a429c43f4c05e785d2ab8e6b34dc9531b6c0a0ac0a8a899cc664a5c9b09cd6dbf022f52ad10afa784951773512880f9817191310b146c457c23f7236289a76c134e2145a9493b81c449cf87d0caf7dafa946c2d656a34b14f564217b629327ad4cd45e67c24344fb478005e0ebbce9d4d144aa2a45b618a8627c08ec79dfc0b06a2bad714bbd0f9c68aafdbb3cea0215facc9b629646132a9c9bbfba070c19dcf421ff2360c50f21f5021b2945f3f6adf69e1db8b84d72654a44babfa7cc8a94600694868cc80976c48feaf284e0af7692401c1e5abe1ea643615ed98ced6762be14470bb80181799b06dc8043e02e6c0b786331c37dbd9b96607d9314f54fbac965e0bf7ff5221c6113feff3a6a5d6f2ef9e75da52b79adc421fe157c188c29863272d5e287fab4958620566a380ddb30e19c4de6b4bc491f280614417322b325b25b332a794739333062283349e5d9707d261bc03a4efe67070cbbada1d370638a4fe4f630c4d7490b45d6654faee82334319943daa5fce9e83b995522b1d641752dfa909c1a15966ccb19e5abfbe81fe896a4684ab819efd05fc2998007145e6684cdf347c187a9cafff4449b6f162cda2a4d94ab40ecfe190cbdb395fbe58ae2585f8908320ebcd0cf0efe6bd4660b6da1493d003a1308f8d35b3b67f79564582c1f3136366391a2d41802fbc1594831536f009ad976875c3f5cf76cc9c211b386291d4b06992122b486a69cf55b871ae1a807a230215fd3096c2569b6ad4826d739c43d15db67654315c4a3fde38eaf1ffedf332ebf99e62b21098a4152cdb4fa2398d3aae619d50f634bc963bcd764ab30de3b8a0335bd7221a8c020aaf572409742d389300336596e80cc8b3befd5f5723b2b9e0b185f03a43d52ef4e601d4d2164bbc9f05486df4055f3dd5509a3f3b35c6c30ca34422a372066fcb5e84d6bb342173d1fabf12ad9e5d78ee4288fc1faac7a3f1c1fee6b0e44ef8b1b74f71797132266efeb1644d02565161104d104c2190ff434e07f1c8c1e9bd37e63c6a98c4b53fa06ae6a8f196e660393551f5f39390d2a5863b4029a2824f1c47572764765ad9077943f148cce5cb70d7dd05a53b3b1ac0d2da7ae7c8f1d6084467a9fc1587d34703d7e2dc88acbac170b22b3c5a127fb2a22731e44973e3e04c00ff3002c4b3fa723cbaaa8dfa520a2d061c9ef72539d0fc6d8550486672b76bad79f168d4e6983eb92639e9b558442a90bef58236b59bca3d818e0693461115c45402e7f165b80a76646b76086711754755ec14418e07b4b87b058888e270eb731d63d9936ddadf0500265861fce04c1a4fb0d87b37ac76e8fe85a9ebc219a29fff411a8949d744eb93246b341d974560e4c3a48ea63dc1de6a7e1eb3bfc83dd1db7afbd012fdcca84e76645378ba4de678b111f253b16d9e50452b3ef6d17f2bba32d2c80cfb1012db4f6dfc39308f0509dc4dc10ee7c76ae4cd24063589c986029b9dcbce4baddfdb6ade764836bf1e7c3ddc292913c6911d9692f8261106f3841e4fbd88a8cccf78b214058978735147ef39a05c2c6036227a115a8683155578ae63b78ecbe317a5ffca07bc3b2919c80a6b8be6fc956eaabfe89eefe1452e7aed059e304eb4a614168b7c3c64473414161151e642316fd484526980d847e0305bb9f02f431e68b4fd0dfca0a6377aca9e00f6d881b72fb9e881b09ca802edf56cb774b134465e1acae012fad643ba5a2857b2ac657a6a600"/4201, @ANYRES32], @ANYRES64, @ANYRESDEC, @ANYPTR=&(0x7f00000025c0)=ANY=[@ANYRES64, @ANYRES64, @ANYBLOB="1597edd66a1d93cad529e48b99c3f27e271556362b1432c1552d2d93d2a22457453efd4bc370715dba2e50acae87bfc64dca1899322a9de8bf3891230a9fd5e2f14a3b1e8edeb01e6da5e5339869523007b3b843056f71ee37bd8d3041271359b2699bc0769b38a73f245ac5de1c4626715a842b8de59ec1608da1", @ANYRES64=r1, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYPTR, @ANYRES16=r1], @ANYPTR=&(0x7f0000000240)=ANY=[@ANYRESHEX, @ANYPTR64, @ANYRESOCT=r1]], @ANYRESDEC=0x0, @ANYRES32], @ANYRES32, @ANYRESHEX=r0], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000300)='user\x00', &(0x7f0000000280)={'syz', 0x1}, &(0x7f0000001600)="1372a1dc1a3199434bbe11581ecd371ada443744f194da81612df66de4274b84a84ff45f875f03221e70d91702021f7d01098d5c2f524511b48726345bc151010664c523333bc104ad05d27e017f46bbcff8b05493c44686ea147174751b3a35d4db7ee74f54a7f155437d6980ab81b115f7990d38b1d78100008bb802a5573765653c0f41651173cb1b1c6887d3cf41906b6e20995afe6c0723c7f729a00f8fa8f74c9e89f6e5b399ab702c2733fe65752dba0083909b", 0xb7, 0xfffffffffffffffd)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
keyctl$restrict_keyring(0x1d, r1, 0x0, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x0)
keyctl$read(0xb, r3, &(0x7f0000000580)=""/4096, 0x1000)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000000c0)={'syz', 0x1}, &(0x7f0000000100)="90b27be840d9826cd3aad6a5243e09a9090eb379749e1764b28969fc5bd1b5b122b1b203ac71b1ee05044d793c31db0410259f09832c4425e5e13d1dc13db44b521d4dbeeed195498d63b52e8f22dad7e42d22a6d0f1", 0x56, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f00000001c0)='keyring\x00', &(0x7f0000000200)={'syz', 0x3}, 0x0, 0x0, r0)
request_key(&(0x7f0000000180)='keyring\x00', &(0x7f0000000400)={'syz', 0x3}, 0x0, r1)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, r3)
keyctl$KEYCTL_MOVE(0x1e, r0, 0xfffffffffffffffd, r0, 0x0)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$setperm(0x5, r1, 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$read(0xb, r3, &(0x7f0000000280)=""/93, 0x5d)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
r6 = request_key(&(0x7f0000000300)='.request_key_auth\x00', &(0x7f0000000340)={'syz', 0x1}, &(0x7f0000000380)=':chain\x00', r5)
keyctl$search(0xa, 0x0, &(0x7f0000000200)='dns_resolver\x00', &(0x7f0000000240)={'syz', 0x3}, r6)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f00000003c0)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e72f0ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b601d725caad81c000000000000000097a2bec0fd8efff4da2065fd071afd387327d007a5f4733d4d0d81e34abc0000", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
request_key(0xfffffffffffffffe, 0x0, 0x0, r5)

19:20:28 executing program 1:
r0 = request_key(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0)
keyctl$invalidate(0x15, r0)
add_key$keyring(&(0x7f0000000140)='keyring\x00', 0x0, 0x0, 0x0, r0)

19:20:28 executing program 3:
r0 = add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000040)="3080", 0x71, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$read(0xb, r0, &(0x7f0000000240)=""/36, 0x24)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES16=0x0, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
keyctl$clear(0x7, r1)

19:20:28 executing program 1:
keyctl$set_reqkey_keyring(0xe, 0x0)
r0 = request_key(&(0x7f00000003c0)='ceph\x00', &(0x7f0000000400)={'syz', 0x3}, 0x0, 0xffffffffffffffff)
r1 = add_key(&(0x7f0000000340)='cifs.idmap\x00', &(0x7f0000000380)={'syz', 0x3}, &(0x7f0000000440)="50fe2eb88208d7a44383280a4ec5d2", 0xf, 0xfffffffffffffff9)
request_key(&(0x7f0000000280)='pkcs7_test\x00', &(0x7f00000002c0)={'syz', 0x2}, &(0x7f0000000300)='-procvmnet0\x00', r1)
request_key(&(0x7f0000000140)='.request_key_auth\x00', &(0x7f0000000180)={'syz', 0x3}, &(0x7f00000001c0)='user\x00', 0xfffffffffffffffc)
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)="5d839370e59ed626d8c5f7ada2dfe4bef47886a4ac818b5315d8df90da7b4ba4d0a12cd48088cf2cc57c11bd6bdd32953d9a3209dc941a7affd4d09371a1130c8ff7f3c760604978b95567aa37c01e2ecbf6cc3f21e11138ea8b0e7e8fb2d21438538d81fead0a26a2b44136754fa8d78f809b13191f077b15e12cc552eff93b99902f2d684587eb8b9cb1978846983772b065d98433efb7ba4b1204b3aa106e8165e5750b7ea26dbe3c38ecb6a0fe97644f85f8a4", 0xb5, 0x0)
r2 = add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x0}, 0x0, 0x0, r0)
keyctl$assume_authority(0x10, r2)

19:20:28 executing program 0:
r0 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f0000000600)={'syz', 0x0}, &(0x7f0000000640)='O', 0x1, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$reject(0x13, r0, 0x9, 0x2, r3)
keyctl$reject(0x2, r0, 0x721000, 0x1, 0x0)

19:20:28 executing program 2:
keyctl$reject(0x14, 0x0, 0x4ffffc, 0x9, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key(&(0x7f0000000000)='ceph\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$read(0xb, 0x0, &(0x7f0000002080)=""/4111, 0x100f)

19:20:28 executing program 2:
r0 = add_key(&(0x7f0000000240)='logon\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f00000002c0)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a76c7e96aca1f8bbfd0930a0f3a7b3127e7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db8d2da71bae7345e00b108cd9077d31c0d57ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9b", 0x100, 0xfffffffffffffffc)
request_key(&(0x7f0000000000)='ceph\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='mime_type\x00', r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$read(0xb, r3, &(0x7f00000000c0)=""/128, 0x80)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = request_key(&(0x7f0000000080)='id_resolver\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)='syz', r0)
r2 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x0}, 0x0, 0x0, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r2)
add_key$user(&(0x7f0000000480)='user\x00', &(0x7f00000004c0)={'syz', 0x1}, &(0x7f0000000580)="4badadd98efccd02c2819d0ac70b00e33d8f8fe50ce80566b469106b2df0ae1791df207481fda1b97086a667258551cf6b3fa2cabbdcedfe4d639a74b0632bcb68e95853f3fbd6fa534d7b3c4c92634680815c5e5dbd7a9a8ef39bad6d0a58b3271e958d4ef089216b08fc6d8fe819809e444929602006d0aecabfe2411b28e5291ececd7716", 0x86, 0xfffffffffffffffa)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$revoke(0x3, r3)

19:20:28 executing program 3:
r0 = request_key(&(0x7f0000000940)='user\x00', &(0x7f0000000980)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$join(0x1, &(0x7f0000000180)={'syz', 0x2})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x2}, 0x0, 0x0, r3)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0x0, r4)

19:20:28 executing program 1:
add_key(&(0x7f0000000040)='dns_resolver\x00', 0x0, &(0x7f0000000000)="972000000000", 0x6, 0xffffffffffffffff)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
add_key(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x0}, &(0x7f0000000280)="8eebbaba8aa49bf6", 0x8, r5)
keyctl$KEYCTL_MOVE(0x6, r3, r3, r3, 0x0)
add_key(&(0x7f0000000080)='.request_key_auth\x00', &(0x7f00000000c0)={'syz', 0x0}, &(0x7f0000000100)="e979f9674acee9", 0x7, r3)

19:20:28 executing program 3:
add_key(&(0x7f00000007c0)='asymmetric\x00', 0x0, 0x0, 0x0, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key(&(0x7f0000000100)='logon\x00', &(0x7f0000000140)={'syz', 0x1}, &(0x7f0000000180)="3c1caf", 0x3, r0)
r1 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffff8)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r1)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000000)={r2, 0x5e, 0x1000}, &(0x7f0000000180)={'enc=', 'raw', ' hash=', {'blake2b-160\x00'}}, &(0x7f0000000200)="925e971823bffed9aaf0f752b9fdcd25d316334349de96b0a00df543fd91624871615af19a4e251cb4fd80c0cd1de7ae484ff561b87c0903fc61e4572b2aaf1234f1fd598307fa51212152094ff8ce73a68489d887c3a3904194e24f49df", &(0x7f0000000280)=""/4096)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000000c0)=""/68, 0x44)
r3 = add_key$user(&(0x7f0000000140)='user\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
keyctl$reject(0x2, r3, 0x800006, 0x203, 0x0)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
r2 = add_key$user(&(0x7f00000002c0)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
add_key$user(&(0x7f0000000300)='user\x00', &(0x7f0000000240)={'syz', 0x2}, &(0x7f0000000580)="09f754eaf02a10c84c2650e484ee1f9de6733b43923e54cb5e69826a1d1419d101dde671de9a784c80f2860ae4569450f2534472aa0570e01a20a027653b669a8256a2bc9d9c987452373dcc3754202c368d73990d5c5d1672ca4ff6fedf524e6965faabbca380a72cddd309e344fe88092da2e27f63218f60bbb1d08d43bc7af3ebcd1be14869915e0011d8aa0b1d990752e6bc69c9b8fc226b2bb23e1a2568fa424b838de1c2d06d8f6b898c9ca0c19d98f300780ec87c213498cbbed31d917b77bd", 0xc3, r3)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffe)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000540)={'syz', 0x2}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f00000000c0)='user\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000480)=ANY=[@ANYRESHEX, @ANYPTR, @ANYPTR64=&(0x7f0000000580)=ANY=[@ANYBLOB="6c6b8e32f08bb90bf2ce0f03eb92c28a85c090b90b42c6bc3d66388245495ace1ce518da13e9ee353fa0694a80ad3826aeeb5cc8c0d97eb4c7b1f7723911ba53b857dd4a854c3ddc41ae30e2a0e3e376e3f8e9"]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$search(0xa, r4, &(0x7f00000004c0)='encrypted\x00', &(0x7f0000000500)={'syz', 0x3}, r1)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000100)={'syz', 0x2}, 0x0, 0x0, r3)
keyctl$link(0x8, r0, r2)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$session_to_parent(0x12)
keyctl$revoke(0x3, r1)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$KEYCTL_PKEY_QUERY(0x18, r2, 0x0, &(0x7f0000000040)='keyring\x00', &(0x7f0000000080))
add_key$keyring(&(0x7f0000000000)='keyring\x00', 0x0, 0x0, 0x0, 0xfffffffffffffffc)

19:20:28 executing program 0:
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f00000000c0)='\x00\x04\x00\x00iKg\x00B\tfRo\xbek\xcch\x86\x8d\xce;\x95f\xa9Rq\xf9\x1dU\xc7\x01\xbe\xd8:(.\xd3\xa2\xd8+\xde\x18\x8d\xd8\xea\xf4\x18\xea\xe2\xdb~qZ\xb3\x80\xdb\x13-9y\x985\xc6\a\xbf\xa0\x03{\x9ep\v\xcb\xc9\x81\x1f\f\xb0\x00%\xba\xab\x8a\x80\'\x00\x043\xc4\x13\x02\x00\xe3\xa8\x96\xf5K\x97\x13A\xcc\f\xed\xfb`;}i\xfeu\xed\x8f0\xfd\x9d\'z;\x12x\xe5\x1a]\x06\x00\x00\x00\xc8$\xb7\xc2Yp5\xaaC\x1b\xcb\f\xeb\x8a\x01\x9e\xbf\x87(\x8dp24\v=\x1b8\xa8\xa7s\xca\x04\xb0\xcd\xd7', 0xfffffffffffffffb)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000280)=ANY=[@ANYRESOCT=r1, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
r2 = add_key(&(0x7f0000000080)='keyring\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f00000001c0)="92f9c8768233c6204b89b993d342b21385d2feb9ee7fd3a13074b30ba385a28c69c77382b1ad51c00379f3eb27ad1ca6c45d4b574dbba799d7d30de71f4f02bc6538e3aee3b92dd9128e812241ec908f4c3b15fce83313a18c0e899b706bdf23039e024bd47dfa030ff17ad2dc481589cba24afdc97d2f18c0e35bc8a9375123eb586768b4c6991c25c0937f92307ec25a0a4f539ea9ad14eb55b51b2322da6775ddf4c193290813a7a36ccf4456fe1a1745", 0xb2, r1)
keyctl$KEYCTL_MOVE(0x1e, r0, 0xfffffffffffffffa, r2, 0x1)

19:20:28 executing program 3:
add_key(&(0x7f0000000340)='logon\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f0000000100)="0b5951b5e3bb789d4dd24854604e12e48c72c52c37ad4cb6ed698cfad44d15109ca9547951025ee90b4b258e2a29c584305946c45277a809eb848eea53a124e634ef9acd94272adc6760e05f0cc08caddbfe2a29b83215a947f0313d2c60d9a38ae71600e255d732c07c7726b3c63b1d5283fe8214320ea8a9a958ebfeae03daf69c24826f39948ec0ff60d464bece8d731873c60b2fbfaec3115433bf4613bbda6de1ac90cdaac78f72310ab7f99481b361af6e191530d2f8a120af4ceeef57296160cad572d7bfe99466cf26f35aa0786bdab6a90caf9bb81495395999066349e1286e2407a715d9af429962b105c050e84f3a246f509f15187ebc8dd3211f", 0x100, 0xffffffffffffffff)

19:20:28 executing program 2:
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000000)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$join(0x1, 0x0)

19:20:28 executing program 0:
r0 = add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000080)="6e3a690f883309b41d5e2ed1b4f7d59bfc1a4c191222a9185e755dbf98faf35217c830413ba0aa03c8ac", 0xfffffffffffffe2f, 0xffffffffffffffff)
keyctl$unlink(0x9, r0, r0)
add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r0)
keyctl$join(0x1, &(0x7f0000000100)={'syz', 0x1})

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f00000002c0)=ANY=[@ANYPTR64, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f96d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYRES64], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
add_key(&(0x7f00000003c0)='dns_resolver\x00', &(0x7f0000000400)={'syz', 0x0}, &(0x7f0000000580)="ae71e73427a7bbd1c24873297b84a53773fc28999b3756a474c99a24d0cff49c06c5bd09ef1a3e93054c31914d8523dba6c1d3ebb1a9aa39e5e13590ec31b89a315e6ced9c578caecef8c23e405c12bbe339203e41752d71a1eed76058444d67821befec49e2b1167c575f2076bf4fbe602d19aa65dbaa38eeca3f5ac29b601a3778020d8dfd6c4666693e79668741867fa64d29f2a32c5ca07ec80e045c1f298db531de8100620906dbbf816b7320e4595dbe89961b3e652e45c67be4244abe4d0d2e40ede909be9f7848dfe8418e017bfb55dda7424bd86a51", 0xda, 0xffffffffffffffff)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
r5 = request_key(&(0x7f0000000440)='rxrpc\x00', &(0x7f0000000680)={'syz', 0x3}, &(0x7f00000006c0)='\x00', 0x0)
keyctl$reject(0x13, 0x0, 0x20, 0x3, r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$reject(0x13, 0x0, 0x7fffffff, 0x100, r4)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$revoke(0x3, r1)

19:20:28 executing program 1:
keyctl$set_reqkey_keyring(0xe, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000240)=ANY=[@ANYRESDEC, @ANYRESOCT=r1, @ANYRESHEX=r0, @ANYRESHEX=0x0], 0x4, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
keyctl$describe(0x6, r0, &(0x7f0000000000)=""/34, 0x22)
request_key(&(0x7f00000003c0)='ceph\x00', &(0x7f0000000400)={'syz', 0x3}, 0x0, 0xffffffffffffffff)

19:20:28 executing program 2:
add_key(&(0x7f0000000000)='.request_key_auth\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080), 0x18, 0x0)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r4, @ANYRESOCT=r4, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r4]]], 0x5, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r4, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r4)
keyctl$read(0xb, r4, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r4, 0x1)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, r3)
r5 = add_key$user(&(0x7f0000000040)='user\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, r0)
add_key(&(0x7f0000000240)='blacklist\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f0000000580)="c2d36f1baeddf6247f91dbab2f5cf796b3ca34b80174bdc8379365b9cc10dd720a4b4582a1", 0x25, 0x0)
keyctl$reject(0x2, r5, 0x207e0ffd, 0x201, 0x0)

19:20:28 executing program 1:
keyctl$reject(0x2, 0x0, 0x1000721000, 0x201, 0x0)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000080)=""/197, 0xc5)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000000)=""/104, 0x68)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$update(0x2, r1, &(0x7f0000000180)="24c051a0cbe71cabe1ba4bb9e9926280204eea3729a40b7e412008020fa51ec5417b544ce26af42b257f0764c5b1b8bc01847603bf02e54996379f1482d3ca6aa6718bd7347eb38f442874762e1ed50cc197aed73fc067af7a931fa779d6dc2820eeb4cb230f64465c7de3a8f5f1e02d4932fa72ee20ff2a4c0c67b11a04a068ba23684b92a26369f6d9c5466777e6ece871d93f4a5cf7bc7e3e1981625745bc1170574f66d5a15fde58ddcbad2969786d192522abd112d0733ad74397be0647e01f63a55bf89a7102af08f61758e85b993fee1c92ec66d94c99e8ad23738582c2a4ce33e0", 0xe5)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000100)="83971d2746778fb51089d9ed99abda8fd02dc4d627aab2969cfea930330313796ff5c06cf9f66bea5d123a36fd168e649c8173bb1b55d494e4860f5d34a278321ef22e4a22198bb4f20fb9a18d8c2c2f2fb70a65a9650fe217c69a981d09b2c784a179b823224be7e4ac8006a851bcb15cd7c9c598f495044fa5a620413d07e7c894a80c24add2cdaead4b987e6fd64e881ee48696efa6804f3593909c0f0db5d363fb74060fc4e0dc67", 0xaa, r2)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000000080)={r3, 0xa2, 0x70}, 0x0, &(0x7f0000000300)="7baa5564b687b907d1d3e8096d20a1b4d4688eaad296c0394db206f110b11814a0c594292685eed2fc291fc5c8a54ccd1264d74b851daecc7d7f3b8a8a3d9a60afb641b28075db3bfe34a5aa735221258e9754fea709e2e171359c480ad2194adebebf0cec45484dff73d1b81b7fdaecc2560b2bd3f1e5c4e716aad7a9de9d454a5ce9372e1d1639bb2e17aa738f3fd30c0dbc1c2f59ad7aaa8376392c1693e623e2", &(0x7f00000003c0)=""/112)
keyctl$instantiate_iov(0x14, 0x0, &(0x7f0000000980)=[{&(0x7f00000008c0)="b2040ec5ab69ccd2268822f9cc7608bb6118b7e381fb035808a74f4af9b213809fd3a56d7ab12243430124da50fe99bd3efabc48c52d88c9d1ca082770b3900660005d2ecd7380e423c38cbee9fe6590b48c943fee64180dc5040e880e612b5f5d28918ae5660900000000000000d6ff4e082cf604a9e2ac13219e29e214f7708ce081275340ea15e200000000", 0x8d}, {&(0x7f00000002c0)="bd5f5698ae7dcf4d7445cf2d9fd686cd8507e3081d4511af30535094a4b8298e3be2a2c8b1214d9db411183ba9b97c701d08", 0x32}, {&(0x7f0000000b40)="08f53a14f0c6829edcdbf29291786920ff4cc1530a900e8216cd139c09ef80f012c078db152e58a0031d01024b37a47881d2276158c2fe4c512f9465c26f2fd3e8fd604d6e68f2cccfd897366e431972ebaf96d23ccf4e1f139e491f166b61e7ce547e71f4d8fb4b8362f064c89318c25f78dcdd736dbdfe4473cde241b26d6fce8e923688ed541d4af6fb0e17455d975eae607cd424eab21696fb107acf8d119ba18ca291f00c88b79b4e54e4224698aa35bb1b73540b87005658752335a9c7eac886b2be71112b77a6ef8de2a7de8c819b7093631e821c83a739995e24572c7d8faedb6f4f", 0xb0}, {&(0x7f0000000540)="83ba50ef585a021735430d383d6a99aa271e31fae3d607add4ae4126bb3cf67dbbaa59f75a652e6c6ea020124efdee63006a560f5af84dbfb136edf0bc465743ca528db0edce0f3226b93ac5669c3fe385d660d1b6f347b5a00fed210ffbea135947d644bfa6f7f136ec290c54210fa20319a4d4ec58217456a98edd2cfea6d256e7c37a797ec319e5e36c925d878c805ff270e0f535d5a92dbd7472018cf03a812da10050f757318bfb7e5fa6cc46df9035df5443a330899fef2fb00caa165bb988ff52bb737b9ffd89dbac7a2bb7a4169e8e6bee107f84eac52da37113c1f1d8fd67c8c1d2d7a9ff1cdcf0c66430d4e99e", 0xf2}, {&(0x7f0000000440)="bad1f713c75d508914f3a934f2dbeabf9c373b21fa529df7bbe70df3a894a1eef21840622b0e3033fab25ed7b0e702c4ebfe786065b5a227186ac4f03b8e7dbbe623176ad330d59ee33cddc83ec61c1469805b21dd954b184dd03daadd7938730a", 0x61}, {&(0x7f0000000a40)="fdb888ce9393448d678273f2551d29c9987f790290233d54435cb8a5d14aa30aea0aebd8cf92e11be9d6ef33fd8b9cbac3acb684c5a65969f0a5c7156a4ac12651487164578dade55321bdfe1a772bf69e42681b1b86473eb7115550adb459f60bbd5354b573b544bcc3b72c56a2ebcb739a96f03072be1ba44e381b129a673b3a2a0bf0df8318fc1043a25f62a9b9aeb4bf8a6dad5cc599dd2ef27c64fad29fa4e134014829cdc520549c95fd2a197c3500fb612a39875304b78679ab13e146ee5381d33dec411e6b15d98ff86e3401d0aaba3faa7c54784049", 0xfffffffffffffcfa}, {&(0x7f0000000680)="b5508d84d789246e84e7d24743ab7325a77c3ab2ac223daed625a67b6732a30cfffc88ab1eb4aa254192782e199972a6f3b1d871257af7c6052a48af3fdc2be9eac303649e5ef38e99ea2043626a10b7cc928f701fc3cd23f171e7e09f56d9757dea352d532d4d5218fdd99ddbbd1ea5e44759f5008b6e730e6041ef34979a690e1842364fdb75fa0311b8eded04ff04f10e7f28451fdd93649d0ced266e218c9b04b51215fc7098c580606692e661c0fa8214987efec28ce9e7c504054dbbe60c8fa6c24c01d579e6991426419351e23492396142703f70df", 0xd9}, {&(0x7f0000000780)="4ed3afb7d53f44242eeee23f54f7fbccd193752299972936f6f2683dba62bf62654af903f1d80bbe3bb6f90ede9fd3d578876fee3de2a23cf833d7dd6a2b6ff2", 0x4a}, {&(0x7f0000000800)="29b257693642d532b9364d11bbf48eaa17f349e40de12747039efa8020640b1f4c008c6fe6d41c20d7ed0fb9c06e9591b28ef430bb8c850d76216c9d1d6a9f7ad934625a1e1af35b6157c88adbbaceb20a6db9921093c7d2a2bbcbf78d7ba8f53c01413f2befccf40996a2dd1c21558a38f10d30913589a4", 0x78}, {&(0x7f0000000880)="35f035384dec9c5fa99ae9c08a25df618d40b415af630fcb54a365e6aac0afb80a91c0b364e74f8dc6d72464e6296c", 0x2f}], 0x8, 0x0)
add_key(&(0x7f00000000c0)='dns_resolver\x00', &(0x7f00000001c0)={'syz', 0x3, 0x2}, &(0x7f0000000200)="1d1ad732d4eb7f3652ee46e39383af62cce15cf21979c899ae544810538e8b8e82f71c6cc5cd03d1d6719772b7ec6aa7dd0a02e8818a9f497dcf34efd463e8858f6c14f7a25ee85f034f37971b19d8a8aa6eeefc5fc2bbe3fd30759a918117bd91e0a60d2b4cf9d51f2600", 0x6b, 0xfffffffffffffffb)

19:20:28 executing program 2:
keyctl$instantiate_iov(0x14, 0x0, &(0x7f0000000980)=[{&(0x7f00000008c0)="b2040ec5ab69ccd2268822f9cc7608bb6118b7e381fb035808a74f4af9b213809fd3a56d7ab12243430124da50fe99bd3efabc48c52d88c9d1ca082770b3900660005d2ecd7380e423c38cbee9fe6590b48c943fee64180dc5040e880e612b5f5d28918ae5660900000000000000d6ff4e082cf604a9e2ac13219e29e214f7708ce081275340ea15e200000000", 0x8d}, {&(0x7f00000002c0)="bd5f5698ae7dcf4d7445cf2d9fd686cd8507e3081d4511af30535094a4b8298e3be2a2c8b1214d9db411183ba9b97c701d08", 0x32}, {&(0x7f0000000b40)="08f53a14f0c6829edcdbf29291786920ff4cc1530a900e8216cd139c09ef80f012c078db152e58a0031d01024b37a47881d2276158c2fe4c512f9465c26f2fd3e8fd604d6e68f2cccfd897366e431972ebaf96d23ccf4e1f139e491f166b61e7ce547e71f4d8fb4b8362f064c89318c25f78dcdd736dbdfe4473cde241b26d6fce8e923688ed541d4af6fb0e17455d975eae607cd424eab21696fb107acf8d119ba18ca291f00c88b79b4e54e4224698aa35bb1b73540b87005658752335a9c7eac886b2be71112b77a6ef8de2a7de8c819b7093631e821c83a739995e24572c7d8faedb6f4f", 0xe6}, {&(0x7f0000000540)="83ba50ef585a021735430d383d6a99aa271e31fae3d607add4ae4126bb3cf67dbbaa59f75a652e6c6ea020124efdee63006a560f5af84dbfb136edf0bc465743ca528db0edce0f3226b93ac5669c3fe385d660d1b6f347b5a00fed210ffbea135947d644bfa6f7f136ec290c54210fa20319a4d4ec58217456a98edd2cfea6d256e7c37a797ec319e5e36c925d878c805ff270e0f535d5a92dbd7472018cf03a812da10050f757318bfb7e5fa6cc46df9035df5443a330899fef2fb00caa165bb988ff52bb737b9ffd89dbac7a2bb7a4169e8e6bee107f84eac52da37113c1f1d8fd67c8c1d2d7a9ff1cdcf0c66430d4e99e", 0xf2}, {&(0x7f0000000c40)="bad1f713c75d508914f3a934f2dbeabf9cf53b21fa529df7bbef0df3a894a1eef21840622b0e3033fab25ed7b0e702c4ebfe786065b5a227186ac4f03b8e7dbbe623176ad330d59ee33cddc83ec61c1469805b21dd954b184dd03daadd7938730a982eeb9bafe83fdaf0e8c9268555c4b8d481322ab37aad0a9b9497c3e5bbc3243b29318c338284957b31825e4c3c75ddd3ee47562abede4ff4a10166d945df14380bd7401193093c01777c82b1fc81fb1e77baf59904835aa3c5dd9b33ef23b537885b0ac3880dcb8ef2d00e25fdec9236c3e3ded62c31e338a01ac01960845f35b65d7b5ed0b2856093637b45dce63ccc593b94fb6a1c900f", 0xfa}, {&(0x7f0000000a40)="fdb888ce9393448d678273f2551d29c9987f790290233d54435cb8a5d14aa30aea0aebd8cf92e11be9d6ef33fd8b9cbac3acb684c5a65969f0a5c7156a4ac12651487164578dade55321bdfe1a772bf69e42681b1b86473eb7115550adb459f60bbd5354b573b544bcc3b72c56a2ebcb739a96f03072be1ba44e381b129a673b3a2a0bf0df8318fc1043a25f62a9b9aeb4bf8a6dad5cc599dd2ef27c64fad29fa4e134014829cdc520549c95fd2a197c3500fb612a39875304b78679ab13e146ee5381d33dec411e6b15d98ff86e3401d0aaba3faa7c54784049", 0xda}, {&(0x7f0000000d40)="b5508d84d789245584e7d24743ab7325a77c3ab2ac223daed625a67b6732a30cfffc88ab1eb4aa254192782e199972a6f3b1d871257af7c6052a48af3fdc2be9eac303649e5ef38e99ea2043626a10b7cc928f701fc3cd23f171e7e09f56d9757dea352d532d4d5218fdd99ddbbd1ea5e44759f5008b6e730e6041ef34979a690e1842364fdb75fa0311b8eded04ff04f10e7f28451fdd93649d0ced266e218c9b04b51215fc7098c580606692e661c0fa8214987efec28ce9e7c504054dbbe60c8fa6c24c01d579e6991426419351e23492396142703f70dfc9381c320ebdb908ae406f7595effb0a4e75f041e7034275b137c50c9fc39d2706f5411bb453415331a700fe06ae545889ca1b7a96b9ad43eb21bf03f7be7a6dd3425905181117012a8154e9e47bc3a2d56ecb5106d81f08969ea1b8420a92614c6608d9c1ff", 0x13f}, {&(0x7f0000000000)="4ed3afb7d53f44242eeee23f54f7fbccd193752299972936f6f2683dba62bf62654af903f1d80bbe3bb6f90ede9fd3d578876fee3de2a23cf833d7dd6a2b6ff2", 0x40}, {&(0x7f0000000800)="29b257693642d532b9364d11bbf486aa17f349e40de12747039efa8020640b1f4c008c6fe6d41c20d7ed0fb9c06e9591b28ef430bb8c850d76216c9d1d6a9f7ad934625a1e1af35b6157c88adbbaceb20a6db963205dbc13bc8a37f78d7ba8f53c01413f2befccf40996a2dd1c21558a38f10d30913589a4", 0x78}, {&(0x7f00000003c0)="35f035384dec9c5fa99ae9c08a25df618d40b415af630fcb54a365e6aac0afb80a91c0b364e74f8dc6d72464e6296c", 0x2f}], 0xa, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368080007d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c46c179b61c7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$get_keyring_id(0x0, r2, 0xdfdf)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
add_key(&(0x7f0000000040)='ceph\x00', 0x0, &(0x7f0000000000)="0000018039173cad7985f8c7f2d7acc9a34020746460b1", 0xfffffffffffffee0, r3)

19:20:28 executing program 0:
r0 = request_key(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='+\x00', 0xfffffffffffffffa)
keyctl$update(0x2, r0, &(0x7f00000000c0)="cacbb0b6216fafb4d47d22cf3e53341d3bf87f4d907fff2973eb34e32095f8ab4ec56b6901e3effab82df1c0f8cd1ff96ab5bd233087ec29fb431b819a5d28e1d333968321ee250b050b99acfa2eb7cfef2c440a22047fb66c5fe2f195fad9815d5b6cd8e8a1ffe2f02940d7b3ab5d72b24f84b56acc367d729af9b7d43df20982531b8d96c5b110efe08cf990eaea2984953aec978b1efcb299346ecea0882484934454affc5f27fcfa07d541230df93a35581c4da7ec54235564a93dd6e60c6d2eaa39aa125a74e898c9f95224bfad30bcc20cc9bef96708d5099b31324bbd2d903f11b3f89348e21527698847e7bec417678727f843fa15ec2d92946cf7054f3cfa97ce5a1233482a1e0480f96269155c572e8b228e50c7c3fc40b1711e3f069fd2bd46c317c9a8a94551926434980d0c3dc4b0439a015027c8cde04e03b684b1dba1d8da9e3a25c888393cce996821243a00fac5c5c7592ba78280fac4e8bbf533bcaf09b2ec13ba8594810e0de922d44cc81ea6ab29a81abe17278c50a3dfa1cc450b688cad5f1b0eb0608d55b647a24f8bb481ffeed5b3d946ebb5fa2e88d5db6f29681764878407f5a39155a3c632c345a1390ad4ef7acfa3194ee6d8e484fbaeacddc8deaa9d6f7ed79605ccb60fed08df119a3bb8c23308a7e983c9e0315d1ba66fc8e6fc51e1d5b53a08000a5dc0aa942fc5315721a47f42c981a859192c7b0fc24f89824c20b9331e38407cc0028c99285c7cf99f5bb59b84186d77176efe4cc5642c61df3762cd140484be73ecd051e05e1519906a0b97c525abbe225c4162b29dc1c96533e1fcc5006baa62b297477674cbb0e218a2b2d62e6434d2db5c6fa97a9a447bfae6d6b418ffe03a43c43caf3225d8479da6297aba5bae8d3e4eab0da0635699dab6e44685bb599dc5fcccf79187f17a9da80d896f28eadd267079da8c04f96e60d374a384e95bccdffd73a91f83c469759cf07d12b2fe330bace6a01bfbfd2f51824f77c098276939657be25b3a79a35443bbc9a08820d19d83cd9121891b45bbc4f39113075e1a1df5a7c46c7b7f31bfb0763d5e8d944eb26fa6f357c22c5ff6e5a350c2bcdeb1357a22fc1772dee7f55d8f1a2ba66e27f9ad9ff49d4515c398adda5b31482a392438bc452d6d016a7b689418d23115fe849fc9e528412b41f9f2537f83e9c325a98339a6adb2aef6f8c74ef4cb4fa7a4fa81f15aa9bdf6cee6999b153f44c18c01677efefa415d41bbac57f4f41e9eb3f889875378dbcf1d98300a5e12c868eb52ee92460ff18b1f66bb04e7fd0a6c353e9dd76b32b7507ab4d977a7f1904d25dd21363fa1e530a0f0e0ce388b40df8f898f062596333d49fdf7abfd6635874bfc295392cac316bc46780e9f1aa03af3ae45ce0790ba558854b5d01180e72b6f5c5204cc7ff73df58ba679edc09bdd3989475ebe29f3ff87276341cbe025c0589354a8b1c7463cfb0210348928a740da5fe258eadbc10f4d65ccf395e6e2b55c2fd9be392f560748cb3f975d2412798855cba7852b29bee34030a29d19dc8fd5a819cf8f178063cfc13cbbd428dc03efa0b946882f2ffeceb02be686344710a93193aa4ed6a35c5284821eb383b65c2f8a4d2ce22a5c2195a388c15b79b2918b834969e669926b392830f62f09d1eac52db4a12f08d857be0163810553a76c1fcc86134b37e299681d66b0a60b266228814dcab0d9e6612b86c695e6386b7a2253c53e394b6e7bdbef2771655914c2c59aa837f4f5215cf0722bbf945a733dfff07b3d5f8f8234f330623e3f3a6bc451dfd62c91d178669dc9ff4afed71c68bd37fdf07e41ed5d752317e0547ddf58cc047af5c4adc5768d7e5287f52250107a40dac4b324546564912196941d06b352dffd6ae0c34b9bc20cbed1aa65832d977dfc8f1300ab5b7d93b66e012bad2b42454f0d275143df59b5648c7e90068e386ac3b55dfa0e16f42b4045122da36f0957d0884793ec66f5005edd4ffcadf08167479359502bc69dfd38a1938d8fb0162b4d2f922794d3652b7baf7919ccf79348665a4ee2b7cf4f864f574c55fa4c66a1bee1bd092eb17f02b97cefeaccb2638f004bc5f236281cd7debb8a04d61f72acda18b7141a8c130cfa85842dc20014b42cee47e58141c3ac7712bc9ec7a87c9cc7e66f16dffde9cca80930d08790a2721515cd770219567e9738d53eb7abf14c3e2387b17f375b6dcf154689052b55f5570dbf88c382bc068df1a2955c44bebf0ee2556e7addba1a6132177b487510a4e4caead70040266986ac914642bdb7dedbbab807003282e1d5814e27eb05bf96ee01d46e8d3ee26ae9eeb425d0e0ed1ac2ad901e0a5c7cc01fd52cf4e2ff9fe2150ab89d9a35323497bc02617636454c0fcdbf820e0f07cda0d6ba701c64592ffadc46128a6494a1e750d7561cbc974d8eef8a7ee0857f7b6cd68c9465a47dfa4b0cb86066803502206cffa647fc3db1bce3752113cccba59939353c9662a3bc15c182498054b54402298f5517872dc9565cf71f3d3f42262d7c66640be67502b0131e51af471a507c4e155733b012f03dc6eeb3d82da01d147d7041b9dafeb68b776ef52c5b2782df346f5b4bcbc5fd2d4b03e0e4b4f4e7c6224b16d25c343afc6d71d8a36d0e1c59a16c82409a55e7d1759b633d9e0926b38584aeaefff4b4cf59fca66475569ac129ff2e7fb7093a8bb2ae9ae41bbd34f2de1105354b20c8df76d2e5846eed9d57b4f232a835df9c4df6cd03385d41f0054221858e0db342dc23cd6ade8ca3be3ca201679b5eaaa93c222d89f2e419f92d65e0dee455275b02ece99895d4b1bfc07e0330036efc4e82929fa4c75b8194df7069ad97c86385441533a1e7b0c904472dc7c4edac8df0eca8e8161ce68030f37c435c4dabd09423a43eaeef8dc5917e79d161b0728833e46e1c4c022f4ad3cc6c39e209963f123b02b825dcf5057ed99e8247602c86d9cf428c8981406821086362315c607ff2ec75318421a8606bfa82c112bf4ef9fc206c8450d58c3ab6258971f313e30c6afd9eec9d7c941ca15f89c43b599f4c32d8560b7bddbfe225af07b20559d4ad61474b3a711da1214a2594736e49f40a2eaa35e44cc23e884fcf6f2f3ba8b8dac36637cdcd435fc6c89d9788634246ec8ffc952ace9d616d78408bc9ed6c5af598aa1190bbc8d44e02e7e28bb1bfd270ea08920af4f41195d194ed73e530a25111583a303ad9f98f1850e2d2dfe3dd157352039842b0ef7e6ada019de32947dc88cd32ba737ab1876781cbd35f19e5f85f83ad231f346e0832670b0d36062e6cd3409ccf83cd38316a40cc1381de4748fbf5b123ccf1a79b9eb80edb18aa04e89c9a518c0dde36846a4b97b97ab98a29d54ee3946fc363cf8de860e7ccf93451a90f3fbd3398f0dcb7053ae0a4a326d34931ec52c5cb1db2311ed0ca7d155856d8aa474c38d70442c25a1e63fed01fd2dbad4a2b1f251189e76d70aa46ca7e2e079c1c0e87bad05ae1f03bf170d5fda0ab38029a0b6b4d867a4d2146376337fabce9f83b8e44f4fb2fa240b949a57694804b58ac75d6860940e1f9e8c0fce09b4f60da788f62e2aeed85871f1b1b0f3f9f07263e68971bea955a726761ed971ff196206e76cf54aeba0cdc693941d4f019aafbbcac5894abb5cd61a9b8b44040fb4b6d46b9f4e52ec9b16a3c11a5027cef66e04096de4ecd11dba979aa4a42cc8d1128520b7cbbace2cb7fd3c8c437f4d5448368a9f35e6777e78ef306268a1e4d7a8d9283fd89f44e07bac1973e816835182c8bc063e2c3a9233e1cea3be3380f4ce9112ebad09b8bcfa0172baa9b31251b37d0ce783f254a25bd50bf5f5011be50dfce4dc8857d836a2e836995c37a4f73206ce313f586806b622f0553e1689d4a25a017a088eee503125c9fd7b069d213f474184e271aab365445131e53d8dccb86cac916f8d12ed5556731b5070e468545273aceeb317e5cb5c2c8d4f6d3a5d7d5f381c85de3882de3d6aaa7da261c87c0ee0bd73cccee45d6c9d693376c9b2b3bb68581a79793975813688b242a488e56613aca8ab7c3b724506cb4f713d52a961a1a8f6e661ef3ad895d885fb51e90a96b03fafb2687e46963fc10a1bfc108fef7e35b7bc5e843bbed0ceb1fe9a2fb9eacc6f206bc5c5915f0c8c6ab54a8d2e7af58f9954d047537c0fa3183df2ec06fb503d6566f549aaab8c22f9338cc77a745ae05fcaa71e1df380949892660a1e54e92b0971365e452fa7c9ee66d8a8f305405d3f0ac8bba4c06d32b272b99899dea6b3452b90db6cd9072f82d881419602d4b1c90e974c99a521632f02e8526f7a5efdb9fdf3e9f809b31b0e40eab6293cce20b28cd21b94e2697c574a20ca872e15fcf4ed831a9731a39e1a1960f15c24f32ffd36b6e2eff1f6e4c28b7b8f4d8b08c0c8ae7788c7f19104826748b2206e6c41c79773d4ad63f6b7cf3961bfb68ffb2357a04c1905b0e76f4a7514b3eff203a57a8b632634ea2a5d000ba6abdc4ab4f770630934aed73a24d2b1a350f4157a0ac21d06dc6962796ca439abb89127d8ea6c6a728aeeee20a3dfd10f157137a32bf83383bd46d737df924687c50e050380d6c7491ffd5e65e9468d6a1ed34694b1ca5e51b1fa6ea39fe061c85b71af1b8e79799d0cad73742b6643677839bcca53cd0de89adcef93a0e2a53a34cea2ea58a42da0f321a59b26643ae7f65f4446d7559234a6c23ea31f52b3481cbcf77e0d791a93884e95379792e11ed31488981e8bd34db440612f2e94b74a90489db9e59197ea2c374123dc12504833ebea1c684ddb9bdcdf3b1ce17576dfad04a41b4af4ef7d3f30d9f14624f996ef1efeac710190231a56605b5501ac3d80b2d0af7772497fb082d2436dc3d9ce6a5734a2df60e99c8eb5e56ffc77774a88c707c222a63e487911603db8ede18c451a32d0dfd0de49ad5374b6a69f21ca19ac217752de50a1da4376a831fb9e6707b47c3abb4d255b84dede2d27d7d0ad23f99fa5c52d8013f31106eb0e452afee6c6673eb4d359c0e078ad268c69693f7e7389fa3fbac257834669028cd46f6ca4a919933a235b4bcee6a23a33b8da35065b486f50589bf089c67a0881862b5c3b220d44bd1831d63858bbc7fa1a5c79a8a1cb4bed4a2caeaa9d4780b1f715f8e0931d5f72e438e483d168a442ef0ab2b7be4ae7d66641b593e692562b32503cf8d9d2c4cdd7d70b12119a56588045b41e0d34fb915e84baca4c0a0e657e72ad89b5b600acae393c6fb289c715f93f590be55ff56b7de872548046e9f263b0297af7235999ba1a02f5ed1827fce25fa142d5056638801cf75f6e4ae4011bb3d5ba0bafd6f1ee3186e6b47dc3b84da23a33526973bb2e465a0a5c1902ffe97b31913973aa67d2245c8d558a738f37f0e3801eaf519b2f45d4afde9950f66d787ea0a626b5f2634e8f9e6a7e4894c35c247aa9bc9a6a017c7b392d5c8b70b122e9184ce00a39beaa4deae86a09e8f34e76cdea4d8bbe36a53e83bbccd73e4d71d4a3657c1f18eb22b78b9a20e87357215ab7938d7603a0952c16296c8f188dd70101fc05124d68aaf887c289a1a8de7a7cf9e057d03de86b5f49a75921e9399f28d8a695537764ac38fb2b7b28931cc912e6276f9ba234986573a0d655e966317344f601c8434719c5419fad286f69336d2e1f026e4e79375933dfde5e5ce6893eb031717667c8a3274dbfb9aff5ad5944989abb27493b6df219b907db87820c0c91680538e4a4bad51fefbc057a7", 0x1000)
r1 = add_key$user(&(0x7f00000010c0)='user\x00', &(0x7f0000001100)={'syz', 0x2}, &(0x7f0000001140)="170c445fdc2ff7f327978f33824954fe01837822ad21d7984430528d30502b044332a63d8f6e477d79f5cf14a175a8463515e46e2a", 0x35, 0xfffffffffffffffe)
keyctl$negate(0xd, r1, 0x2, r0)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000001180)={r1, 0x79, 0x3c}, 0x0, &(0x7f00000011c0)="5b730d24930977cf0483d5fabd9db32b5fdf49cadccd2c3d5f3c136b7995efc6412b863a037f2c2dd5c4a6b557ad95924bef1db1b37c43ab59ef72504f87fcea3b7f56f534c45b347ca93e2729d941356d642bc2d2fb915a9a60376e27fdb291c36dc551944e418f9218fddd83e94fcadabe3e5c86abfa62c3", &(0x7f0000001240)="0361574497ace2626ee92aaa73bf52d02d4ec836d6357be2f1e684ad2fa4e9b57d57277cda493701dc4c6eb17f1e16d60b6cd170f5556d9ae693aa09")
keyctl$get_security(0x11, 0x0, &(0x7f0000001280)=""/4096, 0x1000)
r2 = add_key(&(0x7f0000002280)='trusted\x00', &(0x7f00000022c0)={'syz', 0x0}, &(0x7f0000002300)="308965ba3fde19ddaa90f67c5d9fbed40d8bafde67d6db64", 0x18, 0xfffffffffffffffa)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000002340)={r2, 0xe9, 0xb2}, &(0x7f0000002380)={'enc=', 'raw', ' hash=', {'wp256-generic\x00'}}, &(0x7f0000002400)="2ff8056425a874c165002e97562b05ff77253ec96b411a4fca7745081d8b6b9162d966ee3421f186ac1107c4d317129073e8fa06b90b905ca25916f43e4515adbdb2a4c4495042527441d290bb41e764b089fdc82e33badae425f74cc9d90ce1a66ad46b30b6dc05baee0f73b3f744103dd4d33797a9314f73f35935b7da71bf52ae526a21b40d98d747035958ea6d52c901c8ed111a8a174cdf0c3f01f507dbb734dd148a47781258e98de70514bd77b310a59da3d9c6dd7eb7e8af95984064a200df3b9a0a7c092689f028f39179c97cebe0d8a411e87c3ecf048f46276aeefd2489c7980e0a266b", &(0x7f0000002500)=""/178)
keyctl$set_reqkey_keyring(0xe, 0x4)
keyctl$search(0xa, r2, &(0x7f00000025c0)='asymmetric\x00', &(0x7f0000002600)={'syz', 0x2}, r0)
r3 = request_key(&(0x7f00000026c0)='rxrpc_s\x00', &(0x7f0000002700)={'syz', 0x2}, &(0x7f0000002740)='keyring\x00', r2)
add_key$keyring(&(0x7f0000002640)='keyring\x00', &(0x7f0000002680)={'syz', 0x0}, 0x0, 0x0, r3)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000002780)={r1, 0xd8, 0x2c}, &(0x7f00000027c0)={'enc=', 'raw', ' hash=', {'ghash-ce\x00'}}, &(0x7f0000002840)="aa824cc199071e0ee4b40ffb3e8779524313dd6233c8164ab8cd0357428433015f7044cebe3a735bfa1be831cf16c5ee6c28645e0a16ac800bb883da8dee20b3333658331ce0d350dbe52940ce28ce6908659937da4f802482707ae73eb02c98f8909f79943936069e94165508c1cf49a0e4c764b40cd52d18acb974193d98167452cb360173c5513c586173053e6488ad7fbc1550b901a51812134713c5a08b57a0ec7d3943e4dacff7bbfebcbf845a47e3e5c84cae9f8bdc8cecf81cdc06682d13ebb267fd30511462bc7759f5e7d741fda06364a31669", &(0x7f0000002940)="517a0c764c2936c971502d1373811e4f0232c321c5b5068602097b1cf6230edb79b214d0d99d2442a5316328")
keyctl$KEYCTL_PKEY_QUERY(0x18, 0x0, 0x0, &(0x7f0000002980)='+\x00', &(0x7f00000029c0))
r4 = add_key(&(0x7f0000002a00)='rxrpc_s\x00', &(0x7f0000002a40)={'syz', 0x2}, &(0x7f0000002a80)="ede2a77d20943229013be71397d445757465185d8bf2214c57778b86536c56fbb4351cabf831f64d45ce086f7dab7b6050a74b65b3b54c1874ef1a5416196d5e0af26110986b6b81a04a41883b51a793b7da4fe4c45139db9f590321bee1b75820f5f439dda2aa81a34cf773fb9a4a1800db80a7f7a72dcca3bb1b6a439b8f2fc848fe12e3ece54bdebcf6f0ff4afa223514b4a32c7e49252070cc1c328fe63e20361cf254dd55da0937661eb40d1f2ab35c050c09493fd001a16df92f2a8b886878618e1cf923c9f453d253cae11e7807e86d771682fd8a9d3d402aec3ff6aff69af5e5730eeeb41ec3fd", 0xeb, 0xffffffffffffffff)
r5 = add_key(&(0x7f0000002b80)='cifs.spnego\x00', &(0x7f0000002bc0)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffa)
keyctl$reject(0x13, r4, 0x9, 0x6, r5)
r6 = add_key$keyring(&(0x7f0000002c80)='keyring\x00', &(0x7f0000002cc0)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffe)
keyctl$search(0xa, 0x0, &(0x7f0000002c00)='.dead\x00', &(0x7f0000002c40)={'syz', 0x1}, r6)
add_key(&(0x7f0000002d00)='trusted\x00', &(0x7f0000002d40)={'syz', 0x0}, &(0x7f0000002d80)="c9216c660a4c852c09d8a7b3f2c96c15686fb6301ac2b08ba0ed415e67f47ba026213c1ade9bc2ad06d44ba1f97f2066ce2b354900ac8308f264476f49223fc16ecc76fff2617c376fc3ff2ba953cd66f9d42c5b8c21e7fcf5712523cfddd3697f486c81825dd423fc0b54ee809fc38e5b6c1a533843d352e6efba6c00faf49b4af564359e0d526e18a14dda718043219e79ae42656abd440e662a1b79ec40db426a1e7aa03040368e95df29f4b65e58bcecc33c6ed180ba", 0xb8, r3)

19:20:28 executing program 3:
add_key$user(0x0, 0x0, &(0x7f0000000300)='B', 0x1, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
keyctl$instantiate(0xc, r1, &(0x7f0000000040)=@encrypted_load={'load ', 'ecryptfs', 0x20, 'user:', 'keyring\x00', 0x20, 0xffff, 0x20, [0x62, 0x36, 0x34, 0x63]}, 0x36, r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000280)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$read(0x1d, r4, &(0x7f0000000300)=""/164, 0xa4)

19:20:28 executing program 2:
keyctl$search(0xa, 0x0, 0x0, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r3, 0x1)
request_key(&(0x7f0000000140)='dns_resolver\x00', &(0x7f0000000180)={'syz', 0x0}, &(0x7f0000000200)='asymmetric\x00', 0x0)
r4 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)="9a63103f9ef351ef17b40aabec853c96270e86f517a8dc797260105f95cacc64457e97614b5037c85e7f7131df24690b08ef551696cd1bafde41535f4349cc36c1ab2272f1f0456dca644f8a8901fdd9fa2ae7c956076a7883c3bf39839dd54f54a30d410fc50d9bc038693003279fff3a6014c27119c7211fcd6b074b8b073fe37fbefd1e177bccf03ae9f34f2b277d28695c306697be750ebb5c0e15bc668273ebe5907d25b500826271da92cced2d4f7aedc248697969c644e11fd2c0ca6a", 0xc0, r1)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r7 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r6, r7, 0x1)
keyctl$negate(0xd, r4, 0xb53, r6)

19:20:28 executing program 1:
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000000c0)='\x00D\bK', 0x4, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, 0x0, 0x0)
add_key(&(0x7f0000000000)='rxrpc\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x3}, 0x0, 0x0, r3)

19:20:28 executing program 0:
request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000000)={'syz', 0x3}, &(0x7f00000002c0)=':bdevwlan0vboxnet0&\x00', 0xfffffffffffffffe)
add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffa)

[   16.442732] dns_resolver: Unsupported content type (68)
19:20:28 executing program 3:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000080)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, 0xffffffffffffffff)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000001c0)=""/197, 0xffffffed)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r0)

19:20:28 executing program 1:
r0 = add_key(&(0x7f0000000080)='blacklist\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)="7231cc658e4406fe95c332b236aed751363aa3dca8d81337a99317834691721ea4a33084620bf09c9857b810edbe9b53655558b830a4f1997cc1495412b2ca5702f3b85f432ec66932ac6b0c6788181b781a230f842139121b66cd62861272c75ed094c62ee6b5fba9746bbbc7cad6a97acd93dc7681ca77ca867cdf8d5a730652e83a71d31dfc427fd2a2ee04fb6bb51ee201a64d1b75286b8381b8e344f45264319a50dcbbde62594fd122b9d04dfceb3dd04731293e945e16652bbd93f5c5fb54631d185046000e1224dad8f28208d5e5795d", 0xd4, 0xfffffffffffffff8)
add_key(&(0x7f0000000040)='dns_resolver\x00', 0x0, &(0x7f0000000000)="00008549053593e1c84f897b0c3b90c33d588703e9a7cb9a", 0x18, r0)

19:20:28 executing program 0:
keyctl$KEYCTL_PKEY_QUERY(0x18, 0x0, 0x0, &(0x7f0000000000), 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
add_key(&(0x7f0000000240)='logon\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f0000000ac0)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a76c7e96aca1f8bbfd0930a0f3a7b3127e7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db8d2da71bae7345e00b108cd9077d31c1d57ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9bb2acaff52afa55f349c55ce1380657d925d7118040382421856ba8087dea9adca01ef4f68b786e7bcbc22e70ea44da51858b9d35d8e13c598f525afeccadd79e607835f92aa683ae047539599e1dd1eed4bfaf2c06a2e973f18ad7186e73749119bd144af13a8f39e89b112f1d0bfeb6c1044b5e55ab57f58f2bc79aa9639caa01b348a49605b9b12351dbeb0e38bd01500b717a5bf63eec9e15f617612cc28b36ca3beacb1ba37645010d5bc047bb12955476326c8eaef11181f699a1ecbfd664065f68254fd0dabe77a3217b6aa87c2839ab43506c63e7eec891e30acccb2624143d8bae117b62d9bab98446ebd929cda32dab7d3cc0a3e08c3c3f904172f39becf836eda5c339b013a3f387d44ab7cf1f6f67f1ff6e3f3268abc1fbf279a6466922ffa02546e7efa00bdf7c5335143920e6daa175e1602e63603d2706042841b9ba79aa9beabe2019b3df1ebf316a38b3272e936c91cbf0575e5fa0cbc0e992b83192a429cb008507f8007ac49e9b2d3f7ac7f9cb470ab2a011ba0a32e8fb7a3a3a5bffc1ec45ac3a219e53b11c640477eaa28e83142dbc35c084dbafa54034e34b38b15bdda592a073ba4f6c8e6983ce9f5dae10c5c3e9ede7e3753ef5f04252efe476fbed0d87dba02236a3cf2fca62684c6b392660be5837fc64b37f6cf0d5b627a58c89a94162b575e76f8c35e18cf335aed0d501f7fa2e98d308e79ae7fcfc8163be7b86b35a8315ee937ba2f235f5c7116eaec99d76413c683a13518aa49e1b7a5366123ea111f8bb08ec6228a0fc85654d9df2d485bc1437e9656751bb44fc648462efe9ae33631368b75a38f72a46b1b9dec5c001f8b67226a5fbb73d565c65457f9a0945c930fc02c0a301860b266108c9517d7f0a861dd0ab5815bd54e43f541ef5fbdafa41c5d6a5d7a284199f9e0a4c8843d6c29725b23a63c73d69aa45439c3dca38d7567734ee75f356d1e86f3c5ab28e346bb9ae81325344aa1ca4d6cf2dcb7a51509fc0f25502e2cd290852ea707f2744efeb1371320918657497697637dc22c3a39551100b74fc1c9c50d0082933aaf5aa5a0bec283e593267de44e68ed751036ba9f3ca47d339fdf214e3908007bc7d966ee10a37f2e7f3435187592ac05ef1ed74a9f6e805630c9a38bc67123d764401791e0bd8c7219f431d01cff5191a0e310065a44c4c56194c270630508814fdebbe1224e31a33f2b1af8d9d93be52fd4088f7e51a40e7af734301287f30adad39510447ba8fc270edfd25cf47fcb9294106789677f2c137bdf409853b0d9506ba7795faebdef8885eba157f6b7aeba314e99d29da7c1d81b613463002bd567e966b30399f26281a85645400084b0aed930b856f6bc40c763cc1cda1cfb2d37251ca645f8d83425c9423d39af4221f38fefa1efb6cad4352c1735856bbe4164462f6476d740fece7be2bd3e536e6696b79864729db19447dd7113a228c2078c4bebb1582ba892628e1690fd09e08e35d9fcc11b03901554f40ae8aadbae91895ee51282863d8da193340c5461054a02cbae8e9ab41b95315d5f2edd7d0ed1349a604094d3e3348529bb0e582b603e39713da528dc7d65029b9c31e3b6631359339a9c30b36a4e586cbee97683bbdd1bfa6f559f1aae230bff6534ac2c11c82763e78efdefec8ae053421796b7524bbc96acde04c5523d523cf0f73f3442b7be45a8710432592b973dd1b59c6ca0c0320ae14f9d64ca0ac3340e66c1e5185ca1473b1dc31c88181605a7b16ec97cb8dceb417a1093730075bfc322e1f2237f8e2cf24ac595f33ebadfd07b7f593851cee9bda2b35e26866bdcf2d682e98c41bd42428083b0571073e4841e867ed0672c8647ead6b849c57503134537f4fc54dd349b23d44ba5267c9e7a924c28adcadbc2b4062339d60f477690448ef79bb494b86c5d412ea9aecbbf319d97bae22f17ff299cf502178303b667e40668a73807905f4e48980aeca937a401c48fcc5232208e2a0ab1199b07fbe8855a9a6b202d339c50031b8cc8274ddf72240dcdc2ab376a31c3b2a54e2fb2d3b52c9f48922a7887cf2c467881686d25cac07b19628bc6c526c2a840c422cb7df44d8f678ba3d71b35bb3660f119a3066b6b41a0bae0b1aec48532389b83f55640152fa2dd1474649118ce730b8651511b2999a0edb0ccb6d4d87d57cb4a2c14337bab2ea0433e4b182ca5b0b83ec22242e7079a2b2af16e3b81ac178c493c8de3beec7f8eb7404ce48a16ffd4bcd68adaaf1fea5283c40ffdfa6a1200fb272aed6428947b3a33de97fd5e226c2d18f7701700c3e57d42e3b659c26e7af3b081c89da48a112a5754ede6e6dd11f4616a51e8bd5fe0a4104eed631155b1174300a0484ebb3e4c083ce66fe46debcbb237042eb0ce15867cbcef32ef026d0b880f15b6f73a77dab13be09cdd7203581da09b99ab7b2cf49f0981338e72a6265305da3ce69930d1a4e487f96c8386132cba4069597ce07ee7b2878d09d81ed840aca471bd28fec60cfcf7677b5f63c15269667b0bc5388758905f6c515f23593dcb0721a8ff092be1ac399238d12a63d2d4ffc0b961f9da066c5663464fc0f22ad00bb35feca2f4c561ab7a2000000000000000000453adf10d9395bec0fc63c3d3d3bde5ce15904ecedde746e3d948f4028327a69ab50dea5711f72abe910784eb75214913f2f41d7488ef5bb0f14a5e99237600029d06db6", 0x88b, r2)

19:20:28 executing program 1:
r0 = add_key(&(0x7f0000000240)='logon\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f00000002c0)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a76c7e96aca1f8bbfd0930a0f3a7b3127e7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db8d2da71bae7345e00b108cd9077d31c0d57ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9b", 0x100, 0xfffffffffffffffc)
add_key(&(0x7f0000000000)='rxrpc_s\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="297f7b61c61d95328af30a5e8962d3744e187ae03e9cb583a4e26e4d86107d255195d2e9fcb22c579f893d5f58efcff6371417b57448f223bd3ee7f6d160f5bed17fe7707af52b7e66fe3bc1b0064454f1d387ab7dce5bdf5d53c85d559a63f9a7cf1922f531ea12eb53e3064136a36a7eaf3f227b2abf13d438360ad5a36b3a829e5836", 0x84, r0)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = request_key(&(0x7f00000000c0)='pkcs7_test\x00', &(0x7f0000000100)={'syz', 0x1}, &(0x7f0000000140)=',em0:!\x00', r1)
r4 = add_key$user(&(0x7f0000000200)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000180)="80a321f9d1944de715bdb25886d4a0f194b364d8aa20facf5f6fd5ff08d96fc2dbef15b0ac9e867689928cd8c6661908d0", 0x31, r3)
keyctl$reject(0x2, r4, 0x7fffff, 0x8, 0x0)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r5, @ANYRESOCT=r5, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r5]]], 0x5, r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r5, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r5)
keyctl$read(0xb, r5, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r5)
keyctl$search(0xa, 0x0, &(0x7f0000000240)='cifs.idmap\x00', &(0x7f0000000280)={'syz', 0x3}, r5)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='trusted\x00', &(0x7f00000003c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd6420cde6", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
keyctl$reject(0x13, r1, 0x8000, 0x8000, r5)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000200)='asymmetric\x00', &(0x7f0000000240)='key_or_keyring:')

19:20:28 executing program 1:
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)="c2", 0x1, 0xfffffffffffffffe)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$setperm(0x7, r1, 0x0)

19:20:28 executing program 0:
request_key(&(0x7f0000000080)='cifs.idmap\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f00000002c0)=':bd]\xae\xa8\xb4E\x10\a\xbbbonet0&\x00\x00', 0xfffffffffffffffe)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffa)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r0)
keyctl$set_reqkey_keyring(0xe, 0x6)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f00000000c0)={r1, 0x16, 0x12}, 0x0, &(0x7f0000000100)="10aeb61168b75341d0a23922ad94eafa5e06bfd31eb0", &(0x7f0000000140)=""/18)
keyctl$invalidate(0x15, r1)

19:20:28 executing program 1:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f0000000080)="83e7", 0x2, 0xffffffffffffffff)
add_key(&(0x7f0000000000)='blacklist\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$read(0xb, r0, &(0x7f00000000c0)=""/58, 0x3a)

19:20:28 executing program 2:
keyctl$reject(0x2, 0x0, 0x721000, 0x201, 0x0)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000001c0)=""/197, 0xffffffed)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, r1)
keyctl$reject(0x2, r3, 0x760fff, 0x201, 0x0)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000280)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffff9)
keyctl$link(0x8, r0, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_MOVE(0x1e, r0, r0, r2, 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000480)={r0, 0x53, 0xeb}, &(0x7f00000004c0)={'enc=', 'oaep', ' hash=', {'sha1-ni\x00'}}, &(0x7f0000000580)="486250b5b98540ed4b5226a277dd0341512faa6d4174abb8574dd995d36455a2563e9fd2045d9e9bfde510c50aa0bd96c9ebd29b438bea3416d20b99095d089c35e764bb1f1890ad9d6724dbbfbf10ba2e9d44", &(0x7f0000000600)="2589e1904648d58053a3a10d2ca23ec87c9e22f65d6e42fa19c72ab14f55c0ebabf308cf4b384c03d72cc325ad4328959edda27c168324ad2f44c1761a93c76628bfec3f7cbc175620020dda32d2632407847122b5d652104998b14bd603aa7f817df8d3aec0c49214dadf5c14f5b5ddba15feb9331b8e4843c814d385a458d8ceaca8d3148487104d6a525a71cf30c63e749a6cc1b6e63b5ce26a3787f75e99524fcc4810ba17ee5fa3b297aa7f7f207fadcdc5416b41ab1c106141051eb6cd0ef02845aaa167a982ae7e0cd4f94c7597219a05220d94e7871411ba833cad82f4f3829e15412ba5530409")
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$reject(0x13, 0x0, 0xff, 0x1003, 0x0)
keyctl$clear(0x7, r3)

19:20:28 executing program 3:
add_key(&(0x7f0000000040)='rxrpc_s\x00', 0x0, &(0x7f0000000080)="107bdfc9b2f9177cd6c94baadee016c2274fde629d8a0f88a50594838a65a6e300ea5db974bad434568f84d6a43c93bf9eca351085dab4aa9e7edff2dbf9cd9b3c31364ed459aff79b1343f20b880e8bb87f23e466c63b1b440bd99cd1b3d33657588ae31dd453a8b894375a99cbf0db489ea546d1743bfaa8f64dd78fa40c183186b1ae", 0x84, 0xffffffffffffffff)

19:20:28 executing program 1:
keyctl$assume_authority(0x10, 0x0)
keyctl$invalidate(0x15, 0x0)
r0 = request_key(0x0, 0x0, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0x401, r0)
keyctl$reject(0x13, 0x0, 0x1000, 0x9, r0)
add_key$keyring(0x0, &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000280)='cifs.spnego\x00', 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r1)
add_key$keyring(&(0x7f0000000200)='keyring\x00', &(0x7f0000000240)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffa)
r3 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r3)
r5 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, r4)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r5)
r7 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x1}, 0x0, 0x0, r6)
request_key(&(0x7f00000002c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x1}, &(0x7f0000000080)='-\x00\xa6\xb3\xf6O%\xc2F\xdb\xd7\xc8\xd7A\xa4@\x8c\x81O\xe1\xfe\xefaD\x94\xf6\xe6\xe0\xd1\x9f\xb5h\b?F\x13\xdf\x82\xd4<sFV\xe3\xdd3\x1c\x9c\xdck\xe61\xbd\xf3\xfeB\xd2\x10\x9d\a\x85%\xfb\xe8\x9a\xb1\xa8\xca\xc2<\xaa\x8f\x84u\x0eb\xcaq\xd23\x83\xef\xa1\n\x94\xdc/\xb2y\xf7\xb6R\xcc\xc3&\xafy\xfc\x00'/114, r7)

19:20:28 executing program 3:
add_key(&(0x7f00000007c0)='asymmetric\x00', 0x0, &(0x7f0000000840)='[', 0x1, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r1)

19:20:28 executing program 0:
keyctl$clear(0x7, 0xfffffffffffffffc)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000380)='keyring\x00', &(0x7f00000003c0)={'syz', 0x2}, 0x0, 0x0, r2)
keyctl$unlink(0x9, 0x0, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='id_resolver\x00', &(0x7f0000000200)=@secondary='builtin_and_secondary_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
add_key(&(0x7f0000000000)='ceph\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r5)

19:20:28 executing program 3:
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000000)='<@', 0xfffffffffffffffe)

19:20:28 executing program 0:
add_key$user(&(0x7f0000001a80)='user\x00', &(0x7f0000001ac0)={'syz', 0x2, 0xe}, &(0x7f0000001b00)="bf", 0x1, 0xfffffffffffffffc)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@secondary='builtin_and_secondary_trusted\x00')
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000780)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf192ef023876ed376653cf7032186f330bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c0d9b7dc7601d725caad81ca1b5ae820d340300000000000000fff4da4cf45459ca561fe2ebb1fc3d2c58d77e46589690aec1a1755eb3c850a550baeda9176ae01f7a67a228ac7fc82fd9bbe1acb0f7286f7b8a4ef9561e2495d3b9f18098a2964e9a6f48660a4e50ed1fddc4d1244ccc8e6523d7d7d6fc456abaa2ff9f6286a7df16a313517b55fced5a1d4ff67b9ac2078f9be1cf48ca85a2515066c97a46448f4a59cf0856703016f43d17ca5d38a11d0519e40f5e02af3c9fa5873694d8b56563c7a4b4a8b5bef92d8b4bc7aaadb88e3d37ffcd1aca3d9a2709577b1f9fb2b5b65650b0ccf5a45dbe4ef8719a419592f23d614b3534e490a5ddf97ef0888dafe642b139c9b5d71587a62866fb9121f822b65fb3f87ffd5945c45c98722e3a18f1089836cd9b7920a20092e85326108b8af96152d678a5a70000", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r5)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r5, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r5, 0x0)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key$user(&(0x7f0000000140)='user\x00', &(0x7f0000000180)={'syz', 0x0}, &(0x7f0000000300)="e13a", 0x2, r2)
keyctl$read(0xb, r4, &(0x7f0000000340)=""/4096, 0x1000)
r5 = add_key$user(&(0x7f00000000c0)='user\x00', &(0x7f0000000100)={'syz', 0x3}, &(0x7f0000000200)="433d5a9b30a070e0818aa1f902fdc1d91f7c5e22ad42ab9e8aeee1c04197bba9b0a57b32303d32599be18a1731f0d657187b57b5543dab63cc866e9fb284b093f5b17f9bc8f4674a80c6e70099319eba376042d402f9c681c66ab6e271821b04cb47f2a4d34480ab2dabad0297fefc60cd8dbd4907792f14a941a4814b266ce4c0e3b0f17c76656fbd618f2dc9ca8f6defc9b82d73f94abb29384c58acf41bb673c0d83cca06b8e2c0b0e29f94444375619a4f19824f58ca7858e737448f52d0b742cf87ac297e52d638d699eef5c110097d19eda2b9fc21593d69ab921a5e6f3714a7eac79b3b3b9f5000485cd2c5d3d9ef716d6701aed156", 0xf9, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f00000001c0)='user\x00', &(0x7f0000000080)=@keyring={'key_or_keyring:', r5})

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="ed2029e16f6317", 0x7, r2)
request_key(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x3}, &(0x7f0000000240)='\\/]et\x02\x00&\x00', r2)
keyctl$setperm(0x5, r3, 0x302)
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f00000002c0)='\x00 ', 0x2, 0xffffffffffffffff)

19:20:28 executing program 1:
r0 = request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000000000)={r0, 0xc7, 0x64}, &(0x7f0000000040)={'enc=', 'oaep', ' hash=', {'sha1-ce\x00'}}, &(0x7f00000000c0)="d5f72a835b360cf604069c6947e907e5fac8582af164af8c4550ca06179dbca48db4302e3ef6c36f099ada98ae0f7a93206e21340fc1a27fd60e3d13a4ded511fecd6aae43931961e0a4d27a3a00431ba4c489cb0eab4579e9676b6ba89a969ed51a9c68024f196ea2475ae916fd90917b593687ec3fd60ed47555ea7df34bae6cb436bb403ad51ab863ad201efbe5f87b1f3359b5d4b9b820ae62984c2dd0f2e5d40be85831a2483aacc3a704353176716cd83a59b78aaaa96aec33c7c7ddfbec74c448a25943", &(0x7f00000001c0)=""/100)

19:20:28 executing program 0:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000300)='B', 0x1, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
add_key$user(&(0x7f0000000180)='user\x00', &(0x7f0000000200)={'syz', 0x3}, &(0x7f0000000340)="9b068bcb097e6ea130558af33695448cc3a4169fd2805b9b21b230cf760b1cbc954d1e4ee78cf553479961a8d8e495d791da80e0147126a3cd762e4472e1aa1f7dea7a4eb31f57b537dabd15ec4bdf589bc49606a958a27d8bf32d2da338b1d3d63b7215dcda6bd85ef93b2f3cb312b1ee67183150eb6facc789da0b450cc9509af75df48c9e1e4e4779ca565b58f52434753f5e2a09a91155e810dd61175f46074f540d0fe67d08cf94a99ca5b6e3385d5f705411f8d92c5ce05ab99e2496f5c8d12596cae19a99aff419e0295efe22e866f2f072c6ce17cd6ee3b2cc7b5f0f5b5a", 0xe2, r6)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r7 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x2}, 0x0, 0x0, r3)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x0}, 0x0, 0x0, r7)
keyctl$setperm(0x5, r0, 0x92000)
keyctl$get_security(0x6, r0, 0x0, 0x0)

19:20:28 executing program 2:
r0 = add_key(&(0x7f0000000040)='big_key\x00', 0x0, &(0x7f0000000000)="30f5de", 0x3, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key$keyring(&(0x7f00000003c0)='keyring\x00', &(0x7f0000000400)={'syz', 0x1}, 0x0, 0x0, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESOCT=r3, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
r4 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='user\x00', &(0x7f0000000580)=@chain={'key_or_keyring:', r0, ':chain\x00'})
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@secondary='builtin_and_secondary_trusted\x00')
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, r5)

19:20:28 executing program 1:
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000140)="108102", 0x3, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$search(0xa, r1, &(0x7f0000000040)='dns_resolver\x00', &(0x7f0000000080)={'syz', 0x2}, r5)

19:20:28 executing program 3:
request_key(&(0x7f0000000940)='user\x00', &(0x7f0000000980)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368122207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e3e74bf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$reject(0x13, r0, 0x5, 0xff, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$assume_authority(0x10, r2)

19:20:28 executing program 0:
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000140)="1080", 0x2, 0xffffffffffffffff)
r0 = request_key(&(0x7f00000000c0)='rxrpc\x00', &(0x7f0000000100)={'syz', 0x0}, &(0x7f0000000180)='vmnet0\x00', 0xfffffffffffffffe)
keyctl$get_keyring_id(0x0, r0, 0x0)
add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffc)

19:20:28 executing program 2:
add_key(0x0, 0x0, &(0x7f0000000000)="c3543993f40dd2514632455d209a097a0800000000000000c6c4a7ef210ebeab632904be1875c8eaf8a24bac2375d514ac68e20e6cca7464662f57c3e85275b895c45070b322a45cd794cdf381b11d4d33d75679e9e40d5640c459fa0af8dbbae323", 0xfffffffffffffdb0, 0x0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000240)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r0 = add_key$user(&(0x7f00000000c0)='user\x00', &(0x7f0000000100)={'syz', 0x0}, &(0x7f0000000480)="4d236bac09a48d6c2738048367deb65eee27e1585dfc016669c1925cc406ec55c373867291c7d0ac0ac0f451bfc86b50641dfe2d25b04b19196f83ac335cae9a547da2d00b4b85d4c314c6d92cda819f433ef30b2ce955ae5d2cbf32b2b44ec08991c62ad3641bd12bca4f57a7e6c2931496143ef2c6e7ae9a57ea3a795cdb4884a529d545b5cf33931c754eccd32323e8a379", 0x93, 0x0)
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={r0}, &(0x7f0000000140)={'enc=', 'pkcs1', ' hash=', {'ghash-generic\x00'}}, 0x0, 0x0)
add_key$user(&(0x7f00000001c0)='user\x00', &(0x7f0000000200)={'syz', 0x3}, &(0x7f0000000380)="f683652e8216e52240eda8f1ffd7e794a988abf3e573f44ce0845a59d82eada15dde8c37ae15b3d70a659e81f4c271d380d445524ef63d0eb35db543c4d2e5779721282817da3f4096655a49ecc8ae0f7ebfd2cc62b8c9098e4ebe8075231e7d290c76ccd67c31148b3679651b59672d4393f07d467bbbf0a7d3ab5ae3aebc1febf7200a26d487ba09d18a1adb6eaea52431041b5943dc18a35a52df69968231d530f27ed53cd8c0c5c7fbcfd7a9808ae177784a68823cbf3c328df146383fbcc05f927355003cea06dce4ae23346405b62675e70cb1fc0cb2d6582e08f00c36ef6c72d036ce337a16f679bfbaa3fdd88796c7ff30", 0xf5, 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$unlink(0x9, r2, r4)
add_key(&(0x7f0000000340)='dns_resolver\x00', 0x0, &(0x7f0000000000)="00008549053593e1c84f897b0c3b90c33d588703e9a7cb9a", 0x18, 0xffffffffffffffff)

19:20:28 executing program 2:
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000000c0)=""/36, 0x24)
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$reject(0x13, r2, 0x3, 0x9, r5)
keyctl$reject(0x2, r0, 0x800006, 0x201, 0x0)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000380)='asymmetric\x00', &(0x7f00000003c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000280)={r2, 0x1000, 0x19}, &(0x7f00000002c0)={'enc=', 'pkcs1', ' hash=', {'sha224-ce\x00'}}, &(0x7f0000000540)="aaba83eba42129e235ed6ec19912340eaee7ef83f6343d760183a2191ded0773deff2a50e925ad4c3979bdd6b97d36cb82ac68d164fa1207367848422d2eb5b92add5ed2f7201e59662b56cfa57ed21dca7ee9ec389f29220e8cc2a2fe78188229f7b50b21af66986227df70a352594960f0fd9c0f2596f4e39c0558dfdc6f60aeaf3246ba73451f77651fb67f1c6d2d460fd31a80250fe3ad6dbcecb4d05eb2add347e2830a76da055cee3642cd992e813495a01570ca15a2150a1e66df736577dc66c1798d918045428c9484914e700bc5ca92e14864b26d7c4ba046a0555c70d2c85afc51916b5a9fca29a5b1940c7b3d7c56da8f22e39b101bd92f60adb5557c08b1c889aa929bb16fcb41ed559100dda3004c50521ed17658a652ef347e6928462f8314aef2580e0afa22012b9c1aee56624c4799fa244b57dbcf23aff81926c4de09a1520b60b8c679f63181f2c355fb148a2b85da6e5697baf621ff6603e87bd1ce3782b393749030536099e9df849e7fce7bddd415dfdca793fd6fcf2e71e2035f30484ee90c5201744a89c8285bc92414c2b388678ba2bf5593004640fdeed778f16dd3de8b4273686c63b645cedbe57fc7189dbdf66bc1c64fcfc50de0b812490a4e9ab45a897141cbb18b7c4dbc8b37204ef6d4e7a556e8637977c4344068553bd01693fb3b4fb1df7a94609d2ebb4b818f610ef0e59778b75831aac9694a4b9285651a497457d77f945ae872a7a377cd4f32e3288da969fa0ed8ccbcde2e1490af0d3918c7cf3e0108ecb6bfbd29b13c10ec4dc356070677056f09b8f9b0e9e497b68262471a478f942bde724e312865c88a99a6f653a69b772cac47419f36b40ebac8dc1731cd2b30ad4df36b72060bad8436358dae1d5ad377e809d587a57bc8164ed3b59625c9c8f27b974247fe71387fc7324e80302904b4a5862dc144321b1ab3be5a473e28b0cac529ea2776a1137c60a12d41ec80ee8caefbd9fd94e55f7bc49d670f14209830b60b7cc837e0fe3136b9b2684eb02b5f3bae9476fe7d40c65bf49e25735690c086974fc18e641f7d844fe7f0200f922768a87fb1c5c15b94befd26276411e6da6640697fbb16a7287a2467da364ae40c374f332131084d947470bd123ab76b199d974ec07679421d8a84b80d6f945d79be7e19ba7a42a76b8b18ecfbb89b8480ac860ed43f0cc833c69e3c767bf444eaa8e72317bbd2f7633b09723741fc2c780a50478def88d2df3021826a2001a99ad59423ef86b4fd05924130b0af49f6ed663f6c21cf3e75ed62a6ae85b9d5c1e21940754ce8507d99388dab44b2b21cc709a09bb8edc90d89704b7950693e8eb4b240fbb85ef854a6f1f1d181a18669cd114c7ba87872ba755aa044fb0c84efc7a1980fdcf8802ee83d89bb26b3d77953bb04d2a838b206a751feb4f4b8739cd1bd746ec7b2fb38fd08c7c3505c83c6d7f6438dff79de5f198b29beed7634d7f3bb1e52b28909b15c820395a8a5e7d66059f3da6b4180fe227c1ac6a575b42f2f4edeffa4fc468fd518c5d469ecea29be16ec3a643b09a3b55b71af65b311cc2e4916d15a67c572e27d3bf514f50f4f2d5c4f8b9be40a04db8cc9b3dc324fd4f934e87e5c1e9f960cf8f8f0c16b29ed605993bdd52b96a04ac8e9483627b4b800a560ef560666f4f850a9c0f6144d00a05567719eb1b1da173f2ee152e02adec90f4b3fd16cfb84d665887c467b9aebdca81eb202c30b7d8adc7e9feedb75fe52d7e6d420234188094910376ac5d5766a5fe4df0d4d31fff51a8c0aeb50b88c1fdae8c617db54ccba66ab46f21c683e61faa79ce469c678999f3608b0d04b0f74d3d04021e5d85923b6f339d20d0f648dff37e78a93883be816346ce359d147120fee6ad9e981465a161a3f39fb0574b5c79e9f8d081bc4142500b5f4797e129166959e0026979d61b28298147699eb326eb3968c700feeec07e4152c5fd91c877c9070bda3329e794b49dbed939e69729083a9f5d561bc2090b0056056c9a2acde734d3817d2022c62b5e500d1ab356486b4352f63ce9abb978c1f3cea5838a888797e2d70a8141620b266224e0da2e81957d92f5a3fdbb5f7e8f29d482534c170cc0d39b6c01010cb0c2f4f38d26264914408a35e992eebaff895f03f86b790aad530c85dcbca3783c6d1bd9d6c8096bf75a1b3e1e8de3d05dffcb031aa1df1a2f65ffaddbd6d698a70b7aa373a1920c14e78b9949f4eb3c4fbee4556fcd706260e14e00ac2707971d15a20bbd3250217e196a38cef299858ca0ff7ad98d6322a356652894119cddbe95012783f5608d4f39417de85b0298b716f0f484e8da651c0652095216b70f09d8dbb13353a767a57fcb13da2541a9312ee51a2c2cdb8508f27a53c6537d4e5651af24b7f87b89919d88942bb875e9d121b99129eda7f7b570e9cf4d5b117f68ca0154c3a8594f8141463377583a0e0d38e99712306d7d198b4f7cef04bd3ade7aa5ec636858e552ea138d0570bd9f914435704f0d208c5819a0e0a53927e9570eea93e40270cf71c73e17938e30a666418b2e77c358fe1ff460eaf65be44c58226784a1c86c50f54f822055b4849e8295f931f358cf007966f9cfb1ca997c3fb65b31acd6736eb051b62110ab88b067cbcabd847f2ffebddf971f858a98f449ebd2b60ecf9d1d9c61acf1802dab803e39a215e88b42ad915157af038a9671cc4437d1eaddb8cde384bf9a8d00981a55d80e78d5b474964e531e53384fc6b35d34cea5617789457ef1d30c101795dd59b5a94715d10ed4e3719ff21df1c39e036269233fdd1493211e47face3c2b8fc0cb9ffef68c1022568d1b796d6eecfeabbc12237db95965a7a8e89588b11dc84b248002769e26401a366b80ad2846d8fdf141502395559bdfab0fddda40e290ab4acd90276e8b0857649e48a8e4f03bccc8767bf8a644fe7ba2fa04e8b1ab62cb81f6f9e7edef7921d8eafe3166b145517789765819a1e340f39cd352908598f59eca43ad25d120b1cce792ddb423b51d739591758ddb2748c91da5ad696af6f404feed67ede9bc839c1f88d856b6429bb8dd15c77a8767851cfa9193eeb6d620a0a9a7af6b3029af31855bb194a7b53007d3cbbb25d5f2bfa88bdd55c1c553545cafa822d49a3cabd41a671dace554625aed2d4c766e5e0e34ef884d209a8aa50466fe0c0a4220a983179a11853b2558ac7cc3529df3c5a211a0f59eaf182e1d90c64e50493e5268220caef8f60f7429fa59380ae217b7dd92da97392302280aa7926b3ddb9d0b1cc97a5d38fbc05b6abcaf913880be1c49ada81590e2f2fd74a65f98bc56136e89bb1fe919a5ec79ed717e6a5240d342533555e07eef06528986e7c88388a609fcf1e4421c8a79dca7d032ae462df552f7ffe47b210e5a8a06a8a21d54de8bfb1bb9b4040181a5c3196b9990b5d44eef0c15cc653d6ce548e894eac07e968b00ce7edcac6c3d5af69c7be2568e12c9f07b6552a5f73a450f80fab5584adb1493c246c80167fec60f4f2702be67cfe2269e58d5aa84c93d239e1470c5b88f140fbf55d3e302e39256ceecd651cbc4d835b5591d94aab9af90fd67154277d7343218b074e93565527552dc3637b5d99ead543b3e2cb69ec35929d3316f1919c70b397d84e8990cb1158a63dac248426ebe1954b44889548b8116fabb961d58a304a9551705748de19eb996d9cd4205cbcb176250a89a277e37ae6d83f4f88880ed78ceb60308b5c80443dae71b6dd92475a50cdfce92ff1b252775705a1cd1265cc786388d60114a27527d249ab3a9dcf79e15ce9cb5ace471551055718e954d60b7e703fddbeea246b0621b42ea1079dc045b523f4ce1c6509556bf9f7c6f438bbd6308205a1aff5283169c3ae626025d5cefec656ac2e5ca143e046a9c518c65c2ade1bdf14b0bc8dc6b2a38404fe6a91cb9f777d1c9b9b307789485bd0bee87674aa4cf29526edf98d132d0685dc9e3eaa48dcabb0ab8b6c20284690c40064a816ea24bd9abf335b417007de58767c5301905d20923876619f161d6dc9a73083130fed5cdc489e42d93ce1e34012e55164a4ab5b48cbbff2f8fe52a16706823ed141149ae999b9821f7958ee710406e804355ff261addc2bbe63614e6fad4314f2f5a08ba535a85e1c706a8dacaed6ffa7fabc970531eceddb205d0f0c70856a2bdfed832a226d1e2c38ab7b251d7a0961dd772dce2412bdda83a9ecb901a66cdf8ad6eb9b6ce6e30c804f5bd71c23b7b91de293eb4a4f5fb2533e10962112e0710e3edf710960f35adceba3edb30988b8f131f1ae693e46dc73b98cecb40b527f96653a53cc0562ee9cf12a8770c69fcb9e0ac097e51ffca5e297dbb7ce19c3ab2b5f5b9710a07ddc4c0fc38fe76a4936719371506cf814a24ecb90d0987272b140c18b59b7a5652f0432dabb4d028514ed5a98f6d55775b42d645f5684337058b23801b16f21edb65c79b03b52dbc6f1b40c7e871e2c56b5366bea8ae1b89ec052beefbe720683686a88e6755b8fd95f367e36d35e46170ad6d14018dcf86c50175105751e1d865a78f47e6cc921fb8f356890fa0d9c53f76c87340434f506f5c10e038a4e684f6b4b3a867f015cf639db7306dd4ebe5d3a12221d6d3ce89c1a42f4e4a88dbf7731fcfe79ae659af33c5ada99aeb81eb1f9b2f5d5f8c4bf88f8f7cff0dbd3d4456791a25b9389745007a28a3357b8d55acee793b81ec02b9ccf4ea3ab6f8c0d51666891f93bdda4e7c271810c89f4b2e35e23f6d4db564395275150a8210dfabec745d2cf8f3a293e1128bddd27f5e71cef77600398a3c4763061e0efbfe4cfe488e134e93cf4c3deb9355de8ad3cdc4116fdec3eb19ffaf2b01671a63dba796dc6bd14c3610635b92e1e73512835d3a59986d8528ea5dea2e94c935a7e72a01f54ebb91252fe2e5d11fc729ad035111584ad195c84ee08f33ca4cf5229b38fbccd505af9390a1cf93c54b46fb0667926b3cd9aaa33c3154fecda67193b86acdbcea5a0cecb443c8f96d7daf915957a9a978f0c0bea33cfc6d22add05bb1bd74be9a52e1af372cd206570259d14ee90aec9107e5b5d3af654dbde8e26a03e9be1db1d436bd44177e5bab1e28ff5beecbfa4a579271a4dbe15f60051f315eae80dc049c7e488e5defb875942ff116053d63281d2bf839a8ca8d4766310a92c57d6b8e0a2e7735f428f153a2177d5dee175c720bcecb855b86e091991f5f94db9b98e25c07b251ce930634388c21335cf1bbb914de45bd379e7faefa9cd08cd9a03aacc60939f912bf38f44e48a30d6e7554db84b0f97866f871049fd240af123c771fe5d55ae60b5f9a749235670560a45f2383ae4dbf1a8dc4cfb4372e1b6eae1913cb40f05c39c74866a103b77829db7b19fe5b8abc4b08da7e7dc5018331cd5128c0d78d40c2f5ffb3bbad813586eceb771d9334fe879c2e27373afec7d3dfcfa0396fd5dba312f2f4fe46c745e9cd6f3fd3bb0a7bdde9127ae958b1cb5351ebca31e278db541fb70d19affab339be1bfb61fbfa8486dd6f3564a1ed2e5a6bb67d5dc6648f8eb944b5faabbc97f8725be4c99c0a79ffc11deb8e69104e22f47dd5919f8ca5d3d7ae08a251aeaab3118dc84f99cd269b11082b4ebaacf0df496618e60dd1e85118a10b7cdd1c3f0ea897b0ad0f93763085b557034a36effbb6f3682a288045a6428bc6d32aa60e63339c45e3c0ff4a952651019f06011eac4d10207fb9beb10abd7fbc04c6ba7b55c8467698e42b5e365", &(0x7f0000000340)=""/25)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
r4 = add_key(&(0x7f0000000080)='dns_resolver\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000180)="866a71aed03059d02dae0e912d530965fa4b5b771ef931b419805711bd2ecdf4435beaf20a0b405904b61371653683bf73f44fe614c153197733994e7e849626dd2f505125e80ebb67de3309e6a6d536599bcbb1c6c7c7c529c19bca969f22ea1911c9545400fd7f947fc83c5dc31e3d8ba9edff04cb66a06b754dfbdd971b71da4fcf79b6ffcb141b531a4e5ee680f105884c8925bbdb5ef5cc4c19d39442b627168555c78c4ba1fc01491bda97f752e9a1d55dacd2d37003a47515432f33a54f", 0xc1, r3)
keyctl$KEYCTL_MOVE(0x1e, r0, r0, r4, 0x0)
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$KEYCTL_MOVE(0x1e, r0, r5, 0x0, 0x0)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r1 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r0, r1, 0x1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e4000100805f37df3568f4e7270ac2629f89dcce90aa02a4e1f92d61c90d5ce292cb84203761e86584e703926c179b7dc7601d725caad81ca1b5ae8219343e4897a2bec0fd8efff4dadf1ace2a07e9d322092647a182d1a41a049e3ef7fbf43caf539ea47c41007b10717e31509c6f9e61e65bce1ae44b6c31a1664022e75b98a22cad677449d8d2620bdf26c9824a005de6b0799aa7fd06a12fe346ab2102fb21adbab70b2502d7dcc5d0bbfcb3f70207fa6599855910a0bc6b063b757429d82d29bcdb266a9ff5226cf810993184b6a9628278d0cd1be09082503f2a5e26f077b22e9d67c85e9375897f1cf38e83910ee59b9a4988348d9b9c4acaf3c5698aa100"/291, @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r4, 0x1)
add_key(&(0x7f00000007c0)='asymmetric\x00', 0x0, &(0x7f0000000840)='[', 0x1, 0xffffffffffffffff)
r5 = request_key(&(0x7f0000000000)='encrypted\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='ppp0\x00', 0xfffffffffffffffe)
keyctl$read(0xb, r5, &(0x7f00000000c0)=""/163, 0xa3)

[   16.632430] dns_resolver: Unsupported server list version (133)
19:20:28 executing program 2:
add_key(&(0x7f0000000080)='asymmetric\x00', 0x0, &(0x7f0000000040)="100710000494020037", 0x9, 0xffffffffffffffff)
add_key(&(0x7f0000000000)='id_resolver\x00', &(0x7f00000000c0)={'syz', 0x0}, &(0x7f0000000100)="f6470b0a7bc7e1340b878854d2cd88e6c8f5480bcb852bae971e301a3fa995ab40804f64de024768cefc0f3cc21e78e62546934dff98737af48b2758d6ebbf", 0x3f, 0xfffffffffffffff8)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r6, @ANYRESOCT=r6, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r6]]], 0x5, r6)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r6, 0x9982018)
keyctl$restrict_keyring(0x5, r6, 0x0, 0x0)

19:20:28 executing program 0:
add_key(&(0x7f0000000080)='pkcs7_test\x00', 0x0, 0x0, 0x0, 0xfffffffffffffffe)
keyctl$join(0x1, &(0x7f0000001640)={'syz', 0x2})
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffff8)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000580)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc57c1d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc71f52725caad81ca1b5ae820d343e4897a2bec0fd8efff4dae1a2e34c4168be19f1d59794e4b3dff1c258cb4569f1d7", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffff8)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000280)='keyring\x00', &(0x7f0000000240)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r0, r3, 0x0)
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
keyctl$set_timeout(0xf, r1, 0x6)

19:20:28 executing program 3:
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='pkcs7_test\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r4, 0x0)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r7 = request_key(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x2}, 0x0, r6)
keyctl$search(0xa, r6, &(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, r7)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, r0, &(0x7f0000000580)=ANY=[@ANYRESHEX, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568ce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d34004897a2bec0fd8efef4dadcf268c4e0afaae7cc30588f0cf9a31bd924f2cf6c2646c72c671e4ea55a217f0f76b6eee5b4c81143aff6e7e6093ca13607f0eb74e626b75fa2ca79e8502ce90c2ca2b449d0a6948d0aed000000000000000000", @ANYRES16, @ANYRES32], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0x1, r0)
keyctl$assume_authority(0x10, r0)
add_key$keyring(&(0x7f0000000000)='keyring\x00', 0x0, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000680)={'syz', 0x2}, 0x0, 0x0, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f0000000300)='trusted\x00', r3)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$read(0xb, r0, &(0x7f0000000280)=""/93, 0x5d)
keyctl$reject(0x13, r0, 0x0, 0xede8, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = request_key(&(0x7f0000000080)='encrypted\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000180)='\x00', r1)
keyctl$update(0x2, r2, &(0x7f0000000300)="312e166b48d98030836d247060bd60bb7908e2c2541cfb9e888860c5a1e7661308d3adadaa15f413d99bfc3bfc3e14f41db9cd07adc8426aa7855b0bf48bf6fba9f51bb04dc5effc0c18c361bb9b62afdcae2950c06d14d46bf2c703ed7800171a018b6e3c6d7f3cd0d6fd4d4676ae904b3fcdf465d5c08baae47de684281ab2c3bb0881b78cdf128dd54ca76428c9091f2d720b9ad0d0eb9bea3e5673ea4ca5a4791121354b9ec911d3a465a3d2ba6ba79060ec9456833c55a0f329d2fe2a49f25a83f391f9fa64e21f7ba9c337", 0xce)
keyctl$read(0xb, r1, &(0x7f0000000280)=""/93, 0x5d)
keyctl$get_keyring_id(0x0, r1, 0x501)
keyctl$get_security(0x11, r0, &(0x7f0000000100)=""/99, 0x63)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, r5, &(0x7f0000000300)=ANY=[@ANYRES32=r3, @ANYRESDEC, @ANYBLOB="ae04103140030e4438ef0cb57bffa368132200000000000000000c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caabd1835bfa2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r3]]], 0x5, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r3, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r3)
keyctl$read(0xb, r3, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r3)
keyctl$search(0xa, r2, &(0x7f0000000000)='asymmetric\x00', &(0x7f0000000080)={'syz', 0x0}, r3)
add_key(&(0x7f0000000040)='asymmetric\x00', 0x0, &(0x7f00000001c0)="30f5de", 0x3, 0xfffffffffffffffc)

19:20:28 executing program 2:
keyctl$set_timeout(0xf, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
request_key(&(0x7f0000000000)='ceph\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)=')}\x00', r1)

19:20:28 executing program 1:
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$join(0x1, &(0x7f0000000100)={'syz', 0x2})
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f00000002c0)='keyring\x00', &(0x7f0000000300)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffa)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = add_key(&(0x7f0000000140)='blacklist\x00', &(0x7f0000000180)={'syz', 0x3}, &(0x7f0000000200)="376a048895d0d02ff06361f1c8ed2c0eb6c4449d9ff343f503bd652496ecf4419ae48e9963f8f5df39baca276804788d90c2be12f903b51e08ed475432bcfa9e8f3067889ddadf79609808f7351622decd3583d4f668c5d625f3c4e30689f166e8baa705ae1d7445af1d439c", 0x6c, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, 0x0, &(0x7f0000000280)=@secondary='builtin_and_secondary_trusted\x00')
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r3, 0x1)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r5 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, &(0x7f0000000380)={0x0, 0x9f, 0xe1}, &(0x7f0000000700)=ANY=[@ANYBLOB="656e633d706b63733120686173683d6d64342d67656e657269630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ab4f46cd91a3b4719dde5d9056ec060ee3cd1d851156948dc54c796402a21bbc1dcca10af7131b3f3f6fffc3b0b91bd2a3db33d8e9"], &(0x7f0000000540)="9d2124bb6dfd49fb520e915ebf37678fa250c85e63505015a11883c2eb655afa0193a4600af9154e013d24e34a68ecb03b3ccd3894db1c6d2e0e6c2a7f7be82e9af837babba1b9668c1d841840749ca0f4de97db68cb616b68129a3b9e0ea016fa8c471db091184b5f1ea6da3f94f77570d474ae117b2d384111c8040badeaf69e8c40e356cf8ab92ed3fcfd6a45a1ecfe0252e1cc13174295b00d0faeb664", &(0x7f0000000600)=""/225)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@secondary='builtin_and_secondary_trusted\x00')
r6 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r5, r6, 0x1)
keyctl$unlink(0x9, r3, r5)

19:20:28 executing program 2:
keyctl$restrict_keyring(0x5, 0xffffffffffffffff, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
add_key$user(&(0x7f00000000c0)='user\x00', &(0x7f0000000100)={'syz', 0x1}, &(0x7f0000000140), 0x0, r0)
add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f0000000080)={'syz', 0x1}, 0x0, 0x0, r0)

19:20:28 executing program 3:
keyctl$KEYCTL_PKEY_VERIFY(0x1c, &(0x7f0000000080)={0x0, 0x1000, 0x78}, &(0x7f0000000200)={'enc=', 'oaep', ' hash=', {'sha3-256-ce\x00'}}, &(0x7f0000000280)="7f06a03634565c947ff33b907affaec8fe81077bc5e964bd734438f57a34d136ef2fad6147e2624deb0d4214cdb16c6edb81e6d022d6b48113e4441d02c67c1979f10bf9ccf1c710cf15442875a1fd36883bcb0de729b3964182a755c7fcbc6383c1720e03c31e02261d8bde2821a370523fb15a860914e7454d3971a8d282af9a6f43ddb3349a4e6f7a1ff0be1fca56da7bce3f04d55a657ec35ef957ce99312d55ae098637ae448a468b680cda70eb2d0bc27dfba9066218da1015bd711c4fde57b3a5f73dd1e4bef98030007ccb06cf48d2a65f88ad0898c233d72ac70ce8b22c9f9b556a061eec867b21bb058a89b086bcf1d10bde331e6726386f7d360267f7026ebd133682beecd3a876f03bab93d85a2043791205cd56181e304cc6be6289d506c1fdc1ea5ec334c6dae580a504428f807c7aa02ddd89cb9444d90083a4a1a61616999eb51b9fd7142ed4396c0c9540b7a8150b24a76323429d777a1de4ccec3f61cdab43706f6347a514900198f31a6d092acbad95458f23aaf5e7505b9651599386a14982af7889277f4ec43f6b6230535cd84ac543066bb34682c5793691f3bc4b23a3760e5b0c278731a4282893e78ad1aefd3322dfcdefcf3eb937223a286c70989fc7b107c9ab50cf8d38214902676088e6543fc6257a8580b74bfdbf48eb037d570d3708d8c38a76b64ea6164975c052452da8c8da9d43bbd5c10bd59206401ed4528a925a8f84ebe3d9ade48c5870f36b832f17468d3dd2af6c6fe780c9c432beb0fee906f4573d726f94e0b910cface76978591dfd00bc307fd09361b406470d88488c805c6147e9e347d83b9bff8ef48f654eec44de67b872accc750d05aa8a17e3f49e424b3f789eeb47b229c58b1e88a865dd7c774b7f304655624f6b77b6bbd75a5dd51764c3d2426674304808b52dc7cc7a4fa398c8b64a642e221a6da85f0a6c7b0db07c0b014443781d6fe165261d642308e4ebb4669a3796aaa9d3d51abe0107ef933f90f9e87dc1328157deed0022b09b2eff6afd7bfffd3601aef761742f854444dc5a33193cc41d4669fb1a6b315fa75cbba40cfdb09d812405dc8bb811d5b50d2ee9e08388d13b0ca336af62a04fcbabd3c93b8c52dbc92a55b265046018c35843a2f83e16470876ccca81e3d513cd0140f09e0e30352416ee996de49a1522878a6db63cc1646c93396574ae80fbfd9264aee0e6b6954fd2814ce1620dc4dd7f8afb91cccd10ee1f0a77e12f0225ea0809a20273f209b0eab0e9e1bc6e3fc3fc1d50c1bfc7d1ddf0995440866c9e37d59b096578587c0dcefd235405dbfa4e880fa45ef7010d442d3e140b834c09f388cd61d7ee84a446c8b352d489650a3799e684a8810740c17556681baae2acfdd6e49b264a421047d3cad98d65894a2feaf23ed560ac52590f4b743a68dfe2cbc70a5590c40cf80f41eae00a767859e7d801e3cc9fe43a6e302138ff6a8500a5f3c7660b1bacf541d4ac6ae8b72b4c9f9b380beb858fba3c5111a9f12b29da9e43108e9fb886014a86cdda0189bc999e43b88f97b558a6f6775b1b4136bf3758de5d4b788ccec8a58a688bef07080f7fe8763d5cc4720e06423e047cf9a99b01b02ff66b784c96d420deba76ca35f77c287b7937e22d03d85cd119613bd96c3f802d9c2055217bd824fd219dcc07c8007ebe7f503db3f47c9bc38d89a2f21fd9b64182512b6d0f12eeb856f8ff218e5433006b4d1ea0ad6ad1e63bfa3967e181831816cafee357ac382c12407507b7c36199b6dd8dbf72595088f8a05adfd9edc8b2a9893a8fce6cc6b7ab7ea6e4ed9348d20b9ad43d2968f1a610fe6e99803ed28d677e03368fe442053cf601727494e584c14f89dcde7798b3996b0a67c77a9f053687ea82c6bbeb49721d21b16e1f7a9e43a8db7ca448b381e74533e963f559e7c48c4852d9cafc53e7d4520c754587c73ecf005e0ad548c117ee9056d3bb53b2b1caaea03c395bf5a309dd116cf44552273481bf550da1eb5f9e4bde03f9bc1819886718521ac6f53ffefc50fcf4c9ede4d9e2ba8d0e118972cf1ec8055b642d9f6607d303c6fde8a4f09767cf9f63b1d24e1f3b5c2f1d669985fb250b975ed503df402750971abbc8f769782bdd9ed3dad691d0c047468d6c99ad143e8c5f6bff2f360acc405673dcfd7c552e62fd6d10a08b47d3fcabdbc32ecbb0d77561a9a9fa1e7984f21b437b9a6378d11a245736e88644f7043aab20e6d8ad6f4b7880ab0c919924b2417240fff55497b16ddedb96333ddbd5075f83dafd047c352ad02f08b5d48ce532938b5dbd8cd13cf63db4637182c009ec3453515953b1690dedd3597cf69fde81b3a9ce19dcf66ff45f9e365968dc8e4a05e6cf32b8b0af05d4f1e0bb820adbda7bece95ae57c47b14bb0cee00d0fc976e23776bd33a8da51156570a7aa5f18769d7979d82d48eed1a18964d915d9450401659d9932697fce591c4a9bb50f7c0dd8dc64bbf3a13312d80de50c4300ac68331c03d0d5b8ac0a3bf42ff70da8e544672b38a07614bd4bdebb3ce32a866804e4fc7fef9b2ee5a37fbe3b0e9a5ac2b402d4c3505a050a76cdf6c89acce455d9573db50244fa54323a2134ccddf02f314deb96ee9071d1e52f5e38cb04f3743a3a139adfce425f641667152502aaa28db3de2abeeb97c408356b0446de3c7d8c4391faf73ecaa4ca5ebbb89a0066030f282b54c4cee797edce3c5c355b6e38911b1eb435e15795742ae789b91f24c8d7bd230780a1d72a4d487ccd5c5fcbbd5dc2c020d2bedbd62f76d8f821b9d80b1c5db6898232782fa18fe566ceb27fa7d98e8c0ad0ace99ba1836c3804154e353aa80b42af0526aed1f68e9d0af0c2b0686c762842bfec5e4c2c6074fe5e5dc6a2a8321954ccc98299ee15d7e9851cba6fb7374901a5d179eaea44c30fe6f08350a8d494e6bf3b919775cedd776ac977284e87cfe85bf164e079ac37f0ea63fe10a14ea72e2d2199280d11b3058d2536bd9de699ab2d1cd03ce45e944397454ae717388ff00d3140cc75b7f25df9ff557e50e1a9da9660f86eb2308a7dcad158c108ddf573c858eefb004742fc9105a1ae300f0401331a601799dbcef55a0db0aad21a1309cc92c47350c11bc695f52c275b97210cfdd701fb7d5131a2e845fe51e9207eaca4fad213e3da497be1c3c43f70ae10dd349b861d74e9615d6e91015a835ca6e6c61bddfb3fbac5a1e1a4993a21783dfa5fb52b82c3d7492014cc9d2b5556d10dbf069ea9fcfa40820d28d3a9d91ef04cfca71b98fe5fbd81499d9358e8300f774993a31a734e1dd8e82cf585b6466ec64f3e0aebb4c0699386e7d74f04b243c2898f033ced5fb97af097cc322da51f7ce6d92cd41d3d08c1ad726a9ee8d6860fbfea68aef82042bec9ff492ee497282b1ef3d5bf8bb1c68cb7bbb35752133103dfa1d6c5657aca566120abaffebde0396d1c8b291d35131fedc136ef9ac7fd947205ff9076d2a6d2e9ce48eabd6df9e24b2cf6dbda66e61d703782df0686560ca3c1df3767819810df66d141e3e317bd7748c430cf9b744ae2e5d2ed6bc572dfc5cb895459d01fbdcba6231c793792873d5b9008e2c873e5c6a97c565d29f8dfd28a0374ff9133a9ecd22a60ec75288fe895351482f51cfa5b1844316063a122c52c48ab7d652e6f01f07721e4f200bb60e4342787ac5333271d669e90f9f573edfd10017951cb5a56374f44c52cf403afe7dc309c625d18d8b73a746446f9ec4668731beaf4278ede68e121d631d72ce138d452f3bb2f28af4c50f203787de766b08a4a8e692830562fe302df21fb8df5438150729c6ab5ba60304dfea5eb0e5b0645983ad13aa045247fd4d533722ab14341e3ee0a153e1733b660234d5d07148cf86b93ccc3df1cc6b5d2c1b060ed6c9c2f9167f1fe63e23727d91fd857e0156643c5771198064f839303fc6fc6a6f926e3233028c679ca7b51f5368c405f1a02cfe0c9fd8e09daf2d1d8ee7e35f5b6d48580c631331ceeea2313806b22cc89bba919efcb70febe2058b5df7040d5be4b49bc94dfc29c00024afb7e8ad9c7d63ddf74e24d4d35d8c1588816cef355281880d3d8c372df27f362a49a963ab4094d91d92adde56b40ac6013935493f6936101727aa776702b71c0ca52e5a920bf845348a111941854a5d10638713fcd26719c3e0bf7fdae172e7ee8b423e4851df9806faf2b165a4c87925ef21d22d2e888db62d54392e813afc367aa5c43321419f13a0331c8de3e61629bf74b787cfae94c841c59597b9bd01e07e5f3b3408e4362940c324860838de72597ff11c4fca19061fb8b3185c786732dcaf90439acf8b65af5d7faaf4713660f63306f8c8b10dda946b01bff405cd2d85e458ad9b7960ced015e411282c02b06f7982899154eeb79b5631552e3900dc47a524f05a148a0a38db49c8d43231ec332111217226745c23d563213de5417b5b10fadc6df2b8d80640c6c5fb151534f19c32623493f6213ce47d8408485ddc07634775823db0d7ed7a9167760a393a5bd53a10905f4acdbf4f545bc36bb4362ff2ee52cca36721690d65253e566734415a926936dfa291dd10d44ef1187fbf7a5ec09683b5ba3c556fcd17050f5d199998288246be96ce5f63359772b8f5365137533df2c8534daed4589b0aa7fd2fd29e180a9841093d53177e703c1b4dae5cb830d6ccb413acb32362c76aa465b48613c24b67ceedca5640b1512e3fe74895cc1378418847c70760a8f38c5f62f9388bf32f775e72873df00c2244aa99a4bde4e783eff5913638a4d6a65d67693093441f9492b856bd0cc542d67099519555073702c19f1470fbfcc5f0d06b02c0533e704649a65ac53b198285a49d564d4ba3c90afdef25851df3f459660dc3abd31b70a36a46d98a15e9946177aab9e122f961a7847e5688e28422a1d7d8e435a30f3830e444b094bd903b67946480b0ddb4f5d30e1ffd354fab678849c729a8f4b38e39cca3ccd1e6dcd6dfde211bf247f42a247a9bf310ef78a4cae1dfc968cd752425951c9c33fd2eaf3a0df286787210e669ea2047f430048d1348a5313cc02ee55f5f4a6a40f0ec41e3f266dae05a4a46e39cf6e28e0d62de9547345996cd5d53d326d640899c9d0862b08e3fe15863cffc13ad87c34a6276146b132cf314aef1275df90ba0fefbcd231ec49a45e03387aa541e2df61a7c703757b6fa47c85c000fb3df79b8ebfdacba06ad9898a4abec0bcfaa652adb2f3aaaa1a75db5c6de3d5a5feca6c0db5f59128276da1b41081bdac7e44102556fa278a3a996fd12341ae3cdf8da7a6e55b5609719444f569deba633ad2cc6d57456267cb9a9825d10173a76f4312a29bd3f7fd09793311c3c3910677d7bba5c78345cda076b67c77204ca83c569a26033c468369605f96babd7f0d8fc4df5416243dd907526d7d3147a2d498cb2150504537e3bb864bb8b90c579151986cfa0ce0356f35f80648882cc9d9233c541e1430a414e4c7aaace108b56ab7a13ef6df538130aadbe127f607e583d1ceadadab8d2a22fb8b179bb4585cddb71a5bec451b337d784792059a28eef7931e87446cbdd9e773eff8013dbd441880ba6712994f139096996c11497db536a3221a31ae7417f554b4c0b9aae622d5ff122df75b1f5b689fbb77d5f609cae931ea14dd7a8362301f54eec044936dc72e279c677244685cb99e9a77dc6e4254c8e6257e067fa0ac3c2f6e536161b1519ac894f2e1e06957da443664c9cdf935731079193e0e", &(0x7f0000001280)="3f88e6139199938da5e4c2682d59c411adba90893ecbc459980fb857cc9e8422135f48cd8e7783d36c201c07c9c9d356561597f09ca821cd1eb6d9c879de1780f41c858b2a747299544a4ba960dec2117a5382ff246107337be111e1d2f46059126302365da688885011aef57dc1b5760e581a890a4d5184")
r0 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x3}, 0x0, 0x0, 0x0)
add_key$keyring(&(0x7f0000000140)='keyring\x00', &(0x7f0000000180)={'syz', 0x2}, 0x0, 0x0, r0)
add_key(&(0x7f00000001c0)='id_resolver\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000000)="f1acb13157e433", 0x7, r0)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffd)
keyctl$restrict_keyring(0x1d, r0, &(0x7f0000000080)='encrypted\x00', 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[], 0x0, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$get_security(0x11, r1, &(0x7f0000000540)=""/100, 0x64)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
add_key$keyring(&(0x7f0000000500)='keyring\x00', &(0x7f0000000640)={'syz', 0x2}, 0x0, 0x0, r1)
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f00000005c0)='\x00\x00\x00\x00\x00\x00\x00\x00R\xf4\xf3\v\x91\xef\xee\xe7\x9b\xc2\x19\xff(\x14\x8f\xc4\x8b\x87Zy\xccS\xd6F\xa3]\x9cG\x86\x9a\xd1\x86\xaf\xf87\xc3thK\x05\':\xca\xd6\x89\x17\x85\x1c\xb3\x92\x9a\x16\xac\xf3\x85#\xac*P\xca\xb0\x19B\xfb2\x1d2\xe3\xc8\x06\x00\x00\x00\x80\x00\x00\x00\x00\xfd8h\xc4\xe3\xd0W\xc03', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$KEYCTL_MOVE(0x1e, r0, r3, r0, 0x1)
add_key$user(&(0x7f0000000140)='user\x00', &(0x7f0000000100)={'syz', 0x0}, &(0x7f0000000240)="180b2eb73dfe8e128c212dcd2c82ea78b243e51d3e8187b3ee59e671be53e01f18c24e278776e0390825e254747afb3079ea903cecff445e197049951e48fe533c7573b147c001000000cd1dd78b433b5abac38286e95fb0a285cc400e081062f5a0c3da0d02de0d60f95cca70b9587ed928fdc68a4ad88c19992c3c57223c6f5e412e1698f3433238085e32165ac697c488be54d9ffbcc1af1afb115ab6666554bdd83a1d3d8c1cf67da8e45e36f74809bcd1f3503166acfe22ddbac216a04ab07c9105ee81d48a4a02e3a641d34e0835f5d52eac572e64aa8fc114a2eb83bdf45fef0135349a4afbd77ba9c82ba1a0bf7fe55128bad46e596f8bef456b22cec9c1ad154d6de2ad79cea325b8ff89569e62d239c8545aea2a32a656b6bb4f00853a5dbb60395bf07caa3c9e70dc39eccb8500c8b5e2ed2d0b6e5b03452b4ee010d43ac245fa9c0f7d3e898b084e8b0adfbd5b466ebbc836c0ddc5251f4ac7fe6542c265fbbbd61746bbde288ee150322c1403f8e4c765662cc8bf19e458fd5ece4ab755913fb6eda0de5083a134c5362e3efb49782bf70392d753ddd49355a0f1b9a876c6b5fe87cd497a85b2faf04e7903dedc1b7a2e8a2a52a81ae986caff97c62551cec0887c4668192e932924891a5bfcd050250659b53bb609d506d8fac757f3859a0c6944a5ad93d8e80ce8da340c00b532b0848d9c68637f4f6134a5e8eff1e887deecefa7b70d608822", 0x20e, 0xfffffffffffffff9)

19:20:28 executing program 0:
r0 = add_key(&(0x7f0000000080)='.dead\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000000)="30312fcb2f70", 0xfffffe62, 0xfffffffffffffffa)
keyctl$revoke(0x3, r0)

19:20:28 executing program 2:
keyctl$reject(0x2, 0x0, 0x22b0b9d3, 0x201, 0x0)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r1, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYPTR=&(0x7f0000000700)=ANY=[@ANYRESDEC, @ANYPTR64=&(0x7f0000000640)=ANY=[@ANYRES16=0x0, @ANYBLOB="bdd4c21050199c800a88ad414ae95188174f03e6fdb6d21d3a2602f8f6b5e660bd4a1535a7aa02e04e23652c4de9a864a678f50395dde92a7f83169131ec907b22a5f2b1a3b2c7b7b77c616455622644eaea4ac42341a36624c421bfb4f0de5f971b45f723491ca81ba03225f3e07feee00c3b6b65f906541c2796998c11da007493069f8da37bb935e8fa2ae8f137438928fd", @ANYRES32, @ANYRESOCT, @ANYPTR64=&(0x7f0000000800)=ANY=[@ANYBLOB="ef2e5dde5764cda26ddeffd5a6897ec6ee4cef32544376c21f0d14d01d3372c37115c9bea79a75aad2c4ab193af517d0119a4e5b31c914d5636e7157d31b4e416e1d1861f61e4f09552dc8b0c1430908685f3c11cb3037997e8cbae1104120937377c832d36214a49f0ac307189bd714d4d7b1c5371c6abfbe97969c834dd2eadf3777d7c3c2b76ff8f9ec2f0f85648c19c5f86fabf2730f6e9ec39da5f6de4ef214ec79db9aae3d24e362a613ad10e9b769622bffd8a1bac6d133aa490d0892ed1f93016756d9a47a2759842f0b4986e63687db3c4d5822b89ad01bb220c27bb40a11e5407bda24eacdf9b3220669dbbac10c807a951b26fcb33fe8b2f80065c69d911926cc258b7e1f9bd46f474a970732821dc0837864ed1ae7afd6043111ba44d5b12fece73305f6c8896bba1360b27d9e38ea3cba1444316c15ace2cf6abc5c8f0a4c62e596ff1caf4513d88f0f85c3775fe953eff380db2f4b16d8b8fadc21144f6283595ba0110f959b14f57ea958591f9e207cd5145fbba2326d6ea49f46a999b92404ac91c70908f3f72064831341ad95f8a5d5c422bbf38dd0b401e74268e422b1de33ec14dbce8bbd31208455a1bbed2355323a9b941a73a8a80087854f534fa21a40fc652ba134c89824265475908ba8da48a94eb171a4bfbb4edddc8339f450bb5c4c3f2752679ad981582145b5b843522d6a0ca43ef51016efa2b6e63c7b1e6109b603e6b7845c34a4900a484179827db1269718577358de3e66e6b8a8532ab9c59f42e48098e5b0aea1dc5832c3d1e9e908402958edf4dcb430672e9ae096594e7454cc423d50ef8725d1b2dee3a520790902403cbd980d7f3ee2a2cfc4b6f65dd17fb1d6d4959ea646cc536893d8457869b5e22cc90dd86693731600b914cb4f99bf78f698493e7f3feda2db62cdfa671b031edc2341388e819b7538cbe402fa028dd37d3696d81c61235334155a4a5dc0a7f5ec10ac50a5984c87751e01c7f43dfda2acb54abd7cd8394b8770b961d9d79302afee07b2785c9e2b38534218d342967dc0f7084cd514d54b2f2c67602afb10ddcc4946e8cb96449a204f67817710cdb2b7ec05f9cd5804e1e6151cd928dbeaad2fc48cef22c3240caf975327f8d97f1c4862bcdec574edc2f5f6ac4d725f6f5e96a05b6165b9b2c299ae9ef6d3b602f34b5e57cf97763de7a82ffcbc5501b33c7e3a3eb6b525b6ead9aa08309f99a5d7b083083014b2c0ff62533c1ae377b82f88da06a658eb1c7e82547a0c4a6f313e4de6dc6e8ae431ab003d74280f8005d425d968b4fadbcef8ee3e4864f984ca4832b5b351be52f9fb5e8cbad783d632d8ea55ef90b53d7572b6b76fb5eb6fcf3c9100052bf9fef26b25959bd6dc53f8a0d51a24ef5cc282d205ac7466f3a0e09bf5a70e6c358b9e4bc131f818ddf6fd890a90ab0933177cba6ee00b9b4d3ed6de69897b666c2137008744a599bb12a4e7266094068153a75830882f5dd68d068be2f75cb1157738b49758729bd1468af1c0071e0bbca1f827b646b2089ab286c2c6307adcba86fe687bdd01cb61e05a40e95c7546724d5d7962c791067359e86ac0db6fe247bf6df8645b28ba5636b1fc4a08624696fb6a69538d0c02ba255b39c86e8bb44735444f41543d63158b988a2c42c3919ff112cc8c9797c39d644d481276c8f0d9cc8dacdb935ec16efcc50705cac2328fa0f5c9bf148217a9038708ad7ff395d78191de068ffce71ea151fb059fd96cbf6d14f2253a60ea709bccef391f58a32f4a645d35d2a6dc81f6bfbdbe37e09dedd101d716a534f21a6ac97ac0a168c86b576bb1d0c82b685bf434c2ee15d920feb9a8ac1e890c99d6b9b5519d711d10deba9f2fc9eaea0834698fb679e9aad40db4a27108da7045de67c44be8c853f31f92ed27541ea6dc04aa8f530b0c184672ff211fb7e25e78db2e92122cef56429f772f438e7fa0b9e15e07172f4dcb91a66bcb1d8fb7832093d652f95e07e728ba84be5f60ffda7f612a84f2da24cff06efaf7ddfde04b111a187ee4e983125b07dcd9bbfc8954ecc450a0cb82502d7e1590b76657e3c4fd5b13d3768b0efad7e450a0571cfc2f668f62320fe3b3264c80f4ff1332809b475650df9fe2e20e6350f11815309a62706b7670f1c9a1d3537ffd42539c7d379f614c3ff17271889ef0e7cd5f63d17db8c94d43b4d0b0321e06e1ca21683f7e17d82b31c5c3f440d31ef024ce42ba60e8edcf5a8a6bc2607ad3618ca4db3e50dea81504855d8855e060acff64a300f24d3bdcf1cedb94d2870a9c4c5b085fb9f31bdb89f8dd86728567aa00a9645c7c1a8b8016b873c1f5d79646d060ccbedc7647e8e9e90f8bfee009de206376025354661ec813007d13a3c9b3ac75a512087431e8ed4a2354008a766d6272bbfeabacf1755867405eca85a964563b838e8fc746acbb61a7f232743e83881bc27f9d1b340c0f1e7eed5491d34fbaf3e528feea8ceb9bfb7d6e686d82c444416870e4b1d2efda0be1a673ad5563bda5adc85d00d4b8be82689291ad200daa1de7fa3fa69b275345bb35a4183ee5b08c74e6e826bb5055f034c3450a9f97bfd0b064269db8292636659d60ff4033e34a08a2a4d084b9bf93a9c4668fc437bfc277811ad2d467d2c2bc3d2643b262831509d7f30db80557b270445c3dde764d1d2433c815e8509e780db6a7703e10571f3271f653d440d1b42a91d2d4923576994ab6c611e0d79f63d3ba600c95ac50283de74731bc2b6ab1db54703335b6da00944cef0d1fc03cf9563c9b7389988c1a55197787da8488855796a169fcd8a7e5bb244870254dc4eaae7284d8e00aa118d3469f31f287066e2666150f1591af1af3bfa7601410dd751f4d5ed6687aa24121b382fec951d3c38ff3017a8a2e1fba2e01b52250758441d29511a73dd7740101abf89ab96f9dde53b60c8968df3dcc89a44c7888ee6038a35a10c6fe9fabf2514cac7ded98c809187300b1f0594914e46b120f47f4ab89357d17e58d078a5b40ae217c1e1459453445dc162b7fc1e7e68690bc5afbba2762a262621fa997b65ca34ba0401916626c4e8ac66163de99d99259e3232ecb3c768a0ba5351fd951d79b946f26e45cfcec299ac1b89410f3293034830eadf94545aedb7bd08212e3604d3f0be8a8b81980c8c1031e8941f176d2340207f13dfb474c6e37b0cc3873a3989b8f590f37d476ac538db7016d171a279b0650ba9a07eb390adfc2c107552cfb34d849015a00ca20d8d544caed5d40cd5f747322b914225978aadfe169a248bdc9fbce0cd62b3305094f2ac6f337819fc62ca7c88e1ccca747dfd823d322f5878ed96323e9dea60cc8928b43e0136335fd7f6cc8a4aaaf8c205514aefff6dc426be6c70677131bc72a37f3382472567f55bda37259157ad95d1afbdc0b36cdcfac4b0dafebeeeaa7ad02fade79471b834003ca67507bffcc4ecbfa44ade63c7d63de9de3c27500dc1ad0ddf4e150d3f26d69d7f9a7193a126d4c233caa19cb1c3ded89655f6a8aa2ecbaf11e9f37172863285b8720c6d02739001376a874626d260843d8a5678c1921006d2666832a6aa97b67f8730a8ed7b8e839072aabfe62595731ba6b755b5b6c40969dc29ba11c09539985fab03c6693616dd0e44377b7543af8fba710abc3c2758386c625c7912eee4893f6859eb8deea59ccdec67d20d1b8b3ad37b482e2b65d71873dc6e19de7a2e94099092c05e3300d2d8402c6e533c7d0408c339eb106aa8434692df89164bc5c4b474aa82c6e670f673a261d4e1a0e2d4150accb8762c6fa38a894da1a47353a6ee88f49fb6eaca1a5d1cb93c7002e9c937169ee007d3f25435992524e8caad3486df7f218c2a8d7685021fff56e8b7d313fdb5e162898cbe52390a05bd897e8448cc20ded050b6388d4fcda62c9a44171e98c155bee9a63f1108107bc504a370e141cf298be571f46783d1ebfdad05fc4f55f342898717d49fb53db33e667052b00b12437d73cc3a98022e9e127f1fb529f7b79fe69b2ebafc25b15abba5b2b35f7ee5d19fb7242bbfa6abd622187fe7f676d32f14596ebc7e4f8ed192721734eb422ed8dc2791f78dd6ac2157531a44441642904da27fbfa8bc5cf2659a7e98a54ae8c175ce68cedd7b1ebc18c32c832777b4fb27c992d029fbbc6e37bc2d7bb5d1d5313663ae9cd5a9e1c68f3ab59244c8f9b128ef9ef82b8340091476df6403d21f50f5692ed243a35d4bd3554b04a5c88be1c50b6e0fcdaa6a154b212fed646bab4bc312374d71bf1604ca7e647d333776abaefffe9ddd0ef7f1b66930b91ece8596326e8df11d84cff6b9aee2df98415f90c689b4c00974c2f8b29b2ca06de2f71a175bbae2763c76f19206fcc65968a5310f1c85a62e0974b4c0982781b196fa3b2fe7d28942424c83cb4fd33d19d84087e1a6899a83e25d567de887f718af644ebda7e9e1573e25b477058dbdec4107e5acd5816e2137e86cb680fb79ff47dcbbd6648f8df3d027c236051a3919bff714f8cdf6d52139e4319afd5c6beb815332e9cd6650cc81ddb979c2f700e70e0ff0a71d7c227943c3b040bddebf32d79957f429b2774847e19345918ad8373dbd2fcb9dac6575132c7387991a0f89404b52d845f1d1a22f7f5bb63e0544e83114117832b5c1d6bf60ba882e25430637c72d86691a4bba864b7804a02267dfbdbe8d7a24b2c38a32a9b8b166e369af1762dbbb540039c2297419e17a6e309e23d459a3941a1d1b8032348b008b45827a378581b55512f5fbbfa14f14bf461a82eca914d626f38162ce01986eb0c48ed8f1cc6d53aaf11e55ce4b0383e4c75d1be1fdc5c57c899684f1641ae7584db8fe847569790019604fc60adbd6461561a6d7c346f52f8ba3b53ae377e8c879b80f8196cc2ce9a67bdd00164a1ae542e2bea0778c4889e4905b63602b80f7d25315d6dc283914f9f915652b135af212d57577d6fa63d95b23953a572dc42a2023100f32ee246c89d093cf3536b41c41774e4b732c6b261bdd5e9db717e3a9bb16cd725a8516cf9b7bc885fff53db06a0c0ff8e00d256135cefa9f6feee4143649ef0ea3e699070676e78e8d1e0c6b89223b0937e71963cde43c3ecf4b1157d29c397f977beae18bdc2184fca2ef8dce7cf915e68570533221eded760a8fddde14a0191f17a2c73478515977b08b3e5905ee69c8562213b465d15e80d6202442ba4425f95980a7e2b61d86837b17adb1a66e3f8391ff2f3e22e50486a3035807ac6bd207ab298e61dde048f6234b25e241f887733d55b77d98c9238dfec211fde246fd5e1f7629d112c60fda65b93ee4135b0b83b1a9a73621e1822bbc0ec4f16ab2214e4b89e1dd3b5b67605c47fd33d01a350800e4f98db3b4c56a32831007c2da71253082cbf2adab18077a0ee490b926ce1968013948df4f78c6adc3fce341a557ed19bf9ca97db08dd4f169cc4b64070eca41830e7c19a35b0616380bf4d97d9de18dd8fb05fd5397f4fd40564013b05ae7ca31acc84b3cec1d1ac82284064426ac4f9fbc0dc87d65f2163cf7ad8bc33d9343da765167220a1ade93e4ed7078ca251c666be5dde9eb4ffb4450b2768eadd99d639dc362e8421194065d302bede3b138f7121529d286539b5259728a8914f6ddc21d1fc49bf1e154e41fb4bb43b4f4d6e846d5d367143701d3996f09c444c3238c0fc066143a1ac1ce06f7d297d0650cc1c30775f7ec5df1f2243698327578436b059592763edf5924c1a54361b10124ea9b6", @ANYPTR], @ANYRES32=0x0], @ANYPTR=&(0x7f0000000400)=ANY=[@ANYRESDEC], @ANYRESOCT, @ANYBLOB="ff3dab4738c2e1e82844849393ccdd3cd437317b383591b61478aa6e1050fbd33a5db0e5fee0cf4692a05be387c69067e20980dae713f7512a461b7df853fc29df486b551be4706ec52d2e7389e85b856c44fd68c0a17a5d405afb009a99161973926638560f0ca0f6da3a4c901c853d68cedca7e39a30daa9a779f5e3a3a316956ce8b17c68"], @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d000400001ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYRES32], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f00000003c0)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, 0x0, &(0x7f0000000000)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/189, 0xb58b8a)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0x0)
r1 = request_key(&(0x7f0000000080)='dns_resolver\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)='keyring\x00', 0xfffffffffffffffd)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
add_key(&(0x7f0000000180)='encrypted\x00', &(0x7f00000001c0)={'syz', 0x2}, 0x0, 0x0, r4)
keyctl$restrict_keyring(0x1d, r1, &(0x7f0000000140)='pkcs7_test\x00', 0x0)
keyctl$read(0xb, r0, &(0x7f0000000280)=""/93, 0x5d)

19:20:28 executing program 3:
r0 = request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000080)={'syz', 0x3}, 0x0, 0xfffffffffffffffd)
add_key$keyring(&(0x7f0000000040)='keyring\x00', &(0x7f00000000c0)={'syz', 0x1}, 0x0, 0x0, r0)

19:20:28 executing program 3:
add_key(&(0x7f0000000140)='asymmetric\x00', 0x0, &(0x7f00000003c0)="9f3a", 0xfffff, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$get_keyring_id(0x0, r2, 0x290)
keyctl$read(0xb, r2, &(0x7f0000000200)=""/164, 0xa4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='user\x00', &(0x7f00000000c0)=@secondary='builtin_and_secondary_trusted\x00')

19:20:28 executing program 1:
r0 = request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x1}, 0x0, 0x0)
r1 = add_key(&(0x7f00000002c0)='user\x00', &(0x7f0000000180)={'syz', 0x0}, &(0x7f00000001c0)="efaff6de97433db2154619eb57d5dcf49c3fdbfc55737aca0c7095c4ad89366215f62d4a345bb35cfa245012c5b16883e53f83e1e5626cf209f4b4150a8062e34eac88f95d65224ef361f8d25e5c26b4d2bc3cfc8cf2348d09eefb3b0e489c8196ab387638aa6c1b7e1ded8488871a20e735240e61dce08a7e1d9c624065424b404198c2633d61910abc3aa66a752972e0a9530cfcb7c94165b9468c8492314f35bbe162601417492672070cd36960ab4ce2c6aeaec171d3a776e153d55985e21b8e38eb769cd508cd608c13083faaf1906b79a986809c88bc8cf756ffc1381f725b053f37040b7493b3b3e8f28ff4688275", 0xf2, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$reject(0x13, r1, 0x1, 0x8, r3)
request_key(&(0x7f0000000080)='id_resolver\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)='\x00', r1)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r3 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r2, r3, 0x1)
keyctl$unlink(0x9, r0, r3)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_MOVE(0x6, r4, r4, r4, 0x0)

19:20:28 executing program 3:
keyctl$reject(0x2, 0x0, 0x10000721000, 0x201, 0x0)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000180)=""/189, 0xb58b8a)
r0 = add_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)="84ed31a654b7153072a2028df8cdc0be161d84243f6b60", 0x17, 0xfffffffffffffff8)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000003c0)=ANY=[@ANYBLOB="89da3a3ddd7a81e06831653b2a70c8cb9717ecdd24bf4a6998cbc191d489af9a9fbbb9242785bda80f60f151818f31773366499f980a851ad235185b5cc942e68e1368c48493b820cd4209eeeef8dea670a4a7c334ca6ec7f487053af0ef8a4eaacec5e0a0648fca695b5c2c9ddfa26cf6d4b70f033f4d34596d001b8228cd30bffb17952dffddf76e502401dbd0ef5a483260869bbda116ff191793217657fe95559d2869466ad85097e3d7532e2a587ec5aacb0ffe"]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$link(0x8, r0, r3)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000040)={r1, 0xc3, 0x2f}, &(0x7f0000000080)={'enc=', 'raw', ' hash=', {'sha224-ssse3\x00'}}, &(0x7f0000000180)="3b3714a1fdf2f6bfc838a0881d2ff482d3d2abd4cae8864ad69f1d5abf724d80805b615276ee0fef01914a3b7474a0486f301e3e5b501ca33dfb93de8392cfe24ceaafb7ac7e98b52d5d3551f6f976da990117d666f9974d44a1fe6c133a58e3bc1b5573e6246e4e583dc272ebf2ed89d0fa40ab868dd165d4c157d59258f0def60097b29174534649cbfdfc1eae1c55c649c12803ad7ed7232577206e4d8fd3512c91dac159023e8854df0b3b00984bbe217bfa5a6b7ade5368be8dbc83171aaaa51c", &(0x7f0000000100)=""/47)
add_key(&(0x7f0000000000)='asymmetric\x00', 0x0, &(0x7f0000000140)="1080", 0x2, 0xffffffffffffffff)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffff8)
keyctl$unlink(0x9, 0x0, r0)
r1 = request_key(&(0x7f0000000140)='big_key\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f00000001c0)='syz', r0)
r2 = add_key(&(0x7f0000000080)='user\x00', &(0x7f00000000c0)={'syz', 0x0}, &(0x7f0000000100)="7a6ce77cfb7e4b617090523ece9dd7582f03a6ff7e3f98425064353b1cf8a611a625d42eea8f8e7d6473e5db1b53d4", 0x2f, r1)
r3 = add_key$user(&(0x7f0000000200)='user\x00', &(0x7f0000000240)={'syz', 0x3}, &(0x7f0000000280)="d22ca04952c794520d4a2bcf18956f36975467ef00803175a4b1bdf4d44c557ac1212fd017be1d112744340838357df0b2aff8316873140c800345ea639fb49b3da0402e2c0b826b01c06a3a9b00ee789d216564b01ed6732e506990d91b6efb90002f557edfa8fd21def3f249f4cf91fc347ad4ab1c6d259613495e023c15a5eeedc128", 0x84, 0xfffffffffffffffa)
r4 = add_key$keyring(&(0x7f0000000340)='keyring\x00', &(0x7f0000000380)={'syz', 0x0}, 0x0, 0x0, r2)
keyctl$negate(0xd, r3, 0x1f, r4)
r5 = request_key(&(0x7f00000003c0)='big_key\x00', &(0x7f0000000400)={'syz', 0x1}, &(0x7f0000000440)='\x00', 0xfffffffffffffff8)
keyctl$set_timeout(0xf, r5, 0x2)
add_key$user(&(0x7f0000000480)='user\x00', &(0x7f00000004c0)={'syz', 0x2}, &(0x7f0000000500)="1876f2228c510d9fa446580ecab53856612cdf3eb29cdeae9197960d3780edaf8f8a806c1457a719f938ada6b94cee5e7250b430c2b338937bc4f556417e77bf80b2e5ba003bf605285a5d6297e648c0d3df0fe1acaabac136ca325be37243d96a1eb8264223b659ffc0a87f5dd0d5ed2b8ad0e130fce158795c7af1b9255dfda51cd973e09060a4", 0x88, r2)
add_key$keyring(&(0x7f00000005c0)='keyring\x00', &(0x7f0000000600)={'syz', 0x1}, 0x0, 0x0, r5)
r6 = add_key$keyring(&(0x7f0000000640)='keyring\x00', &(0x7f0000000680)={'syz', 0x3}, 0x0, 0x0, r0)
keyctl$get_keyring_id(0x0, r6, 0x100000000)
r7 = add_key$keyring(&(0x7f0000000740)='keyring\x00', &(0x7f0000000780)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffa)
add_key$keyring(&(0x7f00000006c0)='keyring\x00', &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, r7)
add_key$keyring(&(0x7f00000007c0)='keyring\x00', &(0x7f0000000800)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffff8)
add_key$keyring(&(0x7f0000000840)='keyring\x00', &(0x7f0000000880)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffff8)
r8 = request_key(&(0x7f00000008c0)='asymmetric\x00', &(0x7f0000000900)={'syz', 0x3}, &(0x7f0000000940)='vboxnet0eth1*\x00', 0x0)
keyctl$clear(0x7, r8)
keyctl$revoke(0x3, 0x0)

19:20:28 executing program 1:
r0 = request_key(&(0x7f0000000140)='rxrpc_s\x00', &(0x7f0000000180)={'syz', 0x2}, &(0x7f00000001c0)='dns_resolver\x00', 0x0)
keyctl$invalidate(0x15, r0)
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, 0x0, 0x0, &(0x7f0000000000)="b7b4ab3e2caa3f3a669d7e3de8c2d6359fc66a81eb25d5273eb67f23238ef5fc25b85421af6698399936307f290c9b11b65e7738d31539c64475a81eb4d0b67914c4e13b3b6fdef7d93c6897436e9b581906dd693dffff00000000000063a37448bd44d1c4ce0aa0360aec0297f42a3df171ff8543670e03822b1fa1044ed2d1a0ed3da426bd0294f1ee32cb73fa9b63cb0d2b7bc2592b8184110cc7dd9653f14314896290a58439993db6cbd3a8982a2ee6f4ab4562d0ae2a377a600a3c01045b9d4fc0e6eeaf0700000051df92542a3af5b39360643327c24735bb5c34059fb1461d05ac4b4628368c9c208748c08efe21498dce732fdf59dc582e2023d74cdef722e8e3ad698b5a9fddebcbd655ebb7e05be8d4ca8d247d08d6", 0x0)
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x1001, 0xffffffffffffffff)

19:20:28 executing program 1:
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000000c0)=""/36, 0x24)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000100)={r2, 0x7a, 0x7}, &(0x7f0000000140)={'enc=', 'oaep', ' hash=', {'poly1305\x00'}}, &(0x7f00000001c0)="c9850ace7a5926ba7729be6e79f9d4a691d79ed408d18b7bc3066a8f344bde2cb06fdd97b4f2fe1db4fe1f8dea2358a0e8efd7817b6b69832d048ffbfd9a4d40c868f7ce1182d2e049a92136349362d3275f3e68277d4858ccb8c0b080a68ae193b2813c253257c447e2811f435abba230c5fccc66e44ab1bcb8", &(0x7f0000000240)=""/7)
r3 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
keyctl$reject(0x2, r3, 0x800006, 0x201, 0x0)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
r3 = request_key(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)='md5sumtrusted\x00', r1)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f00000000c0)={r3, 0xd3, 0x3d}, &(0x7f0000000100)={'enc=', 'oaep', ' hash=', {'crct10dif-generic\x00'}}, &(0x7f00000003c0)="d34e526cd5555b6944a3eb4b4634f223a2b557e2da7841cf933070ddb90b5e1d58d1f3bf3c07c5e791f802c3cfce4ca1a8e340efa119ca8eb280085687c16fcf1e18603f7b9a4e8abb0d408eebc99b322b212db34081f6160dff4237398798e2aa829a54a6664fe379a20f1324dc4e085eb3b815f4784158d2c017a5d2c5d22c80b908b203fa92454a4cd9ab0c43088c42b458bd74e76c26f31c2f89e4ffd492afcba78560e23cc27f6c2e3ff61fd7305ed88196811fb8118145853a52b807f4d453a03fa67d297e9f83bf40080f9f1699dbd2", &(0x7f0000000180)=""/61)
add_key(&(0x7f0000000240)='logon\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f00000002c0)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a76c7e96aca1f8bbfd0930a0f3a7b3127e7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db8d2da71bae7345e00b108cd9077d31c0d57ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9b", 0x100, 0xfffffffffffffffc)

19:20:28 executing program 2:
request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f00000002c0)=':bdevwlan0vboxnet0&\x00', 0xfffffffffffffffe)
request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='wlan0nodevsecurity\x00', 0xfffffffffffffff8)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$link(0x8, r0, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$link(0x8, r2, r3)
add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffe)

19:20:28 executing program 0:
keyctl$KEYCTL_PKEY_QUERY(0x18, 0x0, 0x0, 0x0, 0x0)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r1, 0x1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$negate(0xd, 0x0, 0x3, r3)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000780)=ANY=[@ANYRES32=r0, @ANYRESHEX, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37db3568a2c4a16862c996f2d323296c4e13c2629f89dcce90aa02a413542e8b0abf1930bcbad52df8c24d43dc35392f01f0a44bcc2184df86ad91e6f92c61c90d5ce292dc84203761e86584e703926c17886e73cbcf25b88f17ab6c8722e88a2a2b876c6d9bd7163d831c3149b77981477bd2a4c6d9576267516c725c20311882d08243574c345781e14e1fd07e215e329ec231d32d4fa7514f21545fa699b3b0cb0e6ea8dc3dce64dccb20527d7b0d85ab26bcee2bd0d9bb501bc73cfd1463ae391b3530e130e54f9199d62ca1561184c01e4efe89e2f62b1b9293df7780a1018d9fa559087373d451853c0866085731452e23ffe23ff8da0a0f9ded5afc6cd53c1dd5dfb6afca736284dcc834c9cda85a2fe10e17967c46b05c3d20d138e3b2c7ece5fddbbf88788d14b13988", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000280)='pkcs7_test\x00', &(0x7f0000000240)=@chain={'key_or_keyring:', r4, ':chain\x00'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key(&(0x7f0000000000)='id_resolver\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)="fa179db3206987fa0ff1f9ada75613ce6affd5106fa3f3968b35e949d89d8915fdd76c9719020c6322a845ec065f5429ee3b0d6ea1b9c274", 0x38, r0)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000180)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$negate(0xd, r2, 0x0, r3)
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f00000000c0)='\x00\x04\x00\x00iKg\x00B\tfRo\xbek\xcch\x86\x8d\xce;\x95f\xa9Rq\xf9\x1dU\xc7\x01\xbe\xd8:(.\xd3\xa2\xd8+\xde\x18\x8d\xd8\xea\xf4\x18\xea\xe2\xdb~qZ\xb3\x80\xdb\x13-9y\x985\xc6\a\xbf\xa0\x03{\x9ep\v\xcb\xc9\x81\x1f\f\xb0\x00%\xba\xab\x8a\x80\'\x00\x043\xc4\x13\x02\x00\xe3\xa8\x96\xf5K\x97\x13A\xcc\f\xed\xfb`;}i\xfeu\xed\x8f0\xfd\x9d\'x;\x12x\xe5\x1a]\xdc\xa6\xfbH\xc8$\xb7\xc2Yp5\xaaC\x1b\xcb\f\xeb\x8a\x01\x9e\xbf\x87(\x8dp24\v=\x1b8\xd6\xfe$}\xa9\xc3rA', 0xfffffffffffffffb)

19:20:28 executing program 1:
add_key(&(0x7f0000000000)='logon\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080), 0x0, 0xfffffffffffffff9)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000200)='ceph\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000140)='.dead\x00', &(0x7f0000000180)=@keyring={'key_or_keyring:', r4})
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$assume_authority(0x10, r2)
keyctl$invalidate(0x15, 0x0)
request_key(0x0, 0x0, 0x0, 0x0)
r5 = add_key$keyring(0x0, &(0x7f0000000700)={'syz', 0x3}, 0x0, 0x0, 0x0)
keyctl$search(0xa, 0x0, &(0x7f0000000780)='blacklist\x00', 0x0, r5)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, &(0x7f0000000940)='-\x00', 0xfffffffffffffffe)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
add_key(&(0x7f0000000040)='rxrpc\x00', 0x0, &(0x7f0000000140)="1080", 0x2, r1)

19:20:28 executing program 2:
r0 = add_key$user(&(0x7f00000005c0)='user\x00', &(0x7f0000000600)={'syz', 0x0}, &(0x7f0000000640)='O', 0x1, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYRESDEC, @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f00000003c0)='logon\x00', &(0x7f0000000400)=@secondary='builtin_and_secondary_trusted\x00')
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, 0x0, 0x0, r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, 0x0, r5, 0x1)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, 0x0, 0x0)
keyctl$search(0xa, r0, &(0x7f0000000000)='rxrpc_s\x00', &(0x7f0000000040)={'syz', 0x3}, r4)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000400)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffd)
r3 = add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r2)
keyctl$KEYCTL_MOVE(0x1e, r3, 0xfffffffffffffffd, r2, 0x0)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r4, @ANYRESOCT=r4, @ANYBLOB="ae041031132207d9b742e403875e0c5f37df3568f4e7270ac2629f891930bc5781d2e1f92d61c90d5ce292c484203761e865c4e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd72ad7781", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r4]]], 0x5, r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r4, 0x9982018)
r5 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r4)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r6)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r6, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r5, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r6, ':chain\x00'})
add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000100)={'syz', 0x3}, 0x0, 0x0, r6)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
add_key$keyring(&(0x7f0000000380)='keyring\x00', &(0x7f00000003c0)={'syz', 0x3}, 0x0, 0x0, r0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000400)='keyring\x00', &(0x7f0000000440)={'syz', 0x3}, 0x0, 0x0, r1)
add_key$keyring(&(0x7f0000000480)='keyring\x00', &(0x7f00000004c0)={'syz', 0x3}, 0x0, 0x0, r0)
add_key(&(0x7f0000000200)='id_resolver\x00', &(0x7f0000000500)={'syz', 0x3}, &(0x7f0000000540)="d2308c62ad6f0a04d8316b8e4ba68ad7320fa649a41cfd4b8a677233bea69a9da59b429213a859df7b6f85c899fc1d2251a99f6eb16c282a5d24f29e47cf85d99aa0029cfc1968b7aec2895c5a244526e9bc035bae120e24da5eb5aa45090bc0c98e374f59e67894146ad1d59633894dbe2e741db8b8834cbe05e1fca04678ecafe58fb25a66ca920a7013fce25a55975e3134b25a6e806f08b4e825e2a42c3f52ee37a2afa42bef9764c7ebef7e8e4fe654110706bf7f6d2563943315ad230adeac6a271d2f766ebb1e5872f09a8df8510789d48d81fe9c784f59aef61d401c264fea586dc9f4af339f23a7bafb8660b2", 0xf1, 0xfffffffffffffffb)
keyctl$clear(0x7, r2)
r3 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffff8)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = add_key$keyring(&(0x7f0000000240)='keyring\x00', &(0x7f0000000300)={'syz', 0x3}, 0x0, 0x0, r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r0, r2, 0x1)
keyctl$negate(0xd, r4, 0x2, r5)
add_key(&(0x7f0000000080)='logon\x00', &(0x7f00000000c0)={'syz', 0x2}, &(0x7f0000000100)="20a420912b19b69adea64941de55bd176c9b88f60e00dda6436f13da69cf4c4ebee0fe496106d98e81b31c00ff836a140216fe947c44cfcab1e920dbe7510bf7f6ce915274bcce53904cfea02ab3b6a10a7274f52a08565dfbdba7f5d1d549d41c7a2e58a4fd7f4d2489a7e205cafc07ae7e6d61fb39e4e5e7d9a3ab879891a7a08e130beba7768ea24b45cab4a04814415fc6dd0a9f5e1b573f694d4ebf51719e88acfc708640be9b96b4", 0xab, r3)
add_key(&(0x7f0000000640)='id_legacy\x00', &(0x7f0000000680)={'syz', 0x2}, &(0x7f00000006c0)="375de0de924fcab279f7256de7c4794e4d73e2c98ec432d0063dfd7441b4d496076850", 0x23, 0xffffffffffffffff)

19:20:28 executing program 0:
add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000380)="76eb6ae5193a83070eb6a01e50851d431a56479171d743b93a66b7c723656fe81e822932d98427049a442b5b0ae027958679259aed7f252d0e3a53873b32ead42860a8806d9fa583dc04724120f0d07774dcfcd19ea6fadd5dc8af4f74aecae9783770c41c1e94a525209186b68c944a9b1e29f41a37ea68a0aa8845e71b6ab63b412a12675d7094aa32fd2984f5d6b213ebbf898fde03cd2dc70ec240aa629d4d0f334f26fb61f4b0d1179589e4d6b7360ef9369f9d58b11e39bf741d39cc87ceba9a31581246b1df0d3822c8e9629db70e3e70a055dec482d915ff80ae2559a294e8faef6b5f5f9bcfd02bfcba08b713bc4b9233549ccac4a8699d0d2cd69f497b82fbec35658b32762f79e5e98c3a34b916f0471ea7c874f031e92eab7931bc3e573c5dbf90242f81abe1aa5e084643595d6dcb8a589036428302e9d9b54d8138c45a84eeb559ab3c93e4dfaba309eaa1a68b68477d030517f8dcb4b1cbcbb34bb1936a23456387b676559fd0edc1241f1bb0efdb094562b6201e82c1c8afa15d91e4cc96bbc5949362d8ece3474ab22c12eda90c001d9b306bf48ec2f66df7dadb921bfcec2ea6cf4deb256f1641f3b4931adb43a12cfd3e9456dc191139cd33f286f2bd931d72f90a6fe1cdfb26269830121dca064df5391a54c67839597aa0908060085c3e31cb644969ef6cd9a44739280a024625eccb4ef10f7e6a4427252828b9a51d81b73fa8c35d6bf9d50b4ad4251d0bc841a729a1d901ecc46efb6495dac6728e0e68e76fb65a48c5ce27885bae54c29e93fbd20c19893e279d56b188ef1ad2886ecebaf6ac72dbc4076eaf6e69555ddc18f253948afba41e19f45486bfc5eb4e8cb9a6354861d1f5e521fbdd226baddd80ca3e7e99ba0fb80b434d52f43417e0a38a8d122affa9564e29c7f87f63f2c3ca00e71a9d0bd7b86fab5aad808d4f90dc210e728be55f3a6a49f4ab7a3915d94af7561fc29aef588e796478b03870e8c74d8ec44be37063ad58f7280dbedc2533c8fb3ef18a4b83366750aa98708d5fb17ff3639f4a9d2a4c453a291f5e64d58a05408da4f4cb8db9e9d89660246bf6f6f60360d8d6e636a153215cc7c611563cbb76b4c5fd2af3c78fa57c2c3764bca84fe04c6ac3648a7b7c3ad4362fa53610e77ee6f06480a167630f824b19b4223a63cbfe08d492f53a59a143bb43b79c4c17385803d8497b0d83f1ab5b9fbae90e8f22cd7a7388df52d20b44cede6db3c27ceb8f63f3db03b12379373ae2fcd20d02751f28f8c356fc65a1ba1d7f8da816e60e90fb03b4f6d887ee217c6d194b6e0793ccf949aee0a21151e616c70a5295f419ea273db02aedb6fa87159e7f7960016dabbe9287b17dae9414678b42b54b7e6dac470cab20050aeadbf5a379a2bac62bd32bd5d19636627a3e53a470aafae1ebe7f161400a222620cc441c4b927c59532bb3130a0d806d7cf271a3c598f3358b5a3cf1e82004d546a74f84592fc935c5e69593f8501960c0b899f63db1b2e16a3512e2fdbe051b0dba343e8ce368dc4bc850dfd15946af9d388d4e60d90f06b1bd0e873ed71d6082cafd606138538cbffcb56fd11e86575716c96667fc913730fccf6737f6dbb668e50b406c7b1caaeba2eaacb8aa2b397f288cfd818fcddf0e8fa9672061acaded91d5ef07fc76d1dcba03d7c8bc6588f55776da49323ec19c1dc79e67c8d5f79710ab0115970c3b29624bf932954ce8931df3c37bff439f7f0766ce4a93f5ca0088497f6ce540d99098abf163fa49cc02693fe76744a2a1e1c9de028e41429110fbcba3354dcc085476cd509bab5416d19b0659f69589d27815c5a36c9986e5e52c2be18c8ce581f9d63dad559578fcfd53652caa8df7c474b770e1172eb8690b58282656ee31a544097faf0d49033f452d19991416e9a96af0bc1b6c8a421e45fd5cf94557d013668a93f4bedf2b3ebc4a910eb79ef3ca4185f9df6298ad2cd3844e2d230f4c71849ac033f1b373158b9e15b1777d639b90dc066a4e200d3bbccb424020bcf299de17633c5c5abb4ef1a8d58c8c5413ae2ae0924c52d540573451f631c358c1608f1690507db99be03c65ef19b5d813f7cb8d5627fce3b9c520ce00ef968901b9bea8002a2447f896851d07d62783cc4e698c9c60e83b8137ee7fd65933d64b356eda128de33052937726c2d6f5ca41e5f27bb37d7a89614f9ee73a85d35796f77e37a74d55e9471bf94db86d97d70a532e40e3e9ce5ba062d8f3f7dfce645323989f8d42784d9133a85ffd99d150d01d8d366ac0ba2f70240c894a642b90703cd51d03c729edf7bf10b7a12291388c5b6da37c7c14c3b571e60ccfea3d80d3b9b0d618f1307cf96de56d7b8bdfd5f1b6a7967dbdf1f7cf81cfbfdca194e059af64e0bbd8c394d0ab734919a21930c2a457ec9fa2137abb3d19ee0936c5dfe0d2abdf4f636ad92d986efdb75e2e5590f15c5e7dc847586f03c648a65b95d282ff99b53a0fd1271d39eeaccc817e63691049680f208bd1f4e5285a0d0fd39e54a8096d63641d4dc4778f6459208b7198e85336797955b927eaa42328d86d01066b483e74e613c671f56c91abb68516f616ffe505f2e04ab447a443cc2453d8b19bebda3146e31727a3cb17da5f23710635ed77a21b83badea12e730232e69d5825935a86066b0e4642bf12e341fab563e9519bc16f60b0d2ddec3c992dae77ba8632ab51d1118dbfb2c44c3879773545477121b82f20e8e604c60e93d17a117a36bf26468a07f43614aee958f1b87d89c39f20fc286206b316a8cf425efaea43292eeae15e813fb97887aafcc0d5b8a92157a4bfb1fc1805011cbc2bdb6d7ac7148c1c926f7bbb6efaa1dbf91dd8f86d12dba01f882fdf63d90530eded3e71fd4728aca46c7b461fe68efde79963e64d7e889bb9b53a5da5f8c886961d794dd227fee386f632f09a6450933cddb081f9d1f99e6571c9cd8c92c36d81413f87d0b5beff0f2a39d8e13965ac1af4a81f271a27883b1a82654f1522a2710e356fa7740fff04864cd64e56c8f049f7fd28834ba147d7018fcd5de52afa98b69890ade120f9e81659a8cbcc2ba5a93005b9cbe9c715941f2cb2ef97a5bc2c06decb58dde7ff64307db11b8e64c4a765214b2e076c2ae701ba7718429ef94e848128b95ee1a3e826165ac5c4cd4af1d4978646b0cdaa67f62137b09f8457943a41a8725af87095ef2ef586ea6e97470bb05e306eab0ada83664b3c3dba7e7c8dfd32a8d1f39778e31c008ad6221fd3061d00155434c84eb8e6368338d59734ac7944b8f85ed7ff248e68f513f580e4c572093f2e857cabce4fa2f460acf6efd1b03280938733ad3799e6067a3f90efffa5a8981a1ece209afb2ebe099473bbed92fcc730888aec586746dcde7a7cc3fd7fcd57faaa88795a3f74c0f279f0c8b7f90494cb89162deac801c2ca77d5b01dcd8fa6acc726ebc8600df07010f8cafd09b655b6c3f85c78375456bbae801b5078e5004554891be8eb5b534a0266f78e027a70c261f331520f01b9d855823a483ae4110bf9a21348d6e938b1006777a04c520d785c1e7c7883e0e974ecbcd00c6f86f0e47cb09fb5d814fa4cf80268c21d2b95f094f195e1789d60eb27136f350b87f648f2f0bfdbe9cf1633a6657ecdf1602a443f1626d0f79fae0be3d25809652365109c1e89fb3d946911cf215b513f391dcb4b17ec278abd9d963ca514c8ca1d455c33a7bbdc16fcbf0bab2c7d2d71a2f0c0c6c33b9be11b144c067c0d1fd3df7b50cc424027b50c3fa56411993c4a51f456dd317fac4bdad81086b6ce7938f2d68d69ef87f7b854948637f816efa49e4465acd65025a14147551c2bec721c30d17c3efe13dedd866a795d208e50c01f5a1045591067be39b11b3a4c5ef4b785c6110a39f4c0206de6e4d2ed38d2d9e7c63204e1b86cf0a2b56356aa977d5a173bd48ef03da92b73778f3119c3afd8c764d8e3e0e11c67f4a25e11a0678a0d4b32011b7bf24f5891e0ffe57598f15dc5e5d7ebda16d635af93e47d983915543711f7efa60c4707a83f3362770c99b1d87e5d80320eb8f1c37fd7a9172c0cb070a7c8d6259b5273c7fb5815b93211fa73ef39f3ac8ad8dda1d2e22a7e339a2e86f72488157b21d26554e9e43a2887638cd7da28cb66cf8faa20352549d60c4589807ad38900cf4f3f3b840675887eabb9855dc0162720debecfd31726f8bc973cb86334cd714c53604adcc9d8187e6fe46159072b567a25ba65e5f5201d0e1e18190599beb350dc7e2c2b0c030357f94b514f273824bdc2e2375db9820a066280948d58f0aa1879e112c65b21a7a134afcefecdeb6975fe812e26104c693c95d90db962fec8cd78ba3ea4c5082f6a057e0e94f44cce0250126a35811fbed2d56fd0df7aff23edbf6d61944bf438866861af6d156c1f9027f11c2cef33847b20a2bcfa0e20e8e6ccec1078d912d9493745613cba6b0614f0d4b3236c85ee3e99f1bbe229b38774a8f3d47947a94c24fb58cb363bafe673c1807037bb3c438daac89c74f8b2c7a363f9bcef56819a16466355cc92bfb18a8decd577291b3d529cf115b9047cf33d1d9eca7aff9454695e88fd7f266f69526768ad5158d6f7ec5eea352d9b47520b87645fcaf68f5c6760136ef737196bff2ab48fb3e1db7c3c4acfd9ba3faf2fdc1256696f56d072aea4a7e64164a9154c5ac1362ef14893c3d1062c0dfde0c947fb68fa8c469f9d2a5befe95213726686072ad679f023fde6f0cb9019cee90dee7037f63d22baf297ba9ba1d5c1326b148f75d1b83ee372939da3353e5e53154b039f814d45b3e35c43857a9fdaf03d4fdb6f4a2118419ce7956a477cb8adba5fa6d0d3989804764c037ec9a7bd4089bd233cd7511181bea05b0c4fbadd47f6ee1b00b4d3afc8d6f56528261da6076ab966e3d06506828d4b87ee2c2bf12d1225528945ea305c2c38c68c2b09668f54d0def080f5f8332f82f056ac8594a2913bb8bb52918c815d5b7936c55df80217e2b6a7998513cd9ca2f0e08d428137e9ba3e65389628695a28f5d02c9ad166d00e9be12980964e8c0aeb5d0a1a0ed5f569ada59d000709c702a833603338545aef01604df0ad63adbb4275f58311c7c242053355e27cf47bf632411bb851f2a7cfd1a795afc02dc054174f29fac66b4be5f5a13b2dd9e584a6436ca20229c7c813cc32c6919aafef7835513edd9ea2bdb60a1a140f2948aba165a3ff3cc986af0b71100554b757d74bbbd45e43a7e02d492a84d022464a0726020b7a6526fcd81edf382da4073344f6982222353d8fee37a5765baa77e0cbc591e82ae696f84202f905acb16f1f9ac62a826f55bcee03fcc3b369c89e44572adabb8ce8347b1652bc28f30eced00e082415aabe10c0a67bdb7397f006aee3e20545ac1f0133c277a614dd62b166bcf71a0b8a3116c4a4edac655c2915eab8eb92e8dc308a77285dd25af6f6d7fff625eddd60fb7b8b60e253612b44800acb0dceb06d2c9d7cc6edf695e636bdf930c6c50bfc5a6781ceb9253a17eb8032db65fbfd908da3dcb8a5a72cd02c756ca956ad6f799fe2f30fc47cc7be0c3137d94b671fa4514f0429c5e0e1930533262f9b6cf6bccd26d6751f43684e280ea9ee92e75da91f7612f5bcbefc3c0e05b8dea5ca3749d9b83c48dbbe61867257ea8f887b13c1fd257bdfc9a6f09874eb14c7612fd865e3935158e8d2cc9d45b6e66b9e45f32a2c9546ab26389b047b495de5b23729766a2f2b69325370fc", 0x1000, r2)
keyctl$describe(0x6, r3, &(0x7f0000000080)=""/206, 0xce)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000000)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$set_timeout(0xf, r0, 0x2)
keyctl$read(0xb, r0, &(0x7f0000000080)=""/56, 0x38)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000001500)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e443aef0cb57bffa368132207d9b742e403875e0c5fa22d23a0ddc2d42437df3568f4e7270ac262ac775a84510e0a5f7973495b72f461d99f89dcce90aa02a413542e8b0abf1930bc5781d2203761e86584e703926c179b7dc76001005caad81c97b5ae820d343e4897a2bec0fd8efff4da0000000000000000000000abbb6a01ac374c93537cf6fdb7951fdcc5f6c3bf288a9f882177ae68db82195144e68e1d66c9e31902fdff83aaf3", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$get_keyring_id(0x0, 0x0, 0x40)
keyctl$setperm(0x5, r1, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000001180)="6626f1257531631192283087a4eb00000000b21d2cdda6cfe2dadbbf4d002e04ed4c1cb8acbea2a4cd38c428ecdef281041425e8f4f8f92bc0f243784cb192dd379332074ce457a924724e9ba20a43c88397a5dac6425c845e3957c237cfd415f5171861ffe7c606a9887d9288ed84cee24c78505b4f53f3d8d51e03c8509718a17a972041b20fccbfd3538267de6464c4c699eed7bbdddcbe0b6aadd73d1de365fa179874162dfadeeec8078062510000000000000000", 0xb7, r1)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f0000001280)=@keyring={'key_or_keyring:'})
request_key(&(0x7f0000001140)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000001340)='tkus4ee\x00\xdd\xbaT\x19\xb9mK D\x8e/\x04B\x14\x83i\xe8X\xff\xff\xff\xff\x18e\xdf\xb3$5\xba\xfc\xed;p\xc63\xf1}\xdd\x06\x15v\xf6\x15O\xa4\x0fmSF\xf9o\x9c\x00\x00%qOmm}\xe6\xab\x96\x1a\x7f &\xf2%\a\xb0\x8dB\x8a\xa4_\xf8[\x89\x04\xc9\xf5\x1a\xef\xfe=\xdb<\xc5=\xe6\b_\x00\xff\xbe\x97K\xb5\xf8g\xcd\xf5\xc4\b\xf3\x9d\xe1\xbd\x00\xff\x00\x00\x05h\xb2\xd0\x9a*\t\x9e\n\v\x16B\x915l\xa0G\x10}\xd4\x8fi\a\xcc\xf9yX\xd8\xf2\x83\x0f\xb5\xe9nT}\x8a\xc0\xea\x02=A\xd1\xe2\b\a\x94\xd3!\x1dX\xcb\xe6Z\xf4\x1e\x87\xb8\xf2>\x9dj\xbc\xc2\xb3+E\xe3\x19\xf5\xfc\xd2!4_\xfb\xaf\fV\x84\xca\xe0L\xb2a\xfbnL\xc3\xea\x91\xd8 \x90\x8dL\xad+\x9c\x1cOT\xe9A\xec\x1b\xb3\x11\xe2\xc0V\\^\x7fl\xcd\xf7\x81{\xad\xab\xfa(\xa6\xd0\xf3\x9a\xb0\xfb\xb1\xe0\xeb\a\xf8\x138\x91\xf6.\xd2\xc4B\xc75\xea\xeeH\xbd\xc0.\xc0\xfc/\x12B\xae\xb3\xe5E\xeb\xe0\\0\x03C\xfe\xb3\x14\xedS\xd5\xfe&I6Uhe\\\xf4\x97}\xcd\xba\xeb\x85\xac\x89\xee9=\xf4\xc9\x933\x8c\xbfc\x8c.\xc0\xfeV\x13\xfe\xedC\xa9\xc9mS3\x87\xe0\xa7\xdb\xb1\x1cj\xd2u\xec\xc3_\'\xedy\xabj3\xc6t\xbd\xaf\x05\xca\xc2\xe3\xbe\xd6k)\x9a\xbb\xcf\x01\x06\xc1\x91\xe8\xda\x99\xcc\xa2\xf5$S\xbf\x05\xcck\x0f\xe9\x0e\xc6\xc3\xec\xc0\xce\x8ep\x12\x006\xda\x06\xfa\x18\xda\xdc\xcbx\x02w \xd3Bxo\xb3\xbb\xb1I\x9e#\a`\x97\xd1\xc8[m@\x80\xb2t\x95\xe7\xce\x97\xb0\xba3\x89<\xa8\xad\xf6\x91\xa3T`\x83$.\xac', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
r4 = add_key(&(0x7f0000000040)='rxrpc_s\x00', &(0x7f0000000100)={'syz', 0x0}, &(0x7f0000000140)="a0228726781a608b435204a6d51797878ad0ee89f3e65d6e8d2a38aedf8654251dde1e96dcded1ed3626a56ee35b282573746cd8407f94f8b3f380a6086ff5896f6186155e57985db44135192a90d939ad270e8109aae2624a8c5bb6b4886579d661c13e862a2aa7ab978dc4a1d50a9d4f8a54a69bd9cc7dd3ef8a1ee47a8e18d13bf7848e69015e298d6c0cb251066094e651e0c5f83d3f5ac0cff75f3d1d632c5211e95633352eba87e90946ddde0b962211e80306abf13a5b1643c4e0d95bf8f7d3bb76ff06b1251d932f3112c831c596c0abc92ac539a13e217c6fd8b0625be27b03223c4b803d5f76f9bf66cc2156596bd55857c2542292c68b576a09d08ec2d4d048569e801c209d5290fc44d0ac7fb0b0f011885698f2332b377bce9666f42ecb725833f5a8e1332f91d219f295a4a8b1a48afbd553c2ad3148392b931fa149821526290c58fe4a319ded58a4b175bb7d37e56d2592de58697e93ad1ddcb1e3eac5dc9bfefa54707337dcc3d4feeba3befab6437bf4c883505f4fa02d202a696d001e2b430f844fe1fd222898558e4e23e33537e3520f9bba397ef2cc73733c4c9bbddf1764044f6beef17adb42c7de5e3ae12b219eee81df735767c496bf05c379f7cc3a048f7e969a2b369cf2868423d8d65f5072cae212c687286146d2cc5145720495d105ac835e32b3b9793f5301f64e4da6c15a8b143e0532d05ebbcac30189b376fca5716df0f13e3ad7c9076428f9d60559797c14980291f371fd8989f247d824ec67f0effd87ab240deaf559ac698ef39ad94fcc2c7a2d72123433bfe8472eaf1abeaa6374da210cfaba10cb51be229ae064bf42a89a7bf8c7399c33989771b17897842d80151a38edca3bd7d0224b2928330350fa8c02e0b31d81809dcca379a1993666ab887413a28d02aaed9417de378f2a5850f2ac98f9dba3ac7b7b93ec258829c64a12b7a0f381f446f77d2029a4bfba03f4546b503d030665896589d6b92bb323b57df5b74eea66a09c45749f298ead6310284408d7e90a138cd93589dedfd79464cde7bd4797b2914982b25e55a0fd0cc17b96df0c8a29a9352c7c072eab64d1f21c10c8f36fa3cdcaad7aedd112e9354dc94c3731ab847d642fabfc22eda9ae266134568932a952b3b7817a630ee45fc7adea070688ee1895f7e9cb5310d20f33f99c84cc7e0a8c16aa9c5141e14a02ce7dabb0cfcf8b5922f03e3fba7db64f3eec6a277777ea8c4520ed09a3abc3bca84fab802d1c96ad2f0418f30a5c629523137f97855ccf260b98a1f73c4fca7e9fd71c94b5ec0f18d016a16fdc81c1c845a8975d0db558db92e9a126ca7df1a759f82f9351d76bb922937c1b7e1533f2e0b7296a3ce1c2011bcce07d9e3c7b127256ab15e1b85866bfc8898423796faa8539c19996260cee49c4bd87997a99101257995a3184e44e4f289a1762a50cecfe3b57d8a7ebe9638b604d1bf5af8ad72959e1a688f8331cc496e77f7c50a9846184653ebdb6ce5d54c4801dc604ff70354fc37a285584eec5b74d527f0f9142927b676347598ae566e39eab26de25101466cafa3f96410b15c92199f6b34f3af30cb8837ad633b353f9f598b936924f52cfdfdc250000dcd31e45da71939ac0435473b86b22764216bdf8b3cd5a298f0f508691ccb91bb76e3a48bcb6e6b23f59c1e4164ec6b861d6f3b081d39cc36962c0a05e96a9e9f172039a19bd4eab72bc74311d5e8caf3cdc6dbca54e81652d7fe298dc87be625fcdbf458217d5a2279be66a4da2e46346fad6a6c0144ed1c09d31d1bb753ad3886adcb0e210c241e422caf78ddb25cadbcb6f523ed61da90040698b94dcae5072c914370646a9d23f551e102f91ef99cf623936110d2ab3baada68d3d28c8ca5b368a4e5ffd9d99643d1c0d0b12dbe7ce717815a3f37d1c52be285a73ed7103bf11e3eacc568aaf172d242ebd6ae3630bb990b7f2acdfe99d043f43e92eff5498e3fef5188562e5b8b18726680ece52b4945598a8e856f3626e2d5b79415a3a0b3900894bc39f695c88abd5520fd74532620b8b8a9d00e881bc0472b3e5d91fdb5115326aff8aec0155cce718d581352e11600d3dc4800a53c168f45f39f43ade41f561c601b0178841fe791e3856e46df86eb682d1e25442feb77a1f3ab2fc335c9c458341d5161769348fde70ce1565710b027a6001699bdd515e496547dfed6e478ad153090f89b869d4c8769eaf6b3fa992d642c2bc44950034f2e8ea555897ebbe5a8a7dd539f36e40246435b6131ff311e7d996aeacbcd7763e8ff62937f70b8f7848ff691a8d1600025fd6d58e1f5ffee07be162d9710ecbb7b69d0028a2a00f344355634b216a7e01a0fd5ca95d631cbb1c85d31a0875014fbe93bd186be2a718b8799985ddd691a2d3cb3fa1efd7acaf29e8b07dc352a614e951e25bfc83a4823dec3bdc8d7487ec8a198d72d447adeba191da3ed134a80d18d65e094c563b7fd15f414ea734216081af37519c39a82f202a3f26d9c79046d7540e52a7412b6d688421ad04e3cec9e5f213d3260d1e191f053f79d70a92268859bf88690b25c0c90b73260f0e6ebdd61483bc5b2becd953b9378f6b50465c86d8fe7d2b842ca9ace5ea572bff4dd6d64b30502e3eabd2a95c3e726bc529b55e37bd20f0cfd621aa1b7bd076b46551645ad2f5a74a4a6596f1ffaa8419abdcb0af499ea3576544894e21b7f7823e5ca64f6d6261d8b11c5ef61010f1afa7a7c96b589333abc21959b6e911361580142aa6612e9081859b95d4cc57ad384a7f13d68a5184d9a4023ad900dda2f11010f74c5c9cebb4765061268a3f1cd15eb6ebdfb27070c95f334e864a8cc5f79db7db6b8bf25ee5fe23d5c4c1af7c03ae62bbbcbb715125846cce8a87c8d2ae1aa01d1d87715e33cbc86d5105ddb27696b3a205cd65e959771da40b069445bf2268a7be88d1e97648e941d45f358f036da8b211f2c4b1bcf1ee8a6a41798ee56e7fb36a45f7ece206fe8b0028e90ea61f8788d37f8cec74c1eca7c073a8a7faa49a84749d2e2cf34a372313b65822d5feca994447413d321b9d6fa57ab71459e1217b601b8847352ea8074693b6b72c742646fca7054d1f333c9a3430037f32d30bdd7f7e788645939cb00862a6e8ac530f0b54dd593a1fface9afeef5a6ead3aa956e965aab082ba20e49cb272ec6da9c6aef875ff3cfae8b9a6c571aba99bd2ffb348880fd38d857cb821a05201c7465b4b9883f6d406fdb79d6e499e850da6822efb5dab48fed5ad557f074a1b78c303f2007984f502b508b5a82d93523a6321cd3077a1ad974419af7f4ad8c9eecd3b3f05c7d52724f51a488222076ab064ef58e9628ffe5aeb1219c9911b411e2b46d4c1bded38174f6f83acae2cccdc6f057a9ca6a5990b8ee1f2e6394bb239212cf443fc063a51b31343973ac5669192d4de1c00a26c2a0b6e56a735e5085ab567f979dd460d74deda8ef19dbeb605024b72774cd543f8f2dc98d9a69bc9a9e831439aa06f475d673db72bd8d95a4efeb86ade4a85a3848490bf9aa87473198aeb589f87080216c6446e0554aaf42aca50151b5ad7d8ee1747b0b6d6635b51429b6a0cdbbcbb95a7df33a233d66782dc7101acc713785aa1928b6ac6f7d6cf8dba58b94ce284ed000f87555caa3c2b88bb504e9c64386b53162f3fe84a64b1f04e007fa0e86b0dca93a0f90b0fcf66a6a8a6caf826ba2648cbde09329f0a19131fac145ab4b582c6ba9ca09263ca5bbf48645b331b2003e0bcc1898a60a36390120a47028ffe112932edf87b7f0bd5a2c8ea7d14e57d823bf4e7a3ccc9c9d43a44e6d1e1b25f5e1895d99820c3ca77d968d23f71ca28147269dab6daac65d68d8b1ef104394a05e5999c0b814e966d436ca6e0c9cc6292958a516d83fbae581897fcb12087b8be22f4363a52bccd553b054b7328cf3d30bece8a01bb0bd66951114cbd21a7f70b2bb27be0ba55952e5c1f1be98462014e3157e795481b83bb92e7c6df06013273283c917bc434a41178e3a3bd63fd643f0de4ac3ac74817e6f237b3c54ed95f2125fadca1eb91e536b0a497898f7475f08a82b5414b0dd716c2f14129c1cd2db8dee53928a8b7adb09b421a0abfa3b28a301b39a4ebaddb8d5fb148dde0281ed50c9665ef1cdc9a06845e4282e9af26432bd8b237d1456ed810e1ceb2523c0a729d84770aaa367a2dc4932d4860df0c4b71315f6ab461e2f6bdae2a902ca9e17884f51688e3a688d5dc0728c5979e44d8e7d780d6573487b79a38afa2e7031e16a5d8228b32ea8c402df7b4fc548cb1c42d799b6b205a1783bd357f29b936431b0a4cbf27c07211d9b4c388999264a0e9e8c38b227b83ff7e60a0babc58ccc0698be983c06ea36a8173fcc61065a986b703e7d639f0374e2ffcd0822ac566132b837cea00e5bc73e23607520d9d26c87768d5b0b20446e227d21ab172454a091dd0bd25e818b38fb387c49e093d3a27ce4a694fff1f7e873a6bf3fb67ec4490b399b771964e28d96449af00e542189472ec3bd64d39818d8b5584dde36b54bcf1d7ccd1be46a0ac1481b6acc7d80d63523e7b8ea9a9b5508e4d70a787fc1662d2050ed2f2cd7ebda23e21095dac4cacc234457fa0e9860a19e7e64f2a5496b06e0bd4d0fb5562092a7f84b5c4886486590b8d7cee55fcbec68513c996afb3ebca5a0611bc2febd1f1ec8f74f0f3e24ab685e50399d426499e65d2b58cd2dd6a868285cf0c7011f142ea06808489bb5e55f3dd5606bb1dfc821970ade6971d67a8ab3a2229f6be8d89354744abf90396d1f90e7ea50cbb25c4f383c474b59432f329e4b56b089a753f47ee0335d447983b74b7536e049b6e219b4da3a40a70ad4f0adbe51434c48fff1d0eb15f6450849d9846f139df660ecb9bfd754ebea23ab96cc8ddc1df1eb83e30ec0e6d57e14546738c0d1ccb1db66e05c2e06d9405c6413877a436605666ebd0677a672aaea092ee3fb2be9fa80c1c5387ffe986cb22b9589a359b7d848d8e772a6938d97bdadb46bd0ba140c33b1a0c4e36080093d724dd82982625d0298259b25c2a76bbfe5dfcb970c61e11e18f9f1620a19ad55acfac9b6ee6405dfb25a68d974d2a17b5515e025b2740f8c88b7b9aa96888a7d1042e166889f1475e2a7acd6d017348e1952147a642830e414abfb571fee13d1ea11eb8363f181d95d9887c1c57d9567d1ab7b50731ef0719d5df02aa5c0194b02424f877c2116e1de21d615d094d9127b137e115d54c83f38cd0a03877c5777c08198246d6f5524945d3ee0b12758719a28e1d7ae108c2468b58e15f53b761fe1504997425cf5bd13e32a4cc1ea8bbd410ab8877c4b5e890d1dfcbce67acbb613a4a5fd601e6790c55cc546d42021a3d0ef52ee86e1d0b10e313550dd48d966db1a7177c5242ecd7bcd0b8150f1664e515a06b2c42dc755e76f3013a5840d88e046bceac3d44dbb320b1a974cced47978f152b3b576d4a76e30cf6b7ece3da85c1262ffeb0894a234810305e31cc0f01dc92aa04be85af0ee33e43631cb55f133b9b3303d52d55ff2dda33a564e02cf3a38621520a6561bcfaac3e09ef3443dd009f86c27842e14a03dc6087331760eaa4017bfe32df0ef13752cb47f526b539d3eb590a0c93d90c29d3144b327a5b497516982853921a173cc89762c0a7a77a43874488837c7e018e795b16349b4f9c72cc570778c13e7c6c8cd648d78e550bdfec909cac8844e7aedf902a32b83058f9803c98b668f544a85241", 0x1000, r3)
keyctl$revoke(0x3, r4)

19:20:28 executing program 3:
r0 = add_key$keyring(&(0x7f00000004c0)='keyring\x00', &(0x7f0000000000)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffe)
keyctl$search(0xa, r0, &(0x7f0000000540)='keyring\x00', &(0x7f0000000580)={'syz', 0x1}, 0x0)

19:20:28 executing program 1:
r0 = add_key$user(&(0x7f0000000980)='user\x00', &(0x7f00000009c0)={'syz', 0x0}, &(0x7f0000000a00)='8', 0x1, 0xfffffffffffffffc)
keyctl$search(0xa, r0, &(0x7f0000000b00)='ceph\x00', &(0x7f0000000b40)={'syz', 0x1}, 0x0)

19:20:28 executing program 2:
request_key(&(0x7f0000000000)='rxrpc\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)='syz', 0xfffffffffffffffc)
add_key$user(&(0x7f0000000300)='user\x00', &(0x7f0000000240)={'syz', 0x1}, &(0x7f00000000c0)="92d9a33b21c175db9a9c9448c7bf71", 0x23211fcaa24cd0a2, 0xfffffffffffffffd)

19:20:28 executing program 3:
keyctl$set_reqkey_keyring(0xe, 0x6)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r1, ':chain\x00'})
keyctl$invalidate(0x15, r1)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000180)='trusted\x00', &(0x7f0000000140)={'syz', 0x0}, &(0x7f0000000500)='4rusted\x00', 0xfffffffffffffffb)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$setperm(0x5, r3, 0x2220000)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='pkcs7_test\x00', &(0x7f00000000c0)=@builtin='builtin_trusted\x00')
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f00000002c0)=@builtin='builtin_trusted\x00')
keyctl$reject(0x13, 0x0, 0x7, 0xfffffffffffffff8, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
r5 = add_key(&(0x7f0000000180)='dns_resolver\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffffb)
add_key$keyring(&(0x7f0000000080)='keyring\x00', &(0x7f00000000c0)={'syz', 0x2}, 0x0, 0x0, r5)
r6 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_MOVE(0x11, 0x0, r6, r6, 0x1)

19:20:28 executing program 0:
r0 = add_key(&(0x7f0000000340)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0xfffff, 0xffffffffffffffff)
r1 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x3}, 0x0, 0x0, r0)
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="2fea091e3d54203671500e39763cecc2cc2e894032deff3dc4df6c81092a74e26dd8e2168f8e86cb81dfc498403135f903719efb4c43679f172f259e829de00c918a0c1d67b045ccdccc902458fc93cae47e0c4064c8a911ca77bf33", 0x5c, r1)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000001c0)=""/197, 0xffffffed)

19:20:28 executing program 3:
request_key(&(0x7f0000000000)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f00000002c0)=':bdevwlan0vboxnet0&\x00', 0xfffffffffffffffe)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
keyctl$set_timeout(0xf, r1, 0xffffffffffff0515)

19:20:28 executing program 2:
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000100)=""/49, 0x31)
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffff9)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYPTR64=&(0x7f00000005c0)=ANY=[@ANYBLOB="a5e15c8921ee91d08277b9fe67dfd95c062ee8ee7226d79d991ffd853858e104a95dab83d39cbf30bbf27aa6e81b592b38f585eb13120606c8d99ae8013f178f503a94211f927e5a7259467f2fd316dc09b0f33f61e614bc38c8da5a35341c6eb3439af5a13786de9b27f298f53fd4feda2a1e04e7deb700e6e608d6a7670eea0e992ad7dfb3ce5207b974f2342dc5ec1dd5099be0e8b10e7fa49dfca7f6ea6b4095558e2f365f8ea06f59973e6906c703e3bd83a9948453e4ac08fec751fa852c8ee6119d522d527513c6cb764fcc8ea2596909f458c5c437cc12fd843f426f76b6c3b255300df2461743266a", @ANYRES64, @ANYRESHEX=0x0, @ANYPTR64=&(0x7f0000000580)=ANY=[@ANYRES32, @ANYRES32], @ANYRESOCT=r1, @ANYRESDEC, @ANYRESDEC=r2], @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$instantiate(0xc, 0x0, &(0x7f00000003c0)=ANY=[@ANYRES32=r0, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa3681317ed725f2207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd", @ANYPTR, @ANYRESDEC], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
r3 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r4)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r4, ':chain\x00'})
r5 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000001c0)={'syz', 0x2}, 0x0, 0x0, r4)
keyctl$search(0xa, r0, &(0x7f00000000c0)='syzkaller\x00', &(0x7f0000000140)={'syz', 0x1}, r5)
keyctl$reject(0x2, r0, 0x800006, 0x201, 0x0)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000140)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r1, @ANYRESOCT=r1, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r1]]], 0x5, r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r1, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r1)
keyctl$read(0xb, r1, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r1)
request_key(&(0x7f0000000000)='trusted\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)='syz', r1)
keyctl$search(0x4, r0, &(0x7f00000004c0)='logon\x00', 0x0, 0x0)
keyctl$describe(0x6, r0, 0x0, 0x0)

19:20:28 executing program 2:
add_key$user(&(0x7f0000000300)='user\x00', &(0x7f0000000240)={'syz', 0x2}, &(0x7f0000000280)='Q', 0x2001, 0xfffffffffffffffe)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r2 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x1)
request_key(&(0x7f0000000000)='cifs.spnego\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='syz', r1)

19:20:28 executing program 3:
add_key(&(0x7f0000000a00)='logon\x00', &(0x7f0000000a40)={'syz', 0x3}, &(0x7f0000000a80)="de", 0x1, 0xfffffffffffffffd)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, r2)
keyctl$restrict_keyring(0x1d, r3, &(0x7f0000000080)='big_key\x00', 0x0)

19:20:28 executing program 1:
r0 = request_key(&(0x7f0000000180)='blacklist\x00', &(0x7f00000001c0)={'syz', 0x1}, &(0x7f0000000200)='}%)%\x00', 0xfffffffffffffffd)
r1 = add_key$keyring(&(0x7f0000000100)='keyring\x00', &(0x7f0000000380)={'syz', 0x3}, 0x0, 0x0, r0)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f00000000c0)=""/36, 0x24)
r2 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x2}, &(0x7f0000000080)="80", 0x1, 0xfffffffffffffffd)
keyctl$reject(0x2, r2, 0x800006, 0x201, 0x0)
add_key(&(0x7f0000000240)='asymmetric\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f00000002c0)="a14c5f047ac83f9f7c37a3fbcf206c7f5db7c6370799f45ac3008a7b6ff591ad1a2902e74387d09e8c5ab06074e2f41a514c810e2d7d0ad91d05e343bb99095aa21abc6a4760948aad1af1c0b05b1a04dda0043394a69316a8759a9a6a7d50f20b522d065004af3f06a49d56b51d7726f172339ec05deb38801ed32e7f73d987340890a50f66e956794d0934cc35fe0592a696144691006ee3b30c311c43c05b41367af6b743d5aa0686c1975406443fc8d8", 0xb2, r1)

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r2 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$link(0x8, r3, r1)
add_key(&(0x7f0000000140)='cifs.spnego\x00', &(0x7f0000000180)={'syz', 0x1}, &(0x7f0000000200)="496f7b7bd2a9f71fa5f70b92d15270d3cdf0fe6f515a478affe7bb2cd887f2ca6f7b460bec13e1ed2441c8f5f17d23118170fd73b24eacc5034c50c3049f0aca1b7357ae8498b6c8281d8b454e5e73feeb57d74033513c920df4de928900fa30df744851e123ccf964d3fe94fbaffe472ea979", 0x73, 0xfffffffffffffffc)
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r0)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r4, 0x1)
r5 = request_key(&(0x7f0000000000)='rxrpc\x00', &(0x7f0000000080)={'syz', 0x0}, &(0x7f00000000c0)='\x00', r1)
add_key$user(0x0, 0x0, &(0x7f0000000640)='O', 0x1, r5)
keyctl$KEYCTL_CAPABILITIES(0x1f, &(0x7f0000000040)=""/39, 0x27)

19:20:28 executing program 3:
r0 = request_key(&(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)={'syz', 0x3}, &(0x7f00000002c0)=':bdevwlan0vboxnet0&\x00', 0xfffffffffffffffe)
request_key(&(0x7f00000000c0)='keyring\x00', &(0x7f0000000040)={'syz', 0x1}, &(0x7f0000000080)='wlan0nodevsecurity\x00', 0xfffffffffffffff8)
keyctl$restrict_keyring(0x1d, r0, 0x0, &(0x7f0000000100)='keyring\x00')
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$link(0x8, r1, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x0}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$link(0x8, r3, r4)

19:20:28 executing program 0:
keyctl$KEYCTL_PKEY_DECRYPT(0x1a, 0x0, 0x0, &(0x7f0000000300)="b7b43f3a8742d025cc7fa60c9fc66a92eb5e1bbdbe495bede94eadcc3eb67f2323", 0x0)
add_key(&(0x7f0000000340)='encrypted\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f00000002c0)="83e7", 0x2, 0xffffffffffffffff)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
r3 = add_key$keyring(&(0x7f0000000400)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r3, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000000)='encrypted\x00', &(0x7f0000000040)=@builtin='builtin_trusted\x00')

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
r1 = request_key(&(0x7f0000000080)='encrypted\x00', &(0x7f0000000340)={'syz', 0x3}, &(0x7f0000000380)='\'vmnet1^#\'em1GPL],\x00', r0)
r2 = request_key(&(0x7f0000000240)='blacklist\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f00000002c0)='em0\x00', r1)
add_key$user(&(0x7f00000000c0)='user\x00', &(0x7f0000000100)={'syz', 0x1}, &(0x7f0000000140)="8c3c84e67ae3c02573bf12683841943dbe24c45ceba85ddc8930120c830b467022ef8b5eb4f0a5f97eb5d32034baa4e1b7f2a3887e38d99aab6e8796eaf8fc85055872e20258ae346c4c233094158aa6874612d71b738969dfbdd09975b155276400394010879366ffe4e518ac482ff855dc24eee96ce21e66fbb9b2d96f09ff97cc06d1d0928037d0680d8939329d410e2e4c7f035b83bdfbcea4c8ba223e7e8fe9554963dae53c075414e306dfbbcc8c3d422e42c6a24fcc00a89a91e1378d60005a02ef91d4119000", 0xca, r2)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$read(0xb, r0, &(0x7f0000000640)=""/163, 0xa3)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$search(0xa, r0, &(0x7f00000005c0)='trusted\x00', &(0x7f0000000600)={'syz', 0x2}, r5)
keyctl$assume_authority(0x10, r0)
r6 = add_key(&(0x7f0000000480)='blacklist\x00', &(0x7f00000004c0)={'syz', 0x2}, &(0x7f0000000500)="31451d26116e97d114c7eab88d4f9ec3b280e9e009fd595acc904c408711e5eb9110717db96ee09a88fde0773d78d74c1a26d7e7a04857adee388d1e73ef97a96ed14d4d3f4f563a5734eef322bd54aaa0acce2687caa40875f59c590f25039b538062a9d3a093a5035a456e86d1e034366783cebe24f50b155e30639752beb3ce0fc8d05b5d1c3c8899a05814da4af5a7f51b8c719bc004d75182c2da66c7968c", 0xa1, 0xfffffffffffffff9)
keyctl$clear(0x7, r6)
add_key$user(&(0x7f0000000300)='user\x00', &(0x7f00000003c0)={'syz', 0x3}, &(0x7f0000000400)="c5c23a8f6b8bdedb4562015f0646df9b5121244551a697a56b5555cc5377ca2478b3b766405b5c8fddd60aa1a14dc132d4fdf0ee9611f4bf7b738c1acb11e234a19de5eeaf2ed31311d91aa365521ea837d47103f07beff29ac26388e152608276139f0eb22e4e9f18372ba99acda4f2313c0ddf", 0x74, 0xfffffffffffffffe)

19:20:28 executing program 2:
keyctl$session_to_parent(0x12)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000240)={'syz', 0x0}, &(0x7f0000000580)="515e2c010000000000000052c59f8f7e57048ccb6b8156a075dc8322f6f41e7660de9c6e7fe89843bf6cfecc0f2b8b1b806ccc83b4654195c5ae18c46b952d346d07754df30a06440fadb983d958165ba4940cf3b24478bf9318e2defe7062040053713467ae47e7450bb4110cc06e6c9912e0cc352db41c72e651279cc1d9c52ea1db1e39941cb71109febdaa96f793f7441feac13e0f95c9e73ab110ce98efa900000000237b0400c475499e5c537d54545d8f489bf9a9f799745fd858634ad37b817abadcc7cb621722f5a20c95613f32f7867cf2dc97ded545cb33f8828ca96aac7e7ca94da8b4149d795f6f40642bdaf84a5091cae57ce69814bfcbc8bbb7fe9d4a6909c007f591fdcb20c3acb284fe5ecf890bd32b0a0538cab9550aefd063f480feef5ef8260bdd66ccc0b117a53420493edd721e0554b2ccbf3ed8073ca724195181cf2fbd18424fe60f219f5549c2bc9d190829aa47771d683b5e549484a2c7074cef9013d9a000414ccec1028e7c6659c7ce6ef020115a6c8c08bad571108de173e0205dde37d409bb3a7ed0e582c1976d97460212bacd7802e68c649d7b5a0c38dcb9967b", 0x1aa, r0)

19:20:28 executing program 0:
add_key(&(0x7f0000000240)='logon\x00', &(0x7f0000000280)={'syz', 0x0}, &(0x7f0000000ac0)="3c22b2d9973d0ef8fdf6e7f7c0ea0051c0ed91cf39ad835f990853c6b8ad815a7605006aca1f8bbfd0930a0f3a7b3127e7d670ce6dd49f22aedef133f9046650ce80e38be1c5506a57fab8041426ec224b5ddd66180345a2a8ee8112de42e4a4a5aff3e7bc828c516f870767e611b235be0baf59974f7d065e27c4972d84150db8d2da71bae7345e00b108cd9077d31c0d57ea67ddc496b50028a9d2df9709b2234466c14f05f0fe54c780181871d1dd16fd5b9d839452536976ed73eeaa74dada64e43da902be935833eb642524be0960d71868e360d2955534ff9ff78ffb9ca2eb9be4af4a25b07c1de30072964d58ff32745dbfb28eb327be30e0972b2b9bb2acaff52afa55f349c55ce1380657d925d7118040382421856ba8087bcbc22e70ea44da51858b9d35d8e13c598f525afeccadd79e607835f92aa683ae047539599e1dd1eed4bfaf2c06a2e973f18ad7186e73749119bd144af13a8f39e89b112f1d0bfeb6c1044b5e55ab57f58f2bc79aa9639caa01b348a49605b9b12351dbeb0e38bd01500b717a5bf63eec9e15f617612cc28b36ca3beacb1ba37645010d5bc047bb12955476326c8eaef11181f699a1ecbfd664065f68254fd0dabe77a3217b6aa87c2839ab43506c63e7eec891e30acccb2624143d8bae117b62d9bab98446ebd9e08c3c3f904172f39becf836eda5c339b013a3f387d44ab7cf1f6f67f1ff6e3f3268abc1fbf279a6466922ffa02546e7efa00bdf7c5335143920e6daa175e1602e63603d2706042841b9ba79aa9beabe2019b3df1ebf316a38b3272e936c91cbf0575e5fa0cbc0e992b83192a429cb008507f8007ac49e9b2d3f7ac7f9cb470ab2a011ba0a32e8fb7a3a3a5bffc1ec45ac3a219e53b11c640477eaa28e83142dbc35c084dbafa54034e34b38b15bdda592a073ba4f6c8ef04252efe476fbed0d87dba02236a3cf2fca62684c6b392660be5837fc64b37f6cf0d5b627a58c89a94162b575e76f8c35e18cf335aed0d501f7fa2e98d308e79ae7fcfc8163be7b86b35a8315ee937ba2f235f5c7116eaec99d76413c683a13518aa49e1b7a5366123ea111f8bb08ec6228a0fc85654d9df2d485bc1437e9656751bb44fc648462efe9ae33631368b75a38f72a46b1b9dec5c001f8b67226a5fbb73d565c65457f9a0945c930fc02c0a301860b266108c9517d7f0a861dd0ab5815bd54e43f541ef5fbdafa41c5d6a5d7a283bc50deeca9ef932e0f864d84199f9e0a4c8843d6c29725b23a63c73d69aa45439c3dca38d7567734ee75f356d1e86f3c5ab28e346bb9ae81325344aa1ca4d6cf2dcb7a51509fc0f25502e2cd290852ea707f2744efeb1371320918657497697637dc22c3a39551100b74fc1c9c50d0082933aaf5aa5a0bec283e593267de44e68ed751036ba9f3ca47d339fdf214e3908007bc7d966ee10a37f2e7f3435187592ac05ef1ed74a9f6e805630c9a38bc67123d764401791e0bd8c7219f431d01cff5191a0e310065a44c4c56194c270630508814fdebbe1224e31a33f2b1af8d9d93be52fd4088f7e51a40e7af734301287f30adad39510447ba8fc270edfd25cf47fcb9294106789677f2c137bdf409853b0d9506ba7795faebdef8885eba157f6b7aeba314e99d29da7c1d81b613463002bd567e17f616a89f26281a85645400084b0aed930b856f6bc40c763cc1cda1cfb2d37251ca645f8d83425c9423d39af4221f38fefa1efb6cad4352c1735856bbe4164462f6476d740fece7be2bd3e536e6696b798609b12c5d21a46a193a228c2078c4bebb1582ba892628e1690fd09e08e35d9fcc11b03901554f40ae8aadbae91895ee51282863d8da193340c5461054a02cbae8e9ab41b95315d5f2edd7d0ed1349a604094d3e3348529bb0e582b603e39713da528dc7d65029b9c31e3b6631359339a9c30b36a4e586cbee97683bbdd1bfa6f559f1aae230bff6534ac2c11c82763e78efdefec8ae053421796b7524bbc96acde04c5523d523cf0f73f3442b7be45a8710432592b973dd1b59c6ca0c0320ae14f9d64ca0ac3340e66c1e5185ca1473b1dc31c88181605a7b16ec97cb8dceb417a1093730075bfc322e1f2237f8e2cf24ac595f33ebadfd07b7f593851cee9bda2b35e26866bdcf2d682e98c41bd42428083b0571073e4841e867ed0672c8647ead6b849c57503134537f4fc54dd349b23d44ba5267c9e7a924c28adcadbc2b4062339d60f477690448ef79bb494b86c5d412ea9aecbbf319d97bae22f17ff299cf502178303b667e40668a73807905f4e48980aeca937a401c48fcc5232208e2a0ab1199b07fbe8855a9a6b202d339c50031b8cc8274ddf72240dcdc2ab376a31c3b2a54e2fb2d3b52c9f48922a7887cf2c467881686d25cac07b19628bc6c526c2a840c422cb7df44d8f678ba3d71b35bb3660f119a3066b6b41a0bae0b1aec48532389b83f55640152fa2dd1474649118ce730b8651511b2999a0edb0ccb6d4d87d57cb4a2c14337bab2ea0433e4b182ca5b0b83ec22242e7079a2b2afe0a997740011e844ff16e3b81ac178c493c8de3beec7f8eb7404ce48a16ffd4bcd68adaaf1fea5283c40ffdfa6a1200fb272aed6428947b3a33de97fd5e226c2d18f7701700c3e57d42e3b659c26e7af3b081c89da48a112a5754ede6e6dd11f4616a51e8bd5fe0a4104eed631155b1174300a0484ebb3e4c083ce66fe46debcbb237042eb0ce15867cbcef32ef026d0b880f15b6f73a77dab13be09cdd7203581da09b99ab7b2cf49f0981338e72a6265305da3ce69930d1a4e487f96c8386132cba4069597ce07ee7b2878d09d81ed840aca471bd28fec60cfcf7677b5f63c15269667b0bc5388758905f6c515f23593dcb0721a8ff092be1a8a8bcec8d22d9d798c36f71ec5b72a9b44952e02f5c9b1d57502608c24cc241be7683671b9964f7fd0350e187007ac02cc21139b10bf1e523c2e7bcdc3ecf28ce4e0a81111781235ace68949154a1445e34da30579339fcae5cf2f3e6831f5d21e4b51f5998a7a42cd2b1a2f9a63c70d", 0x87c, 0xfffffffffffffffc)
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$get_security(0x11, 0x0, &(0x7f0000000640)=""/76, 0x4c)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
add_key(&(0x7f00000003c0)='big_key\x00', &(0x7f0000000400)={'syz', 0x2}, &(0x7f0000000580)="ec66eeea0718c9e9bbaea2de72b091a58914fdf6a0dc214ba0b71ed2f0f1fa626558666f996d75733e6d0e89e7d5ed752ab98b9af9e9ebe86eab86f8abb86fc4e58b6f82d715044535c2398f55f46e44b6d46e6bb19b09a80c2cf79ed02da8c046b62205073c23685f56b83b6131ea7815173f64761e93ab85c94bacb4df54c32c4ee7d6af3115e4315242e126f2e194f848bfd2", 0x94, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, r2)
keyctl$assume_authority(0x10, r3)

19:20:28 executing program 3:
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32, @ANYRESOCT, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX]]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r0 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r1 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r1, ':chain\x00'})
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r4 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r3, r4, 0x1)
keyctl$search(0xa, r1, &(0x7f0000000000)='id_legacy\x00', &(0x7f0000000040)={'syz', 0x2}, r4)
r5 = add_key$user(&(0x7f0000000980)='user\x00', &(0x7f00000009c0)={'syz', 0x0}, &(0x7f0000000a00)='8', 0x1, 0xfffffffffffffffc)
keyctl$search(0xa, r5, &(0x7f0000000b00)='dns_resolver\x00', &(0x7f0000000b40)={'syz', 0x1}, 0x0)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT, @ANYRESOCT=r0, @ANYRES64, @ANYPTR64=&(0x7f0000001200)=ANY=[@ANYRES32=r0, @ANYBLOB="e96500d3cbf31545332f1ec99178fc7000305ac1b9c6d369f03bc0c5a703ec0efc04fa283d361c215d3beb235924879a047a664ad773a2e24002e2a919bf72cc0afa56199040048d60cc1987c39888", @ANYRESOCT]], 0x5, 0x0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$get_security(0x11, r1, &(0x7f0000001180)=""/17, 0x11)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
keyctl$read(0xb, r0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r0)
add_key(&(0x7f0000000100)='id_resolver\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000180)="5b8905e65ae4c439bfd03400834b4810ef6ac0216717683e9e4708f86e9aa671efbcb64c1f170cd6a6644ad436026ab91645f5a2e9e2a4588fe9ca246ecf18fdf48243170b54656784192a0eca8bee529c8ab3db24438deed99bd74882b32ff2d07edc432935338ddbdb275b3ab5a1f15b870f7eae78cd323415c2883ea6f22151dbc2d6ef44208106af36e7ec09005f4bb3cf1198720fedcfc3fc2635086d679c023b70d14dba5081851c0b0ed7935b1b311cc5cd3e8adccd6890e2c6708d7e4d972a2dd899e64be6203c2feffc45297f6eccfb2f59879965e07b67ef6f50e6aceb6c22949271b0a17fef0f70c7fae4b0dedbb839d4fd5f8ad79ce734d61e4ff7e34260119f77a921e8fa2c37df0c7e4b46441859e0a01f84961aaa0e1dde16d436bdf326c32827ff0b408b701f45340559b9e28fecbb2e986c21596f7e43e88b26a18544fbf079affd141b7c4e050506b14b13f587197cad19338ab687e85c5b88a1b442ea34b9b44e318d7e162c974d9ea8cad66d5aa423f37c3d5f05e1dece348737746329444cc6df088c3ea5d488479b768437f648ba1a175c7dd836f1a5b165d43177c3c3ef29d1869c9b3ef25af44303f8d930ebbf6efceb2290b04355959a5fd1c7e34baae76380017955b7a41bde63216301c654254cff792d42f2bc6d9ddfb364ece964a09c6ebd17a7db0388113413996842ec58ca9b54e30c7bce60c8e8f0d3c03ffe8c0a142cf252ffdd567c106c60db9056fe9d6390dd1ae7d2f807b9bb7a4c2cac358a813910f7062c85fde1662d5f1b1ee450cececd05e0cca646b1a5f605ffb2f9270b80a1cb9d8c5720a2153a7f8a5d8238d506f85a608e0b98a5f8b9c0d84de11ab7d5ff98d7c61ca909ccab28d301bc479f2725871c5304ebc8e1e34400086dc7b240cabff723c3d7701919bbb82e16eb4ed7a43c9957cb5ea6cae99e7a61e429e2e76b2bd37b598c8918be659c5fc6715439cb8e0e7036386c392b660cc6e7c937a0c3820bca651448d79ef918616c70a227f39ba69366f1cda841e507758b0d38097a8d8ea58b7e3552c251bbad60c7d1762b7e43dd3ff9e281cee9eac80964d972e83f27acea2596267bb08ea88f6ed084ba70a096088455aa53abc2b1922e8c60d60799569ff337124313b10d289d7af08af7a3f199a79173d8de019b0df4c196c8b2b5bfa75e7f86a25690d74fe05be29ef0c381cfb732418de3a17358af70b51276a6a7d223f28698d9446f678c28d4b4156d0d8410d0cdf4d327de4248b8be6c598d750de67ab49d12dc6c2ac6373184b24a1ec5491b6c0a926bb54232679ddca9424aa2de532ee4654c94956fe069cfc7865c1d0ecf734d7819eb9053f06a6662dbad19000fda93cf8aff4325293d82a25140529c88ac00e345df4075fce0ccc823ed2edc76059e899f218de78a10406b333f0b60afad158640e57fe6636db51dd8372043f1bbb2baa958c4f4866a232c94bd4649f65d0ac65a760b0f704ad97214bb746ba5b8ab1900e7fd92a8baa2c8c307f47ea79bfe2c7752aa965a919765fb2c02cdbb2adc1acb5a65a848a5a243811587904e5346e1541ce1630d4d359ece19fde023921d1e3aa010bc3f4dcffa499eae8bdf6cd3c5867afae8c639ccba42f20b6576fe2c10f10c2f101685c44d2633bcbe8b71ba9cc5d5943547d8fd223fa23e675f56ec94f0eeee18385ff73d384ee348d60deebcb22daf4c45df01a78ea30626da7a9c2079d633307b16f282b6e099e1e2f21e93d8f8c7f666f3fc79c51517c3b6a168b8115cca8f4ca01d661fef4cd5a75fa419eb844b6fcef53c13e78ccc94786e12b2e50757d3202ffbc48e0e708d7c1d22be819121fb954aed2ff6fad18f2195562227c7e6ad3763e580067bad4214e69eb28f8bf4359b2247306e4f8529d169ecbadad8197b0d8610da433a25e54f8a14c6e3d4bf3f1b31e4c9f06c3b1db7ca03d58ae38bb2e7c8bed534d69e538a763ddfcfcdcf9d1c16546950e892e59d228084d2ae1774d9503070acdb999cd94edc2eabff01f0a7df387a0cce923b442ec84b7414b6ef18e5c9c0a30f5970a9ec3a8d08489d5ece4bd69de40a72d5cf6fe7332b1abad721f9f56eb412b3d6f3ce4dc4ffbb1febefe87080f8c4c714967f04fa0002befe27eaa647978b5e322fc034d36e548e312c294a60b1c2cd9f038cc5f0ae81f42bd89ebcc270059a9c08c6e62c9e765b473e8792d772a70f7f670fecadbdc4b64a3817ec3e6f49975a3b21789c02683ce28e042b096d34582347b3703ed41c727e46db8e7a7079af35d7e6f02c9f59bf7ce9c2a3e912647d17a10144be1fa7c946a93e5d798737b6317bc1905e4b96f3fbfcc13ad391a942430b35903ec6cc5f7757bedf1770446739809c4ff8d67c44720570b62b9cafa955c6b669a78911a849954923b98f945ee18f8b0f1c685578c43d4d8497daa1ef7c02c60b742d1904ddab9e45203b92965142a2346dad25038011edb43861bf782ad520de3fd12ecc3571b33596b4b4825386511ccad0943805d6250de6e9d5f2bd891b5524c15c6cc790246682af940ba4adf248771e5dcd390bda454a66762b7516a4e65f02d1a6d75d310a48b80b89f17185a2c5a585bb1c3e3491b154860c4dfca3da8af8ccf88983ac6b4bf8b90a0083eccc5cc21f8c417482ef76063d0e28a4e999d534f62ddfabe48731f782f1f934c4c0c64f40a35e90966d547359c6d7c7d1e4b82532442b5fe241404e3eeb562aaae81fcabb01fb9a9fef4e67f66e39a36d5629d0f0f851f8154bf966c294f9e0db7c4d7b4850c37a7a121325cbb215ab92619a00f3085f8cfb23b96e78f479f340a5da42fcb620f300079508ce783474c226061bc499dcd1415d6014fb5c5279b14f8a3ed21f7315a92d426446f0c7814e9c90de878450eba0e5b0f542469baac3a85d6c5eba3b1267c14a8d216ada1394257492d935ee320149fa5d194d1f446469e51b21bc96bfcdb1030d7f201f707680a3c86383e307e57c283db3b93b0e307749de87fd25b3cd0c1c0dc6590e8c48dc7bddb64b65df3045607ba1d916ee8a15374b8f3e6c673dbcf9d90702590921717e8b058bdc767cd5dd9d0ab302f83f6ee6206215d2308becaf75a762330a9be8bc3c3d3a47d629195fc8162c4520939af583906de1149bfe5e5ee4da36fb25999cf5448ef902d7f39a4bdbfd2dd73bf0ad30f4ef0521c7cfb462b1bb00af847f6ba7a2740eded31878da7007f8d0c3bafd8360369f4d876dfa0fbd502308e259d99be61cb4bc3862bdd7c2287f53916b05e6564bc19e6f38bf52e4bf4961b538d676703c66d95787fddd2373ac7c4801d299955a46dce639aabad544224022a43a14e7572e4af56466b88fd3a6718d40503800695a0814cb65fe2f714357635439a54b4e8e491950bbb1186b0701d4c0fbd9aaf0563f257babd6a716f0bbd5ea1809f2669b9d7286740562f873deace716034622c911072e2964a958b0a6d3ca66b219ec987f9bd6e46880a7e520d7f7abdcc87eaecac69f209dd63fd02eb969ceecb07019c69bcdf6e150de0efabbebe8dc98a31e90702b67f411b2c4ffbbf316df74204fe862081df34e08e6aa97a34927a99d0eaece227f6f48a9aa6627ec8bee7bb12fb59881d3bca4b730fe8530d421ebaa962fcf4c888889d8d312b52b6cf8eeb6d8bdc128a637465eb38907907ad22d903066e0ed90cb5557e76ea34f1d9733722b883a474da51628bdd490ade20c335b6dd77837c8ada85754f40e1d1fd8bc5155faedc5c1a745cb1b0600c1c097608661f50a64dddd1bf37f9b264852d40e992257891fd8c524c75a5524bb0539c68926694f7593f4258169ea5e4faf7a862929af8d306bdc1ee566e01d1ca8eeb03e9f668bb8e4abc28f332efc52d461272d5edf0f261bc276ed2d5a44f1b55d2a1dd7568394a6fee3a9e7306b3976ee68741a9b654dc972a714ab046da21479f54750dad4117ec4568212819254df8661f17438c72dea959b8ec93e001d701b5b5dc5cab4f6e0b896dbb25598212519b0e4ac6e226a976385b7af0f02625c60e8f4d8a08c758b58f3460d370872371c463c6f037e59c700d34e28aa29a1d27dced3bfb2f534570bf63931a02d6948c928e817a53a350e8bd528abe65f130476237eefc532ad17a6678e2dd13ed63831d4c65fb87d08410050c870c79df9e2e82e5576099033d9ae0947077df95ecfed91f4d31bcdb62d23c7ccf3f62aaf87b0e3e0323e7bf22f9a4d613cca3456c2f43d3f87b9b74769fd16c99008eef82b7f517d6d835abafdc2d966a902455cfaa8c4c6bb49ddf89a08f657879317813dbc10328622c98eb272ca58bb7fced4542d658dc6ebb1b87aff6c3ba2e9783d30a80510bb3ad8e8cac0d56cbd83a7ce09218c74246198abd73096a5d56e4080febdbdcf741d9a8a5ea9164ab66a021942d08037dc3aa8aa68da60d9f1a5db529ae1ba55ea3d25fdc810aa7db44f97b58f4e2efd885834c9f1fbc22738b6d0028b3374bf17e7f2c2be9863a83a6011cb0cf22cfc3bb0eed9e55e041a183462b9a866c2042d40a60dd4965837371416ba91165a5addb050ded9efd7c61b972adc6b0248fecb4b529663d67b1cc001144a87430239db20033c9a746669673c8bf5ee227a9e35921d942585f09565b75140cd3a1974d5f6a33380228934bbcdbe4a96c031ea2f0bbf71ecbf8a6041e6e3c7fcc3e63ae11353346bd0583138d89b77c2056b05f452a396643d8e9f6a9f3c4d9f57d563efca61f3aa41ae02c701745c2c333e63cba7f53ea9bbda7ed641a8b76f6632d76ada6b64fc06bdc24e230c17923718d012b04c276fbf5c735a84fabbd8fcd22e8db26b0f93649e74bbb46c07d1eaabf4c83d4f148288d6757cd0d8f51b3b18212e3a518a26444f12b73dc36e2cf4e7059cc8267932d9a4125221a79ad6efa33107ab996d0da7e580e260b5e9375fe91a0cd3e5a8e9cf290866490173a593eb60a40581612138ff2702201418c0abc1f1fe0dcd1be30102933aa612c426c2e9da56b29a5f95754e605d02b03329fb908f7e65297ce1896991b1b52c8d3828b50405fdc1ed95b48b7d576c966a78dfa418785c0682cfb83194fb6d2f5e6bff45f3bfab9a0d937a061fa8589768ccf1d542e74a855fb683a857050c5e6f04f1faf9ada89f9047a0126211edc3e5737f98b8fa34681dd7c75e79411cf76144f8c5debcc369c726dcfbff5dd3c22a63dd0c8d69669a36d068d05bf7638376285d5fd05560e82744182dace4bd51d6b2d90b8d3ec9c4af333c8e057dba56063fad2cc33f44738f5392b396b82d73417b90458d6f2da9627eb82599d079154537665d7273419dd7a3abf662bf364b8ca61a53034897c840f984e0398814eb200beda7fda2ece7b379e81c1ac79d60bb2ae9c6161bfdbf6ff5eead857573bc414a83556e40cf43036cb8508529dc91979080278050589424c310d14c7f6bb61eae7a197f397c99a0f6352299d187631e80e69e7a85dc40bf93840f6bd6f99965a3e666aa388a7d068140b76425c356f43035db29056d1a8c4fd1005348f4b5bfa95ab979cc4d68d4ed2ff89652dd94ba67b0feba31605acd04b57b659e9a2061823841fc58cb5944787f6b975c6cc0b0aa67c02a774b9f91e21f9704ed8c74c03de5b07667a92dc0b6f1fedc2889d1e83d577d3e748c6ce34eb0060e1ab2e84b3d4dbfd340db3d3dc61c2ce14e3d80e630e25b26afc2551f5f7a217332972b67c8bf3b813d9921ee8448", 0x1000, r0)
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$restrict_keyring(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000000c0)='key_or_keyring:7p\xa7\x8f\xd2a\xb2?\xbc\x11\v)\xd9\x8c\xe2\xb8\xb0e\x98j\xff\xf1\x92\xd6\'\xfd<[\xf2o\xc1\xc7\xf7\xa5T\xe2\x93\xfd\xfc\x13%\xe5M\xd1JF\xf7\x17')

19:20:28 executing program 2:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
r3 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r3, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
r4 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r4, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
r5 = request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r3)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r4, r5, 0x1)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000000)='id_legacy\x00', &(0x7f0000000040)=@chain={'key_or_keyring:', r5, ':chain\x00'})
add_key$user(&(0x7f0000001a80)='user\x00', &(0x7f0000001ac0)={'syz', 0x2, 0xe}, &(0x7f0000001b00)="bf", 0x1, 0xfffffffffffffffc)

19:20:28 executing program 1:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r0, @ANYRESOCT=r0, @ANYBLOB="ae04103140430e4438ef0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r0]]], 0x5, r0)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r0, 0x9982018)
r1 = add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000080)='asymmetric\x00', &(0x7f00000001c0)=@builtin='builtin_trusted\x00')
request_key(&(0x7f0000000480)='trusted\x00', &(0x7f00000004c0)={'syz', 0x3}, &(0x7f0000000500)='trusted\x00', r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@chain={'key_or_keyring:', 0x0, ':chain\x00'})
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r1, &(0x7f0000000240)='dns_resolver\x00', &(0x7f0000000280)=@chain={'key_or_keyring:', r2, ':chain\x00'})
keyctl$update(0x2, r1, 0x0, 0x0)
request_key(&(0x7f00000008c0)='id_resolver\x00', &(0x7f0000000900)={'syz', 0x2}, 0x0, 0xfffffffffffffffe)

19:20:28 executing program 3:
r0 = add_key$user(&(0x7f0000000000)='user\x00', &(0x7f0000000040)={'syz', 0x3}, &(0x7f0000000080)="efab75d937e35f6dab498c9c8ef9272b48b367cfcf91ecd199513c98ab91ba65d67281f056c9014cb754551a4667af1c1ce021ee632a422739e23267944e8c690fbab0bf86e37dbf6457913fe4148fb8ef10b3ae33f79eb89987392c8aadadf2bdf6cfcd0148183529a9b41e1d467dc2ac3e33b2d31ad8f1e26b3a078c574d0c", 0x80, 0xfffffffffffffffd)
keyctl$KEYCTL_PKEY_ENCRYPT(0x19, &(0x7f0000000100)={r0, 0x1f, 0x1000}, 0x0, &(0x7f0000000140)="dafab63b56f8dc6f78ad0e49b8cda4f8a6a518a8d4cf6ee9758b162a850adb", &(0x7f0000000180)=""/4096)
keyctl$get_security(0x11, 0x0, &(0x7f0000001180)=""/183, 0xb7)
r1 = add_key$keyring(&(0x7f00000012c0)='keyring\x00', &(0x7f0000001300)={'syz', 0x3}, 0x0, 0x0, 0xfffffffffffffff8)
r2 = add_key$keyring(&(0x7f0000001240)='keyring\x00', &(0x7f0000001280)={'syz', 0x3}, 0x0, 0x0, r1)
keyctl$read(0xb, r0, &(0x7f0000001340)=""/120, 0x78)
r3 = add_key(&(0x7f00000013c0)='rxrpc_s\x00', &(0x7f0000001400)={'syz', 0x2}, &(0x7f0000001440)="4ea118f211", 0x5, r2)
r4 = add_key(&(0x7f0000001480)='user\x00', &(0x7f00000014c0)={'syz', 0x3}, &(0x7f0000001500)="37313e17e1b94c6ccbd48a0ea86376a9330bc9430acebd5bda3419fde33e1ac729bf7258c66060e1cf73921bb2547b41bc1c57e8b787615b9c8c9580cb1a2b8c7688a25a1f579fbcb34a86cff7f32ca92c13fdbfe1f5129b939fa207ead3fa17baaedb7a", 0x64, r1)
keyctl$read(0xb, r4, &(0x7f0000001580)=""/133, 0x85)
r5 = request_key(&(0x7f0000001640)='keyring\x00', &(0x7f0000001680)={'syz', 0x1}, &(0x7f00000016c0)='\x00', 0xfffffffffffffffc)
r6 = request_key(&(0x7f0000001bc0)='cifs.idmap\x00', &(0x7f0000001c00)={'syz', 0x2}, &(0x7f0000001c40)='eth0\x00', 0xffffffffffffffff)
keyctl$instantiate_iov(0x14, r5, &(0x7f0000001b40)=[{&(0x7f0000001700)="0c606778aea5fa37c7916394c4fd193dbf16820087e1de28c2e3518124d3c56dd8dfd48c0e4e417a5503d1a1d564ae5ae0274eca3bb97837fe8b44e000b12fd06b3a5d85d09eb69484f4bf7832dc6b7c538e5df22a02b4aa50ad93a38b7672c202dfa87082bb072619e74830dcb579ac17ca15e773c9b4ac071007003ae76f1214cc91507c93a6345ac9a8452cf87c66baf7ea6ffa013008ff4a42c930eb7b598ca7731931f7103ac50e6933018aee84f46dc8780af5", 0xb6}, {&(0x7f00000017c0)="188d6dea74d518a31652b30ea16618d925832fca69dbcd6922eee28801ede122aa58ff1f7d61e4bd116cd78666577f44a4563dd5a1ca8f7363b6ca3a71f19c6f8f9521c0193dfa4bae9ac4a9a6aded0d58b79a782d2998972d4ecba2f1cd341af9f8f8e3506628f870d609e404a1427f54223695b38cb47e8c8e0884ac06da028e305c4e82576b51aff5501353eea1e0b2aa61267d73dc0f9fed309fa89099ffbefb4cd080e86659c3883d50eb0e686e6f878d59c6cd6a9f7257557fcc74d4ca11", 0xc1}, {&(0x7f00000018c0)="858a481a0140a1fe9d4ebe886c6ff25be9c436bcc9cc5b0890044873a7935cabb14b3a82b0e5a2ee810527b692780d2f6ea9aa050eeeec4e4a2dd19c3e650098fa8f3d250c5fdac5", 0x48}, {&(0x7f0000001940)="7736b44f09de953c58eb5f15d40b55cb4f0a649a1183b648983dacfc8bec7896142d739b0aed3bbcbff22a6abac4811fa80317af043501ac5fe6f5d27d8eec32588ce67dd9487a9996d8431b90c3d13a6495fa12bacfcce54ce2b31dc3951d76612ef7b8d9d86302bc9813ddf3b8ffb9fd2e309cd5dc74889b7935132787ca59d778bd9033725c8414be8f99b1480cf13d34c3286ea234803c77179bd69ae0582b6253bf49e9bda87cdcc40f1f2e14d14bc0f1ab611f34a54a74ff65a4c047c9d89bb36352f6df6a6f69cb7c5a76d54c4acd4c6fa38aba2f7119", 0xda}, {&(0x7f0000001a40)="be24893c3320c538162e9ec8dfa210a4a32b55d449350384a130ab89ae7f71a8557146b9e56e41b612a6a7083bf4d3a379c3e3eb7e37ef3779f0aa08ea3cdba97b3fb094f84f91928dea704083aca7febbf478e057f6a4878547c764320b5b61cbfe462e11371839f3baf619285effc89627ad4be5f9d1f2af611eafe88c52bcf7dcaa60e7c4c47b969c35073ac43b1fb0773f20b92d16363bbd2114286f99444b37445d546b053ea06ce7eb52446f8518233ae96c9a7ea9706ca833af82383f5e361949f5cf3c55973bccad8b42b98da3cffa52245b3710b012b61952e5a814c17194256ef6865fedd4b332d87c8312ab9a495709f802e6aa61", 0xfa}], 0x5, r6)
keyctl$invalidate(0x15, 0x0)
keyctl$describe(0x6, r0, &(0x7f0000001c80)=""/29, 0x1d)
add_key$keyring(&(0x7f0000001cc0)='keyring\x00', &(0x7f0000001d00)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffff8)
request_key(&(0x7f0000001d40)='logon\x00', &(0x7f0000001d80)={'syz', 0x0}, &(0x7f0000001dc0)='nodev\x00', 0xfffffffffffffffd)
r7 = add_key$user(&(0x7f0000001e00)='user\x00', &(0x7f0000001e40)={'syz', 0x1}, &(0x7f0000001e80)="374c4f5a7192d8fbafad73d446446badc3b3572855fa42dec76c2125259b2803e2ab0a5964261230304cd5531f59a68f9c9b849312d012c930e00279032316a3719ee4ff3503b087ebba090efe615d12c22cb5c481d64832de3572b4364f2897468c6d9455370471f87c133e93295ec56ae0487404703b404dcbcee024c2fd724b7cc6d0ea74c72409038177ca13fc11989aaf4407890c217d87ae61a9054faa1a302849dc341074b3ce4e2c30d860137a6fc3550bcc63d475702d67eca40adc0472c215992b74422e76eea9ff6b27dc3a55eac21d9d152198a341e6fa208924e383879bf8c8db04caf86426603d21108458", 0xf2, r3)
keyctl$instantiate(0xc, r4, &(0x7f0000001f80)=@encrypted_load={'load ', 'ecryptfs', 0x20, 'user:', '', 0x20, 0x79, 0x20, [0x37, 0x31, 0x34, 0x31, 0x30, 0x30, 0x64, 0x66, 0x61]}, 0x33, 0xfffffffffffffff9)
keyctl$KEYCTL_PKEY_SIGN(0x1b, &(0x7f0000001fc0)={r6, 0x55, 0xb8}, &(0x7f0000002000)={'enc=', 'oaep', ' hash=', {'streebog256-generic\x00'}}, &(0x7f0000002080)="80f3d5c8e2b870381bf74ca69dd9865d1d1bee6c7ca032f4a445e9a7dd9dc257250556146332a31eb91f5b350b1c1027e36339dcbd4b385caf1f9af5f45d0c98f27f8c3d63f53667f42de0ed5925209661c0a2dc23", &(0x7f0000002100)=""/184)
keyctl$unlink(0x9, r7, 0x0)

19:20:28 executing program 1:
r0 = add_key(0x0, 0x0, &(0x7f0000000380)="c3543993f40dd2514632455d209a097a1a0edd08e790ffc9c6c4a7ef210ebeab632904be1875c8ead727775629e2f664662f57c3e85275b895c45070b322a45cd794cdf381b11d4d33d75679e9e40d5640c459fa0af8dbbae323", 0x5a, 0x0)
add_key(&(0x7f0000000000)='cifs.idmap\x00', &(0x7f0000000040)={'syz', 0x0}, &(0x7f0000000080)="b89098a2ced6bd42ca0abaaaed235630f8537e7a66e3a09a021ccf1fa3abca7a22495aa42515b8789cb8ae5aca83dbfde8560a7cdf224a50d3cca0acf940fbd2e1faed8e3b6def76a37f9ba9e03f5fb31ded731352080183151821ad30686e3e2f40dfc7268ec393fa9f53fd42a91357e667604b76615744911f06d227e914d23726dbba64e2948c8e818a6bc9f8341e6ce41d0130e59a78229ae72056a76954c3b5fec5fadbecf06a9b272fb24597573536630523dd510502883ae28ec72050ad34a9229422d10e5fc190fcb7281d0f0ef49ca0200e7122b9a2e65c37db4e615369ba34e076e974eb4e462a40b15f2d63", 0xf1, r0)
add_key(&(0x7f0000000340)='trusted\x00', &(0x7f0000000280)={'syz', 0x2}, &(0x7f0000000180)="83e7", 0x2, 0xffffffffffffffff)

19:20:28 executing program 0:
r0 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
r1 = request_key(&(0x7f0000000100)='asymmetric\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000180)='keyring\x00', 0xfffffffffffffff8)
keyctl$search(0xa, 0x0, &(0x7f0000000080)='rxrpc_s\x00', &(0x7f00000000c0)={'syz', 0x0}, r1)
add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x3}, 0x0, 0x0, 0xffffffffffffffff)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, 0x0, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, 0x0, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, 0x0)
keyctl$read(0xb, 0x0, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, 0x0)
r2 = add_key$keyring(&(0x7f0000000000)='keyring\x00', &(0x7f0000000040)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffffc)
keyctl$instantiate(0xc, 0x0, &(0x7f0000000300)=ANY=[@ANYRES32=r2, @ANYRESOCT=r2, @ANYBLOB="ae04103140430e4438eb0cb57bffa368132207d9b742e403875e0c5f37df3568f4e7270ac2629f89dcce90aa02a413542e8b0abf1930bc5781d2e1f92d61c90d5ce292c484203761e86584e703926c179b7dc7601d725caad81ca1b5ae820d343e4897a2bec0fd8efff4da", @ANYPTR, @ANYPTR64=&(0x7f0000000540)=ANY=[@ANYRES64, @ANYRESHEX, @ANYPTR64=&(0x7f00000002c0)=ANY=[@ANYRESHEX=r2]]], 0x5, r2)
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000180)='trusted\x00', &(0x7f0000000140)=@secondary='builtin_and_secondary_trusted\x00')
keyctl$KEYCTL_RESTRICT_KEYRING(0x1d, r2, &(0x7f0000000100)='asymmetric\x00', &(0x7f00000000c0)=@keyring={'key_or_keyring:'})
keyctl$setperm(0x5, r2, 0x9982018)
add_key$user(&(0x7f0000000080)='user\x00', &(0x7f00000001c0)={'syz', 0x2}, &(0x7f0000000200)="66649ea134a726f1257531631192283087a4eb7f5d6372db1549", 0x1a, r2)
keyctl$read(0xb, r2, &(0x7f00000003c0)=""/135, 0x87)
keyctl$reject(0x13, 0x0, 0xfffffffffffff044, 0xfff, r2)
keyctl$KEYCTL_MOVE(0x1e, 0x0, r1, r2, 0x0)
keyctl$get_security(0x11, r0, 0x0, 0x0)

[   16.969094] Kernel panic - not syncing: Found leaking of user_key_payload
[   16.972934] CPU: 0 PID: 5400 Comm: syz-executor.3 Not tainted 5.5.3 #53
[   16.976444] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.0-59-gc9ba5276e321-prebuilt.qemu.org 04/01/2014
[   16.982509] Call Trace:
[   16.983973]  dump_stack+0x15e/0x1ae
[   16.985893]  panic+0x228/0x700
[   16.987336]  ? 0xffffffff9b600000
[   16.989055]  user_read+0xa0/0xa0
[   16.990601]  keyctl_read_key+0x1f1/0x240
[   16.992577]  __se_sys_keyctl+0x4e2/0xcd0
[   16.994485]  ? _copy_to_user+0x8e/0xb0
[   16.996462]  ? put_timespec64+0xbe/0xf0
[   16.998378]  ? fpregs_assert_state_consistent+0xac/0xe0
[   17.000970]  ? __x64_sys_keyctl+0x1c/0xc0
[   17.003118]  do_syscall_64+0xd1/0x160
[   17.005176]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
[   17.007853] RIP: 0033:0x467519
[   17.009501] Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48
[   17.019033] RSP: 002b:00007f87b0653c48 EFLAGS: 00000246 ORIG_RAX: 00000000000000fa
[   17.022819] RAX: ffffffffffffffda RBX: 000000000074bf00 RCX: 0000000000467519
[   17.026414] RDX: 0000000020001340 RSI: 0000000038478ef3 RDI: 000000000000000b
[   17.030000] RBP: 00007f87b06546bc R08: 0000000000000000 R09: 0000000000000000
[   17.033412] R10: 0000000000000078 R11: 0000000000000246 R12: 00000000ffffffff
[   17.036515] R13: 0000000000000705 R14: 00000000004c83ba R15: 0000000000701640
[   17.043228] Dumping ftrace buffer:
[   17.044487]    (ftrace buffer empty)
[   17.045790] Kernel Offset: 0x1a600000 from 0xffffffff81000000 (relocation range: 0xffffffff80000000-0xffffffffbfffffff)
[   17.049837] Rebooting in 1 seconds..
